{"meta":{"version":1,"warehouse":"5.0.1"},"models":{"Asset":[{"_id":"themes/Chic/source/favicon.ico","path":"favicon.ico","modified":0,"renderable":1},{"_id":"themes/Chic/source/css/base.styl","path":"css/base.styl","modified":0,"renderable":1},{"_id":"themes/Chic/source/css/font.styl","path":"css/font.styl","modified":0,"renderable":1},{"_id":"themes/Chic/source/css/custom.styl","path":"css/custom.styl","modified":0,"renderable":1},{"_id":"themes/Chic/source/css/layout.styl","path":"css/layout.styl","modified":0,"renderable":1},{"_id":"themes/Chic/source/css/media.styl","path":"css/media.styl","modified":0,"renderable":1},{"_id":"themes/Chic/source/css/normalize.styl","path":"css/normalize.styl","modified":0,"renderable":1},{"_id":"themes/Chic/source/css/style.styl","path":"css/style.styl","modified":0,"renderable":1},{"_id":"themes/Chic/source/css/variable.styl","path":"css/variable.styl","modified":0,"renderable":1},{"_id":"themes/Chic/source/js/mathjax2.7.5.js","path":"js/mathjax2.7.5.js","modified":0,"renderable":1},{"_id":"themes/Chic/source/js/script.js","path":"js/script.js","modified":0,"renderable":1},{"_id":"themes/Chic/source/image/avatar.jpeg","path":"image/avatar.jpeg","modified":0,"renderable":1},{"_id":"themes/Chic/source/js/tocbot.min.js","path":"js/tocbot.min.js","modified":0,"renderable":1},{"_id":"themes/Chic/source/fonts/iconfont/demo.css","path":"fonts/iconfont/demo.css","modified":0,"renderable":1},{"_id":"themes/Chic/source/fonts/iconfont/demo_index.html","path":"fonts/iconfont/demo_index.html","modified":0,"renderable":1},{"_id":"themes/Chic/source/fonts/iconfont/iconfont.eot","path":"fonts/iconfont/iconfont.eot","modified":0,"renderable":1},{"_id":"themes/Chic/source/fonts/iconfont/iconfont.svg","path":"fonts/iconfont/iconfont.svg","modified":0,"renderable":1},{"_id":"themes/Chic/source/fonts/iconfont/iconfont.json","path":"fonts/iconfont/iconfont.json","modified":0,"renderable":1},{"_id":"themes/Chic/source/fonts/iconfont/iconfont.ttf","path":"fonts/iconfont/iconfont.ttf","modified":0,"renderable":1},{"_id":"themes/Chic/source/fonts/iconfont/iconfont.css","path":"fonts/iconfont/iconfont.css","modified":0,"renderable":1},{"_id":"themes/Chic/source/fonts/iconfont/iconfont.woff","path":"fonts/iconfont/iconfont.woff","modified":0,"renderable":1},{"_id":"themes/Chic/source/fonts/iconfont/iconfont.woff2","path":"fonts/iconfont/iconfont.woff2","modified":0,"renderable":1},{"_id":"themes/Chic/source/fonts/iconfont/iconfont.js","path":"fonts/iconfont/iconfont.js","modified":0,"renderable":1},{"_id":"themes/Chic/source/fonts/lanting/lanting.eot","path":"fonts/lanting/lanting.eot","modified":0,"renderable":1},{"_id":"themes/Chic/source/fonts/lanting/lanting.otf","path":"fonts/lanting/lanting.otf","modified":0,"renderable":1},{"_id":"themes/Chic/source/fonts/lanting/lanting.woff2","path":"fonts/lanting/lanting.woff2","modified":0,"renderable":1},{"_id":"themes/Chic/source/fonts/lanting/lanting.TTF","path":"fonts/lanting/lanting.TTF","modified":0,"renderable":1},{"_id":"themes/Chic/source/fonts/lanting/lanting.woff","path":"fonts/lanting/lanting.woff","modified":0,"renderable":1},{"_id":"source/CNAME","path":"CNAME","modified":0,"renderable":0},{"_id":"themes/Chic/source/baidu_verify_codeva-BNp6wxaszM.html","path":"baidu_verify_codeva-BNp6wxaszM.html","modified":0,"renderable":1}],"Cache":[{"_id":"source/about/index.md","hash":"fd6c05a8a6cb50bb5c9172f974a1f4df05cbc69a","modified":1734934531043},{"_id":"source/_posts/ç¬¬ä¸€ç¯‡åšå®¢ï¼Œæˆ‘çœ¼ä¸­çš„äº‘åŸç”Ÿ.md","hash":"6eb81dac14ee92a10f752cf0b3775bc22470a30e","modified":1734774914820},{"_id":"source/category/index.md","hash":"495a5b1bd9c38eab2da81246e883cc3eeab947ef","modified":1734934527719},{"_id":"source/tag/index.md","hash":"6b1c99fb359dd402e711a544d0fdbaaa143862c3","modified":1734934521647},{"_id":"themes/Chic/LICENSE.md","hash":"632b916dd7e4f5c11790ab808388cda6610210ed","modified":1734925557115},{"_id":"themes/Chic/README.md","hash":"b33e7d4a20dde46667050db2fb14c783fcd1a6c7","modified":1734925557118},{"_id":"themes/Chic/_config.yml","hash":"6df8ec5a57a3ef3acb36521705f8d56fbb2644bc","modified":1735349583099},{"_id":"themes/Chic/README-CN.md","hash":"e0b616b7546d05a50bd7bf046858af8e221fd0fc","modified":1734925557117},{"_id":"themes/Chic/ChangeLogs.md","hash":"933f301ff60aa18183fadb929e6c24023c9147c2","modified":1734925557113},{"_id":"themes/Chic/package.json","hash":"55d477f0e6c76fa767b782ca0f5e0fede8d2ea28","modified":1734925557149},{"_id":"themes/Chic/languages/default.yml","hash":"f26a34a7983d4bc17c65c7f0f14da598e62ce66d","modified":1734925557121},{"_id":"themes/Chic/languages/de.yml","hash":"d45cea36c5c83d7d09afcd1c26fff4a4c513c25b","modified":1734925557121},{"_id":"themes/Chic/languages/ja.yml","hash":"3e2fedca096678c0c234ebffa4637828979296fa","modified":1734925557123},{"_id":"themes/Chic/languages/fr.yml","hash":"8cb0fe4b6913b4d5b662cdd0108a923c90025f85","modified":1734925557123},{"_id":"themes/Chic/languages/es.yml","hash":"e3b4937da4cd2d0393b8a0ba310e70fc605cc431","modified":1734925557122},{"_id":"themes/Chic/languages/nl.yml","hash":"3d82ec703d0b3287739d7cb4750a715ae83bfcb3","modified":1734925557124},{"_id":"themes/Chic/languages/no.yml","hash":"ddf2035e920a5ecb9076138c184257d9f51896a7","modified":1734925557125},{"_id":"themes/Chic/languages/ko.yml","hash":"11330316e3c1262474a2b496e40dbc29f93fe01b","modified":1734925557124},{"_id":"themes/Chic/languages/pt.yml","hash":"ae2c61b30e638f74f1a42c9ce39ac08d063b30f5","modified":1734925557126},{"_id":"themes/Chic/languages/zh-CN.yml","hash":"b057f389c6713010f97d461e48ec959b0b6f3b44","modified":1734925557127},{"_id":"themes/Chic/languages/ru.yml","hash":"2a476b4c6e04900914c81378941640ac5d58a1f0","modified":1734925557127},{"_id":"themes/Chic/layout/archive.ejs","hash":"48cdf67b628eb6a1c24d484ed252f5b0e3f06ddf","modified":1734925557142},{"_id":"themes/Chic/languages/zh-TW.yml","hash":"f5f0ca88185da7a8457760d84bf221781473bd7c","modified":1734925557128},{"_id":"themes/Chic/layout/category.ejs","hash":"78c93c3a13f9678fa0f27061fa3a91a82edbcc17","modified":1734925557143},{"_id":"themes/Chic/layout/post.ejs","hash":"ce00469dfecca6db0ec9977c4a573533af9aee98","modified":1734934997119},{"_id":"themes/Chic/layout/index.ejs","hash":"b44f40dd5b866e1d6a840654aa8323054f061dac","modified":1734925557143},{"_id":"themes/Chic/layout/layout.ejs","hash":"a3f9466598ddb6df7cf8e3df5c19c09a9597340b","modified":1735350791344},{"_id":"themes/Chic/source/favicon.ico","hash":"96b9a549337c2bec483c2879eeafa4d1f8748fed","modified":1734925557237},{"_id":"themes/Chic/layout/tag.ejs","hash":"f6a48442749c2a743e47fde26bddabaaa2d7d95b","modified":1734925557148},{"_id":"themes/Chic/scripts/imageTag.js","hash":"21c67e132584333eaa7b0c015fdd37d2e56ea934","modified":1734925557150},{"_id":"themes/Chic/layout/page.ejs","hash":"92c2d419faea7ec7d984a3d960f5668608d36842","modified":1734925557146},{"_id":"themes/Chic/layout/_partial/footer.ejs","hash":"0f496d4767f32baca1854495ff78701cbdeb513f","modified":1735219374535},{"_id":"themes/Chic/layout/_partial/head.ejs","hash":"3e00d97ea2a1507f7b29a8b45f0be38b91b00f3e","modified":1735221982474},{"_id":"themes/Chic/layout/_page/archive.ejs","hash":"074ef6ede857a3404a454684b2a3bf6121d53bf3","modified":1734925557130},{"_id":"themes/Chic/layout/_partial/paginator.ejs","hash":"8ad8d7752378f71708ce9d25e19f06f316eacce0","modified":1734925557139},{"_id":"themes/Chic/layout/_partial/toc.ejs","hash":"e51732ce0e5787b4e4e0f6f1f4b8b6e7bc8ad50c","modified":1734925557140},{"_id":"themes/Chic/layout/_page/category.ejs","hash":"607bbfd724c47649a5b4c54d0509194ec1f6bbbd","modified":1734925557131},{"_id":"themes/Chic/layout/_partial/header.ejs","hash":"2d4be1a3899d4512892fb951e11c9cd47d38ed56","modified":1734925557138},{"_id":"themes/Chic/layout/_page/page.ejs","hash":"90559c37712ec3d7cdd58ad15d14d5662816bce1","modified":1734925557132},{"_id":"themes/Chic/layout/_page/profile.ejs","hash":"812a8a209261cde9643f38ca2fb284e91bb4310f","modified":1734925557133},{"_id":"themes/Chic/layout/_page/post.ejs","hash":"354e4a74681c10b3e6481c1a2ced03b606a0dd9f","modified":1734925557133},{"_id":"themes/Chic/layout/_page/tag.ejs","hash":"271bbaf9549a62cffbe7b5aab7afdabb4eea5ebc","modified":1734925557134},{"_id":"themes/Chic/source/css/font.styl","hash":"95f69310a9f6bc4c0b893f7c134182f2e4a871cd","modified":1734933046661},{"_id":"themes/Chic/source/css/base.styl","hash":"b6be42e4758f81662484798a66d5c36a10d812f6","modified":1734925557230},{"_id":"themes/Chic/layout/_plugins/giscus.ejs","hash":"3ca3c86fb29871816942e79ef0aa930a83b7df64","modified":1734933354037},{"_id":"themes/Chic/layout/_plugins/mathjax.ejs","hash":"56722622edf8cb6e7bb138ad1d0329e2125d9c38","modified":1734925557141},{"_id":"themes/Chic/source/css/media.styl","hash":"512311f047b94f886163f664e1236f58798e5677","modified":1734925557234},{"_id":"themes/Chic/source/css/custom.styl","hash":"71eba9ef37cca89fd8ca81b768f288fea6673906","modified":1734933995079},{"_id":"themes/Chic/source/css/normalize.styl","hash":"df9ca719f651c45a88ab4d6afa6d29edf51aeba9","modified":1734925557234},{"_id":"themes/Chic/source/css/layout.styl","hash":"d1485f52f16c19bb5022f90e0e7d7b09071202b2","modified":1734925557233},{"_id":"themes/Chic/source/css/style.styl","hash":"f87c15993e8b7c3c0bd885b51a11377fa5d2cfe3","modified":1734925557235},{"_id":"themes/Chic/source/css/variable.styl","hash":"4fbb2ffdc00cad2f5cd6ff0dd689836d6f20d227","modified":1734925557236},{"_id":"themes/Chic/source/js/script.js","hash":"85e13dd7d9f08dad3a97ff6246caf38cab1d875a","modified":1734925557350},{"_id":"themes/Chic/source/js/mathjax2.7.5.js","hash":"fd54df22584629c604511acf67c9e992d362a5e3","modified":1734925557349},{"_id":"themes/Chic/source/js/tocbot.min.js","hash":"bae97e8a24a05a99335f8e725641c8ca9c50502a","modified":1734925557352},{"_id":"themes/Chic/source/image/avatar.jpeg","hash":"5d46dc78e55390dfab0149798249bf655dd03fca","modified":1734925557347},{"_id":"themes/Chic/source/css/_highlight/agate.styl","hash":"fc289ba8f47ead6331ec3a51533cfa93251c5634","modified":1734925557154},{"_id":"themes/Chic/source/css/_highlight/androidstudio.styl","hash":"4d67bdab6cc9c614486ca42f98199a04d053e7f0","modified":1734925557154},{"_id":"themes/Chic/source/css/_highlight/arduino-light.styl","hash":"591962bfc758a521b4cb907750c19a1a2423b4d5","modified":1734925557155},{"_id":"themes/Chic/source/css/_highlight/ascetic.styl","hash":"ca087a3c70998c7ac6b0b42d5cf7a653b8707591","modified":1734925557157},{"_id":"themes/Chic/source/css/_highlight/arta.styl","hash":"262167aaebcf28de7f85af7ac77a76fa1fa284f7","modified":1734925557156},{"_id":"themes/Chic/source/css/_highlight/atelier-cave-light.styl","hash":"f47de0b9d66617728f68096ed48371dd6bb9e67a","modified":1734925557159},{"_id":"themes/Chic/source/css/_highlight/atelier-cave-dark.styl","hash":"7e83c7f2acaaaa98864660afe2794745c36c8e51","modified":1734925557158},{"_id":"themes/Chic/source/css/_highlight/atelier-estuary-light.styl","hash":"2b416a0567a53aa0fa8898b196ddd44315c1a5f3","modified":1734925557163},{"_id":"themes/Chic/source/css/_highlight/atelier-dune-light.styl","hash":"657fe215931fd06e21b56374df699a94890f7ab4","modified":1734925557160},{"_id":"themes/Chic/source/css/_highlight/atelier-estuary-dark.styl","hash":"1cecd13e0d6b24042ff86372f0596c1441bb834a","modified":1734925557162},{"_id":"themes/Chic/source/css/_highlight/atelier-heath-dark.styl","hash":"f186b357dcebded89b7bcc77389b2cff76533d72","modified":1734925557165},{"_id":"themes/Chic/source/css/_highlight/atelier-dune-dark.styl","hash":"68584ed0e99c7d0e49ef8a2e67cd4dcdad359de4","modified":1734925557159},{"_id":"themes/Chic/source/css/_highlight/atelier-forest-dark.styl","hash":"a741eba35cdfe2cfd67dfbf109655f253d6b4795","modified":1734925557164},{"_id":"themes/Chic/source/css/_highlight/atelier-heath-light.styl","hash":"c1db353e8613607580d40b12ddc162d029560576","modified":1734925557166},{"_id":"themes/Chic/source/css/_highlight/atelier-forest-light.styl","hash":"8d7c7242974aa2454fa792c5d7a47c5f9632355a","modified":1734925557165},{"_id":"themes/Chic/source/css/_highlight/atelier-lakeside-light.styl","hash":"8659eaae6a0c2e00b4b9199803e50adf4ff0128d","modified":1734925557168},{"_id":"themes/Chic/source/css/_highlight/atelier-savanna-dark.styl","hash":"bbad7a9512b4873294e73ce806e36e43973e6ed8","modified":1734925557170},{"_id":"themes/Chic/source/css/_highlight/atelier-lakeside-dark.styl","hash":"802979cea895a0a384645cb30a43de9572cb0e3f","modified":1734925557167},{"_id":"themes/Chic/source/css/_highlight/atelier-plateau-light.styl","hash":"96181544eeadc5b0749229f11607e7c01f81e078","modified":1734925557169},{"_id":"themes/Chic/source/css/_highlight/atelier-plateau-dark.styl","hash":"0d51ddc580ccb0a291271fa9632bc91dab632df6","modified":1734925557168},{"_id":"themes/Chic/source/css/_highlight/atelier-savanna-light.styl","hash":"8a5207a0c30262a0bf5e1a41411a306f7a89a7e7","modified":1734925557171},{"_id":"themes/Chic/source/css/_highlight/atelier-seaside-dark.styl","hash":"2f008271299042f2443bca98c9bcadbc8c45e837","modified":1734925557172},{"_id":"themes/Chic/source/css/_highlight/atelier-seaside-light.styl","hash":"08e2df313c272d5c70c93e713639663c168180d0","modified":1734925557173},{"_id":"themes/Chic/source/css/_highlight/atelier-sulphurpool-dark.styl","hash":"18dcb00ab9c62eb810d492047214331c51bb654f","modified":1734925557174},{"_id":"themes/Chic/source/css/_highlight/atelier-sulphurpool-light.styl","hash":"add3d88c9d12567dcfae7a8e49984d119fc72227","modified":1734925557174},{"_id":"themes/Chic/source/css/_highlight/brown-paper.styl","hash":"e45a5e2ae53c90334e9bc8be1e45f3c3aa3d785d","modified":1734925557175},{"_id":"themes/Chic/source/css/_highlight/codepen-embed.styl","hash":"1de45e603e2c71c7f6b0c1372a3ba00b1bc153a8","modified":1734925557177},{"_id":"themes/Chic/source/css/_highlight/brown-papersq.png","hash":"3a1332ede3a75a3d24f60b6ed69035b72da5e182","modified":1734925557177},{"_id":"themes/Chic/source/css/_highlight/color-brewer.styl","hash":"9c4905eab730d0b389e6972e907057577f7e25f1","modified":1734925557178},{"_id":"themes/Chic/source/css/_highlight/far.styl","hash":"8da83d66724f2ce508a40f21b4f6dc0d704be562","modified":1734925557181},{"_id":"themes/Chic/source/css/_highlight/darkula.styl","hash":"8965ad6920601c275ca97e617beff5536925a266","modified":1734925557179},{"_id":"themes/Chic/source/css/_highlight/dark.styl","hash":"98d7884806838a0b46132d759d60ac27c0c4bd9c","modified":1734925557179},{"_id":"themes/Chic/source/css/_highlight/docco.styl","hash":"7bd3389ce16d20488ab336d557056cc703c921c7","modified":1734925557180},{"_id":"themes/Chic/source/css/_highlight/foundation.styl","hash":"28c59a31467c33bd51cbf3b6085782c2a724ff6c","modified":1734925557181},{"_id":"themes/Chic/source/css/_highlight/github-gist.styl","hash":"71f4b0fca91a587e6eba15a5306dca963bb8f441","modified":1734925557182},{"_id":"themes/Chic/source/css/_highlight/github.styl","hash":"a84eb710b302006120c3e7f8ca18f9e6fbc231c3","modified":1734925557183},{"_id":"themes/Chic/source/css/_highlight/googlecode.styl","hash":"7f5082ae008925a23eb713f160773fe647eb3ff7","modified":1734925557184},{"_id":"themes/Chic/source/css/_highlight/grayscale.styl","hash":"c83804abe39faebd80f8f4ff64fbd7137674cb1c","modified":1734925557185},{"_id":"themes/Chic/source/css/_highlight/highlightjs.styl","hash":"192611c56d6fe4da343718548de21c31a75919db","modified":1734925557186},{"_id":"themes/Chic/source/css/_highlight/hybrid.styl","hash":"4906456025787de04b48a87c42bb704c5ff67065","modified":1734925557187},{"_id":"themes/Chic/source/css/_highlight/gruvbox-dark.styl","hash":"f66403ce77dcb16b1f98a5061b72f7581630d69f","modified":1734925557186},{"_id":"themes/Chic/source/css/_highlight/hopscotch.styl","hash":"dd3c78c42d4a865f11623235e5e5f6829d789706","modified":1734925557187},{"_id":"themes/Chic/source/css/_highlight/index.styl","hash":"36c44375229613a5bb9ee84a8e90214978070439","modified":1734925557189},{"_id":"themes/Chic/source/css/_highlight/ir-black.styl","hash":"aa31b30069ebee39e2c3ebb75e2c96ba8678eb14","modified":1734925557190},{"_id":"themes/Chic/source/css/_highlight/kimbie.light.styl","hash":"e901738455ec9a1bddde7b62bbd8595de6033e1e","modified":1734925557192},{"_id":"themes/Chic/source/css/_highlight/kimbie.styl","hash":"13113af220dfed09cb49d85102babb352c3eff97","modified":1734925557193},{"_id":"themes/Chic/source/css/_highlight/idea.styl","hash":"e284c1760e8da0848f56cd5601d867ceeb0192d7","modified":1734925557188},{"_id":"themes/Chic/source/css/_highlight/mono-blue.styl","hash":"14fb8678739b77f35771b6d63101ddbf1e7a9fbc","modified":1734925557194},{"_id":"themes/Chic/source/css/_highlight/magula.styl","hash":"ab179306c12a1cf2949482beaca328e379ef034a","modified":1734925557193},{"_id":"themes/Chic/source/css/_highlight/kimbie.dark.styl","hash":"3b998c640eeb2c6192fee24bc78b4137de475dd7","modified":1734925557190},{"_id":"themes/Chic/source/css/_highlight/monokai.styl","hash":"c3a3bfae1eb864505fbc8748db734600057af1af","modified":1734925557196},{"_id":"themes/Chic/source/css/_highlight/obsidian.styl","hash":"efba069860181d2b709e1548dd16cf102ca267fa","modified":1734925557196},{"_id":"themes/Chic/source/css/_highlight/paraiso-dark.styl","hash":"50f1cee8a5b3b165b4184ead0a99dc564b62ef4f","modified":1734925557197},{"_id":"themes/Chic/source/css/_highlight/monokai-sublime.styl","hash":"84a27bd29d939105d65f4164c219d6cc2e09ae60","modified":1734925557195},{"_id":"themes/Chic/source/css/_highlight/paraiso-light.styl","hash":"e428e8202b01e83b0f018a96058d806e7f4c76bf","modified":1734925557197},{"_id":"themes/Chic/source/css/_highlight/paraiso.styl","hash":"846a06a57fa0b3db7f83ec7ac2bf34911f32cf66","modified":1734925557198},{"_id":"themes/Chic/source/css/_highlight/pojoaque.jpg","hash":"c5fe6533b88b21f8d90d3d03954c6b29baa67791","modified":1734925557199},{"_id":"themes/Chic/source/css/_highlight/pojoaque.styl","hash":"37436c1018394f799a1f3dfd326309da8df89742","modified":1734925557200},{"_id":"themes/Chic/source/css/_highlight/railscasts.styl","hash":"5dc9ce33cecee87fe9ca8f2ed9342602194484ec","modified":1734925557201},{"_id":"themes/Chic/source/css/_highlight/school-book.styl","hash":"6d685307f4362d3b2b0868f7b0a94b930db66e6a","modified":1734925557203},{"_id":"themes/Chic/source/css/_highlight/school-book.png","hash":"711ec983c874e093bb89eb77afcbdf6741fa61ee","modified":1734925557202},{"_id":"themes/Chic/source/css/_highlight/rainbow.styl","hash":"95246afef181bd96f9adb1a2e84fb3ef302d4598","modified":1734925557201},{"_id":"themes/Chic/source/css/_highlight/solarized-dark.styl","hash":"9fc9400d3a8cae97eb5761c284140acb0f847538","modified":1734925557204},{"_id":"themes/Chic/source/css/_highlight/solarized-light.styl","hash":"bb04944fc06c12ecd7b56ad933dbedde60c2259a","modified":1734925557204},{"_id":"themes/Chic/source/css/_highlight/sunburst.styl","hash":"e6e4c009b10b9805f0c593446bf013edec47d146","modified":1734925557205},{"_id":"themes/Chic/source/css/_highlight/tomorrow-night-blue.styl","hash":"92f4423d4964fcfe34ff7ca6cb21012b5738c697","modified":1734925557206},{"_id":"themes/Chic/source/css/_highlight/tomorrow-night-bright.styl","hash":"e6b025b247e4027fb3c1b7833588f5a5b04a549c","modified":1734925557207},{"_id":"themes/Chic/source/css/_highlight/tomorrow-night-eighties.styl","hash":"8b16876cf205111d5d5454100de712bc3ea8f477","modified":1734925557208},{"_id":"themes/Chic/source/css/_highlight/tomorrow-night.styl","hash":"eb8441364bb1664ecebde77b965dc36c91133aa0","modified":1734925557209},{"_id":"themes/Chic/source/css/_highlight/tomorrow.styl","hash":"502335f0fac07ed74ca78207bcf3ef8dd2252cf6","modified":1734925557210},{"_id":"themes/Chic/source/css/_highlight/vs.styl","hash":"14fbb0c43af440a290280b26968c8a5c0786b27f","modified":1734925557211},{"_id":"themes/Chic/source/css/_highlight/zenburn.styl","hash":"f63534764dd6598e81177d64714a184f98153b11","modified":1734925557212},{"_id":"themes/Chic/source/css/_highlight/xcode.styl","hash":"5fa8999c7f807c1aae29c7a1cdf681678576fb69","modified":1734925557211},{"_id":"themes/Chic/source/css/_lib/tocbot.css","hash":"f646f2bb75bcd1eb65b2788ac7bf15d4fd243ce9","modified":1734925557215},{"_id":"themes/Chic/source/css/_partial/footer.styl","hash":"578a744914f05bab4eae73838076b1cdb8130929","modified":1734925557228},{"_id":"themes/Chic/source/css/_lib/looper.css","hash":"f4ee39f122059c1e7793b8dc1d72fcbc5fa5ea15","modified":1734925557214},{"_id":"themes/Chic/source/css/_partial/header.styl","hash":"9e4d9b67cc2dbbb92b190be3f9ebcd77e093f057","modified":1734925557229},{"_id":"themes/Chic/source/css/_partial/paginator.styl","hash":"fbe7e3ce8234e5e1a18764113f997b98d777ee5f","modified":1734925557229},{"_id":"themes/Chic/source/css/_page/archive.styl","hash":"edc8ee7f34629c59fd4d31f2889d5c069e9d63ac","modified":1734925557223},{"_id":"themes/Chic/source/css/_page/page.styl","hash":"b2cf99b15965f6851129d52d23f26ed91dc2ede7","modified":1734925557225},{"_id":"themes/Chic/source/css/_page/category.styl","hash":"9b0c89a525b2b4f0163f6ff1bf1d208277c8bb1f","modified":1734925557224},{"_id":"themes/Chic/source/css/_page/profile.styl","hash":"ced34f67543094c5517a6f375d6526ff1d978183","modified":1734925557226},{"_id":"themes/Chic/source/css/_page/tag.styl","hash":"715f3fb46c9ccd7c1b701bcf5aac87051ecb3d17","modified":1734925557226},{"_id":"themes/Chic/source/fonts/iconfont/demo.css","hash":"53456972a11d52af67187fc17999e6665f9f06fe","modified":1734925557241},{"_id":"themes/Chic/source/fonts/iconfont/demo_index.html","hash":"55c47c8924542a89da4741fcce7eca7e5f881e77","modified":1734925557243},{"_id":"themes/Chic/source/fonts/iconfont/iconfont.svg","hash":"8f1d735e4fae3757dac1866dc3e30147140811e2","modified":1734925557249},{"_id":"themes/Chic/source/fonts/iconfont/iconfont.json","hash":"cb99651b9be2f87afcd5989480dd7360b4bf4643","modified":1734925557248},{"_id":"themes/Chic/source/fonts/iconfont/iconfont.ttf","hash":"41c4f4dc82e42452dcfd19caed6c7dc333ee769e","modified":1734925557250},{"_id":"themes/Chic/source/fonts/iconfont/iconfont.css","hash":"496a69ed5e5232feecfd8e1390877b77003e405c","modified":1734925557244},{"_id":"themes/Chic/source/fonts/iconfont/iconfont.woff","hash":"a57593c49b56c16ac1def0e1f3dbca3f658b3579","modified":1734925557251},{"_id":"themes/Chic/source/fonts/iconfont/iconfont.eot","hash":"d18736f7885569e497698d17f49b9167add67dc6","modified":1734925557245},{"_id":"themes/Chic/source/fonts/iconfont/iconfont.woff2","hash":"39d97a0f72417487f5c1e0a0abf8e27dd6ebda31","modified":1734925557253},{"_id":"themes/Chic/source/fonts/iconfont/iconfont.js","hash":"87bfdaae31251f4d605646c5ae9c67196f6cc4e2","modified":1734925557247},{"_id":"themes/Chic/source/css/_page/_post/post_content.styl","hash":"8fa506bf4dd38c7cb6d5f48445ab170de4cd6868","modified":1734925557218},{"_id":"themes/Chic/source/css/_page/_post/post_code.styl","hash":"7b57bafe7e8e375372055f4a775bb42a3c190c95","modified":1734925557218},{"_id":"themes/Chic/source/css/_page/_post/post_copyright.styl","hash":"e1851fabb110414a624a1be634129dc6b0ce8d03","modified":1734925557219},{"_id":"themes/Chic/source/css/_page/_post/post_header.styl","hash":"6ea0ede34416dfaddda04a903f658325572f91a4","modified":1734925557220},{"_id":"themes/Chic/source/css/_page/_post/post_toc.styl","hash":"6c64f313146416a17b087d0a2fc90362cd977776","modified":1734925557223},{"_id":"themes/Chic/source/css/_page/_post/post_nav.styl","hash":"9c73772ad0d2b1e67007aa2816ee9b97d5152ffa","modified":1734925557221},{"_id":"themes/Chic/source/css/_page/_post/post_tags.styl","hash":"bd16f8c0e5ee2e302b61b861470ab993b6af709b","modified":1734925557222},{"_id":"themes/Chic/source/fonts/lanting/lanting.woff2","hash":"5f325fcd2726a5b44e08b7004a5219e14847cbfa","modified":1734925557345},{"_id":"themes/Chic/source/fonts/lanting/lanting.woff","hash":"642ad1f17d27d4b1010d1a0571d1b44cbc823d9d","modified":1734925557340},{"_id":"themes/Chic/source/fonts/lanting/lanting.eot","hash":"3e184614f037939a6f98d607da3ed7dffb350e65","modified":1734925557303},{"_id":"themes/Chic/source/fonts/lanting/lanting.TTF","hash":"97e9a4538cceef4b17d54c7dc589524905d1b685","modified":1734925557281},{"_id":"themes/Chic/source/fonts/lanting/lanting.otf","hash":"4e184da596772d3ef6e5763cdee3e46a1ce2f2dd","modified":1734925557334},{"_id":"public/about/index.html","hash":"1d647675e492eefcaab284f19221130c8e6ca5ea","modified":1735350801860},{"_id":"public/category/index.html","hash":"44023acd83862e343fb8608ef86e82e675d5a970","modified":1735350801860},{"_id":"public/tag/index.html","hash":"1ac235aae378b3ff7b314517d50b87e10b81e493","modified":1735350801860},{"_id":"public/2024/06/10/ç¬¬ä¸€ç¯‡åšå®¢ï¼Œæˆ‘çœ¼ä¸­çš„äº‘åŸç”Ÿ/index.html","hash":"3a79fec06b88f2eca1b352211f90d7b686e110a6","modified":1735350801860},{"_id":"public/archives/index.html","hash":"707e89a8ff74c7bd1cb600c6e2aca961f840b8b6","modified":1735350801860},{"_id":"public/archives/2024/index.html","hash":"00ce21c665933356cbafc2a91e3905c0790c7583","modified":1735350801860},{"_id":"public/archives/2024/06/index.html","hash":"40a2ec44137e4f2af7af3d72a839b86abdd7c361","modified":1735350801860},{"_id":"public/tags/äº‘åŸç”Ÿ/index.html","hash":"334457ac345dfc0fcd455a3b19c8a2cad4904265","modified":1735350801860},{"_id":"public/categories/äº‘åŸç”Ÿ/index.html","hash":"8f688f13983d06c091dab2634abb366727fb423e","modified":1735350801860},{"_id":"public/index.html","hash":"84fdf41cc9ca154f67baa9cee673721a0b27400f","modified":1735350801860},{"_id":"public/favicon.ico","hash":"96b9a549337c2bec483c2879eeafa4d1f8748fed","modified":1734936367275},{"_id":"public/image/avatar.jpeg","hash":"5d46dc78e55390dfab0149798249bf655dd03fca","modified":1734936367275},{"_id":"public/fonts/iconfont/iconfont.ttf","hash":"41c4f4dc82e42452dcfd19caed6c7dc333ee769e","modified":1734936367275},{"_id":"public/fonts/iconfont/iconfont.eot","hash":"d18736f7885569e497698d17f49b9167add67dc6","modified":1734936367275},{"_id":"public/fonts/iconfont/iconfont.svg","hash":"8f1d735e4fae3757dac1866dc3e30147140811e2","modified":1734936367275},{"_id":"public/fonts/iconfont/iconfont.woff","hash":"a57593c49b56c16ac1def0e1f3dbca3f658b3579","modified":1734936367275},{"_id":"public/fonts/iconfont/iconfont.woff2","hash":"39d97a0f72417487f5c1e0a0abf8e27dd6ebda31","modified":1734936367275},{"_id":"public/css/base.css","hash":"2fce73a3c2df8f93edeb5e34a53b7d83e5191d85","modified":1734936367275},{"_id":"public/css/custom.css","hash":"d5486dc67559aed2c756aa6b034347fddf4f56eb","modified":1734936367275},{"_id":"public/css/font.css","hash":"87059edd1f2bfc4296f5599e73208893f2b06458","modified":1734936367275},{"_id":"public/css/media.css","hash":"5023ee404900a47d61ca0591b2d4e9eace0fe88e","modified":1734936367275},{"_id":"public/css/layout.css","hash":"9b81d7e5146871ae2d1010f3a10089bbb43e81e3","modified":1734936367275},{"_id":"public/js/mathjax2.7.5.js","hash":"7ba18c783d543cfb4b45a0118ccb73d3f68cd46e","modified":1734936367275},{"_id":"public/css/normalize.css","hash":"2d4b663b6a4c68295b6ba240fa2dd9fb3863093c","modified":1734936367275},{"_id":"public/css/style.css","hash":"8ae635d7655079afccffb83bb89e16a42ebc0b00","modified":1734936367275},{"_id":"public/css/variable.css","hash":"cb4180b3bbad471e30cf52ebb40e998d58a30d7d","modified":1734936367275},{"_id":"public/js/script.js","hash":"5dd8ce4fa55a7201d7e2ffe417b48c95943a906b","modified":1734936367275},{"_id":"public/fonts/iconfont/demo.css","hash":"65c50db528a5abe06426b1a20735feaf1f2a0d9b","modified":1734936367275},{"_id":"public/fonts/iconfont/demo_index.html","hash":"16e01463756a77b4acd15ade4e6b73f0376d75e1","modified":1734936367275},{"_id":"public/fonts/iconfont/iconfont.json","hash":"3123aa840109e385d58a75d34e88a2d621e1ada8","modified":1734936367275},{"_id":"public/fonts/iconfont/iconfont.css","hash":"1e5540dca41dc53879226750f936e72daf616662","modified":1734936367275},{"_id":"public/fonts/iconfont/iconfont.js","hash":"87bfdaae31251f4d605646c5ae9c67196f6cc4e2","modified":1734936367275},{"_id":"public/js/tocbot.min.js","hash":"bae97e8a24a05a99335f8e725641c8ca9c50502a","modified":1734936367275},{"_id":"public/fonts/lanting/lanting.woff2","hash":"5f325fcd2726a5b44e08b7004a5219e14847cbfa","modified":1734936367275},{"_id":"public/fonts/lanting/lanting.woff","hash":"642ad1f17d27d4b1010d1a0571d1b44cbc823d9d","modified":1734936367275},{"_id":"public/fonts/lanting/lanting.eot","hash":"3e184614f037939a6f98d607da3ed7dffb350e65","modified":1734936367275},{"_id":"public/fonts/lanting/lanting.TTF","hash":"97e9a4538cceef4b17d54c7dc589524905d1b685","modified":1734936367275},{"_id":"public/fonts/lanting/lanting.otf","hash":"4e184da596772d3ef6e5763cdee3e46a1ce2f2dd","modified":1734936367275},{"_id":"source/_posts/Pythonå·¥ç¨‹åŒ–ä¸å®Œå…¨æŒ‡å—.md","hash":"6556ec56277a04854053ba9b5eeefe877a463dfa","modified":1735223515380},{"_id":"public/2024/07/06/Pythonå·¥ç¨‹åŒ–ä¸å®Œå…¨æŒ‡å—/index.html","hash":"d21fb0f14929b4c622b2ea4688e37d596689de00","modified":1735350801860},{"_id":"public/categories/æ—¥å¸¸å¼€å‘/index.html","hash":"fd1f7e8020e9b60ff54e89ac54ab86226089e5ba","modified":1735350801860},{"_id":"public/archives/2024/07/index.html","hash":"c863117cbbb2ed9ded711a90845b44c875502682","modified":1735350801860},{"_id":"public/tags/Python/index.html","hash":"3dd6741991ed8e34256b86858559138438963e81","modified":1735222377903},{"_id":"source/CNAME","hash":"792cb140eb26ab12829b4a49eee4ce7875704121","modified":1735019619211},{"_id":"themes/Chic/layout/_plugins/site-visitor.ejs","hash":"26cdf4e61146024025782fd16def9e643f67ce34","modified":1735219347292},{"_id":"public/CNAME","hash":"792cb140eb26ab12829b4a49eee4ce7875704121","modified":1735219538510},{"_id":"themes/Chic/source/baidu_verify_codeva-BNp6wxaszM.html","hash":"8e0c9b3b5479c2be0aba88d2d916281511553613","modified":1735223269039},{"_id":"public/baidu_verify_codeva-BNp6wxaszM.html","hash":"dc41c40b243d3e155564489004f8a5ec582c894a","modified":1735223017652},{"_id":"public/tags/Python-æ—¥å¸¸å¼€å‘/index.html","hash":"f13087722bd75ec8d527c2017d47b4b66ab159a0","modified":1735350801860}],"Category":[{"name":"äº‘åŸç”Ÿ","_id":"cm50ntui700043gwb7ob77f2d"},{"name":"æ—¥å¸¸å¼€å‘","_id":"cm521pph100010kwbf4ln3vnm"}],"Data":[],"Page":[{"title":"å…³äºæˆ‘","date":"2024-06-01T11:33:57.000Z","article":{"licenses":null},"giscus":{"enable":false},"_content":"\näº‘åŸç”Ÿå¼€å‘å·¥ç¨‹å¸ˆï¼Œçˆ±ç¢ç£¨ï¼Œåœ¨è½¬å‹å¤§æ¨¡å‹åº”ç”¨å¼€å‘å·¥ç¨‹å¸ˆçš„è·¯ä¸Š~\n","source":"about/index.md","raw":"---\ntitle: å…³äºæˆ‘\ndate: 2024-06-01 19:33:57\narticle:\n  licenses: null\ngiscus:\n  enable: false\n---\n\näº‘åŸç”Ÿå¼€å‘å·¥ç¨‹å¸ˆï¼Œçˆ±ç¢ç£¨ï¼Œåœ¨è½¬å‹å¤§æ¨¡å‹åº”ç”¨å¼€å‘å·¥ç¨‹å¸ˆçš„è·¯ä¸Š~\n","updated":"2024-12-23T06:15:31.043Z","path":"about/index.html","comments":1,"layout":"page","_id":"cm50ntuhp00003gwbesj208sd","content":"<p>äº‘åŸç”Ÿå¼€å‘å·¥ç¨‹å¸ˆï¼Œçˆ±ç¢ç£¨ï¼Œåœ¨è½¬å‹å¤§æ¨¡å‹åº”ç”¨å¼€å‘å·¥ç¨‹å¸ˆçš„è·¯ä¸Š~</p>\n","excerpt":"","more":"<p>äº‘åŸç”Ÿå¼€å‘å·¥ç¨‹å¸ˆï¼Œçˆ±ç¢ç£¨ï¼Œåœ¨è½¬å‹å¤§æ¨¡å‹åº”ç”¨å¼€å‘å·¥ç¨‹å¸ˆçš„è·¯ä¸Š~</p>\n"},{"title":"Category","layout":"category","date":"2024-12-23T03:48:28.000Z","giscus":{"enable":false},"_content":"","source":"category/index.md","raw":"---\ntitle: Category\nlayout: category\ndate: 2024-12-23 11:48:28\ngiscus:\n  enable: false\n---\n","updated":"2024-12-23T06:15:27.719Z","path":"category/index.html","comments":1,"_id":"cm50ntuhr00013gwbbvwo1wmn","content":"","excerpt":"","more":""},{"title":"Tag","layout":"tag","date":"2024-12-23T03:48:17.000Z","giscus":{"enable":false},"_content":"","source":"tag/index.md","raw":"---\ntitle: Tag\nlayout: tag\ndate: 2024-12-23 11:48:17\ngiscus:\n  enable: false\n---\n","updated":"2024-12-23T06:15:21.647Z","path":"tag/index.html","comments":1,"_id":"cm50ntuhr00023gwb06cm35hh","content":"","excerpt":"","more":""}],"Post":[{"title":"ç¬¬ä¸€ç¯‡åšå®¢ï¼Œæˆ‘çœ¼ä¸­çš„äº‘åŸç”Ÿ","date":"2024-06-10T12:21:39.000Z","cover":"https://image.robocanic.com/notes/k8s.svg","thumbnail":"https://image.robocanic.com/notes/k8s.svg","toc":true,"_content":"\nå¾ˆå¤šå°ä¼™ä¼´åˆšä¸€å¼€å§‹çœ‹åˆ°â€œäº‘åŸç”Ÿâ€œä¸‰ä¸ªå­—æ—¶éƒ½ä¼šæœ‰ç‚¹æ‡µï¼Œå½“ç„¶å½¼æ—¶çš„æˆ‘ä¹Ÿä¸ä¾‹å¤–ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†ä»â€äº‘åŸç”Ÿæ˜¯ä¸ªå•¥â€œï¼Œâ€äº‘åŸç”Ÿå’Œæˆ‘æœ‰å•¥å…³ç³»â€œï¼Œâ€œäº‘åŸç”Ÿçš„æœªæ¥â€è¿™ä¸‰ä¸ªæ–¹é¢æ¥å±•ç°æˆ‘çœ¼ä¸­çš„äº‘åŸç”Ÿï¼Œå¸Œæœ›å¯¹ä½ æœ‰æ‰€å¸®åŠ©ã€‚\n\n# äº‘åŸç”Ÿæ˜¯ä¸ªå•¥\n\nåœ¨è¯´äº‘åŸç”Ÿä¹‹å‰ï¼Œä¸å¾—ä¸å…ˆæ¥è°ˆè°ˆäº‘è®¡ç®—å’Œå¾®æœåŠ¡ã€‚äº‘è®¡ç®—æ˜¯ä¸€ç§æ‰˜ç®¡åœ¨è¿œç¨‹æ•°æ®ä¸­å¿ƒçš„æœåŠ¡ï¼Œåœ¨ä»Šå¤©å·²ç»ç›¸å½“æ™®éäº†ã€‚äº‘è®¡ç®—ç”±äºšé©¬é€Šåœ¨ 2006 å¹´é¦–å…ˆæ¨å‡ºï¼Œä¸»æ‰“çš„å–ç‚¹å°±æ˜¯äº‘çš„é«˜å¼¹æ€§ï¼Œé«˜å®¹é”™ï¼Œå…ï¼ˆå°‘ï¼‰è¿ç»´ï¼Œæ¯”è‡ªå»ºæœºæˆ¿æ›´ä¾¿å®œç­‰ä¼˜ç‚¹ã€‚éšåå„å¤§äº‘å‚å•†å¦‚ Googleï¼Œå¾®è½¯ï¼Œé˜¿é‡Œå·´å·´ç­‰è¿…é€Ÿè·Ÿè¿›ï¼Œå»ºç«‹äº† Iaasï¼ŒPaasï¼ŒSaas ç­‰å¯¹äº‘åŸºç¡€è®¾æ–½ä¸åŒæŠ½è±¡å±‚æ¬¡çš„æœåŠ¡ä½“ç³»ï¼Œåœ¨ 08 åˆ° 16 å¹´æ€èµ·äº†ä¸€æ³¢ä¸Šäº‘çš„æµªæ½®ã€‚\n\n![xaas](https://image.robocanic.com/notes/image-vbfj.png)\n\nåœ¨è¿™æ³¢æµªæ½®æ¨åŠ¨çš„åŒæ—¶ï¼Œå¾®æœåŠ¡ç”±äºå…¶æ˜“äºæ‰©å±•ï¼Œå¼€å‘æ•æ·ï¼Œäººæ•ˆåˆ©ç”¨é«˜ç­‰ä¼˜ç‚¹ä¹Ÿå¤§è¡Œå…¶é“ã€‚ä½†æ˜¯åœ¨æµªæ½®è¿‡åï¼Œå·²ç»ä¸Šäº‘çš„ä¼ä¸šåˆå‘ç°ä¸€äº›æ£˜æ‰‹çš„é—®é¢˜ï¼š\n\n1. äº‘æœåŠ¡ç»‘å®šäº‘å‚å•†ï¼Œæ— æ³•æ¯”è¾ƒå¹³æ»‘è¿ç§»åˆ°å¦ä¸€ä¸ªäº‘å‚å•†\n\n2. äº‘æœåŠ¡å™¨çš„åˆ©ç”¨ç‡æ™®éåä½ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹çš„æˆæœ¬ç®—ä¸‹æ¥æ¯”è‡ªå»ºæœºæˆ¿è¿˜è¦é«˜\n\n3. äº‘æœåŠ¡ç¡®å®å…·å¤‡å¼¹æ€§å’Œå®¹é”™æ€§ï¼Œä½†éšç€å¾®æœåŠ¡çš„ç››è¡Œï¼ŒåŸºäºæœºå™¨ç²’åº¦çš„å¼¹æ€§å’Œå®¹é”™æ€§æ»¡è¶³ä¸äº†å¤§éƒ¨åˆ†ç”¨æˆ·çš„éœ€æ±‚\n\n......\n\nä¼—å¤šä¼ä¸šåœ¨ç”¨äº‘è¿‡ç¨‹éƒ½æˆ–å¤šæˆ–å°‘ç¢°åˆ°äº†è¿™äº›é—®é¢˜ã€‚è€Œäº‘åŸç”Ÿå°±æ˜¯è¿™æ ·ä¸€å¥—æŠ€æœ¯ä½“ç³»ä»¥åŠç†å¿µï¼Œèƒ½å¤Ÿä½¿å¾—ä¸Šè¿°æåˆ°çš„é—®é¢˜è¿åˆƒè€Œè§£ã€‚é‚£åˆ°åº•äº‘åŸç”Ÿæ˜¯æ€ä¹ˆè§£å†³çš„å‘¢ï¼Ÿ\n\näº‘åŸç”Ÿçš„å¾ˆå¤šæŠ€æœ¯éƒ½è€ƒè™‘åˆ°äº†åº”ç”¨ï¼ˆæœåŠ¡ï¼‰è¿™ä¸ªç²’åº¦ï¼Œè¿™ä¸ä¼ ç»Ÿäº‘è®¡ç®—çš„ Iaas è¿™ä¸ªå±‚æ¬¡å¯¹æœºå™¨çš„ç²’åº¦çš„æŠ½è±¡ç›¸æ¯”éƒ½è¦æ›´å°ä¸€äº›ã€‚ä»¥äº‘åŸç”Ÿçš„é›†å¤§æˆè€… Kubernetesï¼ˆk8sï¼‰ä¸ºä¾‹ï¼Œç®€å•è®²è®²å®ƒæ˜¯æ€ä¹ˆè§£å†³è¿ç§»éš¾ï¼Œåˆ©ç”¨ç‡ä½ï¼Œå¼¹æ€§å’Œå®¹é”™æ€§éš¾ç”¨è¿™ä¹ˆå‡ ä¸ªå…³é”®ç‚¹çš„ã€‚\n\né¦–å…ˆ k8s å®šä¹‰äº† Nodeï¼ˆå°±æ˜¯ä¸€å°æœåŠ¡å™¨ï¼‰ä¸ Podï¼ˆå°±æ˜¯ä¸€ä¸ªæœåŠ¡çš„å‰¯æœ¬ï¼‰è¿™ä¸¤ç§èµ„æºï¼ŒPod å¯ä»¥ç”³è¯· CPUï¼Œå†…å­˜ç­‰è®¡ç®—èµ„æºï¼Œk8s ä¼šæ ¹æ®ç”³è¯·çš„ CPU å’Œå†…å­˜å°† Pod æŒ‰ç…§ä¸€å®šç­–ç•¥è°ƒåº¦åˆ°æŸä¸€ä¸ª Nodeã€‚æˆ‘ä»¬å¯ä»¥è°ƒæ•´è¿™å…¶ä¸­çš„ç­–ç•¥æ¥ä½¿å¾— Node å¯ä»¥æ‰¿è½½æ›´å¤šçš„ Podï¼Œä»¥æé«˜æœåŠ¡å™¨æ•´ä½“çš„ä½¿ç”¨ç‡ã€‚ä¸€èˆ¬ä¸ºäº†é«˜å¯ç”¨æˆ‘ä»¬çš„æœåŠ¡éƒ½æ˜¯ä»¥å¤šå‰¯æœ¬ï¼ˆPodï¼‰éƒ¨ç½²çš„ï¼Œå¯¹å¤–æä¾›ç›¸åŒçš„æœåŠ¡ã€‚åŒä¸€ä¸ªæœåŠ¡çš„ Pod å¯ä»¥æ‰“æ•£éƒ¨ç½²åˆ°ä¸åŒçš„ Node ä¸Šï¼Œè¿™æ ·å°±ç®—ä¸€ä¸ª Node å‡ºç°æ•…éšœæŒ‚æ‰ï¼Œé‚£ä¹Ÿåªæ˜¯è¿™ä¸ª Node ä¸Šçš„ Pod æ— æ³•æä¾›æœåŠ¡ï¼Œå…¶ä»– Node ä¸Šçš„ Pod ä»ç„¶å¯ä»¥å¯¹å¤–æä¾›æœåŠ¡ï¼Œä¸æ­¤åŒæ—¶ k8s è¿˜ä¼šåœ¨å…¶ä»– Node ä¸Šæ‹‰èµ·å› ä¸º Node æ•…éšœè€ŒæŒ‚æ‰çš„ Podã€‚è¿™æ ·é«˜å¯ç”¨å°±èƒ½å¾—åˆ°å¾ˆå¥½çš„ä¿éšœã€‚\n\nå½“ç„¶ï¼Œæœ€é‡è¦çš„è«è¿‡äºï¼škubernetes æ˜¯å¼€æºçš„ï¼Œä¸å‚å•†æ— å…³ã€‚åªè¦æˆ‘ä»¬çš„æœåŠ¡è¿è¡Œåœ¨ k8s ä¸Šï¼Œç†è®ºä¸Šå°±èƒ½å¤Ÿåœ¨ä¸åŒçš„äº‘å‚å•†ä¹‹é—´è¿›è¡Œè¿ç§»ã€‚ å¯ä»¥è¿™ä¹ˆè¯´ï¼Œåœ¨è¿‡å»åå¹´ï¼Œäº‘åŸç”Ÿå°±æ˜¯è¶ç€å¾®æœåŠ¡çš„ä¸œé£ï¼Œæ‰ä¸€è·ƒæˆä¸ºç‚™æ‰‹å¯çƒ­çš„æŠ€æœ¯ä¹‹ä¸€ã€‚å› æ­¤ï¼Œäº‘åŸç”Ÿå’Œå¾®æœåŠ¡æ˜¯å¯†ä¸å¯åˆ†çš„ã€‚\n\nå†æ¥å›ç­”åˆ°ä¸Šä¸€å°èŠ‚æœ«çš„é—®é¢˜ï¼Œäº‘åŸç”Ÿæ˜¯æ€ä¹ˆè§£å†³çš„å‘¢->ç²’åº¦çš„å‡å°ï¼Œå‡å°åˆ°ä»€ä¹ˆç¨‹åº¦å‘¢->ä¸å¾®æœåŠ¡ä½“ç³»ä¸­çš„æœåŠ¡ç›¸åŒ¹é…ã€‚\n\n# äº‘åŸç”Ÿå’Œæˆ‘æœ‰å•¥å…³ç³»\n\nå¯èƒ½å†™åˆ°è¿™ä½ è¿˜æ˜¯å¯¹äº‘åŸç”Ÿæœ‰ä¸€äº›ç–‘æƒ‘ï¼Œæœ€å¤§çš„ç–‘æƒ‘å¯èƒ½è«è¿‡äºï¼šå¯¹äºâ€œæˆ‘â€è€Œè¨€ï¼Œäº‘åŸç”Ÿå’Œæˆ‘æœ‰å•¥å…³ç³»ï¼Ÿä¸ºäº†å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥è®©è¿™ä¸ªâ€œæˆ‘â€æ¥æ‰®æ¼”å¤šä¸ªè§’è‰²ã€‚\n\nå¦‚æœâ€œæˆ‘â€æ˜¯ä¼ä¸šè€æ¿/æŠ€æœ¯è´Ÿè´£äººï¼Œé‚£æˆ‘é¦–å…ˆåº”è¯¥æƒ³åˆ°çš„æ˜¯äº‘åŸç”Ÿèƒ½å¤Ÿæä¾›â€œçœ‹å¾—åˆ°â€çš„ä»·å€¼ã€‚é‚£é¦–å½“å…¶å†²çš„å°±æ˜¯ä½¿ç”¨äº‘åŸç”ŸæŠ€æœ¯èƒ½å¤Ÿæœ‰æ•ˆæé«˜æœºå™¨è´Ÿè½½ï¼Œé™ä½æœºå™¨æˆæœ¬ï¼Œè¿™ä¸€å¤©ç„¶çš„ä¼˜åŠ¿ç‰¹åˆ«ç¬¦åˆè¿‘ä¸¤å¹´æ¥çš„â€œé™æœ¬å¢æ•ˆâ€çš„æµªæ½®ã€‚å…¶æ¬¡åŸºäºæœåŠ¡ç²’åº¦çš„å¼¹æ€§å’Œå®¹é”™æ€§ä¹Ÿè¿›ä¸€æ­¥å¢å¼ºäº†æœåŠ¡çš„å¥å£®æ€§ï¼Œå‡å°‘äº†äº‹æ•…çš„å‘ç”Ÿã€‚ä»äººæ•ˆä¸Šçœ‹ï¼ŒåŸºäºäº‘åŸç”Ÿçš„ CI/CD æµæå‡äº†æ•æ·å¼€å‘çš„æ•ˆç‡ï¼ŒåŠ å¿«äº†ä¸šåŠ¡è¿­ä»£çš„é€Ÿåº¦ï¼Œä»è€Œæä¾›äº†äººæ•ˆã€‚å› æ­¤äº‘åŸç”Ÿä½œä¸ºåŸºç¡€è®¾æ–½ï¼Œèƒ½äº§ç”Ÿå¾ˆå¤šçœ‹å¾—åˆ°çš„ä»·å€¼ï¼Œè¿™ä¸ä»¥å¾€åŸºç¡€è®¾æ–½å¾ˆéš¾ä½“ç°å‡ºä»·å€¼å½¢æˆäº†é²œæ˜çš„å¯¹æ¯”ã€‚\n\nå¦‚æœâ€œæˆ‘â€æ˜¯æ™®é€šçš„å¼€å‘è€…ï¼Œé‚£æˆ‘é¦–å…ˆæƒ³åˆ°çš„æ˜¯å…¶æŠ€æœ¯ä»·å€¼ã€‚åœ¨å¸¸è§çš„å¼€å‘è°ƒè¯•->éƒ¨ç½²ä¸Šçº¿->çº¿ä¸Šè°ƒæ•´è¿™ä¸ªåº”ç”¨ç”Ÿå‘½å‘¨æœŸä¸­ï¼Œäº‘åŸç”Ÿä¸»è¦æ¶‰åŠåˆ°â€œéƒ¨ç½²ä¸Šçº¿â€œå’Œâ€œçº¿ä¸Šè°ƒæ•´â€è¿™ä¸¤ä¸ªæ­¥éª¤ã€‚åœ¨è§„æ¨¡ç¨å¤§çš„å…¬å¸ä¸­ï¼Œé€šå¸¸ä¼šåˆ†ä¸ºä¸šåŠ¡å¼€å‘å’Œå¹³å°å¼€å‘ï¼Œä¸šåŠ¡å¼€å‘ä¸“æ³¨äºä¸šåŠ¡å¼€å‘ä¸è¿­ä»£ä»¥æ»¡è¶³å®¢æˆ·éœ€æ±‚ï¼Œè€Œå¹³å°å¼€å‘åˆ™ä¸“æ³¨äºå†…éƒ¨ç ”å‘å¹³å°çš„å¼€å‘è¿­ä»£ä»¥æ»¡è¶³ä¸šåŠ¡å¼€å‘çš„éœ€æ±‚ã€‚å› æ­¤éƒ¨ç½²ä¸Šçº¿å’Œçº¿ä¸Šè°ƒæ•´ä¸€èˆ¬éƒ½ä¼šéƒ½ä¼šåˆ’å½’åˆ°å¹³å°ç ”å‘ä¸­ã€‚é‚£æ˜¯ä¸æ˜¯ä¸šåŠ¡å¼€å‘å°±å’Œäº‘åŸç”Ÿæ²¡å…³ç³»äº†ï¼Ÿä»æŸäº›æ„ä¹‰ä¸Šæ˜¯çš„ï¼Œä½†ä»æŠ€æœ¯å‘å±•çš„è§’åº¦çœ‹ï¼Œäº‘åŸç”Ÿä½œä¸ºåŸºç¡€è®¾æ–½å±‚çš„æŠ€æœ¯ï¼Œèåˆäº†å¾ˆå¤šè®¾è®¡è‰ºæœ¯ï¼Œæ¶‰åŠåˆ°å¾ˆå¤šé«˜å¯ç”¨ï¼Œé«˜å¹¶å‘çš„åœºæ™¯è®¾è®¡ã€‚å› æ­¤å½“ä½ å­¦ä¹ äº‘åŸç”Ÿçš„ä¸€äº›æŠ€æœ¯æ—¶ï¼Œä½ ä¼šè‡ªç„¶è€Œç„¶åœ°å°†ä¸€äº›ä¼˜é›…çš„è®¾è®¡ç†Ÿç¨”äºå¿ƒã€‚æ­¤å¤–ï¼Œç†Ÿæ‚‰äº‘åŸç”Ÿçš„å¤§è‡´æ¡†æ¶æœ‰åŠ©äºå¯¹æ•´ä¸ªåº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸæœ‰å®Œæ•´çš„ç†è§£ï¼Œåè¿‡æ¥ä¹Ÿæœ‰åŠ©äºä½ åœ¨å¼€å‘åº”ç”¨æ—¶èƒ½å¤Ÿæ›´å¥½åœ°åˆ©ç”¨åº•å±‚çš„åŸºç¡€èµ„æºã€‚\n\n# äº‘åŸç”Ÿçš„æœªæ¥\n\nä¸Šæ–‡ä¸­è¯´é“ï¼Œäº‘åŸç”Ÿä¹˜ç€å¾®æœåŠ¡çš„ä¸œé£ï¼Œåº¦è¿‡äº†â€œé»„é‡‘åå¹´â€œã€‚é‚£åœ¨ä¸‹ä¸€ä¸ªåå¹´ï¼Œäº‘åŸç”Ÿåˆè¯¥ä½•å»ä½•ä»ï¼Ÿ\nè¦å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆæ¥çœ‹çœ‹äº‘åŸç”Ÿçš„ä¼˜åŠ¿ã€‚å…³äºäº‘åŸç”Ÿçš„ä¼˜åŠ¿ï¼Œä¸Šæ–‡ä¹Ÿæåˆ°äº†ä¸å°‘ï¼Œåœ¨è¿™é‡Œæˆ‘å¯ä»¥æ€»ç»“æˆä¸€å¥è¯ï¼šäº‘åŸç”ŸæŠ€æœ¯èƒ½å¤Ÿä½¿åº”ç”¨æ›´å¥½åœ°åˆ©ç”¨äº‘èµ„æºï¼Œæ›´å¥½åœ°å¯¹å¤–æä¾›æœåŠ¡ã€‚å¯¹è¿™å¥è¯å†è§£è¯»ä¸€ä¸‹ï¼Œæˆ‘ä»¬çš„åº”ç”¨æ˜¯éœ€è¦æ¶ˆè€—äº‘èµ„æºå¹¶å‘å¤–æä¾›æœåŠ¡çš„ï¼Œè€Œäº‘åŸç”ŸæŠ€æœ¯æŠ½è±¡äº†è®¡ç®—èµ„æºï¼Œèƒ½å¤Ÿè®©åº”ç”¨æŒ‰éœ€åœ°ä½¿ç”¨äº‘èµ„æºï¼Œä»è€Œä½¿å¾—åº”ç”¨å¯¹å¤–æä¾›æœåŠ¡è¿™ä¸€è¿‡ç¨‹ä¾¿æ·äº†ä¸å°‘ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä»¥ä¸Šçš„æ€»ç»“ä»¥åŠè§£è¯»ä¸­çš„â€œåº”ç”¨â€œç‰¹æŒ‡æ¶ˆè€— CPUï¼Œå†…å­˜ï¼Œå­˜å‚¨çš„â€œä¼ ç»Ÿåº”ç”¨â€œã€‚é‚£ä¸ä¼ ç»Ÿåº”ç”¨ç›¸å¯¹åº”çš„æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿç­”æ¡ˆå°±æ˜¯ AIã€‚ä»å»å¹´å¤§ç«çš„ ChatGPT åˆ°ä»Šå¹´çš„ç™¾æ¨¡å¤§æˆ˜ï¼ŒAI å‘å±•çš„é€Ÿåº¦è¶…è¿‡äº†ç»å¤§å¤šæ•°äººçš„æƒ³è±¡ã€‚ä¸ä¼ ç»Ÿåº”ç”¨ç›¸æ¯”ï¼ŒAI åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸæ›´é•¿ï¼Œä¸”æ¨¡å‹çš„è®­ç»ƒï¼Œå¾®è°ƒï¼Œæ¨ç†éƒ½ç¦»ä¸å¼€å½“ä»Šæ—¶ä»£çš„â€œé»„é‡‘â€œâ€”â€”GPUï¼Œè€Œäº‘åŸç”Ÿé¢†åŸŸçš„æŠ€æœ¯å¯¹ AI çš„æ”¯æŒè¿˜è¿œæ²¡æœ‰ä¼ ç»Ÿåº”ç”¨çš„å®Œå–„ã€‚è¯¸å¦‚ mlopsï¼ŒGPU çš„è°ƒåº¦åˆ†é…ï¼Œåˆ†å¸ƒå¼è®­ç»ƒç­‰éšç€ AI å‘å±•è€Œæ¶Œç°çš„ topic ä¼šè¶Šæ¥è¶Šå¤šï¼Œç›¸ä¿¡äº‘åŸç”Ÿ+äººå·¥æ™ºèƒ½çš„è„šæ­¥ä¹Ÿä¼šè¶Šæ¥è¶Šå¿«ã€‚\n\nè‡³æ­¤ï¼Œäº‘åŸç”Ÿçš„æœªæ¥ä¹Ÿå¾ˆç¡®å®šäº†ï¼ŒCNAIï¼ˆCloud Native Artificial Intelligenceï¼‰å°†ä¼šæˆä¸ºäº‘åŸç”Ÿä¸‹ä¸€ä¸ªåå¹´çš„ä¸»èˆªé“ã€‚\n\n![CNAI](https://image.robocanic.com/notes/image.png)\n\nå†™åœ¨æœ€åï¼š\n\næƒ³äº†å¾ˆä¹…ç¬¬ä¸€ç¯‡åšå®¢è¦å†™äº›ä»€ä¹ˆï¼Œå‰å‰ååæƒ³äº†ä¸€å‘¨ï¼Œæœ€åè¿˜æ˜¯æ•²å®šäº†ä¸€ä¸ªæ¯”è¾ƒå¤§çš„ titleï¼Œå¸Œæœ›å¯¹ä½ æœ‰æ‰€å¸®åŠ©ã€‚æ–‡ç« å†…å®¹å¦‚æœ‰é”™è¯¯ï¼Œè¯·è€å¸ˆä»¬è¯„è®ºåŒºå‹˜è¯¯ ğŸ˜ğŸ˜ã€‚åç»­å°†ä¼šæŒç»­æ›´æ–°äº‘åŸç”Ÿï¼ŒLLM ç­‰é¢†åŸŸçš„å†…å®¹ã€‚\n","source":"_posts/ç¬¬ä¸€ç¯‡åšå®¢ï¼Œæˆ‘çœ¼ä¸­çš„äº‘åŸç”Ÿ.md","raw":"---\ntitle: ç¬¬ä¸€ç¯‡åšå®¢ï¼Œæˆ‘çœ¼ä¸­çš„äº‘åŸç”Ÿ\ndate: 2024-06-10 20:21:39\ntags: äº‘åŸç”Ÿ\ncategories: äº‘åŸç”Ÿ\ncover: https://image.robocanic.com/notes/k8s.svg\nthumbnail: https://image.robocanic.com/notes/k8s.svg\ntoc: true\n---\n\nå¾ˆå¤šå°ä¼™ä¼´åˆšä¸€å¼€å§‹çœ‹åˆ°â€œäº‘åŸç”Ÿâ€œä¸‰ä¸ªå­—æ—¶éƒ½ä¼šæœ‰ç‚¹æ‡µï¼Œå½“ç„¶å½¼æ—¶çš„æˆ‘ä¹Ÿä¸ä¾‹å¤–ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†ä»â€äº‘åŸç”Ÿæ˜¯ä¸ªå•¥â€œï¼Œâ€äº‘åŸç”Ÿå’Œæˆ‘æœ‰å•¥å…³ç³»â€œï¼Œâ€œäº‘åŸç”Ÿçš„æœªæ¥â€è¿™ä¸‰ä¸ªæ–¹é¢æ¥å±•ç°æˆ‘çœ¼ä¸­çš„äº‘åŸç”Ÿï¼Œå¸Œæœ›å¯¹ä½ æœ‰æ‰€å¸®åŠ©ã€‚\n\n# äº‘åŸç”Ÿæ˜¯ä¸ªå•¥\n\nåœ¨è¯´äº‘åŸç”Ÿä¹‹å‰ï¼Œä¸å¾—ä¸å…ˆæ¥è°ˆè°ˆäº‘è®¡ç®—å’Œå¾®æœåŠ¡ã€‚äº‘è®¡ç®—æ˜¯ä¸€ç§æ‰˜ç®¡åœ¨è¿œç¨‹æ•°æ®ä¸­å¿ƒçš„æœåŠ¡ï¼Œåœ¨ä»Šå¤©å·²ç»ç›¸å½“æ™®éäº†ã€‚äº‘è®¡ç®—ç”±äºšé©¬é€Šåœ¨ 2006 å¹´é¦–å…ˆæ¨å‡ºï¼Œä¸»æ‰“çš„å–ç‚¹å°±æ˜¯äº‘çš„é«˜å¼¹æ€§ï¼Œé«˜å®¹é”™ï¼Œå…ï¼ˆå°‘ï¼‰è¿ç»´ï¼Œæ¯”è‡ªå»ºæœºæˆ¿æ›´ä¾¿å®œç­‰ä¼˜ç‚¹ã€‚éšåå„å¤§äº‘å‚å•†å¦‚ Googleï¼Œå¾®è½¯ï¼Œé˜¿é‡Œå·´å·´ç­‰è¿…é€Ÿè·Ÿè¿›ï¼Œå»ºç«‹äº† Iaasï¼ŒPaasï¼ŒSaas ç­‰å¯¹äº‘åŸºç¡€è®¾æ–½ä¸åŒæŠ½è±¡å±‚æ¬¡çš„æœåŠ¡ä½“ç³»ï¼Œåœ¨ 08 åˆ° 16 å¹´æ€èµ·äº†ä¸€æ³¢ä¸Šäº‘çš„æµªæ½®ã€‚\n\n![xaas](https://image.robocanic.com/notes/image-vbfj.png)\n\nåœ¨è¿™æ³¢æµªæ½®æ¨åŠ¨çš„åŒæ—¶ï¼Œå¾®æœåŠ¡ç”±äºå…¶æ˜“äºæ‰©å±•ï¼Œå¼€å‘æ•æ·ï¼Œäººæ•ˆåˆ©ç”¨é«˜ç­‰ä¼˜ç‚¹ä¹Ÿå¤§è¡Œå…¶é“ã€‚ä½†æ˜¯åœ¨æµªæ½®è¿‡åï¼Œå·²ç»ä¸Šäº‘çš„ä¼ä¸šåˆå‘ç°ä¸€äº›æ£˜æ‰‹çš„é—®é¢˜ï¼š\n\n1. äº‘æœåŠ¡ç»‘å®šäº‘å‚å•†ï¼Œæ— æ³•æ¯”è¾ƒå¹³æ»‘è¿ç§»åˆ°å¦ä¸€ä¸ªäº‘å‚å•†\n\n2. äº‘æœåŠ¡å™¨çš„åˆ©ç”¨ç‡æ™®éåä½ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹çš„æˆæœ¬ç®—ä¸‹æ¥æ¯”è‡ªå»ºæœºæˆ¿è¿˜è¦é«˜\n\n3. äº‘æœåŠ¡ç¡®å®å…·å¤‡å¼¹æ€§å’Œå®¹é”™æ€§ï¼Œä½†éšç€å¾®æœåŠ¡çš„ç››è¡Œï¼ŒåŸºäºæœºå™¨ç²’åº¦çš„å¼¹æ€§å’Œå®¹é”™æ€§æ»¡è¶³ä¸äº†å¤§éƒ¨åˆ†ç”¨æˆ·çš„éœ€æ±‚\n\n......\n\nä¼—å¤šä¼ä¸šåœ¨ç”¨äº‘è¿‡ç¨‹éƒ½æˆ–å¤šæˆ–å°‘ç¢°åˆ°äº†è¿™äº›é—®é¢˜ã€‚è€Œäº‘åŸç”Ÿå°±æ˜¯è¿™æ ·ä¸€å¥—æŠ€æœ¯ä½“ç³»ä»¥åŠç†å¿µï¼Œèƒ½å¤Ÿä½¿å¾—ä¸Šè¿°æåˆ°çš„é—®é¢˜è¿åˆƒè€Œè§£ã€‚é‚£åˆ°åº•äº‘åŸç”Ÿæ˜¯æ€ä¹ˆè§£å†³çš„å‘¢ï¼Ÿ\n\näº‘åŸç”Ÿçš„å¾ˆå¤šæŠ€æœ¯éƒ½è€ƒè™‘åˆ°äº†åº”ç”¨ï¼ˆæœåŠ¡ï¼‰è¿™ä¸ªç²’åº¦ï¼Œè¿™ä¸ä¼ ç»Ÿäº‘è®¡ç®—çš„ Iaas è¿™ä¸ªå±‚æ¬¡å¯¹æœºå™¨çš„ç²’åº¦çš„æŠ½è±¡ç›¸æ¯”éƒ½è¦æ›´å°ä¸€äº›ã€‚ä»¥äº‘åŸç”Ÿçš„é›†å¤§æˆè€… Kubernetesï¼ˆk8sï¼‰ä¸ºä¾‹ï¼Œç®€å•è®²è®²å®ƒæ˜¯æ€ä¹ˆè§£å†³è¿ç§»éš¾ï¼Œåˆ©ç”¨ç‡ä½ï¼Œå¼¹æ€§å’Œå®¹é”™æ€§éš¾ç”¨è¿™ä¹ˆå‡ ä¸ªå…³é”®ç‚¹çš„ã€‚\n\né¦–å…ˆ k8s å®šä¹‰äº† Nodeï¼ˆå°±æ˜¯ä¸€å°æœåŠ¡å™¨ï¼‰ä¸ Podï¼ˆå°±æ˜¯ä¸€ä¸ªæœåŠ¡çš„å‰¯æœ¬ï¼‰è¿™ä¸¤ç§èµ„æºï¼ŒPod å¯ä»¥ç”³è¯· CPUï¼Œå†…å­˜ç­‰è®¡ç®—èµ„æºï¼Œk8s ä¼šæ ¹æ®ç”³è¯·çš„ CPU å’Œå†…å­˜å°† Pod æŒ‰ç…§ä¸€å®šç­–ç•¥è°ƒåº¦åˆ°æŸä¸€ä¸ª Nodeã€‚æˆ‘ä»¬å¯ä»¥è°ƒæ•´è¿™å…¶ä¸­çš„ç­–ç•¥æ¥ä½¿å¾— Node å¯ä»¥æ‰¿è½½æ›´å¤šçš„ Podï¼Œä»¥æé«˜æœåŠ¡å™¨æ•´ä½“çš„ä½¿ç”¨ç‡ã€‚ä¸€èˆ¬ä¸ºäº†é«˜å¯ç”¨æˆ‘ä»¬çš„æœåŠ¡éƒ½æ˜¯ä»¥å¤šå‰¯æœ¬ï¼ˆPodï¼‰éƒ¨ç½²çš„ï¼Œå¯¹å¤–æä¾›ç›¸åŒçš„æœåŠ¡ã€‚åŒä¸€ä¸ªæœåŠ¡çš„ Pod å¯ä»¥æ‰“æ•£éƒ¨ç½²åˆ°ä¸åŒçš„ Node ä¸Šï¼Œè¿™æ ·å°±ç®—ä¸€ä¸ª Node å‡ºç°æ•…éšœæŒ‚æ‰ï¼Œé‚£ä¹Ÿåªæ˜¯è¿™ä¸ª Node ä¸Šçš„ Pod æ— æ³•æä¾›æœåŠ¡ï¼Œå…¶ä»– Node ä¸Šçš„ Pod ä»ç„¶å¯ä»¥å¯¹å¤–æä¾›æœåŠ¡ï¼Œä¸æ­¤åŒæ—¶ k8s è¿˜ä¼šåœ¨å…¶ä»– Node ä¸Šæ‹‰èµ·å› ä¸º Node æ•…éšœè€ŒæŒ‚æ‰çš„ Podã€‚è¿™æ ·é«˜å¯ç”¨å°±èƒ½å¾—åˆ°å¾ˆå¥½çš„ä¿éšœã€‚\n\nå½“ç„¶ï¼Œæœ€é‡è¦çš„è«è¿‡äºï¼škubernetes æ˜¯å¼€æºçš„ï¼Œä¸å‚å•†æ— å…³ã€‚åªè¦æˆ‘ä»¬çš„æœåŠ¡è¿è¡Œåœ¨ k8s ä¸Šï¼Œç†è®ºä¸Šå°±èƒ½å¤Ÿåœ¨ä¸åŒçš„äº‘å‚å•†ä¹‹é—´è¿›è¡Œè¿ç§»ã€‚ å¯ä»¥è¿™ä¹ˆè¯´ï¼Œåœ¨è¿‡å»åå¹´ï¼Œäº‘åŸç”Ÿå°±æ˜¯è¶ç€å¾®æœåŠ¡çš„ä¸œé£ï¼Œæ‰ä¸€è·ƒæˆä¸ºç‚™æ‰‹å¯çƒ­çš„æŠ€æœ¯ä¹‹ä¸€ã€‚å› æ­¤ï¼Œäº‘åŸç”Ÿå’Œå¾®æœåŠ¡æ˜¯å¯†ä¸å¯åˆ†çš„ã€‚\n\nå†æ¥å›ç­”åˆ°ä¸Šä¸€å°èŠ‚æœ«çš„é—®é¢˜ï¼Œäº‘åŸç”Ÿæ˜¯æ€ä¹ˆè§£å†³çš„å‘¢->ç²’åº¦çš„å‡å°ï¼Œå‡å°åˆ°ä»€ä¹ˆç¨‹åº¦å‘¢->ä¸å¾®æœåŠ¡ä½“ç³»ä¸­çš„æœåŠ¡ç›¸åŒ¹é…ã€‚\n\n# äº‘åŸç”Ÿå’Œæˆ‘æœ‰å•¥å…³ç³»\n\nå¯èƒ½å†™åˆ°è¿™ä½ è¿˜æ˜¯å¯¹äº‘åŸç”Ÿæœ‰ä¸€äº›ç–‘æƒ‘ï¼Œæœ€å¤§çš„ç–‘æƒ‘å¯èƒ½è«è¿‡äºï¼šå¯¹äºâ€œæˆ‘â€è€Œè¨€ï¼Œäº‘åŸç”Ÿå’Œæˆ‘æœ‰å•¥å…³ç³»ï¼Ÿä¸ºäº†å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥è®©è¿™ä¸ªâ€œæˆ‘â€æ¥æ‰®æ¼”å¤šä¸ªè§’è‰²ã€‚\n\nå¦‚æœâ€œæˆ‘â€æ˜¯ä¼ä¸šè€æ¿/æŠ€æœ¯è´Ÿè´£äººï¼Œé‚£æˆ‘é¦–å…ˆåº”è¯¥æƒ³åˆ°çš„æ˜¯äº‘åŸç”Ÿèƒ½å¤Ÿæä¾›â€œçœ‹å¾—åˆ°â€çš„ä»·å€¼ã€‚é‚£é¦–å½“å…¶å†²çš„å°±æ˜¯ä½¿ç”¨äº‘åŸç”ŸæŠ€æœ¯èƒ½å¤Ÿæœ‰æ•ˆæé«˜æœºå™¨è´Ÿè½½ï¼Œé™ä½æœºå™¨æˆæœ¬ï¼Œè¿™ä¸€å¤©ç„¶çš„ä¼˜åŠ¿ç‰¹åˆ«ç¬¦åˆè¿‘ä¸¤å¹´æ¥çš„â€œé™æœ¬å¢æ•ˆâ€çš„æµªæ½®ã€‚å…¶æ¬¡åŸºäºæœåŠ¡ç²’åº¦çš„å¼¹æ€§å’Œå®¹é”™æ€§ä¹Ÿè¿›ä¸€æ­¥å¢å¼ºäº†æœåŠ¡çš„å¥å£®æ€§ï¼Œå‡å°‘äº†äº‹æ•…çš„å‘ç”Ÿã€‚ä»äººæ•ˆä¸Šçœ‹ï¼ŒåŸºäºäº‘åŸç”Ÿçš„ CI/CD æµæå‡äº†æ•æ·å¼€å‘çš„æ•ˆç‡ï¼ŒåŠ å¿«äº†ä¸šåŠ¡è¿­ä»£çš„é€Ÿåº¦ï¼Œä»è€Œæä¾›äº†äººæ•ˆã€‚å› æ­¤äº‘åŸç”Ÿä½œä¸ºåŸºç¡€è®¾æ–½ï¼Œèƒ½äº§ç”Ÿå¾ˆå¤šçœ‹å¾—åˆ°çš„ä»·å€¼ï¼Œè¿™ä¸ä»¥å¾€åŸºç¡€è®¾æ–½å¾ˆéš¾ä½“ç°å‡ºä»·å€¼å½¢æˆäº†é²œæ˜çš„å¯¹æ¯”ã€‚\n\nå¦‚æœâ€œæˆ‘â€æ˜¯æ™®é€šçš„å¼€å‘è€…ï¼Œé‚£æˆ‘é¦–å…ˆæƒ³åˆ°çš„æ˜¯å…¶æŠ€æœ¯ä»·å€¼ã€‚åœ¨å¸¸è§çš„å¼€å‘è°ƒè¯•->éƒ¨ç½²ä¸Šçº¿->çº¿ä¸Šè°ƒæ•´è¿™ä¸ªåº”ç”¨ç”Ÿå‘½å‘¨æœŸä¸­ï¼Œäº‘åŸç”Ÿä¸»è¦æ¶‰åŠåˆ°â€œéƒ¨ç½²ä¸Šçº¿â€œå’Œâ€œçº¿ä¸Šè°ƒæ•´â€è¿™ä¸¤ä¸ªæ­¥éª¤ã€‚åœ¨è§„æ¨¡ç¨å¤§çš„å…¬å¸ä¸­ï¼Œé€šå¸¸ä¼šåˆ†ä¸ºä¸šåŠ¡å¼€å‘å’Œå¹³å°å¼€å‘ï¼Œä¸šåŠ¡å¼€å‘ä¸“æ³¨äºä¸šåŠ¡å¼€å‘ä¸è¿­ä»£ä»¥æ»¡è¶³å®¢æˆ·éœ€æ±‚ï¼Œè€Œå¹³å°å¼€å‘åˆ™ä¸“æ³¨äºå†…éƒ¨ç ”å‘å¹³å°çš„å¼€å‘è¿­ä»£ä»¥æ»¡è¶³ä¸šåŠ¡å¼€å‘çš„éœ€æ±‚ã€‚å› æ­¤éƒ¨ç½²ä¸Šçº¿å’Œçº¿ä¸Šè°ƒæ•´ä¸€èˆ¬éƒ½ä¼šéƒ½ä¼šåˆ’å½’åˆ°å¹³å°ç ”å‘ä¸­ã€‚é‚£æ˜¯ä¸æ˜¯ä¸šåŠ¡å¼€å‘å°±å’Œäº‘åŸç”Ÿæ²¡å…³ç³»äº†ï¼Ÿä»æŸäº›æ„ä¹‰ä¸Šæ˜¯çš„ï¼Œä½†ä»æŠ€æœ¯å‘å±•çš„è§’åº¦çœ‹ï¼Œäº‘åŸç”Ÿä½œä¸ºåŸºç¡€è®¾æ–½å±‚çš„æŠ€æœ¯ï¼Œèåˆäº†å¾ˆå¤šè®¾è®¡è‰ºæœ¯ï¼Œæ¶‰åŠåˆ°å¾ˆå¤šé«˜å¯ç”¨ï¼Œé«˜å¹¶å‘çš„åœºæ™¯è®¾è®¡ã€‚å› æ­¤å½“ä½ å­¦ä¹ äº‘åŸç”Ÿçš„ä¸€äº›æŠ€æœ¯æ—¶ï¼Œä½ ä¼šè‡ªç„¶è€Œç„¶åœ°å°†ä¸€äº›ä¼˜é›…çš„è®¾è®¡ç†Ÿç¨”äºå¿ƒã€‚æ­¤å¤–ï¼Œç†Ÿæ‚‰äº‘åŸç”Ÿçš„å¤§è‡´æ¡†æ¶æœ‰åŠ©äºå¯¹æ•´ä¸ªåº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸæœ‰å®Œæ•´çš„ç†è§£ï¼Œåè¿‡æ¥ä¹Ÿæœ‰åŠ©äºä½ åœ¨å¼€å‘åº”ç”¨æ—¶èƒ½å¤Ÿæ›´å¥½åœ°åˆ©ç”¨åº•å±‚çš„åŸºç¡€èµ„æºã€‚\n\n# äº‘åŸç”Ÿçš„æœªæ¥\n\nä¸Šæ–‡ä¸­è¯´é“ï¼Œäº‘åŸç”Ÿä¹˜ç€å¾®æœåŠ¡çš„ä¸œé£ï¼Œåº¦è¿‡äº†â€œé»„é‡‘åå¹´â€œã€‚é‚£åœ¨ä¸‹ä¸€ä¸ªåå¹´ï¼Œäº‘åŸç”Ÿåˆè¯¥ä½•å»ä½•ä»ï¼Ÿ\nè¦å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆæ¥çœ‹çœ‹äº‘åŸç”Ÿçš„ä¼˜åŠ¿ã€‚å…³äºäº‘åŸç”Ÿçš„ä¼˜åŠ¿ï¼Œä¸Šæ–‡ä¹Ÿæåˆ°äº†ä¸å°‘ï¼Œåœ¨è¿™é‡Œæˆ‘å¯ä»¥æ€»ç»“æˆä¸€å¥è¯ï¼šäº‘åŸç”ŸæŠ€æœ¯èƒ½å¤Ÿä½¿åº”ç”¨æ›´å¥½åœ°åˆ©ç”¨äº‘èµ„æºï¼Œæ›´å¥½åœ°å¯¹å¤–æä¾›æœåŠ¡ã€‚å¯¹è¿™å¥è¯å†è§£è¯»ä¸€ä¸‹ï¼Œæˆ‘ä»¬çš„åº”ç”¨æ˜¯éœ€è¦æ¶ˆè€—äº‘èµ„æºå¹¶å‘å¤–æä¾›æœåŠ¡çš„ï¼Œè€Œäº‘åŸç”ŸæŠ€æœ¯æŠ½è±¡äº†è®¡ç®—èµ„æºï¼Œèƒ½å¤Ÿè®©åº”ç”¨æŒ‰éœ€åœ°ä½¿ç”¨äº‘èµ„æºï¼Œä»è€Œä½¿å¾—åº”ç”¨å¯¹å¤–æä¾›æœåŠ¡è¿™ä¸€è¿‡ç¨‹ä¾¿æ·äº†ä¸å°‘ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä»¥ä¸Šçš„æ€»ç»“ä»¥åŠè§£è¯»ä¸­çš„â€œåº”ç”¨â€œç‰¹æŒ‡æ¶ˆè€— CPUï¼Œå†…å­˜ï¼Œå­˜å‚¨çš„â€œä¼ ç»Ÿåº”ç”¨â€œã€‚é‚£ä¸ä¼ ç»Ÿåº”ç”¨ç›¸å¯¹åº”çš„æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿç­”æ¡ˆå°±æ˜¯ AIã€‚ä»å»å¹´å¤§ç«çš„ ChatGPT åˆ°ä»Šå¹´çš„ç™¾æ¨¡å¤§æˆ˜ï¼ŒAI å‘å±•çš„é€Ÿåº¦è¶…è¿‡äº†ç»å¤§å¤šæ•°äººçš„æƒ³è±¡ã€‚ä¸ä¼ ç»Ÿåº”ç”¨ç›¸æ¯”ï¼ŒAI åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸæ›´é•¿ï¼Œä¸”æ¨¡å‹çš„è®­ç»ƒï¼Œå¾®è°ƒï¼Œæ¨ç†éƒ½ç¦»ä¸å¼€å½“ä»Šæ—¶ä»£çš„â€œé»„é‡‘â€œâ€”â€”GPUï¼Œè€Œäº‘åŸç”Ÿé¢†åŸŸçš„æŠ€æœ¯å¯¹ AI çš„æ”¯æŒè¿˜è¿œæ²¡æœ‰ä¼ ç»Ÿåº”ç”¨çš„å®Œå–„ã€‚è¯¸å¦‚ mlopsï¼ŒGPU çš„è°ƒåº¦åˆ†é…ï¼Œåˆ†å¸ƒå¼è®­ç»ƒç­‰éšç€ AI å‘å±•è€Œæ¶Œç°çš„ topic ä¼šè¶Šæ¥è¶Šå¤šï¼Œç›¸ä¿¡äº‘åŸç”Ÿ+äººå·¥æ™ºèƒ½çš„è„šæ­¥ä¹Ÿä¼šè¶Šæ¥è¶Šå¿«ã€‚\n\nè‡³æ­¤ï¼Œäº‘åŸç”Ÿçš„æœªæ¥ä¹Ÿå¾ˆç¡®å®šäº†ï¼ŒCNAIï¼ˆCloud Native Artificial Intelligenceï¼‰å°†ä¼šæˆä¸ºäº‘åŸç”Ÿä¸‹ä¸€ä¸ªåå¹´çš„ä¸»èˆªé“ã€‚\n\n![CNAI](https://image.robocanic.com/notes/image.png)\n\nå†™åœ¨æœ€åï¼š\n\næƒ³äº†å¾ˆä¹…ç¬¬ä¸€ç¯‡åšå®¢è¦å†™äº›ä»€ä¹ˆï¼Œå‰å‰ååæƒ³äº†ä¸€å‘¨ï¼Œæœ€åè¿˜æ˜¯æ•²å®šäº†ä¸€ä¸ªæ¯”è¾ƒå¤§çš„ titleï¼Œå¸Œæœ›å¯¹ä½ æœ‰æ‰€å¸®åŠ©ã€‚æ–‡ç« å†…å®¹å¦‚æœ‰é”™è¯¯ï¼Œè¯·è€å¸ˆä»¬è¯„è®ºåŒºå‹˜è¯¯ ğŸ˜ğŸ˜ã€‚åç»­å°†ä¼šæŒç»­æ›´æ–°äº‘åŸç”Ÿï¼ŒLLM ç­‰é¢†åŸŸçš„å†…å®¹ã€‚\n","slug":"ç¬¬ä¸€ç¯‡åšå®¢ï¼Œæˆ‘çœ¼ä¸­çš„äº‘åŸç”Ÿ","published":1,"updated":"2024-12-21T09:55:14.820Z","comments":1,"layout":"post","photos":[],"_id":"cm50ntui200033gwbfmg56z1g","content":"<p>å¾ˆå¤šå°ä¼™ä¼´åˆšä¸€å¼€å§‹çœ‹åˆ°â€œäº‘åŸç”Ÿâ€œä¸‰ä¸ªå­—æ—¶éƒ½ä¼šæœ‰ç‚¹æ‡µï¼Œå½“ç„¶å½¼æ—¶çš„æˆ‘ä¹Ÿä¸ä¾‹å¤–ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†ä»â€äº‘åŸç”Ÿæ˜¯ä¸ªå•¥â€œï¼Œâ€äº‘åŸç”Ÿå’Œæˆ‘æœ‰å•¥å…³ç³»â€œï¼Œâ€œäº‘åŸç”Ÿçš„æœªæ¥â€è¿™ä¸‰ä¸ªæ–¹é¢æ¥å±•ç°æˆ‘çœ¼ä¸­çš„äº‘åŸç”Ÿï¼Œå¸Œæœ›å¯¹ä½ æœ‰æ‰€å¸®åŠ©ã€‚</p>\n<h1 id=\"äº‘åŸç”Ÿæ˜¯ä¸ªå•¥\"><a href=\"#äº‘åŸç”Ÿæ˜¯ä¸ªå•¥\" class=\"headerlink\" title=\"äº‘åŸç”Ÿæ˜¯ä¸ªå•¥\"></a>äº‘åŸç”Ÿæ˜¯ä¸ªå•¥</h1><p>åœ¨è¯´äº‘åŸç”Ÿä¹‹å‰ï¼Œä¸å¾—ä¸å…ˆæ¥è°ˆè°ˆäº‘è®¡ç®—å’Œå¾®æœåŠ¡ã€‚äº‘è®¡ç®—æ˜¯ä¸€ç§æ‰˜ç®¡åœ¨è¿œç¨‹æ•°æ®ä¸­å¿ƒçš„æœåŠ¡ï¼Œåœ¨ä»Šå¤©å·²ç»ç›¸å½“æ™®éäº†ã€‚äº‘è®¡ç®—ç”±äºšé©¬é€Šåœ¨ 2006 å¹´é¦–å…ˆæ¨å‡ºï¼Œä¸»æ‰“çš„å–ç‚¹å°±æ˜¯äº‘çš„é«˜å¼¹æ€§ï¼Œé«˜å®¹é”™ï¼Œå…ï¼ˆå°‘ï¼‰è¿ç»´ï¼Œæ¯”è‡ªå»ºæœºæˆ¿æ›´ä¾¿å®œç­‰ä¼˜ç‚¹ã€‚éšåå„å¤§äº‘å‚å•†å¦‚ Googleï¼Œå¾®è½¯ï¼Œé˜¿é‡Œå·´å·´ç­‰è¿…é€Ÿè·Ÿè¿›ï¼Œå»ºç«‹äº† Iaasï¼ŒPaasï¼ŒSaas ç­‰å¯¹äº‘åŸºç¡€è®¾æ–½ä¸åŒæŠ½è±¡å±‚æ¬¡çš„æœåŠ¡ä½“ç³»ï¼Œåœ¨ 08 åˆ° 16 å¹´æ€èµ·äº†ä¸€æ³¢ä¸Šäº‘çš„æµªæ½®ã€‚</p>\n<p><img src=\"https://image.robocanic.com/notes/image-vbfj.png\" alt=\"xaas\"></p>\n<p>åœ¨è¿™æ³¢æµªæ½®æ¨åŠ¨çš„åŒæ—¶ï¼Œå¾®æœåŠ¡ç”±äºå…¶æ˜“äºæ‰©å±•ï¼Œå¼€å‘æ•æ·ï¼Œäººæ•ˆåˆ©ç”¨é«˜ç­‰ä¼˜ç‚¹ä¹Ÿå¤§è¡Œå…¶é“ã€‚ä½†æ˜¯åœ¨æµªæ½®è¿‡åï¼Œå·²ç»ä¸Šäº‘çš„ä¼ä¸šåˆå‘ç°ä¸€äº›æ£˜æ‰‹çš„é—®é¢˜ï¼š</p>\n<ol>\n<li><p>äº‘æœåŠ¡ç»‘å®šäº‘å‚å•†ï¼Œæ— æ³•æ¯”è¾ƒå¹³æ»‘è¿ç§»åˆ°å¦ä¸€ä¸ªäº‘å‚å•†</p>\n</li>\n<li><p>äº‘æœåŠ¡å™¨çš„åˆ©ç”¨ç‡æ™®éåä½ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹çš„æˆæœ¬ç®—ä¸‹æ¥æ¯”è‡ªå»ºæœºæˆ¿è¿˜è¦é«˜</p>\n</li>\n<li><p>äº‘æœåŠ¡ç¡®å®å…·å¤‡å¼¹æ€§å’Œå®¹é”™æ€§ï¼Œä½†éšç€å¾®æœåŠ¡çš„ç››è¡Œï¼ŒåŸºäºæœºå™¨ç²’åº¦çš„å¼¹æ€§å’Œå®¹é”™æ€§æ»¡è¶³ä¸äº†å¤§éƒ¨åˆ†ç”¨æˆ·çš„éœ€æ±‚</p>\n</li>\n</ol>\n<p>â€¦â€¦</p>\n<p>ä¼—å¤šä¼ä¸šåœ¨ç”¨äº‘è¿‡ç¨‹éƒ½æˆ–å¤šæˆ–å°‘ç¢°åˆ°äº†è¿™äº›é—®é¢˜ã€‚è€Œäº‘åŸç”Ÿå°±æ˜¯è¿™æ ·ä¸€å¥—æŠ€æœ¯ä½“ç³»ä»¥åŠç†å¿µï¼Œèƒ½å¤Ÿä½¿å¾—ä¸Šè¿°æåˆ°çš„é—®é¢˜è¿åˆƒè€Œè§£ã€‚é‚£åˆ°åº•äº‘åŸç”Ÿæ˜¯æ€ä¹ˆè§£å†³çš„å‘¢ï¼Ÿ</p>\n<p>äº‘åŸç”Ÿçš„å¾ˆå¤šæŠ€æœ¯éƒ½è€ƒè™‘åˆ°äº†åº”ç”¨ï¼ˆæœåŠ¡ï¼‰è¿™ä¸ªç²’åº¦ï¼Œè¿™ä¸ä¼ ç»Ÿäº‘è®¡ç®—çš„ Iaas è¿™ä¸ªå±‚æ¬¡å¯¹æœºå™¨çš„ç²’åº¦çš„æŠ½è±¡ç›¸æ¯”éƒ½è¦æ›´å°ä¸€äº›ã€‚ä»¥äº‘åŸç”Ÿçš„é›†å¤§æˆè€… Kubernetesï¼ˆk8sï¼‰ä¸ºä¾‹ï¼Œç®€å•è®²è®²å®ƒæ˜¯æ€ä¹ˆè§£å†³è¿ç§»éš¾ï¼Œåˆ©ç”¨ç‡ä½ï¼Œå¼¹æ€§å’Œå®¹é”™æ€§éš¾ç”¨è¿™ä¹ˆå‡ ä¸ªå…³é”®ç‚¹çš„ã€‚</p>\n<p>é¦–å…ˆ k8s å®šä¹‰äº† Nodeï¼ˆå°±æ˜¯ä¸€å°æœåŠ¡å™¨ï¼‰ä¸ Podï¼ˆå°±æ˜¯ä¸€ä¸ªæœåŠ¡çš„å‰¯æœ¬ï¼‰è¿™ä¸¤ç§èµ„æºï¼ŒPod å¯ä»¥ç”³è¯· CPUï¼Œå†…å­˜ç­‰è®¡ç®—èµ„æºï¼Œk8s ä¼šæ ¹æ®ç”³è¯·çš„ CPU å’Œå†…å­˜å°† Pod æŒ‰ç…§ä¸€å®šç­–ç•¥è°ƒåº¦åˆ°æŸä¸€ä¸ª Nodeã€‚æˆ‘ä»¬å¯ä»¥è°ƒæ•´è¿™å…¶ä¸­çš„ç­–ç•¥æ¥ä½¿å¾— Node å¯ä»¥æ‰¿è½½æ›´å¤šçš„ Podï¼Œä»¥æé«˜æœåŠ¡å™¨æ•´ä½“çš„ä½¿ç”¨ç‡ã€‚ä¸€èˆ¬ä¸ºäº†é«˜å¯ç”¨æˆ‘ä»¬çš„æœåŠ¡éƒ½æ˜¯ä»¥å¤šå‰¯æœ¬ï¼ˆPodï¼‰éƒ¨ç½²çš„ï¼Œå¯¹å¤–æä¾›ç›¸åŒçš„æœåŠ¡ã€‚åŒä¸€ä¸ªæœåŠ¡çš„ Pod å¯ä»¥æ‰“æ•£éƒ¨ç½²åˆ°ä¸åŒçš„ Node ä¸Šï¼Œè¿™æ ·å°±ç®—ä¸€ä¸ª Node å‡ºç°æ•…éšœæŒ‚æ‰ï¼Œé‚£ä¹Ÿåªæ˜¯è¿™ä¸ª Node ä¸Šçš„ Pod æ— æ³•æä¾›æœåŠ¡ï¼Œå…¶ä»– Node ä¸Šçš„ Pod ä»ç„¶å¯ä»¥å¯¹å¤–æä¾›æœåŠ¡ï¼Œä¸æ­¤åŒæ—¶ k8s è¿˜ä¼šåœ¨å…¶ä»– Node ä¸Šæ‹‰èµ·å› ä¸º Node æ•…éšœè€ŒæŒ‚æ‰çš„ Podã€‚è¿™æ ·é«˜å¯ç”¨å°±èƒ½å¾—åˆ°å¾ˆå¥½çš„ä¿éšœã€‚</p>\n<p>å½“ç„¶ï¼Œæœ€é‡è¦çš„è«è¿‡äºï¼škubernetes æ˜¯å¼€æºçš„ï¼Œä¸å‚å•†æ— å…³ã€‚åªè¦æˆ‘ä»¬çš„æœåŠ¡è¿è¡Œåœ¨ k8s ä¸Šï¼Œç†è®ºä¸Šå°±èƒ½å¤Ÿåœ¨ä¸åŒçš„äº‘å‚å•†ä¹‹é—´è¿›è¡Œè¿ç§»ã€‚ å¯ä»¥è¿™ä¹ˆè¯´ï¼Œåœ¨è¿‡å»åå¹´ï¼Œäº‘åŸç”Ÿå°±æ˜¯è¶ç€å¾®æœåŠ¡çš„ä¸œé£ï¼Œæ‰ä¸€è·ƒæˆä¸ºç‚™æ‰‹å¯çƒ­çš„æŠ€æœ¯ä¹‹ä¸€ã€‚å› æ­¤ï¼Œäº‘åŸç”Ÿå’Œå¾®æœåŠ¡æ˜¯å¯†ä¸å¯åˆ†çš„ã€‚</p>\n<p>å†æ¥å›ç­”åˆ°ä¸Šä¸€å°èŠ‚æœ«çš„é—®é¢˜ï¼Œäº‘åŸç”Ÿæ˜¯æ€ä¹ˆè§£å†³çš„å‘¢-&gt;ç²’åº¦çš„å‡å°ï¼Œå‡å°åˆ°ä»€ä¹ˆç¨‹åº¦å‘¢-&gt;ä¸å¾®æœåŠ¡ä½“ç³»ä¸­çš„æœåŠ¡ç›¸åŒ¹é…ã€‚</p>\n<h1 id=\"äº‘åŸç”Ÿå’Œæˆ‘æœ‰å•¥å…³ç³»\"><a href=\"#äº‘åŸç”Ÿå’Œæˆ‘æœ‰å•¥å…³ç³»\" class=\"headerlink\" title=\"äº‘åŸç”Ÿå’Œæˆ‘æœ‰å•¥å…³ç³»\"></a>äº‘åŸç”Ÿå’Œæˆ‘æœ‰å•¥å…³ç³»</h1><p>å¯èƒ½å†™åˆ°è¿™ä½ è¿˜æ˜¯å¯¹äº‘åŸç”Ÿæœ‰ä¸€äº›ç–‘æƒ‘ï¼Œæœ€å¤§çš„ç–‘æƒ‘å¯èƒ½è«è¿‡äºï¼šå¯¹äºâ€œæˆ‘â€è€Œè¨€ï¼Œäº‘åŸç”Ÿå’Œæˆ‘æœ‰å•¥å…³ç³»ï¼Ÿä¸ºäº†å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥è®©è¿™ä¸ªâ€œæˆ‘â€æ¥æ‰®æ¼”å¤šä¸ªè§’è‰²ã€‚</p>\n<p>å¦‚æœâ€œæˆ‘â€æ˜¯ä¼ä¸šè€æ¿&#x2F;æŠ€æœ¯è´Ÿè´£äººï¼Œé‚£æˆ‘é¦–å…ˆåº”è¯¥æƒ³åˆ°çš„æ˜¯äº‘åŸç”Ÿèƒ½å¤Ÿæä¾›â€œçœ‹å¾—åˆ°â€çš„ä»·å€¼ã€‚é‚£é¦–å½“å…¶å†²çš„å°±æ˜¯ä½¿ç”¨äº‘åŸç”ŸæŠ€æœ¯èƒ½å¤Ÿæœ‰æ•ˆæé«˜æœºå™¨è´Ÿè½½ï¼Œé™ä½æœºå™¨æˆæœ¬ï¼Œè¿™ä¸€å¤©ç„¶çš„ä¼˜åŠ¿ç‰¹åˆ«ç¬¦åˆè¿‘ä¸¤å¹´æ¥çš„â€œé™æœ¬å¢æ•ˆâ€çš„æµªæ½®ã€‚å…¶æ¬¡åŸºäºæœåŠ¡ç²’åº¦çš„å¼¹æ€§å’Œå®¹é”™æ€§ä¹Ÿè¿›ä¸€æ­¥å¢å¼ºäº†æœåŠ¡çš„å¥å£®æ€§ï¼Œå‡å°‘äº†äº‹æ•…çš„å‘ç”Ÿã€‚ä»äººæ•ˆä¸Šçœ‹ï¼ŒåŸºäºäº‘åŸç”Ÿçš„ CI&#x2F;CD æµæå‡äº†æ•æ·å¼€å‘çš„æ•ˆç‡ï¼ŒåŠ å¿«äº†ä¸šåŠ¡è¿­ä»£çš„é€Ÿåº¦ï¼Œä»è€Œæä¾›äº†äººæ•ˆã€‚å› æ­¤äº‘åŸç”Ÿä½œä¸ºåŸºç¡€è®¾æ–½ï¼Œèƒ½äº§ç”Ÿå¾ˆå¤šçœ‹å¾—åˆ°çš„ä»·å€¼ï¼Œè¿™ä¸ä»¥å¾€åŸºç¡€è®¾æ–½å¾ˆéš¾ä½“ç°å‡ºä»·å€¼å½¢æˆäº†é²œæ˜çš„å¯¹æ¯”ã€‚</p>\n<p>å¦‚æœâ€œæˆ‘â€æ˜¯æ™®é€šçš„å¼€å‘è€…ï¼Œé‚£æˆ‘é¦–å…ˆæƒ³åˆ°çš„æ˜¯å…¶æŠ€æœ¯ä»·å€¼ã€‚åœ¨å¸¸è§çš„å¼€å‘è°ƒè¯•-&gt;éƒ¨ç½²ä¸Šçº¿-&gt;çº¿ä¸Šè°ƒæ•´è¿™ä¸ªåº”ç”¨ç”Ÿå‘½å‘¨æœŸä¸­ï¼Œäº‘åŸç”Ÿä¸»è¦æ¶‰åŠåˆ°â€œéƒ¨ç½²ä¸Šçº¿â€œå’Œâ€œçº¿ä¸Šè°ƒæ•´â€è¿™ä¸¤ä¸ªæ­¥éª¤ã€‚åœ¨è§„æ¨¡ç¨å¤§çš„å…¬å¸ä¸­ï¼Œé€šå¸¸ä¼šåˆ†ä¸ºä¸šåŠ¡å¼€å‘å’Œå¹³å°å¼€å‘ï¼Œä¸šåŠ¡å¼€å‘ä¸“æ³¨äºä¸šåŠ¡å¼€å‘ä¸è¿­ä»£ä»¥æ»¡è¶³å®¢æˆ·éœ€æ±‚ï¼Œè€Œå¹³å°å¼€å‘åˆ™ä¸“æ³¨äºå†…éƒ¨ç ”å‘å¹³å°çš„å¼€å‘è¿­ä»£ä»¥æ»¡è¶³ä¸šåŠ¡å¼€å‘çš„éœ€æ±‚ã€‚å› æ­¤éƒ¨ç½²ä¸Šçº¿å’Œçº¿ä¸Šè°ƒæ•´ä¸€èˆ¬éƒ½ä¼šéƒ½ä¼šåˆ’å½’åˆ°å¹³å°ç ”å‘ä¸­ã€‚é‚£æ˜¯ä¸æ˜¯ä¸šåŠ¡å¼€å‘å°±å’Œäº‘åŸç”Ÿæ²¡å…³ç³»äº†ï¼Ÿä»æŸäº›æ„ä¹‰ä¸Šæ˜¯çš„ï¼Œä½†ä»æŠ€æœ¯å‘å±•çš„è§’åº¦çœ‹ï¼Œäº‘åŸç”Ÿä½œä¸ºåŸºç¡€è®¾æ–½å±‚çš„æŠ€æœ¯ï¼Œèåˆäº†å¾ˆå¤šè®¾è®¡è‰ºæœ¯ï¼Œæ¶‰åŠåˆ°å¾ˆå¤šé«˜å¯ç”¨ï¼Œé«˜å¹¶å‘çš„åœºæ™¯è®¾è®¡ã€‚å› æ­¤å½“ä½ å­¦ä¹ äº‘åŸç”Ÿçš„ä¸€äº›æŠ€æœ¯æ—¶ï¼Œä½ ä¼šè‡ªç„¶è€Œç„¶åœ°å°†ä¸€äº›ä¼˜é›…çš„è®¾è®¡ç†Ÿç¨”äºå¿ƒã€‚æ­¤å¤–ï¼Œç†Ÿæ‚‰äº‘åŸç”Ÿçš„å¤§è‡´æ¡†æ¶æœ‰åŠ©äºå¯¹æ•´ä¸ªåº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸæœ‰å®Œæ•´çš„ç†è§£ï¼Œåè¿‡æ¥ä¹Ÿæœ‰åŠ©äºä½ åœ¨å¼€å‘åº”ç”¨æ—¶èƒ½å¤Ÿæ›´å¥½åœ°åˆ©ç”¨åº•å±‚çš„åŸºç¡€èµ„æºã€‚</p>\n<h1 id=\"äº‘åŸç”Ÿçš„æœªæ¥\"><a href=\"#äº‘åŸç”Ÿçš„æœªæ¥\" class=\"headerlink\" title=\"äº‘åŸç”Ÿçš„æœªæ¥\"></a>äº‘åŸç”Ÿçš„æœªæ¥</h1><p>ä¸Šæ–‡ä¸­è¯´é“ï¼Œäº‘åŸç”Ÿä¹˜ç€å¾®æœåŠ¡çš„ä¸œé£ï¼Œåº¦è¿‡äº†â€œé»„é‡‘åå¹´â€œã€‚é‚£åœ¨ä¸‹ä¸€ä¸ªåå¹´ï¼Œäº‘åŸç”Ÿåˆè¯¥ä½•å»ä½•ä»ï¼Ÿ<br>è¦å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆæ¥çœ‹çœ‹äº‘åŸç”Ÿçš„ä¼˜åŠ¿ã€‚å…³äºäº‘åŸç”Ÿçš„ä¼˜åŠ¿ï¼Œä¸Šæ–‡ä¹Ÿæåˆ°äº†ä¸å°‘ï¼Œåœ¨è¿™é‡Œæˆ‘å¯ä»¥æ€»ç»“æˆä¸€å¥è¯ï¼šäº‘åŸç”ŸæŠ€æœ¯èƒ½å¤Ÿä½¿åº”ç”¨æ›´å¥½åœ°åˆ©ç”¨äº‘èµ„æºï¼Œæ›´å¥½åœ°å¯¹å¤–æä¾›æœåŠ¡ã€‚å¯¹è¿™å¥è¯å†è§£è¯»ä¸€ä¸‹ï¼Œæˆ‘ä»¬çš„åº”ç”¨æ˜¯éœ€è¦æ¶ˆè€—äº‘èµ„æºå¹¶å‘å¤–æä¾›æœåŠ¡çš„ï¼Œè€Œäº‘åŸç”ŸæŠ€æœ¯æŠ½è±¡äº†è®¡ç®—èµ„æºï¼Œèƒ½å¤Ÿè®©åº”ç”¨æŒ‰éœ€åœ°ä½¿ç”¨äº‘èµ„æºï¼Œä»è€Œä½¿å¾—åº”ç”¨å¯¹å¤–æä¾›æœåŠ¡è¿™ä¸€è¿‡ç¨‹ä¾¿æ·äº†ä¸å°‘ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä»¥ä¸Šçš„æ€»ç»“ä»¥åŠè§£è¯»ä¸­çš„â€œåº”ç”¨â€œç‰¹æŒ‡æ¶ˆè€— CPUï¼Œå†…å­˜ï¼Œå­˜å‚¨çš„â€œä¼ ç»Ÿåº”ç”¨â€œã€‚é‚£ä¸ä¼ ç»Ÿåº”ç”¨ç›¸å¯¹åº”çš„æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿç­”æ¡ˆå°±æ˜¯ AIã€‚ä»å»å¹´å¤§ç«çš„ ChatGPT åˆ°ä»Šå¹´çš„ç™¾æ¨¡å¤§æˆ˜ï¼ŒAI å‘å±•çš„é€Ÿåº¦è¶…è¿‡äº†ç»å¤§å¤šæ•°äººçš„æƒ³è±¡ã€‚ä¸ä¼ ç»Ÿåº”ç”¨ç›¸æ¯”ï¼ŒAI åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸæ›´é•¿ï¼Œä¸”æ¨¡å‹çš„è®­ç»ƒï¼Œå¾®è°ƒï¼Œæ¨ç†éƒ½ç¦»ä¸å¼€å½“ä»Šæ—¶ä»£çš„â€œé»„é‡‘â€œâ€”â€”GPUï¼Œè€Œäº‘åŸç”Ÿé¢†åŸŸçš„æŠ€æœ¯å¯¹ AI çš„æ”¯æŒè¿˜è¿œæ²¡æœ‰ä¼ ç»Ÿåº”ç”¨çš„å®Œå–„ã€‚è¯¸å¦‚ mlopsï¼ŒGPU çš„è°ƒåº¦åˆ†é…ï¼Œåˆ†å¸ƒå¼è®­ç»ƒç­‰éšç€ AI å‘å±•è€Œæ¶Œç°çš„ topic ä¼šè¶Šæ¥è¶Šå¤šï¼Œç›¸ä¿¡äº‘åŸç”Ÿ+äººå·¥æ™ºèƒ½çš„è„šæ­¥ä¹Ÿä¼šè¶Šæ¥è¶Šå¿«ã€‚</p>\n<p>è‡³æ­¤ï¼Œäº‘åŸç”Ÿçš„æœªæ¥ä¹Ÿå¾ˆç¡®å®šäº†ï¼ŒCNAIï¼ˆCloud Native Artificial Intelligenceï¼‰å°†ä¼šæˆä¸ºäº‘åŸç”Ÿä¸‹ä¸€ä¸ªåå¹´çš„ä¸»èˆªé“ã€‚</p>\n<p><img src=\"https://image.robocanic.com/notes/image.png\" alt=\"CNAI\"></p>\n<p>å†™åœ¨æœ€åï¼š</p>\n<p>æƒ³äº†å¾ˆä¹…ç¬¬ä¸€ç¯‡åšå®¢è¦å†™äº›ä»€ä¹ˆï¼Œå‰å‰ååæƒ³äº†ä¸€å‘¨ï¼Œæœ€åè¿˜æ˜¯æ•²å®šäº†ä¸€ä¸ªæ¯”è¾ƒå¤§çš„ titleï¼Œå¸Œæœ›å¯¹ä½ æœ‰æ‰€å¸®åŠ©ã€‚æ–‡ç« å†…å®¹å¦‚æœ‰é”™è¯¯ï¼Œè¯·è€å¸ˆä»¬è¯„è®ºåŒºå‹˜è¯¯ ğŸ˜ğŸ˜ã€‚åç»­å°†ä¼šæŒç»­æ›´æ–°äº‘åŸç”Ÿï¼ŒLLM ç­‰é¢†åŸŸçš„å†…å®¹ã€‚</p>\n","excerpt":"","more":"<p>å¾ˆå¤šå°ä¼™ä¼´åˆšä¸€å¼€å§‹çœ‹åˆ°â€œäº‘åŸç”Ÿâ€œä¸‰ä¸ªå­—æ—¶éƒ½ä¼šæœ‰ç‚¹æ‡µï¼Œå½“ç„¶å½¼æ—¶çš„æˆ‘ä¹Ÿä¸ä¾‹å¤–ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†ä»â€äº‘åŸç”Ÿæ˜¯ä¸ªå•¥â€œï¼Œâ€äº‘åŸç”Ÿå’Œæˆ‘æœ‰å•¥å…³ç³»â€œï¼Œâ€œäº‘åŸç”Ÿçš„æœªæ¥â€è¿™ä¸‰ä¸ªæ–¹é¢æ¥å±•ç°æˆ‘çœ¼ä¸­çš„äº‘åŸç”Ÿï¼Œå¸Œæœ›å¯¹ä½ æœ‰æ‰€å¸®åŠ©ã€‚</p>\n<h1 id=\"äº‘åŸç”Ÿæ˜¯ä¸ªå•¥\"><a href=\"#äº‘åŸç”Ÿæ˜¯ä¸ªå•¥\" class=\"headerlink\" title=\"äº‘åŸç”Ÿæ˜¯ä¸ªå•¥\"></a>äº‘åŸç”Ÿæ˜¯ä¸ªå•¥</h1><p>åœ¨è¯´äº‘åŸç”Ÿä¹‹å‰ï¼Œä¸å¾—ä¸å…ˆæ¥è°ˆè°ˆäº‘è®¡ç®—å’Œå¾®æœåŠ¡ã€‚äº‘è®¡ç®—æ˜¯ä¸€ç§æ‰˜ç®¡åœ¨è¿œç¨‹æ•°æ®ä¸­å¿ƒçš„æœåŠ¡ï¼Œåœ¨ä»Šå¤©å·²ç»ç›¸å½“æ™®éäº†ã€‚äº‘è®¡ç®—ç”±äºšé©¬é€Šåœ¨ 2006 å¹´é¦–å…ˆæ¨å‡ºï¼Œä¸»æ‰“çš„å–ç‚¹å°±æ˜¯äº‘çš„é«˜å¼¹æ€§ï¼Œé«˜å®¹é”™ï¼Œå…ï¼ˆå°‘ï¼‰è¿ç»´ï¼Œæ¯”è‡ªå»ºæœºæˆ¿æ›´ä¾¿å®œç­‰ä¼˜ç‚¹ã€‚éšåå„å¤§äº‘å‚å•†å¦‚ Googleï¼Œå¾®è½¯ï¼Œé˜¿é‡Œå·´å·´ç­‰è¿…é€Ÿè·Ÿè¿›ï¼Œå»ºç«‹äº† Iaasï¼ŒPaasï¼ŒSaas ç­‰å¯¹äº‘åŸºç¡€è®¾æ–½ä¸åŒæŠ½è±¡å±‚æ¬¡çš„æœåŠ¡ä½“ç³»ï¼Œåœ¨ 08 åˆ° 16 å¹´æ€èµ·äº†ä¸€æ³¢ä¸Šäº‘çš„æµªæ½®ã€‚</p>\n<p><img src=\"https://image.robocanic.com/notes/image-vbfj.png\" alt=\"xaas\"></p>\n<p>åœ¨è¿™æ³¢æµªæ½®æ¨åŠ¨çš„åŒæ—¶ï¼Œå¾®æœåŠ¡ç”±äºå…¶æ˜“äºæ‰©å±•ï¼Œå¼€å‘æ•æ·ï¼Œäººæ•ˆåˆ©ç”¨é«˜ç­‰ä¼˜ç‚¹ä¹Ÿå¤§è¡Œå…¶é“ã€‚ä½†æ˜¯åœ¨æµªæ½®è¿‡åï¼Œå·²ç»ä¸Šäº‘çš„ä¼ä¸šåˆå‘ç°ä¸€äº›æ£˜æ‰‹çš„é—®é¢˜ï¼š</p>\n<ol>\n<li><p>äº‘æœåŠ¡ç»‘å®šäº‘å‚å•†ï¼Œæ— æ³•æ¯”è¾ƒå¹³æ»‘è¿ç§»åˆ°å¦ä¸€ä¸ªäº‘å‚å•†</p>\n</li>\n<li><p>äº‘æœåŠ¡å™¨çš„åˆ©ç”¨ç‡æ™®éåä½ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹çš„æˆæœ¬ç®—ä¸‹æ¥æ¯”è‡ªå»ºæœºæˆ¿è¿˜è¦é«˜</p>\n</li>\n<li><p>äº‘æœåŠ¡ç¡®å®å…·å¤‡å¼¹æ€§å’Œå®¹é”™æ€§ï¼Œä½†éšç€å¾®æœåŠ¡çš„ç››è¡Œï¼ŒåŸºäºæœºå™¨ç²’åº¦çš„å¼¹æ€§å’Œå®¹é”™æ€§æ»¡è¶³ä¸äº†å¤§éƒ¨åˆ†ç”¨æˆ·çš„éœ€æ±‚</p>\n</li>\n</ol>\n<p>â€¦â€¦</p>\n<p>ä¼—å¤šä¼ä¸šåœ¨ç”¨äº‘è¿‡ç¨‹éƒ½æˆ–å¤šæˆ–å°‘ç¢°åˆ°äº†è¿™äº›é—®é¢˜ã€‚è€Œäº‘åŸç”Ÿå°±æ˜¯è¿™æ ·ä¸€å¥—æŠ€æœ¯ä½“ç³»ä»¥åŠç†å¿µï¼Œèƒ½å¤Ÿä½¿å¾—ä¸Šè¿°æåˆ°çš„é—®é¢˜è¿åˆƒè€Œè§£ã€‚é‚£åˆ°åº•äº‘åŸç”Ÿæ˜¯æ€ä¹ˆè§£å†³çš„å‘¢ï¼Ÿ</p>\n<p>äº‘åŸç”Ÿçš„å¾ˆå¤šæŠ€æœ¯éƒ½è€ƒè™‘åˆ°äº†åº”ç”¨ï¼ˆæœåŠ¡ï¼‰è¿™ä¸ªç²’åº¦ï¼Œè¿™ä¸ä¼ ç»Ÿäº‘è®¡ç®—çš„ Iaas è¿™ä¸ªå±‚æ¬¡å¯¹æœºå™¨çš„ç²’åº¦çš„æŠ½è±¡ç›¸æ¯”éƒ½è¦æ›´å°ä¸€äº›ã€‚ä»¥äº‘åŸç”Ÿçš„é›†å¤§æˆè€… Kubernetesï¼ˆk8sï¼‰ä¸ºä¾‹ï¼Œç®€å•è®²è®²å®ƒæ˜¯æ€ä¹ˆè§£å†³è¿ç§»éš¾ï¼Œåˆ©ç”¨ç‡ä½ï¼Œå¼¹æ€§å’Œå®¹é”™æ€§éš¾ç”¨è¿™ä¹ˆå‡ ä¸ªå…³é”®ç‚¹çš„ã€‚</p>\n<p>é¦–å…ˆ k8s å®šä¹‰äº† Nodeï¼ˆå°±æ˜¯ä¸€å°æœåŠ¡å™¨ï¼‰ä¸ Podï¼ˆå°±æ˜¯ä¸€ä¸ªæœåŠ¡çš„å‰¯æœ¬ï¼‰è¿™ä¸¤ç§èµ„æºï¼ŒPod å¯ä»¥ç”³è¯· CPUï¼Œå†…å­˜ç­‰è®¡ç®—èµ„æºï¼Œk8s ä¼šæ ¹æ®ç”³è¯·çš„ CPU å’Œå†…å­˜å°† Pod æŒ‰ç…§ä¸€å®šç­–ç•¥è°ƒåº¦åˆ°æŸä¸€ä¸ª Nodeã€‚æˆ‘ä»¬å¯ä»¥è°ƒæ•´è¿™å…¶ä¸­çš„ç­–ç•¥æ¥ä½¿å¾— Node å¯ä»¥æ‰¿è½½æ›´å¤šçš„ Podï¼Œä»¥æé«˜æœåŠ¡å™¨æ•´ä½“çš„ä½¿ç”¨ç‡ã€‚ä¸€èˆ¬ä¸ºäº†é«˜å¯ç”¨æˆ‘ä»¬çš„æœåŠ¡éƒ½æ˜¯ä»¥å¤šå‰¯æœ¬ï¼ˆPodï¼‰éƒ¨ç½²çš„ï¼Œå¯¹å¤–æä¾›ç›¸åŒçš„æœåŠ¡ã€‚åŒä¸€ä¸ªæœåŠ¡çš„ Pod å¯ä»¥æ‰“æ•£éƒ¨ç½²åˆ°ä¸åŒçš„ Node ä¸Šï¼Œè¿™æ ·å°±ç®—ä¸€ä¸ª Node å‡ºç°æ•…éšœæŒ‚æ‰ï¼Œé‚£ä¹Ÿåªæ˜¯è¿™ä¸ª Node ä¸Šçš„ Pod æ— æ³•æä¾›æœåŠ¡ï¼Œå…¶ä»– Node ä¸Šçš„ Pod ä»ç„¶å¯ä»¥å¯¹å¤–æä¾›æœåŠ¡ï¼Œä¸æ­¤åŒæ—¶ k8s è¿˜ä¼šåœ¨å…¶ä»– Node ä¸Šæ‹‰èµ·å› ä¸º Node æ•…éšœè€ŒæŒ‚æ‰çš„ Podã€‚è¿™æ ·é«˜å¯ç”¨å°±èƒ½å¾—åˆ°å¾ˆå¥½çš„ä¿éšœã€‚</p>\n<p>å½“ç„¶ï¼Œæœ€é‡è¦çš„è«è¿‡äºï¼škubernetes æ˜¯å¼€æºçš„ï¼Œä¸å‚å•†æ— å…³ã€‚åªè¦æˆ‘ä»¬çš„æœåŠ¡è¿è¡Œåœ¨ k8s ä¸Šï¼Œç†è®ºä¸Šå°±èƒ½å¤Ÿåœ¨ä¸åŒçš„äº‘å‚å•†ä¹‹é—´è¿›è¡Œè¿ç§»ã€‚ å¯ä»¥è¿™ä¹ˆè¯´ï¼Œåœ¨è¿‡å»åå¹´ï¼Œäº‘åŸç”Ÿå°±æ˜¯è¶ç€å¾®æœåŠ¡çš„ä¸œé£ï¼Œæ‰ä¸€è·ƒæˆä¸ºç‚™æ‰‹å¯çƒ­çš„æŠ€æœ¯ä¹‹ä¸€ã€‚å› æ­¤ï¼Œäº‘åŸç”Ÿå’Œå¾®æœåŠ¡æ˜¯å¯†ä¸å¯åˆ†çš„ã€‚</p>\n<p>å†æ¥å›ç­”åˆ°ä¸Šä¸€å°èŠ‚æœ«çš„é—®é¢˜ï¼Œäº‘åŸç”Ÿæ˜¯æ€ä¹ˆè§£å†³çš„å‘¢-&gt;ç²’åº¦çš„å‡å°ï¼Œå‡å°åˆ°ä»€ä¹ˆç¨‹åº¦å‘¢-&gt;ä¸å¾®æœåŠ¡ä½“ç³»ä¸­çš„æœåŠ¡ç›¸åŒ¹é…ã€‚</p>\n<h1 id=\"äº‘åŸç”Ÿå’Œæˆ‘æœ‰å•¥å…³ç³»\"><a href=\"#äº‘åŸç”Ÿå’Œæˆ‘æœ‰å•¥å…³ç³»\" class=\"headerlink\" title=\"äº‘åŸç”Ÿå’Œæˆ‘æœ‰å•¥å…³ç³»\"></a>äº‘åŸç”Ÿå’Œæˆ‘æœ‰å•¥å…³ç³»</h1><p>å¯èƒ½å†™åˆ°è¿™ä½ è¿˜æ˜¯å¯¹äº‘åŸç”Ÿæœ‰ä¸€äº›ç–‘æƒ‘ï¼Œæœ€å¤§çš„ç–‘æƒ‘å¯èƒ½è«è¿‡äºï¼šå¯¹äºâ€œæˆ‘â€è€Œè¨€ï¼Œäº‘åŸç”Ÿå’Œæˆ‘æœ‰å•¥å…³ç³»ï¼Ÿä¸ºäº†å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥è®©è¿™ä¸ªâ€œæˆ‘â€æ¥æ‰®æ¼”å¤šä¸ªè§’è‰²ã€‚</p>\n<p>å¦‚æœâ€œæˆ‘â€æ˜¯ä¼ä¸šè€æ¿&#x2F;æŠ€æœ¯è´Ÿè´£äººï¼Œé‚£æˆ‘é¦–å…ˆåº”è¯¥æƒ³åˆ°çš„æ˜¯äº‘åŸç”Ÿèƒ½å¤Ÿæä¾›â€œçœ‹å¾—åˆ°â€çš„ä»·å€¼ã€‚é‚£é¦–å½“å…¶å†²çš„å°±æ˜¯ä½¿ç”¨äº‘åŸç”ŸæŠ€æœ¯èƒ½å¤Ÿæœ‰æ•ˆæé«˜æœºå™¨è´Ÿè½½ï¼Œé™ä½æœºå™¨æˆæœ¬ï¼Œè¿™ä¸€å¤©ç„¶çš„ä¼˜åŠ¿ç‰¹åˆ«ç¬¦åˆè¿‘ä¸¤å¹´æ¥çš„â€œé™æœ¬å¢æ•ˆâ€çš„æµªæ½®ã€‚å…¶æ¬¡åŸºäºæœåŠ¡ç²’åº¦çš„å¼¹æ€§å’Œå®¹é”™æ€§ä¹Ÿè¿›ä¸€æ­¥å¢å¼ºäº†æœåŠ¡çš„å¥å£®æ€§ï¼Œå‡å°‘äº†äº‹æ•…çš„å‘ç”Ÿã€‚ä»äººæ•ˆä¸Šçœ‹ï¼ŒåŸºäºäº‘åŸç”Ÿçš„ CI&#x2F;CD æµæå‡äº†æ•æ·å¼€å‘çš„æ•ˆç‡ï¼ŒåŠ å¿«äº†ä¸šåŠ¡è¿­ä»£çš„é€Ÿåº¦ï¼Œä»è€Œæä¾›äº†äººæ•ˆã€‚å› æ­¤äº‘åŸç”Ÿä½œä¸ºåŸºç¡€è®¾æ–½ï¼Œèƒ½äº§ç”Ÿå¾ˆå¤šçœ‹å¾—åˆ°çš„ä»·å€¼ï¼Œè¿™ä¸ä»¥å¾€åŸºç¡€è®¾æ–½å¾ˆéš¾ä½“ç°å‡ºä»·å€¼å½¢æˆäº†é²œæ˜çš„å¯¹æ¯”ã€‚</p>\n<p>å¦‚æœâ€œæˆ‘â€æ˜¯æ™®é€šçš„å¼€å‘è€…ï¼Œé‚£æˆ‘é¦–å…ˆæƒ³åˆ°çš„æ˜¯å…¶æŠ€æœ¯ä»·å€¼ã€‚åœ¨å¸¸è§çš„å¼€å‘è°ƒè¯•-&gt;éƒ¨ç½²ä¸Šçº¿-&gt;çº¿ä¸Šè°ƒæ•´è¿™ä¸ªåº”ç”¨ç”Ÿå‘½å‘¨æœŸä¸­ï¼Œäº‘åŸç”Ÿä¸»è¦æ¶‰åŠåˆ°â€œéƒ¨ç½²ä¸Šçº¿â€œå’Œâ€œçº¿ä¸Šè°ƒæ•´â€è¿™ä¸¤ä¸ªæ­¥éª¤ã€‚åœ¨è§„æ¨¡ç¨å¤§çš„å…¬å¸ä¸­ï¼Œé€šå¸¸ä¼šåˆ†ä¸ºä¸šåŠ¡å¼€å‘å’Œå¹³å°å¼€å‘ï¼Œä¸šåŠ¡å¼€å‘ä¸“æ³¨äºä¸šåŠ¡å¼€å‘ä¸è¿­ä»£ä»¥æ»¡è¶³å®¢æˆ·éœ€æ±‚ï¼Œè€Œå¹³å°å¼€å‘åˆ™ä¸“æ³¨äºå†…éƒ¨ç ”å‘å¹³å°çš„å¼€å‘è¿­ä»£ä»¥æ»¡è¶³ä¸šåŠ¡å¼€å‘çš„éœ€æ±‚ã€‚å› æ­¤éƒ¨ç½²ä¸Šçº¿å’Œçº¿ä¸Šè°ƒæ•´ä¸€èˆ¬éƒ½ä¼šéƒ½ä¼šåˆ’å½’åˆ°å¹³å°ç ”å‘ä¸­ã€‚é‚£æ˜¯ä¸æ˜¯ä¸šåŠ¡å¼€å‘å°±å’Œäº‘åŸç”Ÿæ²¡å…³ç³»äº†ï¼Ÿä»æŸäº›æ„ä¹‰ä¸Šæ˜¯çš„ï¼Œä½†ä»æŠ€æœ¯å‘å±•çš„è§’åº¦çœ‹ï¼Œäº‘åŸç”Ÿä½œä¸ºåŸºç¡€è®¾æ–½å±‚çš„æŠ€æœ¯ï¼Œèåˆäº†å¾ˆå¤šè®¾è®¡è‰ºæœ¯ï¼Œæ¶‰åŠåˆ°å¾ˆå¤šé«˜å¯ç”¨ï¼Œé«˜å¹¶å‘çš„åœºæ™¯è®¾è®¡ã€‚å› æ­¤å½“ä½ å­¦ä¹ äº‘åŸç”Ÿçš„ä¸€äº›æŠ€æœ¯æ—¶ï¼Œä½ ä¼šè‡ªç„¶è€Œç„¶åœ°å°†ä¸€äº›ä¼˜é›…çš„è®¾è®¡ç†Ÿç¨”äºå¿ƒã€‚æ­¤å¤–ï¼Œç†Ÿæ‚‰äº‘åŸç”Ÿçš„å¤§è‡´æ¡†æ¶æœ‰åŠ©äºå¯¹æ•´ä¸ªåº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸæœ‰å®Œæ•´çš„ç†è§£ï¼Œåè¿‡æ¥ä¹Ÿæœ‰åŠ©äºä½ åœ¨å¼€å‘åº”ç”¨æ—¶èƒ½å¤Ÿæ›´å¥½åœ°åˆ©ç”¨åº•å±‚çš„åŸºç¡€èµ„æºã€‚</p>\n<h1 id=\"äº‘åŸç”Ÿçš„æœªæ¥\"><a href=\"#äº‘åŸç”Ÿçš„æœªæ¥\" class=\"headerlink\" title=\"äº‘åŸç”Ÿçš„æœªæ¥\"></a>äº‘åŸç”Ÿçš„æœªæ¥</h1><p>ä¸Šæ–‡ä¸­è¯´é“ï¼Œäº‘åŸç”Ÿä¹˜ç€å¾®æœåŠ¡çš„ä¸œé£ï¼Œåº¦è¿‡äº†â€œé»„é‡‘åå¹´â€œã€‚é‚£åœ¨ä¸‹ä¸€ä¸ªåå¹´ï¼Œäº‘åŸç”Ÿåˆè¯¥ä½•å»ä½•ä»ï¼Ÿ<br>è¦å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆæ¥çœ‹çœ‹äº‘åŸç”Ÿçš„ä¼˜åŠ¿ã€‚å…³äºäº‘åŸç”Ÿçš„ä¼˜åŠ¿ï¼Œä¸Šæ–‡ä¹Ÿæåˆ°äº†ä¸å°‘ï¼Œåœ¨è¿™é‡Œæˆ‘å¯ä»¥æ€»ç»“æˆä¸€å¥è¯ï¼šäº‘åŸç”ŸæŠ€æœ¯èƒ½å¤Ÿä½¿åº”ç”¨æ›´å¥½åœ°åˆ©ç”¨äº‘èµ„æºï¼Œæ›´å¥½åœ°å¯¹å¤–æä¾›æœåŠ¡ã€‚å¯¹è¿™å¥è¯å†è§£è¯»ä¸€ä¸‹ï¼Œæˆ‘ä»¬çš„åº”ç”¨æ˜¯éœ€è¦æ¶ˆè€—äº‘èµ„æºå¹¶å‘å¤–æä¾›æœåŠ¡çš„ï¼Œè€Œäº‘åŸç”ŸæŠ€æœ¯æŠ½è±¡äº†è®¡ç®—èµ„æºï¼Œèƒ½å¤Ÿè®©åº”ç”¨æŒ‰éœ€åœ°ä½¿ç”¨äº‘èµ„æºï¼Œä»è€Œä½¿å¾—åº”ç”¨å¯¹å¤–æä¾›æœåŠ¡è¿™ä¸€è¿‡ç¨‹ä¾¿æ·äº†ä¸å°‘ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä»¥ä¸Šçš„æ€»ç»“ä»¥åŠè§£è¯»ä¸­çš„â€œåº”ç”¨â€œç‰¹æŒ‡æ¶ˆè€— CPUï¼Œå†…å­˜ï¼Œå­˜å‚¨çš„â€œä¼ ç»Ÿåº”ç”¨â€œã€‚é‚£ä¸ä¼ ç»Ÿåº”ç”¨ç›¸å¯¹åº”çš„æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿç­”æ¡ˆå°±æ˜¯ AIã€‚ä»å»å¹´å¤§ç«çš„ ChatGPT åˆ°ä»Šå¹´çš„ç™¾æ¨¡å¤§æˆ˜ï¼ŒAI å‘å±•çš„é€Ÿåº¦è¶…è¿‡äº†ç»å¤§å¤šæ•°äººçš„æƒ³è±¡ã€‚ä¸ä¼ ç»Ÿåº”ç”¨ç›¸æ¯”ï¼ŒAI åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸæ›´é•¿ï¼Œä¸”æ¨¡å‹çš„è®­ç»ƒï¼Œå¾®è°ƒï¼Œæ¨ç†éƒ½ç¦»ä¸å¼€å½“ä»Šæ—¶ä»£çš„â€œé»„é‡‘â€œâ€”â€”GPUï¼Œè€Œäº‘åŸç”Ÿé¢†åŸŸçš„æŠ€æœ¯å¯¹ AI çš„æ”¯æŒè¿˜è¿œæ²¡æœ‰ä¼ ç»Ÿåº”ç”¨çš„å®Œå–„ã€‚è¯¸å¦‚ mlopsï¼ŒGPU çš„è°ƒåº¦åˆ†é…ï¼Œåˆ†å¸ƒå¼è®­ç»ƒç­‰éšç€ AI å‘å±•è€Œæ¶Œç°çš„ topic ä¼šè¶Šæ¥è¶Šå¤šï¼Œç›¸ä¿¡äº‘åŸç”Ÿ+äººå·¥æ™ºèƒ½çš„è„šæ­¥ä¹Ÿä¼šè¶Šæ¥è¶Šå¿«ã€‚</p>\n<p>è‡³æ­¤ï¼Œäº‘åŸç”Ÿçš„æœªæ¥ä¹Ÿå¾ˆç¡®å®šäº†ï¼ŒCNAIï¼ˆCloud Native Artificial Intelligenceï¼‰å°†ä¼šæˆä¸ºäº‘åŸç”Ÿä¸‹ä¸€ä¸ªåå¹´çš„ä¸»èˆªé“ã€‚</p>\n<p><img src=\"https://image.robocanic.com/notes/image.png\" alt=\"CNAI\"></p>\n<p>å†™åœ¨æœ€åï¼š</p>\n<p>æƒ³äº†å¾ˆä¹…ç¬¬ä¸€ç¯‡åšå®¢è¦å†™äº›ä»€ä¹ˆï¼Œå‰å‰ååæƒ³äº†ä¸€å‘¨ï¼Œæœ€åè¿˜æ˜¯æ•²å®šäº†ä¸€ä¸ªæ¯”è¾ƒå¤§çš„ titleï¼Œå¸Œæœ›å¯¹ä½ æœ‰æ‰€å¸®åŠ©ã€‚æ–‡ç« å†…å®¹å¦‚æœ‰é”™è¯¯ï¼Œè¯·è€å¸ˆä»¬è¯„è®ºåŒºå‹˜è¯¯ ğŸ˜ğŸ˜ã€‚åç»­å°†ä¼šæŒç»­æ›´æ–°äº‘åŸç”Ÿï¼ŒLLM ç­‰é¢†åŸŸçš„å†…å®¹ã€‚</p>\n"},{"title":"Pythonå·¥ç¨‹åŒ–ä¸å®Œå…¨æŒ‡å—","date":"2024-07-06T13:37:12.000Z","_content":"\nPython ä½œä¸ºä¸€ä¸ªå¼±ç±»å‹è¯­è¨€ï¼Œä¼¼ä¹ä»è¯ç”Ÿä¹‹åˆå°±è¢«å¾ˆå¤šäººè§‰å¾—è¿™æ˜¯ä¸€ä¸ªå¾ˆéšä¾¿çš„è¯­è¨€ï¼Œæ„å»ºä¸€ä¸ªå¯é çš„ Python é¡¹ç›®æ˜¯ä¸€ä¸ªå¾ˆéš¾çš„äº‹æƒ…ã€‚äº‹å®ä¹Ÿç¡®å®å¦‚æ­¤ï¼Œéšç€ AI çš„çˆ†å‘ï¼Œå…¥å‘ Python çš„äººè¶Šæ¥è¶Šå¤šï¼Œä½†å¯¹ Python çš„è¯Ÿç—…å´åªå¢ä¸å‡ã€‚ä¸è¿‡ï¼ŒPython å·¥ç¨‹åŒ–è¿˜æ˜¯åœ¨è¯Ÿç—…ä¸­æ›²æŠ˜å‰è¿›çš„ï¼Œåˆ°ä»Šå¤©ä¸ºæ­¢ï¼Œå°½ç®¡è¿˜å­˜åœ¨ç€ä¸€äº›æ··ä¹±ï¼ŒPython å·¥ç¨‹åŒ–çš„æ ‡å‡†è¶‹äºåŸºæœ¬å®Œå–„ã€‚æœ¬ç¯‡å°†ä»â€œè¿‡æ¥äººâ€çš„è§†è§’ï¼Œç”±æµ…å…¥æ·±åœ°è®²è¿° python å·¥ç¨‹åŒ–çš„æ–¹æ–¹é¢é¢ï¼Œæä¾›ä¸€ä¸ªæœ€ä½³å®è·µä¾›ä½ å‚è€ƒã€‚\n\n# é¡¹ç›®ç›®å½•ç»“æ„\n\nPython ä½œä¸ºè„šæœ¬è¯­è¨€ï¼Œä¸€ä¸ª.py æ–‡ä»¶èƒ½æ”¾åœ¨ä»»ä½•åœ°æ–¹è¿è¡Œï¼Œä½†æ˜¯**ä¸€ä¸ªæ¸…æ™°çš„ç›®å½•ç»“æ„ä¸ä»…æ˜“äºæ’æŸ¥é—®é¢˜ï¼Œæ›´æ–¹ä¾¿åˆ«äººè¯»æ‡‚æˆ‘ä»¬çš„ä»£ç ï¼Œæ›´åŠ ä¼˜é›…**ã€‚Python ç”±äºå…¶åº”ç”¨å¹¿æ³›ï¼Œä¸åŒç±»å‹çš„ Python é¡¹ç›®ä¹Ÿæœ‰ç€ä¸åŒçš„ç›®å½•ç»“æ„è§„çº¦ã€‚è¿™é‡Œæˆ‘é€‰å–æ™®é€šåº”ç”¨å·¥ç¨‹å’Œæ•°æ®/AI å·¥ç¨‹è¿™ä¸¤ç§æœ€ä¸ºå¹¿æ³›çš„ç±»å‹è¿›è¡Œè¯´æ˜ã€‚\n\n## æ™®é€šåº”ç”¨å·¥ç¨‹\n\nå‡å®šæˆ‘ä»¬çš„é¡¹ç›®åä¸º`robocanic-project`ï¼Œæ™®é€šåº”ç”¨å·¥ç¨‹æœ€å¸¸ç”¨çš„ç›®å½•ç»“æ„é£æ ¼å¦‚ä¸‹æ‰€ç¤ºï¼š\n\n```Plain Text\nÂ robocanic-project/\nÂ â”‚\nÂ â”œâ”€â”€ robocanic_project/ Â  Â   # ä¸»åŒ…ï¼Œæˆ‘ä»¬çš„æ ¸å¿ƒä»£ç éƒ½åœ¨è¿™é‡Œé¢\nÂ â”‚ Â  â”œâ”€â”€ __init__.py Â  Â  Â  Â  # åŒ…åˆå§‹åŒ–æ–‡ä»¶\nÂ â”‚ Â  â”œâ”€â”€ module1.py Â  Â  Â  Â   # æ¨¡å—1\nÂ â”‚ Â  â”œâ”€â”€ module2.py Â  Â  Â  Â   # æ¨¡å—2\nÂ â”‚ Â  â””â”€â”€ main.py Â  Â  Â  Â      # ä¸»ç¨‹åºå…¥å£\nÂ â”‚\nÂ â”œâ”€â”€ tests/ Â  Â  Â  Â  Â  Â  Â  Â   # æµ‹è¯•ç›®å½•\nÂ â”‚ Â  â”œâ”€â”€ __init__.py\nÂ â”‚ Â  â”œâ”€â”€ test_module1.py\nÂ â”‚ Â  â””â”€â”€ test_module2.py\nÂ â”‚\nÂ â”œâ”€â”€ requirements.txt Â  Â  Â   # ä¾èµ–æ–‡ä»¶\nÂ â”œâ”€â”€ setup.py Â  Â  Â  Â  Â  Â  Â   # å®‰è£…è„šæœ¬\nÂ â”œâ”€â”€ README.md Â  Â  Â  Â  Â  Â  Â  # é¡¹ç›®è¯´æ˜\nÂ â””â”€â”€ .gitignore Â  Â  Â  Â  Â  Â   # Gitå¿½ç•¥æ–‡ä»¶\n```\n\né‚£ä¸Šé¢è¿™ç§è¿˜æ¯”è¾ƒå®½æ³›ï¼Œå¦‚æœä»¥å‰åç«¯åˆ†ç¦»çš„åç«¯ Web åº”ç”¨è¿™ç§æ¯”è¾ƒå¸¸è§çš„é¡¹ç›®ä¸ºä¾‹ï¼Œç›®å½•ç»“æ„å¯ä»¥æ˜¯ä¸‹é¢è¿™æ ·çš„ï¼š\n\n```Plain Text\nrobocanic-project/\nâ”œâ”€â”€ robocanic_project/                     # ä¸»åº”ç”¨ç¨‹åºç›®å½•\nâ”‚   â”œâ”€â”€ __init__.py          # å°†è¯¥ç›®å½•æ ‡è¯†ä¸ºåŒ…ï¼Œé€šå¸¸åˆå§‹åŒ– FastAPI å®ä¾‹\nâ”‚   â”œâ”€â”€ main.py              # ä¸»æ–‡ä»¶ï¼ŒåŒ…å«åº”ç”¨å®ä¾‹å’Œè·¯ç”±\nâ”‚   â”œâ”€â”€ api/                 # API è·¯ç”±ç›®å½•\nâ”‚   â”‚   â”œâ”€â”€ __init__.py\nâ”‚   â”‚   â”œâ”€â”€ v1/              # API çš„ v1 ç‰ˆæœ¬ï¼ˆå¯é€‰åˆ†ç‰ˆæœ¬ç›®å½•ï¼‰\nâ”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py\nâ”‚   â”‚   â”‚   â”œâ”€â”€ routes/   # å…·ä½“çš„ API ç«¯ç‚¹\nâ”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py\nâ”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ user.py  # ç”¨æˆ·ç›¸å…³çš„ API è·¯ç”±\nâ”‚   â”‚   â”‚   â”‚   â””â”€â”€ item.py  # å…¶ä»–æ¨¡å—ï¼ˆå¦‚å•†å“ï¼‰çš„ API è·¯ç”±\nâ”‚   â”‚   â”‚   â””â”€â”€ ...          # æ›´å¤š API è·¯ç”±\nâ”‚   â”œâ”€â”€ core/                # æ ¸å¿ƒé…ç½®æ¨¡å—\nâ”‚   â”‚   â”œâ”€â”€ __init__.py\nâ”‚   â”‚   â”œâ”€â”€ config.py        # é…ç½®æ–‡ä»¶ï¼ŒåŒ…å«æ•°æ®åº“è¿æ¥ã€ç¬¬ä¸‰æ–¹æœåŠ¡é…ç½®ç­‰\nâ”‚   â”‚   â”œâ”€â”€ security.py      # å®‰å…¨ç›¸å…³çš„è®¾ç½®ï¼Œä¾‹å¦‚ OAuth2ã€JWT\nâ”‚   â”œâ”€â”€ models/              # æ•°æ®åº“æ¨¡å‹\nâ”‚   â”‚   â”œâ”€â”€ __init__.py\nâ”‚   â”‚   â””â”€â”€ user.py          # ç”¨æˆ·æ¨¡å‹\nâ”‚   â”‚   â””â”€â”€ item.py          # å…¶ä»–æ•°æ®æ¨¡å‹\nâ”‚   â”œâ”€â”€ crud/                # å¢åˆ æ”¹æŸ¥æ“ä½œçš„å°è£…\nâ”‚   â”‚   â”œâ”€â”€ __init__.py\nâ”‚   â”‚   â”œâ”€â”€ user.py          # ç”¨æˆ·çš„ CRUD æ“ä½œ\nâ”‚   â”‚   â””â”€â”€ item.py          # å…¶ä»–æ•°æ®çš„ CRUD æ“ä½œ\nâ”‚   â”œâ”€â”€ db/                  # æ•°æ®åº“åˆå§‹åŒ–åŠè¿æ¥\nâ”‚   â”‚   â”œâ”€â”€ __init__.py\nâ”‚   â”‚   â”œâ”€â”€ base.py          # åŸºç¡€çš„æ•°æ®åº“æ¨¡å‹\nâ”‚   â”‚   â””â”€â”€ session.py       # æ•°æ®åº“ä¼šè¯ï¼ˆSQLAlchemy ä¼šè¯ï¼‰\nâ”‚   â”œâ”€â”€ tests/               # æµ‹è¯•ç›®å½•\nâ”‚   â”‚   â”œâ”€â”€ __init__.py\nâ”‚   â”‚   â””â”€â”€ test_user.py     # ç”¨æˆ·ç›¸å…³çš„æµ‹è¯•æ–‡ä»¶\nâ”‚   â”‚   â””â”€â”€ test_item.py     # å…¶ä»–æ¨¡å—çš„æµ‹è¯•æ–‡ä»¶\nâ”‚   â”œâ”€â”€ utils/               # å·¥å…·å‡½æ•°ç›®å½•\nâ”‚   â”‚   â”œâ”€â”€ __init__.py\nâ”‚   â”‚   â””â”€â”€ hashing.py       # ç”¨äºå¯†ç åŠ å¯†/è§£å¯†ç­‰å®ç”¨å·¥å…·\n    â”œâ”€â”€ alembic/             # æ•°æ®åº“è¿ç§»å·¥å…· Alembic ç›¸å…³æ–‡ä»¶ï¼ˆå¦‚æœä½¿ç”¨ï¼‰\nâ”‚   â”‚   â”œâ”€â”€ versions/        # æ¯ä¸ªè¿ç§»æ–‡ä»¶éƒ½ä¿å­˜åœ¨è¿™ä¸ªç›®å½•ä¸­\nâ”‚   â”‚   â”œâ”€â”€ env.py           # Alembic ç¯å¢ƒé…ç½®æ–‡ä»¶\nâ”‚   â”‚   â”œâ”€â”€ README           # Alembic è¯´æ˜\nâ”‚   â”‚   â””â”€â”€ script.py.mako   # Alembic è„šæœ¬æ¨¡æ¿\nâ”‚   â””â”€â”€ ...\nâ”œâ”€â”€ .env                     # ç¯å¢ƒå˜é‡æ–‡ä»¶ï¼ˆæ•æ„Ÿä¿¡æ¯ï¼Œä¸åº”æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶ï¼‰\nâ”œâ”€â”€ .gitignore               # Git å¿½ç•¥æ–‡ä»¶åˆ—è¡¨\nâ”œâ”€â”€ requirements.txt         # ä¾èµ–åŒ…åˆ—è¡¨ï¼ˆå¦‚æœä½¿ç”¨ pipï¼‰\nâ”œâ”€â”€ setup.py Â  Â  Â  Â  Â  Â  Â    # å®‰è£…è„šæœ¬ï¼ˆå¦‚æœä½¿ç”¨setuptoolsï¼‰\nâ”œâ”€â”€ pyproject.toml           # é¡¹ç›®å…ƒæ•°æ®åŠä¾èµ–ç®¡ç†ï¼ˆå¦‚æœä½¿ç”¨ poetryï¼‰\nâ”œâ”€â”€ README.md                # é¡¹ç›®è¯´æ˜æ–‡ä»¶\nâ””â”€â”€ Dockerfile               # Docker é…ç½®æ–‡ä»¶ï¼ˆå¦‚æœä½¿ç”¨å®¹å™¨åŒ–ï¼‰\n```\n\nä¸€ä¸ªä»¥ FastAPI ä¸ºåŸºç¡€ Web æ¡†æ¶çš„é¡¹ç›®çš„ç›®å½•ç»“æ„å¦‚ä¸Šæ‰€ç¤ºã€‚å…¶ä¸­ï¼Œé™¤äº†`api`ï¼Œ`models`ï¼Œ`crud`ï¼Œ`utils`è¿™ç±»è§åçŸ¥æ„çš„ç›®å½•ï¼Œè¿˜æœ‰ä¸€ä¸ªä¸å¤ªå¸¸è§çš„`alembic`è¿™ä¸ªç›®å½•ï¼Œalembic å…¶å®æ˜¯æ•°æ®åº“è¿ç§»ï¼ˆ**Database Migration**ï¼‰çš„å·¥å…·ã€‚è€Œæ•°æ®åº“è¿ç§»å°±æ˜¯æŒ‡åœ¨æˆ‘ä»¬çš„åº”ç”¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå½“æ¶‰åŠåˆ°éœ€è¦ä¿®æ”¹ ORM å¯¹åº”çš„æ•°æ®åº“ç»“æ„ï¼ˆä¾‹å¦‚è¡¨ã€å­—æ®µã€ç´¢å¼•ç­‰ï¼‰æ—¶ï¼Œå¼•å…¥çš„ä¸€å¥—é€æ­¥æ¼”è¿›æ•°æ®åº“çš„çŠ¶æ€ï¼Œä½¿å…¶ä¸åº”ç”¨ä»£ç ä¿æŒä¸€è‡´çš„å·¥å…·ã€‚è¿™å¥—å·¥å…·ä¸€èˆ¬æ˜¯åŠè‡ªåŠ¨æˆ–è€…å…¨è‡ªåŠ¨çš„ï¼Œå¯ä»¥å¤§å¤§é™ä½æ‰‹åŠ¨æ“ä½œæ•°æ®åº“å¸¦æ¥çš„é£é™©ã€‚\n\n## æ•°æ®/AI å·¥ç¨‹\n\nè€Œå¯¹äºæ•°æ®ç§‘å­¦ï¼Œæ¨¡å‹è®­ç»ƒï¼Œç§‘å­¦è®¡ç®—è¿™ç±»é¡¹ç›®ï¼Œåˆ™æœ‰ç€å¦ä¸€å¥—å®Œå…¨ä¸ä¸€æ ·çš„ç›®å½•é£æ ¼ï¼š\n\n```Plain Text\nrobocanic-project/\nâ”œâ”€â”€ data/\nâ”œâ”€â”€ notebooks/\nâ”œâ”€â”€ scripts/\nâ”œâ”€â”€ requirements.txt\nâ””â”€â”€ README.md\n\n```\n\nä»¥ä¸Šæ˜¯æ¯”è¾ƒç®€ç•¥çš„ç›®å½•ç»“æ„ï¼Œå±•å¼€æ¥çœ‹ï¼š\n\n```Plain Text\nrobocanic-project/\nâ”œâ”€â”€ data/\nâ”‚   â”œâ”€â”€ raw/                  # åŸå§‹æ•°æ®ï¼ˆæœªå¤„ç†çš„æ•°æ®ï¼‰\nâ”‚   â”œâ”€â”€ processed/            # å¤„ç†åçš„æ•°æ®ï¼ˆæ¸…æ´—åçš„æ•°æ®ã€ç‰¹å¾å·¥ç¨‹åçš„æ•°æ®ï¼‰\nâ”‚   â””â”€â”€ external/             # å¤–éƒ¨æ•°æ®æºï¼ˆå¯èƒ½æ˜¯APIæˆ–ç¬¬ä¸‰æ–¹æä¾›çš„æ•°æ®ï¼‰\nâ”‚\nâ”œâ”€â”€ notebooks/                # Jupyter Notebooksï¼ˆæ¢ç´¢æ€§åˆ†æå’Œåˆæ­¥æ¨¡å‹ï¼‰\nâ”‚   â”œâ”€â”€ 01_data_exploration.ipynb  # æ•°æ®æ¢ç´¢\nâ”‚   â”œâ”€â”€ 02_data_cleaning.ipynb     # æ•°æ®æ¸…ç†\nâ”‚   â””â”€â”€ 03_model_training.ipynb    # æ¨¡å‹è®­ç»ƒ\nâ”‚\nâ”œâ”€â”€ scripts/                  # æ•°æ®å¤„ç†å’Œæ¨¡å‹è®­ç»ƒçš„Pythonè„šæœ¬\nâ”‚   â”œâ”€â”€ data_preprocessing.py  # æ•°æ®é¢„å¤„ç†è„šæœ¬\nâ”‚   â”œâ”€â”€ train_model.py         # æ¨¡å‹è®­ç»ƒè„šæœ¬\nâ”‚   â””â”€â”€ evaluate_model.py      # æ¨¡å‹è¯„ä¼°è„šæœ¬\nâ”‚\nâ”œâ”€â”€ models/                   # ä¿å­˜çš„æ¨¡å‹ï¼ˆè®­ç»ƒå¥½çš„æ¨¡å‹ã€æ ‡è®°åŒ–æ–‡ä»¶ç­‰ï¼‰\nâ”‚   â””â”€â”€ model_v1.pkl           # ä¿å­˜çš„æ¨¡å‹æ–‡ä»¶\nâ”‚\nâ”œâ”€â”€ reports/                  # é¡¹ç›®æŠ¥å‘Šä¸ç»“æœå±•ç¤º\nâ”‚   â”œâ”€â”€ figures/              # å›¾è¡¨å’Œå¯è§†åŒ–ç»“æœ\nâ”‚   â””â”€â”€ final_report.pdf      # æœ€ç»ˆæŠ¥å‘Šæˆ–ç»“æœæ€»ç»“\nâ”‚\nâ”œâ”€â”€ requirements.txt          # é¡¹ç›®æ‰€éœ€çš„ä¾èµ–åº“åˆ—è¡¨\nâ”œâ”€â”€ environment.yml           # Conda ç¯å¢ƒé…ç½®æ–‡ä»¶\nâ”œâ”€â”€ README.md                 # é¡¹ç›®è¯´æ˜æ–‡ä»¶\nâ””â”€â”€ .gitignore                # Gitå¿½ç•¥æ–‡ä»¶\n\n```\n\nå¯ä»¥çœ‹å‡ºæ•°æ®/AI é¡¹ç›®å’Œæ™®é€šçš„åº”ç”¨è¿˜æ˜¯æœ‰å¾ˆå¤§åŒºåˆ«çš„ã€‚**æ•°æ®/AI é¡¹ç›®æ›´å¤šæ˜¯ä»æ•°æ®çš„æµå‘æ¥è¿›è¡Œç›®å½•ç»“æ„çš„åˆ’åˆ†ï¼Œä»æ•°æ®é‡‡é›† â†’ æ•°æ®å¤„ç† â†’ æ¨¡å‹è®­ç»ƒï¼ˆæ•°æ®èšåˆï¼‰â†’ æ¨¡å‹è¯„ä¼°ï¼ˆæ•°æ®è¯„ä¼°ï¼‰â†’...... è€Œæ™®é€šåº”ç”¨é¡¹ç›®åˆ™æ›´å¤šæ˜¯æŒ‰åŠŸèƒ½æ¨¡å—æ¥åˆ’åˆ†ï¼Œæ¯”å¦‚ MVC çš„åˆ’åˆ†æ¨¡å¼ï¼Œä»¥ APP ä¸ºæ ¸å¿ƒçš„åˆ’åˆ†æ¨¡å‹ç­‰ã€‚**\n\næ€»çš„æ¥è¯´ï¼ŒPython å·¥ç¨‹çš„ç›®å½•è¿˜æ˜¯æ¯”è¾ƒçµæ´»çš„ï¼Œæˆ‘ä»¬åœ¨æ„å»ºæˆ‘ä»¬è‡ªå·±çš„é¡¹ç›®ç›®å½•æ—¶å¯ä»¥ä¸æ‹˜æ³¥äºå›ºå®šçš„ç›®å½•ç»“æ„ï¼Œä½†ä¹Ÿè¦éµå¾ªä¸Šé¢æåˆ°çš„ä¸€äº›åŸºæœ¬è§„å¾‹ï¼Œè¿™æ ·åˆ«äººä¸Šæ‰‹æˆ‘ä»¬çš„é¡¹ç›®æ—¶èƒ½å¤Ÿå¿«é€Ÿè¯»æ‡‚æˆ‘ä»¬çš„é¡¹ç›®ç»“æ„ï¼Œè¿›è€Œè¯»æ‡‚ä»£ç ã€‚\n\n# é¡¹ç›®ç¯å¢ƒä¸ä¾èµ–ç®¡ç†\n\næ¥ä¸‹æ¥è¦è°ˆåˆ°çš„éƒ¨åˆ†ä¸ªäººè®¤ä¸ºæ˜¯ python ä¸­æœ€æ··ä¹±çš„éƒ¨åˆ†â€”â€”ä¾èµ–ç®¡ç†ã€‚ä½†æ˜¯è®² Python çš„ä¾èµ–ç®¡ç†ä¸èƒ½åªè®²ä¾èµ–ç®¡ç†ï¼Œè¿˜è¦è¿å¸¦ç€**è™šæ‹Ÿç¯å¢ƒ(Virtual Environment)**ä¸€èµ·è®²ã€‚\n\nä¸åŒäº Javaï¼ŒGo è¿™ç±»ä¾èµ–è·Ÿç€é¡¹ç›®èµ°çš„åšæ³•ï¼ŒPython é¡¹ç›®çš„ä¾èµ–æ˜¯å¯¹äºå½“å‰è™šæ‹Ÿç¯å¢ƒè€Œè¨€çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ä½ åœ¨å‘½ä»¤è¡Œä¸­æ•²ä¸‹`pip install fastapi`å»ä¸‹è½½ fastapi è¿™ä¸ªåŒ…æ—¶ï¼Œè¿™ä¸ªä¾èµ–æ˜¯å¯¹å½“å‰ç¯å¢ƒæœ‰æ•ˆçš„ï¼Œå¦‚æœé¡¹ç›® A å’Œé¡¹ç›® B éƒ½ä½¿ç”¨äº†è™šæ‹Ÿç¯å¢ƒ Eï¼Œé‚£é¡¹ç›® A å’Œé¡¹ç›® B éƒ½å¯ä»¥ä½¿ç”¨`fastapi`è¿™ä¸ªä¾èµ–ï¼Œå¦‚æœæœ‰å¤šä¸ªé¡¹ç›®éƒ½éœ€è¦ä¾èµ–`fastapi`ï¼Œé‚£æ˜¯ä¸æ˜¯æŠŠä»–ä»¬æ”¾åˆ°ä¸€ä¸ªè™šæ‹ŸåŒ–ç¯å¢ƒé‡Œå°±è¡Œï¼Ÿç­”æ¡ˆæ˜¯å¦å®šçš„ï¼Œå› ä¸ºä¸€èˆ¬æ¥è¯´ï¼Œä¸€ä¸ªé¡¹ç›®ä¸å•å•åªä¾èµ–ä¸€ä¸ª`fastapi`ï¼Œè¿˜æœ‰å…¶ä»–çš„ä¾èµ–ã€‚æ¯”å¦‚ä¸¤ä¸ªé¡¹ç›® A å’Œ B ä¾èµ–äº†ä¸€ä¸ªå…±åŒçš„åŒ…`pymysql`ï¼Œä½†æ˜¯ä¾èµ–çš„ç‰ˆæœ¬ä¸ä¸€æ ·ï¼Œè¿™æ ·å°±ä¼šå‘ç”Ÿä¾èµ–å†²çªã€‚å› æ­¤æˆ‘ä»¬åœ¨åˆ›å»º Python é¡¹ç›®æ—¶ï¼Œä¸€èˆ¬éƒ½ä¼šåˆ›å»ºä¸€ä¸ªå¯¹åº”çš„è™šæ‹Ÿç¯å¢ƒæ¥é˜²æ­¢ä¾èµ–å†²çªã€‚æ‰€ä»¥åˆ°è¿™ä½ å°±ä¼šå‘ç°è™šæ‹Ÿç¯å¢ƒå…¶å®è¿˜æ˜¯é¡¹ç›®å±‚é¢çš„ï¼Œä¸€ä¸ªé¡¹ç›®å°±å¯¹åº”ä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒï¼Œè™šæ‹Ÿç¯å¢ƒçš„è¿™ä¸ªè®¾è®¡è¯´å®è¯å¾ˆé¸¡è‚‹ï¼Œä¸ä»…ç›¸åŒç‰ˆæœ¬çš„åŒ…ä¸èƒ½å¾—åˆ°å¤ç”¨ï¼Œè¿˜å˜ç›¸åœ°æé«˜äº†ä¾èµ–ç®¡ç†çš„å¤æ‚åº¦ã€‚\n\nåæ§½å®Œä¹‹åï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ç°é˜¶æ®µç¯å¢ƒç®¡ç†ä»¥åŠä¾èµ–ç®¡ç†çš„æœ€ä½³å®è·µã€‚è¿™ä¸ªæœ€ä½³å®è·µåŒ…æ‹¬ä¸æ¨èçš„æ–¹å¼ venv/virtualenv+pipï¼Œä»¥åŠä¸¤ç§æ¨èçš„æ–¹å¼ï¼šconda+pipï¼Œpoetryã€‚\n\n## venv/virtualenv+pipï¼ˆä¸æ¨èï¼‰\n\nvenv å’Œ virtualenv éƒ½æ˜¯ç”¨æ¥åˆ›å»º python è™šæ‹Ÿç¯å¢ƒçš„å·¥å…·ï¼Œä¸åŒçš„åœ°æ–¹åœ¨äº venv æ˜¯ python3.3 åè‡ªå¸¦çš„è½»é‡çº§è™šæ‹Ÿç¯å¢ƒåˆ›å»ºå·¥å…·ï¼Œåªèƒ½ç”¨äº python3ï¼›è€Œ virtualenv åˆ™éœ€è¦å¦å¤–å®‰è£…ï¼Œå¯ä»¥ç”¨äº py2 ä»¥åŠ py3ï¼Œè¿˜æœ‰ä¸€äº› venv æ²¡æœ‰çš„åŠŸèƒ½ï¼ˆä¸ªäººè§‰å¾—å¯æœ‰å¯æ— ï¼‰ã€‚é‚£å¯¹äº python3.3 ä»¥åçš„é¡¹ç›®ï¼Œç°åœ¨éƒ½æ¨èè‡ªå¸¦çš„ venv äº†ã€‚venv ä½¿ç”¨èµ·æ¥ä¹Ÿå¾ˆç®€å•ï¼š\n\n1.  `python -m venv venv`å‘½ä»¤çš„ç¬¬ä¸€ä¸ª venvï¼Œæ˜¯è¿è¡Œ venv è¿™ä¸ªæ¨¡å—æ¥åˆ›å»ºä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒã€‚ç¬¬äºŒä¸ª venv æ˜¯æŒ‡è™šæ‹Ÿç¯å¢ƒçš„æ–‡ä»¶å¤¹çš„åå­—ï¼Œè¿™ä¸ªå¯ä»¥æ ¹æ®éœ€è¦æ¥ä¿®æ”¹ã€‚å‘½ä»¤æ‰§è¡Œåï¼Œä¼šåœ¨å½“å‰æ–‡ä»¶å¤¹ä¸­ï¼Œå»ºç«‹ä¸€ä¸ª venv ç›®å½•ã€‚ åœ¨è¿™ä¸ª venv ç›®å½•ä¸­ï¼Œä¼šé»˜è®¤æ”¾ç½® python.exeã€pip.exe ç­‰ä¸ç³»ç»Ÿç›®å½•éš”ç¦»çš„å¯æ‰§è¡Œæ–‡ä»¶å’Œä¾èµ–ã€‚ä¸€èˆ¬ venv ä¼šæ”¾ç½®åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹ã€‚\n\n2.  è¿›å…¥åˆ°`venv/Scipts`æ–‡ä»¶å¤¹ï¼Œæ‰§è¡Œ`activate`ï¼Œå¯ä»¥æ¿€æ´»å½“å‰çš„è™šæ‹Ÿç¯å¢ƒ; æ‰§è¡Œ`deactivate`ï¼Œå¯ä»¥åœç”¨å½“å‰è™šæ‹Ÿç¯å¢ƒ\n\n3.  åˆ é™¤è¿™ä¸ªè™šæ‹Ÿç¯å¢ƒåªéœ€è¦åˆ é™¤æ‰é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ venv æ–‡ä»¶å¤¹å³å¯ã€‚\n\nvenv æ²¡æœ‰ç®¡ç†è™šæ‹Ÿç¯å¢ƒçš„åŠŸèƒ½ï¼Œè¿™æ˜¯å› ä¸ºè™šæ‹Ÿç¯å¢ƒçš„ä¾èµ–éƒ½è·Ÿç€é¡¹ç›®èµ°äº†ï¼ˆvenv æ–‡ä»¶å¤¹åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼‰ã€‚å› æ­¤å®ƒè¶³å¤Ÿçš„è½»é‡ã€‚\n\npip æ˜¯ä¸€ä¸ªè½»é‡çº§åŒ…ç®¡ç†å·¥å…·ï¼Œå®‰è£… python æ—¶éƒ½ä¼šè‡ªå¸¦ pipã€‚pip æœ€å¸¸ç”¨çš„å‘½ä»¤æœ‰ç”¨äºä¸‹è½½ä¾èµ–çš„`pip install deps`ã€`pip install -r requirements`å’Œç”¨äºåˆ é™¤ä¾èµ–çš„`pip uninstall deps`ã€‚å¾ˆå¤šäººåœ¨ä¸€å¼€å§‹ä½¿ç”¨ pip æ—¶è¿˜è§‰å¾—ç®€å•å¥½ç”¨ï¼Œä½†åœ¨ä½¿ç”¨å¤šäº†ä¹‹åå°±æ·±æ¶ç—›ç»ã€‚pip è®©äººæ·±æ¶ç—›ç»çš„æœ€ä¸»è¦çš„ä¸¤ä¸ªåŸå› å¦‚ä¸‹ï¼š\n\n1. åœ¨å‘½ä»¤è¡Œæ‰§è¡Œå®Œ`pip install deps`åä¸‹è½½çš„ä¾èµ–ä¸ä¼šåŒæ­¥åˆ° requirements.txt ä¸­ï¼ŒåŒæ ·`pip uninstall deps`åˆ é™¤çš„ä¾èµ–ä¹Ÿä¸ä¼šåˆ é™¤ requirements ä¸­å£°æ˜çš„ä¾èµ–ã€‚\n\n2. **`pip uninstall deps`åªä¼šåˆ é™¤`deps`è¿™ä¸ªç›´æ¥ä¾èµ–ï¼Œè€Œä¸ä¼šåˆ é™¤æœ€åˆä¸‹è½½`deps`è¿™ä¸ªåŒ…å¼•å…¥çš„é—´æ¥ä¾èµ–**\n\nå…¶ä¸­ï¼Œç¬¬ä¸€ç‚¹è¿˜å¯ä»¥ä½¿ç”¨`pip freeze > requirements.txt`æ¥å®Œæˆæ‰‹åŠ¨åŒæ­¥ï¼Œç¬¬äºŒç‚¹åˆ™æ˜¯åæ§½æœ€å¤šçš„ç‚¹ã€‚è¿™ä¸¤ç‚¹ç»å¸¸ä¼šå¼•èµ·ä¾èµ–å†²çªï¼Œç”Ÿäº§ç¯å¢ƒä¸æœ¬åœ°å¼€å‘ç¯å¢ƒä¸ä¸€è‡´çš„æƒ…å†µå‡ºç°ã€‚æ‰€ä»¥åœ¨ä½¿ç”¨ venv+pip ç»„åˆæ—¶ï¼Œå¾—éµå¾ªä¸€ä¸ªå¼€å‘èŒƒå¼ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºä»¥ä¸‹å‡ ç‚¹\n\n1. ç›´æ¥ä¾èµ–éœ€è¦å†™å…¥ requirements.txt ä¸­ï¼Œä½¿ç”¨`pip install -r requirements`æ¥ä¸‹è½½ä¾èµ–ï¼Œæ‘ˆå¼ƒ`pip install deps`ï¼Œä¿è¯é¡¹ç›®ä¾èµ–ç›¸å¯¹æ¸…æ™°\n\n2. å‘ç‰ˆæ—¶å¿…é¡»æ‰§è¡Œ`pip freeze > requirements.txt`æ¥ä¿è¯æœ¬åœ°ä¸äº‘ç«¯ç¯å¢ƒä¸€è‡´\n\n## conda+pipï¼ˆæ¨èç”¨äºæ•°æ®/AI é¢†åŸŸï¼‰\n\nconda ä¸ä»…æ˜¯ä¸€ä¸ªåŒ…ç®¡ç†å·¥å…·åº“ï¼Œè¿˜æ˜¯ä¸€ä¸ªç¯å¢ƒç®¡ç†å·¥å…·ï¼Œå¹¿æ³›ç”¨äºç§‘å­¦è®¡ç®—é¢†åŸŸï¼Œconda å‘½ä»¤ä¹Ÿæ¯”è¾ƒç®€å•æ˜“ç”¨ï¼Œä½¿ç”¨ conda çš„åŸºæœ¬æ­¥éª¤å¦‚ä¸‹ï¼š\n\n1. `conda create -n my-ns`åˆ›å»ºä¸€ä¸ªéš”ç¦»çš„è™šæ‹Ÿç¯å¢ƒ\n\n2. `conda activate my-ns`ï¼Œæ¿€æ´»è™šæ‹Ÿç¯å¢ƒ\n\n3. `conda install dps`ä¸‹è½½ä¾èµ–\n\n4. `conda remve deps` å¸è½½ä¾èµ–ï¼Œconda åœ¨å¸è½½ä¾èµ–æ—¶ä¼šæ™ºèƒ½åœ°å¤„ç†åŒ…çš„ä¾èµ–å…³ç³»ï¼Œå°†é—´æ¥ä¾èµ–ä¸­æ— ç”¨çš„åŒ…ä¹Ÿä¼šä¸€å¹¶å¸è½½\n\n5. `conda remove --name my-ns --all`åˆ é™¤è™šæ‹Ÿç¯å¢ƒ\n\nå…¶ä¸­ï¼Œconda åˆ›å»ºçš„è™šæ‹Ÿç¯å¢ƒä¼šç»´æŠ¤ä¸€ä¸ªä¸ç¯å¢ƒååŒåçš„æ–‡ä»¶ç›®å½•ï¼ˆç±»ä¼¼ venvï¼‰ï¼Œä½†è¿™ä¸ªæ–‡ä»¶ç›®å½•ä¼šç»Ÿä¸€æ”¾åœ¨ä¸€ä¸ªåœ°æ–¹ï¼Œä¸ä¼šæ”¾åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼Œè¿™ä¹Ÿè®©å¤šä¸ªä½¿ç”¨ conda çš„é¡¹ç›®â€œæœ‰äº†å…±äº«è™šæ‹Ÿç¯å¢ƒçš„å¯èƒ½â€ã€‚é‚£ conda æ—¢èƒ½ç®¡ç†ç¯å¢ƒï¼Œåˆèƒ½ç®¡ç†ä¾èµ–ï¼Œæ˜¯ä¸æ˜¯å°±èƒ½æ›¿ä»£ pipï¼Ÿå¾ˆé—æ†¾è¿˜æ˜¯ä¸èƒ½ï¼Œä¸»è¦åŸå› æœ‰ä¸¤ç‚¹ï¼š\n\n1. conda ä¸»è¦ç”¨äºæ•°æ®ç§‘å­¦é¢†åŸŸï¼Œæ•´ä¸ªç¯å¢ƒå®‰è£…èµ·æ¥å°±æ¯”è¾ƒé‡ï¼Œç¯å¢ƒåˆå§‹æ—¶å°±è‡ªå¸¦äº†å¾ˆå¤šä¾èµ–ï¼Œå¾ˆå¤šä¾èµ–æ˜¯æ™®é€šé¡¹ç›®ä¸éœ€è¦çš„ã€‚æ­¤å¤–ï¼Œconda ä¸‹è½½ä¾èµ–çš„é€Ÿåº¦ä¹Ÿä¼šæ…¢ä¸€äº›ã€‚\n\n2. conda çš„åŒ…ä¸ pip å®‰è£…çš„åŒ…ä¸ä¸€æ ·ï¼Œconda åŒ…æ˜¯äºŒè¿›åˆ¶æ ¼å¼çš„ï¼Œé™¤äº†æ•°æ®ç§‘å­¦é¢†åŸŸï¼Œå¾ˆå¤š python åº“éƒ½ä¼šåœ¨ PyPI ä¸Šå‘å¸ƒï¼Œä½†ä¸ä¼šåœ¨ Anaconda repository ä¸Šå‘å¸ƒ\n\næ‰€ä»¥ä»¥ä¸Šä¸¤ç‚¹å°±é™åˆ¶äº† conda çš„åº”ç”¨é¢†åŸŸï¼Œé™¤äº†æ•°æ®ç§‘å­¦é¢†åŸŸï¼Œconda å°±åªèƒ½ä½œä¸ºä¸€ä¸ªç¯å¢ƒç®¡ç†çš„å·¥å…·ã€‚é‚£å¯¹äºä½¿ç”¨ conda æ¥ç®¡ç†ç¯å¢ƒçš„æƒ…å†µï¼Œpip ä¸€èˆ¬ä¹Ÿæ˜¯ä¸å¯æˆ–ç¼ºçš„ï¼Œä½¿ç”¨æ—¶çš„æ³¨æ„ç‚¹åŒä¸Šé¢çš„`venv+pip`\n\n## poetryï¼ˆæ¨èï¼‰\n\n> ä»¥ä¸‹ä»£ç åœ°å€: [https://github.com/robocanic/poetry-fastapi-demo.git](https://github.com/robocanic/poetry-fastapi-demo.git)\n\nä¸Šé¢ä¸¤ç§ç¯å¢ƒä¸ä¾èµ–ç®¡ç†çš„æ–¹å¼éƒ½æœ‰ä¸€ä¸ªæ¯”è¾ƒæ£˜æ‰‹çš„ç‚¹æ— æ³•è§£å†³ï¼Œé‚£å°±æ˜¯ pip å¸è½½ä¾èµ–æ—¶æ— æ³•åˆ é™¤å¼•å…¥çš„é—´æ¥ä¾èµ–ï¼Œè¿™å¾ˆå¯èƒ½ä¼šå¯¼è‡´**ä¾èµ–è‡ƒè‚¿ï¼Œä¾èµ–å†²çª**ç­‰é—®é¢˜ã€‚\n\npoetry æ˜¯ä¸€ä¸ª python ä¾èµ–ç®¡ç†ä¸ç¯å¢ƒç®¡ç†çš„å·¥å…·ï¼Œå®ƒèƒ½å¤Ÿåˆ†æå‡ºå“ªäº›æ˜¯ç›´æ¥ä¾èµ–ï¼Œå“ªäº›æ˜¯é—´æ¥ä¾èµ–ï¼Œåœ¨åˆ é™¤ä¾èµ–æ—¶èƒ½å¤Ÿåˆ æ‰æ— ç”¨çš„é—´æ¥ä¾èµ–ï¼Œä¿æŒé¡¹ç›®ä¾èµ–çš„æ¸…çˆ½ã€‚æ­¤å¤–ï¼Œpoetry è¿˜æœ‰æŒ‡å®šæ¨¡ç³Šä¾èµ–ï¼Œä¾èµ–å¿«é€Ÿå‡çº§ç­‰å®ç”¨çš„åŠŸèƒ½ï¼Œè¿™è®©å®ƒåœ¨ä¾èµ–ç®¡ç†æ–¹é¢ç›´æ¥ç”©äº† pip å¥½å‡ æ¡è¡—ã€‚è‡³äºç¯å¢ƒç®¡ç†ï¼Œpoetry åˆ™æ˜¯åœ¨ virtualenv çš„åŸºç¡€ä¸Šï¼Œå¢å¼ºäº†ä¸€äº›åŠŸèƒ½ï¼Œå¦‚è‡ªåŠ¨åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼Œé›†ä¸­/åˆ†ç¦»çš„ç¯å¢ƒç®¡ç†ç­‰ç­‰ã€‚\n\npoetry çš„å‘½ä»¤ä¼šç›¸å¯¹å¤šä¸€äº›ï¼Œä½†å¸¸ç”¨çš„ä¹Ÿåªæœ‰å‡ ä¸ªï¼Œä¸‹é¢ä»å»ºç«‹ä¸€ä¸ªæ–°é¡¹ç›®çš„æµç¨‹æ¥ç†Ÿæ‚‰ä¸€ä¸‹å¦‚ä½•ä½¿ç”¨ poetryï¼š\n\n#### åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ\n\nåœ¨åˆ›å»ºæ–‡ä»¶å¤¹åï¼Œæ‰§è¡Œ`poetry init`ï¼Œä¼šæœ‰ä¸€ç³»åˆ—äº’åŠ¨çš„ command æ¥å¼•å¯¼ä½ åˆ›å»º`pyproject.toml`:\n\n```YAML\nÂ PS D:\\code\\python-projects\\poetry-fastapi-demo>poetry init\nÂ â€‹\nÂ This command will guide you through creating your pyproject.toml config.\nÂ â€‹\nÂ Package name [poetry-fastapi-demo]: Â \nÂ Version [0.1.0]: Â \nÂ Description []:  A web project template using poetry and fastapi.\nÂ Author [robocanic <robocanic@example.com>, n to skip]: Â \nÂ License []:  Apache 2.0\nÂ Compatible Python versions [^3.11]:  ~3.10\nÂ â€‹\nÂ Would you like to define your main dependencies interactively? (yes/no) [yes] no\nÂ Would you like to define your development dependencies interactively? (yes/no) [yes] no\nÂ Generated file\nÂ â€‹\nÂ [tool.poetry]\nÂ name = \"poetry-fastapi-demo\"\nÂ version = \"0.1.0\"\nÂ description = \"A web project template using poetry and fastapi.\"\nÂ authors = [\"robocanic <robocanic@example.com>\"]\nÂ license = \"Apache 2.0\"\nÂ readme = \"README.md\"\nÂ â€‹\nÂ [tool.poetry.dependencies]\nÂ python = \"~3.10\"\nÂ â€‹\nÂ â€‹\nÂ [build-system]\nÂ requires = [\"poetry-core\"]\nÂ build-backend = \"poetry.core.masonry.api\"\nÂ â€‹\nÂ â€‹\nÂ Do you confirm generation? (yes/no) [yes]\n```\n\nè¿™é‡Œä½ åœ¨å‘½ä»¤è¡Œè¾“å…¥çš„åœ¨åé¢éƒ½æ˜¯å¯ä»¥é€šè¿‡ä¿®æ”¹`pyproject.toml`æ¥åŒæ­¥çš„ï¼Œå› æ­¤ä¸€èˆ¬æˆ‘ä»¬éƒ½ä¼šå¿«é€Ÿåœ°è·³è¿‡è¿™ä¸ªé˜¶æ®µã€‚ç”Ÿæˆçš„`pyproject.toml`å¦‚ä¸‹æ‰€ç¤ºï¼š\n\n```YAML\nÂ [tool.poetry] #é¡¹ç›®ä¿¡æ¯\nÂ name = \"poetry-fastapi-demo\"\nÂ version = \"0.1.0\"\nÂ description = \"A web project template using poetry and fastapi.\"\nÂ authors = [\"robocanic <robocanic@example.com>\"]\nÂ license = \"Apache 2.0\"\nÂ readme = \"README.md\"\nÂ â€‹\nÂ [tool.poetry.dependencies] Â #ä¸»è¦ä¾èµ–\nÂ python = \"~3.10\"\nÂ â€‹\nÂ â€‹\nÂ [build-system] Â # æ„å»ºå·¥å…·\nÂ requires = [\"poetry-core\"]\nÂ build-backend = \"poetry.core.masonry.api\"\nÂ â€‹\n```\n\nåœ¨åˆ›å»º`pyproject.toml`åï¼Œåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ‰§è¡Œ`poetry env use python`ï¼Œä¼šåˆ›å»ºä¸€ä¸ªè¯¥é¡¹ç›®ä¸“æœ‰çš„è™šæ‹Ÿç¯å¢ƒï¼š\n\n```YAML\nÂ PS D:\\code\\python-projects\\poetry-fastapi-demo> poetry config virtualenvs.in-project true\nÂ PS D:\\code\\python-projects\\poetry-fastapi-demo> poetry env use D:\\env\\python\\python.exe\nÂ Creating virtualenv poetry-fastapi-demo in D:\\code\\python-projects\\poetry-fastapi-demo\\.venv\nÂ Using virtualenv: D:\\code\\python-projects\\poetry-fastapi-demo\\.venv\n```\n\nè¿™é‡Œæˆ‘æŒ‡å®šäº† poetry è™šæ‹Ÿç¯å¢ƒçš„è·¯å¾„æ”¾ç½®åœ¨é¡¹ç›®æ ¹ç›®å½•çš„.venv ç›®å½•ä¸‹ï¼Œæˆ‘è§‰å¾—è¿™æ ·çš„é¡¹ç›®ç»„ç»‡æ–¹å¼æ›´æ¸…æ™°ã€‚`poetry env use python` è¿™ä¸ªå‘½ä»¤é»˜è®¤ä½¿ç”¨ç³»ç»Ÿç¯å¢ƒå˜é‡ä¸­çš„ pythonï¼Œå¦‚æœä½ æƒ³ä½¿ç”¨æŒ‡å®šç‰ˆæœ¬çš„ pythonï¼Œå¯ä»¥å°† python æ¢æˆ`path/to/your/py`ã€‚\n\n#### æ·»åŠ ä¾èµ–\n\næˆ‘ä»¬å¯ä»¥ç¼–è¾‘`pyproject.toml`ï¼Œæ·»åŠ æŒ‡å®šçš„ä¾èµ–ï¼Œå†å…ˆåæ‰§è¡Œ`poetry lock` å’Œ`poetry install`ï¼Œ`poetry lock`ä¼šè§£æ`pyproject.toml`ä¸­çš„ä¸»è¦ä¾èµ–ä¸å¼€å‘ä¾èµ–ä»¥åŠé—´æ¥ä¾èµ–ï¼Œé€‰æ‹©åˆé€‚çš„ä¾èµ–ç‰ˆæœ¬ï¼Œè®°å½•åˆ° poetry.lock è¿™ä¸ªæ–‡ä»¶ä¸­ã€‚poetry.lock çš„ä½œç”¨ç±»ä¼¼äº requirements.txtï¼Œå³â€œé”å®šâ€é¡¹ç›®éœ€è¦çš„ä¾èµ–ï¼ˆåŒ…æ‹¬ç›´æ¥ä¾èµ–å’Œé—´æ¥ä¾èµ–ï¼‰ç‰ˆæœ¬ã€‚ç´§æ¥ç€çš„`poetry install`å°±ä¼šæ ¹æ® poetry.lock ä¸­çš„å†…å®¹å»ä¸‹è½½ç›¸åº”ç‰ˆæœ¬çš„ä¾èµ–ã€‚\n\n```Toml\n[tool.poetry] # é¡¹ç›®ä¿¡æ¯\nname = \"poetry-fastapi-demo\"\nversion = \"0.1.0\"\ndescription = \"A web project template using poetry and fastapi.\"\nauthors = [\"robocanic <robocanic@example.com>\"]\nlicense = \"Apache 2.0\"\nreadme = \"README.md\"\n\n[tool.poetry.dependencies]  # ä¸»è¦ä¾èµ–\npython = \"~3.10\"        # pythonç‰ˆæœ¬>=3.10 ä¸” <3.20\nfastapi = \"^0.115.0\"    # fastapiç‰ˆæœ¬ >=0.115.0 ä¸” <0.116.0\nsqlalchemy = \"^2.0.36\"  # sqlalchemyç‰ˆæœ¬ >=2.0.36 ä¸” < 3.0\npyyaml = \"^6.0.2\"       # pyyamlç‰ˆæœ¬ >=6.0.2 ä¸” < 7.0.0\n\n[tool.poetry.group.dev.dependencies]  # å¼€å‘ä¾èµ–\npytest = \"^8.3.3\"       # pytestç‰ˆæœ¬ >=8.3.3 ä¸” < 9.0.0\n\n[build-system]  # æ„å»ºå·¥å…·\nrequires = [\"poetry-core\"]\nbuild-backend = \"poetry.core.masonry.api\"\n\n```\n\næˆ‘ä»¬å¯ä»¥æŒ‡å®šä¸»è¦ä¾èµ–å’Œå¼€å‘ä¾èµ–ï¼Œåœ¨å‘å¸ƒéƒ¨ç½²æ—¶åªæ‰“åŒ…ä¸»è¦ä¾èµ–ï¼Œè¿™æ ·å°±å¯ä»¥å‡å°åŒ…çš„ä½“ç§¯ã€‚åŒæ—¶æˆ‘ä»¬å¯ä»¥æŒ‡å®šä¾èµ–çš„ç‰ˆæœ¬èŒƒå›´ï¼Œä¸åŒçš„ç¬¦å·æœ‰ä¸åŒçš„æŒ‡å®šèŒƒå›´ç­–ç•¥ï¼Œè¿™ä¸€å—å¯ä»¥å‚è€ƒ poetry å®˜æ–¹æ–‡æ¡£ï¼š[https://python-poetry.org/docs/dependency-specification/](https://python-poetry.org/docs/dependency-specification/)\n\næ­¤å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨å‘½ä»¤è¡Œ`poetry add deps`æ¥ä¸‹è½½åŒ…ï¼Œè¿™ä¸ªå‘½ä»¤ä¼šè‡ªåŠ¨åœ°æ›´æ–°`pyproject.toml`ä»¥åŠ`poetry.lock`æ–‡ä»¶ï¼Œä¿è¯ç¯å¢ƒä¸­çš„ä¾èµ–ä¸`pyproject.toml`ä¸­çš„çš„ä¾èµ–çš„ä¸€è‡´æ€§ã€‚\n\n#### åˆ é™¤ä¾èµ–\n\næˆ‘ä»¬å¯ä»¥é€šè¿‡ç¼–è¾‘`pyproject.toml`ï¼Œåˆ é™¤å¯¹åº”çš„ä¾èµ–å£°æ˜ï¼Œç„¶åæ‰§è¡Œ`poetry lock` å³å¯ï¼Œpoetry ä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬æŠŠä¾èµ–åˆ é™¤ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨`poetry remove deps`æ¥åˆ é™¤ä¾èµ–ã€‚\n\npoetry çš„è¿™ä¸¤ç§åˆ é™¤æ–¹å¼éƒ½ä¼šè§£æ`deps`çš„æ— ç”¨çš„é—´æ¥ä¾èµ–ï¼Œå°†å…¶ä¸€å¹¶åˆ é™¤ã€‚\n\n#### åˆ é™¤è™šæ‹Ÿç¯å¢ƒ\n\næ‰§è¡Œ`poetry env remove poetry-demo`ï¼Œå³å¯åˆ é™¤è™šæ‹Ÿç¯å¢ƒã€‚\n\n> å¦‚æœåœ¨ poetry çš„é…ç½®ä¸­æŒ‡å®šäº†`poetry config virtualenvs.in-project true`ï¼Œè™šæ‹Ÿç¯å¢ƒç»´æŠ¤çš„ç›®å½•å°±ä¼šæ”¾åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹ã€‚ç±»ä¼¼äº venv çš„æ–¹å¼ï¼Œå› æ­¤è¿™ç§æƒ…å†µä¸‹åˆ é™¤.venv æ–‡ä»¶å¤¹å°±ç­‰åŒäºåˆ é™¤è™šæ‹Ÿç¯å¢ƒ\n\n#### æŸ¥çœ‹ä¾èµ–æ ‘\n\npoetry ä¸­å¾ˆå®ç”¨çš„ä¸€ä¸ªåŠŸèƒ½æ˜¯å®ƒå¯ä»¥ä½¿ç”¨`poetry show --tree`æ¥æŸ¥çœ‹ä¾èµ–å…³ç³»ï¼Œä»è€Œåœ¨ä¾èµ–é”™è¯¯æ—¶èƒ½å¤Ÿæ›´å¥½åœ°å®šä½å¼‚å¸¸ï¼Œæ›´å¿«é€Ÿåœ°è§£å†³é—®é¢˜ã€‚\n\n![poetry-show--tree](https://image.robocanic.com/notes/image-20241104154436296.png)\n\n#### å¯¼å‡ºä¾èµ–\n\nç†è®ºä¸Šæ¥è¯´ï¼Œæœ‰äº† poetry ä¸å†éœ€è¦ pip äº†ï¼Œè‡ªç„¶ä¹Ÿä¸éœ€è¦ requirements.txt äº†ï¼Œä½†æ˜¯åœ¨åé¢çš„é¡¹ç›®å‘å¸ƒç®¡ç†ä¸­æˆ‘ä»¬ä¼šæåˆ°ï¼Œå½“ä½¿ç”¨å®¹å™¨åŒ–éƒ¨ç½²æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›æˆ‘ä»¬çš„é•œåƒå°½å¯èƒ½åœ°ç²¾ç®€ï¼Œæˆ‘ä»¬çš„é¡¹ç›®éƒ¨ç½²èƒ½å°½å¯èƒ½å¿«é€Ÿã€‚ä»ç²¾ç®€é•œåƒè¿™ä¸ªè§’åº¦æ¥çœ‹ï¼Œpoetry å¯¹äºæˆ‘ä»¬çš„é¡¹ç›®è€Œè¨€åªæ˜¯å¼€å‘æ—¶ä¾èµ–ï¼Œåœ¨è¿è¡Œæ—¶æˆ‘ä»¬å¸Œæœ›åªç”¨æœ€ç®€å•çš„ä¾èµ–å°±èƒ½æŠŠé¡¹ç›®è·‘èµ·æ¥ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦å°† poetry.lock ä¸­çš„ä¾èµ–è½¬åŒ–ä¸º requirements.txtï¼Œè¿™æ ·éƒ¨ç½²æ—¶ä½¿ç”¨`pip install -r requirements.txt`ä¸‹å®Œä¾èµ–ä¹‹åç›´æ¥å°±èƒ½ run èµ·æ¥é¡¹ç›®ã€‚\n\npoetry æœ¬èº«ä¹Ÿæ”¯æŒå¯¼å‡ºç¯å¢ƒå†…çš„ä¾èµ–ï¼Œä½¿ç”¨`poetry export -f requirements.txt -o requirements.txt`å°±å¯ä»¥å°†ç¯å¢ƒä¸­çš„æ‰€æœ‰ä¾èµ–å¯¼å‡ºåˆ° requirements.txt ä¸­ã€‚\n\n#### æ€»ç»“\n\npoetry ä½œä¸ºç¯å¢ƒç®¡ç†ä¸ä¾èµ–ç®¡ç†åˆäºŒä¸ºä¸€çš„é“¶å¼¹ï¼Œåœ¨ä½“éªŒä¸‹æ¥ï¼Œé™¤äº†æ•°æ®ç§‘å­¦/AI é¢†åŸŸçš„é¡¹ç›®ï¼Œæˆ‘è®¤ä¸º poetry æ˜¯å¼€å‘å¤§å¤šæ•° python é¡¹ç›®çš„æœ€ä½³ç¯å¢ƒä¸ä¾èµ–çš„ç®¡ç†æ–¹å¼ã€‚\n\n# é¡¹ç›®æ—¥å¿—\n\n> ä»¥ä¸‹ä»£ç åœ°å€: [https://github.com/robocanic/poetry-fastapi-demo.git](https://github.com/robocanic/poetry-fastapi-demo.git)\n\n## ç›®æ ‡\n\næ—¥å¿—çš„é‡è¦æ€§ä¸è¨€è€Œå–»ï¼Œæˆ‘ä»¬è¿™é‡Œæ¢è®¨çš„â€œé¡¹ç›®æ—¥å¿—â€ï¼Œæ›´å‡†ç¡®åœ°æ¥è¯´æ˜¯æ€ä¹ˆä½¿ç”¨æ—¥å¿—èƒ½å¤Ÿå¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„æ•ˆæœã€‚é€šå¸¸ï¼Œæˆ‘ä»¬å¯¹äºæ—¥å¿—ä¼šæœ‰ä¸€äº›è¦æ±‚ï¼š\n\n1. æˆ‘ä»¬å¸Œæœ›æˆ‘ä»¬çš„æ—¥å¿—èƒ½å¤Ÿæ˜¾ç¤ºå‡ºæ—¥å¿—æ—¶é—´ï¼Œæ—¥å¿—ç­‰çº§(INFO, WARN, ERROR .....)ï¼Œæ—¥å¿—å†…å®¹ï¼Œæ‰€åœ¨çº¿ç¨‹ï¼Œæ˜¯ç”±å“ªä¸ªç»„ä»¶/py æ–‡ä»¶æ‰“å°çš„......\n\n2. å¯¹äºä»¥ä¸Šæ—¥å¿—ä¿¡æ¯ï¼Œä¸ç®¡æ˜¯è‡ªå·±é¡¹ç›®ä¸­çš„è¿˜æ˜¯ä¾èµ–åŒ…ä¸­çš„ï¼Œéƒ½æœ‰ä¸€ä¸ªç»Ÿä¸€çš„æ ¼å¼æ‰“å°å‡ºæ¥\n\n3. ä¸ä»…è¦åœ¨æ§åˆ¶å°æ‰“å°ï¼Œè¿˜éœ€è¦ä¿å­˜åˆ°æ–‡ä»¶ä¸­ï¼Œä»¥ä¾¿åç»­æ’æŸ¥é”™è¯¯æ—¶èƒ½å¤Ÿè¿½æº¯ã€‚\n\n4. æ›´è¿›ä¸€æ­¥ï¼Œæˆ‘ä»¬å¸Œæœ› ERROR çº§åˆ«çš„æ—¥å¿—èƒ½å¤Ÿå•ç‹¬æ”¾åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œæ¯å¤©çš„æ—¥å¿—æŒ‰ç…§æ—¥æœŸåšä¸€ä¸ªåˆ‡å‰²åˆ†å—......\n\n## åŸç†\n\nåœ¨é˜æ˜æ—¥å¿—éœ€è¦è¾¾åˆ°çš„æ•ˆæœä¹‹åï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ python ä¸­çš„ logging æ¨¡å—ï¼Œè¿™ä¸ªæ¨¡å—æ˜¯ python è‡ªå¸¦çš„ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆæ¥è¯•ç”¨ä¸€ä¸‹ï¼š\n\n```Python\nimport logging\nlogging.info(\"this is a info log\")\nlogging.warning(\"this is a warning log\")\nlogging.error(\"this is a error log\")\nlogging.critical(\"this is a critical log\")\n\"\"\"\noutput:\nWARNING:root:this is a warning log\nERROR:root:this is a error log\nCRITICAL:root:this is a critical log\n\"\"\"\n```\n\nè¿è¡Œè¿™ä¸ª python æ–‡ä»¶ä¼šå‘ç°æ§åˆ¶å°å¹¶æ²¡æœ‰æ‰“å°å‡º info çº§åˆ«çš„æ—¥å¿—ï¼Œè¿™æ˜¯å› ä¸º logging æ¨¡å—æä¾›çš„æ—¥å¿—è®°å½•å‡½æ•°æ‰€ä½¿ç”¨çš„æ—¥å¿—å™¨è®¾ç½®çš„æ—¥å¿—çº§åˆ«æ˜¯`WARNING`ï¼Œå› æ­¤åªæœ‰`WARNING`çº§åˆ«çš„æ—¥å¿—è®°å½•ä»¥åŠå¤§äºå®ƒçš„`ERROR`å’Œ`CRITICAL`çº§åˆ«çš„æ—¥å¿—è®°å½•è¢«è¾“å‡ºäº†ï¼Œè€Œå°äºå®ƒçš„`INFO`çº§åˆ«çš„æ—¥å¿—è®°å½•è¢«ä¸¢å¼ƒäº†ã€‚\n\næˆ‘ä»¬å¯ä»¥è§‚å¯Ÿæ¯æ¡æ—¥å¿—ï¼Œæ¯ä¸ªæ—¥å¿—éƒ½ç”±ä¸‰éƒ¨åˆ†æ„æˆï¼š`æ—¥å¿—çº§åˆ«:æ—¥å¿—å™¨åç§°:æ—¥å¿—å†…å®¹`ï¼Œè¿™æ˜¯å› ä¸º logging æ¨¡å—æä¾›çš„æ—¥å¿—è®°å½•å‡½æ•°æ‰€ä½¿ç”¨çš„æ—¥å¿—å™¨è®¾ç½®çš„æ—¥å¿—æ ¼å¼é»˜è®¤ä¸º`%(levelname)s:%(name)s:%(message)s`ã€‚\n\né‚£è‡ªç„¶æˆ‘ä»¬ä¼šæƒ³åˆ°ï¼Œå¯ä¸å¯ä»¥é€šè¿‡è®¾ç½® logging çš„æ—¥å¿—çº§åˆ«ä¸æ—¥å¿—æ ¼å¼ï¼Œæ¥ç”Ÿæˆæˆ‘ä»¬æƒ³è¦çš„æ—¥å¿—æ ¼å¼ï¼Ÿè¿›ä¸€æ­¥ï¼Œæˆ‘ä»¬å¯ä¸å¯ä»¥è°ƒæ•´æ—¥å¿—è¾“å‡ºçš„ä½ç½®ï¼ŒåŒæ—¶è¾“å‡ºåœ¨æ§åˆ¶å°å’Œæ–‡ä»¶ï¼Ÿ\n\nåœ¨å›ç­”è¿™ä¸ªé—®é¢˜ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥æ¥å…ˆç®€å•çœ‹ä¸‹ logging æ¨¡å—æ¶‰åŠåˆ°çš„å››ä¸ªç»„ä»¶\n\n1. æ—¥å¿—å™¨ï¼ˆLoggerï¼‰ï¼Œæä¾›äº†æˆ‘ä»¬çš„ä»£ç å¯ä»¥ä½¿ç”¨çš„æ¥å£ï¼Œå³ log.infoï¼Œlog.warningï¼Œlog.error ç­‰\n\n2. å¤„ç†å™¨ï¼ˆHandlerï¼‰ï¼Œå°† logger åˆ›å»ºçš„æ—¥å¿—è®°å½•å‘é€åˆ°åˆé€‚çš„ç›®çš„è¾“å‡º\n\n3. è¿‡æ»¤å™¨ï¼ˆFilterï¼‰ï¼Œæä¾›äº†æ›´ç»†ç²’åº¦çš„æ§åˆ¶å·¥å…·æ¥å†³å®šè¾“å‡ºå“ªæ¡æ—¥å¿—è®°å½•ï¼Œä¸¢å¼ƒå“ªæ¡æ—¥å¿—è®°å½•\n\n4. æ ¼å¼å™¨ï¼ˆFormatterï¼‰ï¼Œå†³å®šæ—¥å¿—è®°å½•çš„è¾“å‡ºæ ¼å¼\n\nè¿™äº›ç»„ä»¶çš„å…³ç³»å¤§è‡´å¦‚ä¸‹ï¼šæ—¥å¿—å™¨ï¼ˆLoggerï¼‰éœ€è¦é€šè¿‡å¤„ç†å™¨ï¼ˆHandlerï¼‰å°†æ—¥å¿—ä¿¡æ¯è¾“å‡ºåˆ°ç›®æ ‡ä½ç½®ï¼ˆæ–‡ä»¶ï¼Œæ§åˆ¶å°ï¼Œç½‘ç»œç­‰ï¼‰ã€‚è€Œå¤„ç†å™¨ï¼ˆHandlerï¼‰å¯ä»¥è®¾ç½®è¿‡æ»¤å™¨ï¼ˆFilterï¼‰å’Œæ ¼å¼å™¨ï¼ˆFormatterï¼‰æ¥å¯¹æ—¥å¿—è¿›è¡Œè¿‡æ»¤å’Œæ ¼å¼åŒ–ï¼Œå†è¾“å‡ºåˆ°æŒ‡å®šçš„ç›®æ ‡ä½ç½®ã€‚\n\nå› æ­¤ä¸Šé¢çš„é—®é¢˜ä¹Ÿæœ‰äº†ç­”æ¡ˆï¼šé€šè¿‡è°ƒæ•´ Loggerï¼ŒHandlerï¼ŒFilterï¼ŒFormatter çš„è®¾ç½®å’Œç»„åˆå…³ç³»ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„æ—¥å¿—ã€‚\n\næˆ‘ä»¬å¯ä»¥é€šè¿‡ 3 ç§æ–¹å¼æ¥é…ç½® loggingï¼š\n\n1. ä½¿ç”¨ Python ä»£ç æ˜¾å¼çš„åˆ›å»º loggerï¼Œhandleï¼Œfilterï¼Œformatter å¹¶åˆ†åˆ«è°ƒç”¨å®ƒä»¬çš„é…ç½®å‡½æ•°\n\n2. åˆ›å»ºä¸€ä¸ªæ—¥å¿—é…ç½®æ–‡ä»¶ï¼Œç„¶åä½¿ç”¨`fileConfig()`å‡½æ•°æ¥è¯»å–è¯¥æ–‡ä»¶çš„å†…å®¹ï¼›\n\n3. åˆ›å»ºä¸€ä¸ªåŒ…å«é…ç½®ä¿¡æ¯çš„ dictï¼Œç„¶åæŠŠå®ƒä¼ é€’ç»™`dictConfig()`å‡½æ•°ï¼›\n\n## å®è·µ\n\nè¿™é‡Œæˆ‘ä»‹ç»ä¸€ä¸‹ç¬¬ä¸‰ç§ï¼Œå…¶ä»–ä¸¤ç§å¯ä»¥è‡ªè¡Œç ”ç©¶ã€‚ç¬¬ä¸‰ç§æˆ‘ä»¬é€šå¸¸ä¼šç”¨ä¸€ä¸ª yaml/json æ–‡ä»¶æ¥æè¿°é…ç½®ï¼Œç„¶åä½¿ç”¨`yaml.load`è¯»å–æ—¥å¿—é…ç½®æ–‡ä»¶ï¼Œè½¬åŒ–æˆ dictï¼Œè¿›è€Œä¼ é€’ç»™`dictConfig()`ï¼Œå®Œæˆ logging çš„é…ç½®ã€‚\n\nyaml å½¢å¼çš„æ—¥å¿—é…ç½®å¦‚ä¸‹ï¼š\n\n```YAML\nversion: 1\nformatters:  # å®šä¹‰æ ¼å¼å™¨\n  default:   # æ ¼å¼å™¨å\n    format: '%(asctime)s - %(name)s - %(levelname)s -%(threadName)s%(thread)d - %(message)s'  # æ—¥å¿—æ ¼å¼ï¼šæ—¶é—´ - æ—¥å¿—å™¨å - æ—¥å¿—ç­‰çº§ - çº¿ç¨‹å çº¿ç¨‹ID - æ—¥å¿—å†…å®¹\n    datefmt: '%Y-%m-%d %H:%M:%S'   # æ—¶é—´æ ¼å¼\n    use_colors: true   # ä½¿ç”¨é¢œè‰²\nhandlers:     # å®šä¹‰å¤„ç†å™¨\n  console:    # å¤„ç†å™¨å\n    class: logging.StreamHandler  # ä½¿ç”¨çš„handler\n    level: INFO    # æ—¥å¿—ç­‰çº§\n    formatter: default  # ä½¿ç”¨çš„formatteråå­—\n    stream: ext://sys.stdout  # è¾“å‡ºåˆ°æ§åˆ¶å°\n  file:\n    class: logging.FileHandler\n    level: INFO\n    formatter: default\n    filename: app.log   # è¾“å‡ºåˆ°app.log\nloggers:         # å®šä¹‰æ—¥å¿—å™¨\n  poetry_fastapi_demo:   # æ—¥å¿—å™¨åç§°\n    level: INFO  # æ—¥å¿—ç­‰çº§\n    handlers:    # ä½¿ç”¨çš„handler\n      - file\n      - console\n    propagate: false   # æ˜¯å¦ä¼ æ’­åˆ°çˆ¶loggerå†å¤„ç†\n  poetry_fastapi_demo.routers:  # poetry_fastapi_demoçš„å­logger\n    level: INFO\n    handlers:\n      - console\n      - file\n    propagate: false   # æ˜¯å¦ä¼ æ’­åˆ°çˆ¶loggerå†å¤„ç†\n  uvicorn:\n    level: INFO\n    handlers:\n      - console\n      - file\n    propagate: false\nroot:            # æ ¹æ—¥å¿—å™¨ï¼Œæ‰€æœ‰æ²¡æœ‰å½’å±çš„æ—¥å¿—éƒ½ä¼šç”±rootæ¥å¤„ç†\n  level: INFO\n  handlers:\n    - console\n    - file\n```\n\nå…¶ä¸­ï¼Œlogger æ˜¯æœ‰å±‚çº§ç»“æ„çš„ï¼Œlogger çš„åç§°æ˜¯ä¸€ä¸ªä»¥'.'åˆ†å‰²çš„ç»“æ„ï¼Œæ¯ä¸ª'.'åé¢çš„ logger éƒ½æ˜¯'.'å‰é¢çš„ logger çš„ childrenã€‚è€Œ root æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ loggerï¼Œå®ƒä¼šæ•æ‰æ²¡æœ‰è¢«å…¶ä»– logger å¤„ç†çš„æ—¥å¿—æ¶ˆæ¯ï¼Œæˆ‘ä»¬ä¾èµ–çš„ä¸‰æ–¹åŒ…æ‰“å°çš„æ—¥å¿—å¤§éƒ¨åˆ†éƒ½ä¼šç”± root logger æ•è·åˆ°è¿›è¡Œå¤„ç†ï¼Œå› æ­¤ root æ˜¯å¾ˆé‡è¦çš„å…œåº• loggerã€‚\n\nåœ¨å®Œå–„å¥½`log.yaml`åï¼Œæˆ‘ä»¬åšä¸€ä¸ªéªŒè¯ï¼Œ`poetry-fastapi-demo`é¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼š\n\n```Plain Text\n poetry-fastapi-demo/\nÂ â”‚\nÂ â”œâ”€â”€ poetry_fastapi_demo/ Â  Â   Â  Â \nÂ â”‚ Â  â”œâ”€â”€ models Â  Â  Â  Â      # æ¨¡å‹\n â”‚   â”‚   â”œâ”€â”€ __init__.py\n |   |   â”œâ”€â”€ user.py\n |   â”œâ”€â”€ routers Â  Â  Â  Â      # è·¯ç”±\n |   |   â”œâ”€â”€ __init__.py\n |   |   â”œâ”€â”€ user.py\n |   â”œâ”€â”€ tables              # å¢åˆ æ”¹æŸ¥\n |   |   â”œâ”€â”€ __init__.py\n |   |   â”œâ”€â”€ user.py\n â”‚ Â  â”œâ”€â”€ __init__.py Â  Â \n â”‚   â””â”€â”€ main.py Â  Â  Â  Â      # ä¸»ç¨‹åºå…¥å£\n```\n\n`poetry_fastapi_demo/__init__.py`çš„å†…å®¹å¦‚ä¸‹ï¼Œè¿™é‡Œæˆ‘ä»¬å°† log.yaml çš„è·¯å¾„ä»¥ç¯å¢ƒå˜é‡ä¼ å…¥ï¼Œç„¶åä½¿ç”¨`.dictConfig`å®Œæˆæ—¥å¿—çš„é…ç½®\n\n```Python\nimport logging.config\nimport os\nimport yaml\n\nlog_conf_path = os.environ.get(\"LOG_CONFIG\")\nwith open(log_conf_path, 'r', encoding='utf-8') as f:\n    dict_conf = yaml.safe_load(f)\nlogging.config.dictConfig(dict_conf)\n\n```\n\n`poetry_fastapi_demo/routers/user.py`çš„å†…å®¹å¦‚ä¸‹\n\n```Python\nimport logging\n\nfrom fastapi import APIRouter\n\nfrom poetry_fastapi_demo.models import User\nfrom poetry_fastapi_demo.tables import user_table\n\nlog = logging.getLogger(__name__)\nrouter = APIRouter()\n\n\n@router.get(\"\")\ndef get_all_users():\n    return user_table.get_all_users()\n\n\n@router.get(\"/{user_id}\")\ndef get_user(user_id: int):\n    return user_table.get_user_by_id(user_id)\n\n\n@router.post(\"\")\ndef create_user(user: User):\n    log.info(f\"Creating user: {user}\")\n    return user_table.add_user(user)\n\n\n@router.delete(\"/{user_id}\")\ndef delete_user(user_id: int):\n    log.warning(f\"Deleting user with id: {user_id}\")\n    return user_table.delete_user(user_id)\n\n\n@router.put(\"\")\ndef update_user(user: User):\n    log.warning(f\"Updating user: {user}\")\n    return user_table.update_user(user)\n\n```\n\nè¿è¡Œ main.pyï¼ˆè®°å¾—è®¾ç½®ç¯å¢ƒå˜é‡ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ§åˆ¶å°ä¸­çœ‹åˆ°æ—¥å¿—è¾“å‡ºï¼ŒåŒæ—¶åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹ä¹Ÿä¼šç”Ÿæˆ app.log æ—¥å¿—æ–‡ä»¶ï¼Œè®°å½•è¿è¡Œçš„æ—¥å¿—ã€‚\n\n![app-log](https://image.robocanic.com/notes/app-log.png)\n\næˆ‘ä»¬å‘èµ·ä¸€ä¸ªæ–°å¢ user çš„è¯·æ±‚ï¼š\n\n```Shell\ncurl --request POST \\\n  --url http://localhost:8080/api/v1/user \\\n  --header 'content-type: application/json' \\\n  --data '{\n  \"id\": 6,\n  \"name\": \"robb\",\n  \"email\": \"robocanic@gmail.com\",\n \"password\": \"xclkjva\",\n  \"role\": \"user\"\n}'\n```\n\næˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ—¥å¿—æ˜¾ç¤ºå¦‚ä¸‹ï¼š\n\n![create-user-log](https://image.robocanic.com/notes/create-user-log.png)\n\nåˆ°è¿™ï¼ŒåŸºæœ¬çš„æ—¥å¿—éœ€æ±‚å°±æ»¡è¶³äº†ï¼Œæˆ‘ä»¬æ— éœ€è°ƒæ•´ä»£ç ï¼Œä»…é€šè¿‡è°ƒæ•´é…ç½®æ–‡ä»¶å°±èƒ½é€‚æ—¶è°ƒæ•´æ—¥å¿—ã€‚é‚£å¯¹äºç›®æ ‡ä¸­çš„ç¬¬ 4 ç‚¹â€œæˆ‘ä»¬å¸Œæœ› ERROR çº§åˆ«çš„æ—¥å¿—èƒ½å¤Ÿå•ç‹¬æ”¾åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œæ¯å¤©çš„æ—¥å¿—æŒ‰ç…§æ—¥æœŸåšä¸€ä¸ªåˆ‡å‰²åˆ†å—â€ï¼Œç›¸ä¿¡ä½ å¯ä»¥ä¸¾ä¸€åä¸‰\n\n# é¡¹ç›®æµ‹è¯•\n\n> ä»¥ä¸‹ä»£ç åœ°å€: [https://github.com/robocanic/poetry-fastapi-demo.git](https://github.com/robocanic/poetry-fastapi-demo.git)\n\nä¸€ä¸ªé¡¹ç›®å¯é çš„é¡¹ç›®ç¦»ä¸å¼€å®Œå¤‡çš„æµ‹è¯•ï¼Œæµ‹è¯•ä¸€èˆ¬åˆ†ä¸ºå•å…ƒæµ‹è¯•å’Œæ¥å£æµ‹è¯•ï¼Œå•æµ‹é’ˆå¯¹æŸä¸ªå‡½æ•°æˆ–è€…æŸä¸ªæ¨¡å—ï¼Œæµ‹è¯•è¿”å›çš„å‚æ•°æ˜¯å¦ç¬¦åˆé¢„æœŸï¼Œè€Œæ¥å£æµ‹è¯•æ˜¯é’ˆå¯¹äº HTTPï¼ˆRPCï¼‰æ¥å£ï¼Œæµ‹è¯•çš„æ˜¯æŸä¸€å—åŠŸèƒ½çš„å®Œå¤‡æ€§ã€‚\n\nè¿™é‡Œæˆ‘ä»¬è®¨è®ºçš„ä»…é™äºå•å…ƒæµ‹è¯•ã€‚åœ¨ python ä¸­ï¼Œå•å…ƒæµ‹è¯•å¯ä»¥ä½¿ç”¨ unittest æ¨¡å—å’Œ pytestï¼Œuninttest æ˜¯ python è‡ªå¸¦çš„æµ‹è¯•æ¨¡å—ï¼Œè€Œ pytest æ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹æ¨¡å—ï¼Œåœ¨å…¼å®¹ unittest çš„åŸºç¡€ä¸Šï¼Œå¢åŠ äº†é›†æˆæµ‹è¯•çš„åŠŸèƒ½ï¼Œæ–¹ä¾¿æˆ‘ä»¬è¿›è¡Œæ‰¹é‡çš„å•å…ƒæµ‹è¯•ï¼Œä¸ CI è¿›è¡Œç»“åˆã€‚å› æ­¤åæ–‡ä¸­ä½¿ç”¨ pytest æ¥è¿›è¡Œè®²è§£ã€‚\n\npytest å¯ä»¥è‡ªåŠ¨é€’å½’æŒ‡å®šè·¯å¾„ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼Œåªè¦ç¬¦åˆ`test_`æˆ–è€…`_test`å¼€å¤´çš„ py æ–‡ä»¶éƒ½ä¼šè¢«è¯†åˆ«ä¸ºæµ‹è¯•ç”¨ä¾‹æ–‡ä»¶ã€‚éƒ½ä¼šåœ¨æµ‹è¯•è®¡åˆ’ä¸­æ‰§è¡Œã€‚\n\n## å®è·µ\n\nåœ¨ä½¿ç”¨ pytest ä¹‹å‰éœ€è¦ä½¿ç”¨ pip æˆ–è€… poetry ä¸‹è½½ï¼Œæˆ‘ä»¬å¯ä»¥å°† pytest ä¸‹è½½åˆ°`dev`åˆ†ç»„çš„ä¾èµ–ï¼Œä¹Ÿå°±æ˜¯å¼€å‘æ—¶ä¾èµ–ï¼ˆå¦‚`poetry add pytest --group dev`ï¼‰ï¼Œä»¥ä¾¿ç”Ÿäº§éƒ¨ç½²æ—¶ç²¾ç®€æ‰å¼€å‘æ—¶ä¾èµ–ã€‚\n\né¡¹ç›®ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š\n\n```Plain Text\n poetry-fastapi-demo/\nÂ â”‚\nÂ â”œâ”€â”€ poetry_fastapi_demo/ Â  # ç¨‹åºä¸»åŒ… Â  Â \nÂ â”‚ Â  â”œâ”€â”€ models/ Â  Â  Â  Â      # æ¨¡å‹\n â”‚   â”‚   â”œâ”€â”€ __init__.py\n |   |   â”œâ”€â”€ user.py\n |   â”œâ”€â”€ routers/ Â  Â  Â  Â      # è·¯ç”±\n |   |   â”œâ”€â”€ __init__.py\n |   |   â”œâ”€â”€ user.py\n |   â”œâ”€â”€ tables/              # å¢åˆ æ”¹æŸ¥\n |   |   â”œâ”€â”€ __init__.py\n |   |   â”œâ”€â”€ user.py\n â”‚ Â  â”œâ”€â”€ __init__.py Â  Â \n â”‚   â””â”€â”€ main.py Â  Â  Â  Â      # ä¸»ç¨‹åºå…¥å£\n â”œâ”€â”€ tests/                  # æµ‹è¯•æ–‡ä»¶\n |   â”œâ”€â”€ test_user_table.py Â  Â # æ¨¡å‹\n ......\n```\n\nå…¶ä¸­ï¼Œ`poetry_fastapi_demo/tables/user.py`å†…å®¹å¦‚ä¸‹ï¼š\n\n```Python\nfrom typing import Optional, List\n\nfrom poetry_fastapi_demo.models import User\n\nuser_list = [\n    User(\n        id=1,\n        name=\"Chris\",\n        email=\"chris@gmail.com\",\n        password=\"pso3sd5xv\",\n        role=\"admin\"\n    ),\n    User(\n        id=2,\n        name=\"Jon\",\n        email=\"jon@gmail.com\",\n        password=\"rthdfwe5sdf\",\n        role=\"user\"\n    ),\n    User(\n        id=3,\n        name=\"Arya\",\n        email=\"arya@gmail.com\",\n        password=\"ndddrwe42\",\n        role=\"user\"\n    )\n\n]\n\n\nclass UserTable:\n\n    def get_all_users(self) -> List[User]:\n        return user_list\n\n    def get_user_by_id(self, user_id: int) -> Optional[User]:\n        for user in user_list:\n            if user.id == user_id:\n                return user\n        return None\n\n    def update_user(self, user: User) -> bool:\n        for u in user_list:\n            if u.id == user.id:\n                u.name = user.name\n                u.email = user.email\n                u.password = user.password\n                u.role = user.role\n                return True\n        return False\n\n    def delete_user(self, user_id: int) -> bool:\n        for i, u in enumerate(user_list):\n            if u.id == user_id:\n                del user_list[i]\n                return True\n        return False\n\n    def add_user(self, user: User) -> bool:\n        for u in user_list:\n            if u.id == user.id:\n                return False\n        user_list.append(user)\n        return True\n\n\nuser_table = UserTable()\n\n```\n\næµ‹è¯•æ¡ˆä¾‹`test_user_table.py`å†…å®¹å¦‚ä¸‹ï¼š\n\n```Python\nfrom poetry_fastapi_demo.models import User\nfrom poetry_fastapi_demo.tables import user_table\n\n\nclass TestUserTable:\n\n    def test_get_all(self):\n        user_table.get_all_users()\n\n    def test_get_by_id(self):\n        user = user_table.get_user_by_id(1)\n        assert user.name == \"Chris\"\n\n    def test_update_user(self):\n        user = user_table.get_user_by_id(1)\n        user.name = \"Chris2\"\n        assert user_table.update_user(user) is True\n        assert user_table.get_user_by_id(1).name == \"Chris\"   # æ•…æ„å†™é”™\n\n    def test_delete_user(self):\n        assert user_table.delete_user(1) is True\n        assert user_table.get_user_by_id(1) is None\n\n    def test_add_user(self):\n        result = user_table.add_user(User(\n            id=4,\n            name=\"robb\",\n            email=\"robb@gmail.com\",\n            password=\"loqjwnd[as;\",\n            role=\"admin\"\n        ))\n        assert result is True\n        assert user_table.get_user_by_id(4).name == \"robb\"\n\n\n\n```\n\nç„¶åæˆ‘ä»¬åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ`pytest tests/ -v`ï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š\n\n![py-test](https://image.robocanic.com/notes/py-test.png)\n\npytest ä¼šé€’å½’åœ°åœ¨ tests æ–‡ä»¶å¤¹ä¸‹å¯»æ‰¾ä»¥`test_`æˆ–`_test`å¼€å¤´çš„ py æ–‡ä»¶ï¼Œåœ¨ py æ–‡ä»¶ä¸­ï¼Œä¼šå¯»æ‰¾ä»¥`test_`æˆ–`_test`å¼€å¤´çš„å‡½æ•°æˆ–è€…ç±»ï¼Œå¯¹äºæˆ‘ä»¬è¿™ä¸ªæ¡ˆä¾‹æ¥è¯´ï¼Œä¸€å…±æœ‰ 5 ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œåœ¨è¾“å‡ºä¸­æˆ‘ä»¬ä¹Ÿèƒ½è¯¦ç»†åœ°æŸ¥çœ‹åˆ°é€šè¿‡å’Œå¤±è´¥çš„å…·ä½“ç”¨ä¾‹ï¼Œé”™è¯¯çš„åŸå› ï¼Œæ‰§è¡Œçš„æ—¶é—´ç­‰ç­‰ã€‚æ­¤å¤–ï¼Œpytest è¿˜æœ‰å…¶ä»–çš„åŠŸèƒ½ï¼ˆå¯å‚è€ƒ[https://learning-pytest.readthedocs.io/zh/latest/index.html](https://learning-pytest.readthedocs.io/zh/latest/index.html)ï¼‰ï¼Œå¦‚æµ‹è¯•å‰å’Œæµ‹è¯•åçš„é¢„å¤„ç†å’Œåå¤„ç†ï¼Œä½¿ç”¨æ’ä»¶ç”Ÿæˆæµ‹è¯•æŠ¥å‘Šç­‰ï¼Œè¿™é‡Œå°±ç®—æŠ›ç –å¼•ç‰ç»™å¤§å®¶ã€‚\n\n## CI é›†æˆ\n\næŒ‰ç…§å¼€å‘æµç¨‹æ¥è¯´ï¼Œæˆ‘ä»¬åœ¨æœ¬åœ°å¼€å‘å¹¶å•æµ‹å®Œåï¼Œä¼šå‘å¸ƒåˆ°æµ‹è¯•ç¯å¢ƒä¸­è¿›è¡Œè¿›ä¸€æ­¥åœ°è°ƒè¯•éªŒè¯ã€‚æœ‰æ—¶å€™æˆ‘ä»¬ä¿®æ”¹å®Œä»£ç åå¿˜è®°æ‰§è¡Œå¯¹åº”çš„å•æµ‹å°±æäº¤äº†ï¼Œç„¶ååœ¨è°ƒè¯•ä¸­æ‰å‘ç°äº†é”™è¯¯ï¼Œç„¶ååˆå›ç‚‰é‡é€ ã€‚ä¸ºäº†å°½é‡å‡å°‘ä¿®æ”¹å°é”™è¯¯åå¤å‘å¸ƒçš„æ—¶é—´ï¼Œæˆ‘ä»¬å¯ä»¥å°†è‡ªåŠ¨åŒ–æµ‹è¯•é›†æˆåˆ° gitlab pipelineï¼ˆä½¿ç”¨å‚è€ƒ[https://docs.gitlab.com/ee/ci/pipelines/](https://docs.gitlab.com/ee/ci/pipelines/)ï¼‰æˆ– github actions(ä½¿ç”¨å‚è€ƒ[https://docs.github.com/zh/actions](https://docs.github.com/zh/actions))ã€‚\n\n#### github actions\n\n```YAML\nname: Python ci           # workflowåå­—\n\non:                            # è§¦å‘æ¡ä»¶ï¼Œpushæˆ–mergeåˆ°devä¸­è§¦å‘\n  push:\n    branches: [ \"dev\" ]\n  pull_request:\n    branches: [ \"dev\" ]\n\njobs:\n  build:\n    runs-on: ubuntu-latest    # è·‘åœ¨ubuntuè™šæ‹Ÿæœºä¸Š\n    strategy:                 # æ‰§è¡Œç­–ç•¥\n      fail-fast: false\n      matrix:\n        python-version: [\"3.10\"]\n\n    steps:                    # æ‰§è¡Œæ­¥éª¤\n    - uses: actions/checkout@v4    # ä½¿ç”¨checkoutè¿™ä¸ªå·²æœ‰çš„actionæ¥åˆå§‹åŒ–gitç¯å¢ƒ\n    - name: Set up Python ${{ matrix.python-version }}   # ä½¿ç”¨setup-pythonæ¥åˆå§‹åŒ–pythonç¯å¢ƒ\n      uses: actions/setup-python@v3\n      with:\n        python-version: ${{ matrix.python-version }}     # æŒ‡å®špythonç‰ˆæœ¬\n    - name: Set up Poetry                 # ä½¿ç”¨setup-poetryè¿™ä¸ªå·²æœ‰çš„actionæ¥åˆå§‹åŒ–poetry\n      uses: Gr1N/setup-poetry@v9\n    - name: Install dependencies         # ä½¿ç”¨poetryä¸‹è½½ä¾èµ–ï¼Œå› ä¸ºæ˜¯åœ¨ä¸€ä¸ªå•ç‹¬çš„è™šæ‹Ÿæœº/å®¹å™¨ä¸­ï¼Œæ‰€ä»¥æ— éœ€åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ\n      run: |\n        poetry config virtualenvs.create false\n        poetry lock\n        poetry install --all-extras\n    - name: Test with pytest            # ä½¿ç”¨pytestæ‰§è¡Œé›†æˆæµ‹è¯•\n      env:\n        LOG_CONFIG: ./log.yaml\n      run: |\n        pytest tests/ -v\n```\n\næˆ‘ä»¬æŠŠä¸Šé¢è¿™ä¸ª yml å‘½åä¸º ci.ymlï¼Œå¹¶æ”¾ç½®åœ¨é¡¹ç›®æ ¹ç›®å½•.github/workflows ç›®å½•ä¸‹ï¼Œç„¶å github ä¼šè‡ªåŠ¨æ£€æµ‹åˆ° workflow çš„å­˜åœ¨å¹¶æŒ‰ç…§ yml ä¸­å®šä¹‰çš„æ­¥éª¤ä¾æ¬¡æ‰§è¡Œã€‚ç„¶åæˆ‘ä»¬åœ¨ dev åˆ†æ”¯ push åˆ°è¿œç¨‹ï¼Œç„¶åæˆ‘ä»¬ä¼šåœ¨ actions ä¸­å‘ç°å†å²æ‰§è¡Œ/æ­£åœ¨æ‰§è¡Œçš„ workflowã€‚\n\n![github-action](https://image.robocanic.com/notes/github-action.png)\n\næˆ‘ä»¬ç‚¹è¿›æŸä¸€ä¸ª workflow å¯ä»¥çœ‹åˆ° job çš„æ‰§è¡Œç»“æœæ˜¯æˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼š\n\n![github-workflow-job](https://image.robocanic.com/notes/github-workflow-job.png)\n\nè¿›ä¸€æ­¥ï¼Œæˆ‘ä»¬è¿›å…¥ build è¿™ä¸ª jobï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°é›†æˆæµ‹è¯•çš„ä¿¡æ¯ï¼š\n\n![job-test](https://image.robocanic.com/notes/job-test.png)\n\næ­¤å¤–ï¼Œgithub actions è¿˜å¯ä»¥æ¢ç´¢æ›´å¤šçš„ç©æ³•ï¼Œæ¯”å¦‚ï¼šå½“ job å¤±è´¥äº†å‘é€é‚®ä»¶åˆ°è‡ªå·±çš„é‚®ç®±æç¤ºæµæ°´çº¿å¤±è´¥äº†ï¼Œå½“ job å¤±è´¥äº†å›æ»šåˆ°ä¸Šä¸€ä¸ª commit çš„çŠ¶æ€ç­‰ç­‰ï¼Œè¿™äº›å°±éƒ½ç•™ç»™ä½ å»æ¢ç´¢äº†\n\n#### gitlab pipeline\n\n```YAML\nstages:\n  - automatic_test_dev\n\nautomatic_test_job_dev:   # æˆ‘ä»¬åªåœ¨æµ‹è¯•ç¯å¢ƒæ‰§è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œç”Ÿäº§ç¯å¢ƒä¸ºäº†åŠ å¿«å‘å¸ƒé€Ÿåº¦ï¼Œä¸æ‰§è¡Œæµ‹è¯•\n  image: sunpeek/poetry:py3.10-slim    # ä½¿ç”¨å¸¦poetryçš„pythoné•œåƒ\n  stage: automatic_test_dev\n  only:\n    - dev                 # åªæœ‰devåˆ†æ”¯å‘ç”Ÿå˜åŒ–ï¼ˆmergeæˆ–pushï¼‰æ—¶è§¦å‘\n  tags:                   # åŒ¹é…pythonæ ‡ç­¾çš„runneræ‰è¿è¡Œ\n    - python\n  script:                 # æ‰§è¡Œè„šæœ¬\n    - poetry config virtualenvs.create false  # åœ¨å®¹å™¨ä¸­ï¼Œä¸ç”¨åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ\n    - poetry lock     # é”å®šä¾èµ–ç‰ˆæœ¬\n    - poetry install  # ä¸‹è½½ä¾èµ–\n    - pytest tests/   # æ‰§è¡Œæµ‹è¯•\n```\n\næˆ‘ä»¬å°†è¿™ä¸ª yml æ–‡ä»¶å‘½åä¸º.gitlab-ci.ymlï¼Œç„¶å push åˆ° dev åˆ†æ”¯ï¼Œå°±ä¼šè§¦å‘ pipelineã€‚gitlab pipeline æœ¬è´¨ä¸Šå’Œ github actions æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯å£°æ˜å¼çš„æµæ°´çº¿ï¼Œå› æ­¤è¿™é‡Œå°±ä¸å†èµ˜è¿°ï¼Œä½ å¯ä»¥æŸ¥é˜…å®˜æ–¹æ–‡æ¡£ï¼ˆ[https://docs.gitlab.com/ee/ci/pipelines/](https://docs.gitlab.com/ee/ci/pipelines/)ï¼‰æ¥ç»„åˆå‡ºä½ çš„ pipelineã€‚\n\n# é¡¹ç›®å‘å¸ƒç®¡ç†\n\nå½“æˆ‘ä»¬é¡¹ç›®åœ¨æœ¬åœ°è¿è¡Œ okï¼Œæµ‹è¯•ä¹Ÿ ok åï¼Œè¯¥è€ƒè™‘å‘å¸ƒåˆ°å„ä¸ªç¯å¢ƒï¼ˆè”è°ƒï¼Œæµ‹è¯•ï¼Œç”Ÿäº§ç­‰ï¼‰ã€‚è¿™ä¸ªè¿‡ç¨‹æ ¹æ®é¡¹ç›®çš„å±æ€§åˆ†ä¸ºä¸¤ç±»ï¼Œä¸€ç±»æ˜¯äºŒæ–¹åŒ…çš„å‘å¸ƒï¼Œå¦ä¸€ç±»åˆ™æ˜¯æ­£ç»åº”ç”¨å‘å¸ƒã€‚\n\nåœ¨è°ˆè¿™ä¸¤ç±»å‘å¸ƒä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥ç¡®è®¤å‘å¸ƒè¿‡ç¨‹ä¸­æˆ‘ä»¬æƒ³è¦è¾¾åˆ°çš„ç›®æ ‡ï¼ˆè¦æ±‚ï¼‰ï¼š\n\n1. å¯¹äºäºŒæ–¹åŒ…å‘å¸ƒï¼Œæˆ‘ä»¬å¸Œæœ›å®ƒåœ¨æœ¬åœ°å°±èƒ½å¤Ÿå‘å¸ƒ beta ç‰ˆæœ¬ï¼Œä»¥ä¾¿äºå¿«é€ŸéªŒè¯ã€‚æ­¤å¤–ï¼Œæ­£å¼ç‰ˆæœ¬çš„å‘å¸ƒï¼Œæˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿé›†æˆåˆ° CI ä¸­ã€‚\n\n2. å¯¹äºåº”ç”¨å‘å¸ƒï¼Œæˆ‘ä»¬å¸Œæœ›å®ƒå‘å¸ƒæ—¶è¶³å¤Ÿè¿…é€Ÿï¼Œä»¥ä¾¿åœ¨å‡ºç°é—®é¢˜æ—¶å¿«é€Ÿæ¨é€è¡¥ä¸è§£å†³é—®é¢˜ã€‚\n\n3. æ— è®ºæ˜¯äºŒæ–¹åŒ…è¿˜æ˜¯åº”ç”¨å‘å¸ƒï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨å‘å¸ƒçš„æ—¶å€™è‡ªåŠ¨æ‰§è¡Œé›†æˆæµ‹è¯•ï¼ˆç”Ÿäº§é™¤å¤–ï¼‰ï¼Œç”Ÿæˆä¸€ä»½æµ‹è¯•æŠ¥å‘Šã€‚\n\n## äºŒæ–¹åŒ…å‘å¸ƒ\n\näºŒæ–¹åŒ…çš„å‘å¸ƒæ ¹æ®æˆ‘ä»¬ä½¿ç”¨çš„é¡¹ç›®ç¯å¢ƒå’Œä¾èµ–ç®¡ç†å·¥å…·å¯ä»¥åˆ’åˆ†ä¸ºä¸¤ç±»ï¼Œç¬¬ä¸€ç±»æ˜¯ä½¿ç”¨ conda+pip æˆ–è€… venv+pip åçš„å‘å¸ƒæµç¨‹ï¼Œå¦ä¸€ç±»æ˜¯ä½¿ç”¨ poetry åçš„å‘å¸ƒæµç¨‹ã€‚\n\n### setuptools+twine\n\nå‘å¸ƒåˆ†ä¸ºæ‰“åŒ…å’Œæ¨é€ä¸¤ä¸ªæ­¥éª¤ï¼Œsetuptools è´Ÿè´£å°†æˆ‘ä»¬çš„ python ä»£ç æ‰“åŒ…ï¼Œè€Œ twine åˆ™è´Ÿè´£å°†æ‰“åŒ…åçš„ pkg æ¨é€åˆ° PyPI ä»“åº“ã€‚\n\nsetuptools æ˜¯å¾ˆå¤šå¹´æ¥ python æ‰“åŒ…çš„é¦–é€‰å·¥å…·ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦æ‰§è¡Œ`pip install setuptools`æ¥ä¸‹è½½è¿™ä¸ªå·¥å…·ã€‚ç„¶ååœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª`setup.py`æ–‡ä»¶æ¥å†™æ‰“åŒ…æ—¶çš„é…ç½®ï¼Œä¸€ä¸ª setup.py å¦‚ä¸‹æ‰€ç¤ºï¼š\n\n```Python\nfrom setuptools import setup, find_packages\n\nwith open(\"README.md\", \"r\", encoding=\"UTF-8\") as fh:\n    long_description = fh.read()\nversion= os.environ.get(\"GITHUB_REF_NAME\", \"0.0.1b0\") # åŒ…çš„ç‰ˆæœ¬ï¼ŒGITHUB_REF_NAMEæ˜¯github tag nameçš„ç¯å¢ƒå˜é‡ï¼Œä»£è¡¨ä»£ç åˆ†æ”¯TAGï¼›0.0.1b0 æ˜¯0.0.1-BETA0çš„ç¼©å†™\nsetup(\n    name='poetry_fastapi_demo',  # åŒ…å\n    version=version,     # æ„å»ºç‰ˆæœ¬\n    author='robocanic',  # ä½œè€…\n    author_email='robocanic@gmail.com',\n    description='A web project template using poetry and fastapi.',   # æè¿°\n    long_description=long_description,  # é•¿çš„æè¿°\n    long_description_content_type=\"text/markdown\",\n    url='https://github.com/robocanic/poetry-fastapi-demo',\n    packages=find_packages(),  # æ‰“åŒ…æ‰€æœ‰åŒ…ç›®å½•\n    classifiers=[\n        \"Development Status :: 2 - Beta\"    # å¼€å‘é˜¶æ®µ\n        \"Programming Language :: Python :: 3.10\",   # ä½¿ç”¨çš„è¯­è¨€\n        \"Operating System:: OS Independent\",   # ä¸é™å®šOS\n    ],\n    install_requires=[     # è¯¥é¡¹ç›®çš„ä¾èµ–ï¼Œåˆ«äººä¸‹è½½æˆ‘ä»¬çš„åŒ…æ—¶ä¼šè‡ªåŠ¨ä¸‹è½½è¿™äº›ä¾èµ–\n        \"fastapi==0.115.0\",\n        \"sqlalchemy==2.0.36\",\n        \"pyyaml==6.0.2\",\n        \"uvicorn=0.32.0\"\n    ],\n    python_requires='>=3.10'    # pythonè¦æ±‚\n)\n\n```\n\n`setup.py`ä½¿ç”¨ä»£ç çš„æ–¹å¼å£°æ˜äº†æˆ‘ä»¬æ‰“åŒ…çš„é…ç½®ï¼ŒåŒ…æ‹¬æ„å»ºç‰ˆæœ¬ï¼Œç›´æ¥ä¾èµ–ï¼Œpython ç‰ˆæœ¬è¦æ±‚ç­‰ç­‰ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬åªéœ€è¦æ‰§è¡Œ`python setup.py sdist`å°±èƒ½å°†é¡¹ç›®æ‰“åŒ…æˆ.tar.gz æ–‡ä»¶ï¼Œå½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥æŒ‡å®šæ‰“åŒ…æ ¼å¼ä¸º`bdist_wheel`ï¼Œæ‰“åŒ…æˆ.wheel æ–‡ä»¶ã€‚æ‰“åŒ…åçš„æ–‡ä»¶é»˜è®¤æ”¾åœ¨ dist ç›®å½•ä¸‹ã€‚\n\næ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦ä½¿ç”¨ twine ä¸Šä¼ åˆ° PyPI ä»“åº“ï¼Œtwine ä¹Ÿæ˜¯ä¸€ä¸ª python åŒ…ï¼Œåœ¨ä½¿ç”¨ä¹‹å‰éœ€è¦é€šè¿‡`pip install twine`ä¸‹è½½ã€‚ç„¶åæ‰§è¡Œ`twine upload dist/*`å°±ä¸Šä¼ åˆ°äº†ä»“åº“ã€‚\n\n> å¦‚æœè¦ä¸Šä¼ åˆ°ç§æœ‰çš„ PyPI ä»“åº“ï¼Œåˆ™éœ€è¦é…ç½®ä¸Šä¼ çš„ç”¨æˆ·åå’Œå¯†ç ï¼ŒåŒæ—¶åœ¨ä¸Šä¼ æ—¶éœ€è¦æŒ‡å®šç§æœ‰ä»“åº“ã€‚æœ€ä¾¿æ·çš„æ–¹æ³•æ˜¯åœ¨ root ç›®å½•ä¸‹æ–°å¢ä¸€ä¸ª.pypirc æ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹ä¸ºï¼š\n\n    [distutils]\n\n\n    index-servers = private-pypi\n\n    [nexus]\n\nrepository=https://private-pypi.com/simple/\nusername=foo\npassword=bar\nç„¶åä½¿ç”¨`twine upload -r private-pypi dist/*` æ¥ä¸Šä¼ åˆ°æŒ‡å®šçš„ç§æœ‰ä»“åº“\n\n### poetry\n\nå¦‚æœä½ ä½¿ç”¨äº† poetryï¼Œé‚£ poetry å°±è‡ªå¸¦äº†æ‰“åŒ…å’Œä¸Šä¼ çš„åŠŸèƒ½ã€‚poetry æ‰“åŒ…éå¸¸ç®€å•ï¼Œåªéœ€è¦æ‰§è¡Œ`poetry build`ï¼Œå®ƒå°±ä¼šå‚ç…§`pyproject.toml`ä¸­çš„é…ç½®è¿›è¡Œæ‰“åŒ…ã€‚æ‰“åŒ…ç”Ÿæˆçš„æ–‡ä»¶é»˜è®¤ä¹Ÿä¼šæ”¾åœ¨ dist ç›®å½•ä¸‹ã€‚\n\nç„¶åæˆ‘ä»¬æ‰§è¡Œ`poetry publish`å°±å¯ä»¥å‘å¸ƒåˆ° PyPI ä»“åº“\n\n> åŒæ ·ï¼Œè‹¥è¦ä½¿ç”¨ poetry ä¸Šä¼ åˆ°ç§æœ‰çš„ PyPI ä»“åº“ã€‚ä¹Ÿéœ€è¦é¢å¤–çš„é…ç½®ï¼š\n> `poetry config repositories.foo-pub [https://pypi.example.org/legacy/](https://pypi.example.org/legacy/)` > `poetry config http-basic.foo-pub <username> <password>` > `poetry publish --repository foo-pub`\n\n### CI é›†æˆ\n\nå¾ˆå¤šæ—¶å€™æˆ‘ä»¬å‘ç°äº†ç‰¹å®šç‰ˆæœ¬åŒ…çš„ä¸€äº›é—®é¢˜ï¼Œæˆ‘ä»¬æƒ³è¦è¿™ä¸ªç‰¹å®šç‰ˆæœ¬çš„åŒ…å¯¹åº”çš„æºä»£ç ï¼Œå¹¶åœ¨æ­¤åŸºç¡€ä¸ŠåŠ ä¸€ä¸ªè¡¥ä¸ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦å°†æˆ‘ä»¬åŒ…çš„ç‰ˆæœ¬å’Œæˆ‘ä»¬ä»£ç çš„ç‰¹å®šåˆ†æ”¯ä¸€ä¸€å¯¹åº”ã€‚é€šè¿‡äººå·¥å®Œæˆè¿™ä¸ªè¿‡ç¨‹æ˜¯å¯è¡Œçš„ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨æ¯æ¬¡æ‰“åŒ…å‰/å åŠ ä¸€ä¸ª commitï¼Œæ¨åˆ°è¿œç¨‹ä»“åº“ï¼Œæ‰“ä¸€ä¸ª tag å°±èƒ½å¯¹åº”èµ·æ¥ã€‚ä½†æ˜¯è¿™ä»¶é‡å¤çš„å·¥ä½œæˆ‘ä»¬æ—¶å¸¸ä¼šå¿˜è®°ï¼Œè¿™ä¸ªé‡å¤çš„å·¥ä½œå¯ä»¥äº¤ç»™ä¸€ä¸ªå•ç‹¬çš„ç¨‹åºæ¥åšå—ï¼Ÿç­”æ¡ˆå½“ç„¶æ˜¯è‚¯å®šçš„ï¼Œæ¯•ç«Ÿç¨‹åºå‘˜æœ€ä¹ æƒ¯çš„äº‹å°±æ˜¯å°†é‡å¤çš„å·¥ä½œç¨‹åºåŒ–ï¼Œå¤æ‚çš„å·¥ä½œæµç¨‹åŒ–ã€‚gitlab pipeline/github actions èƒ½å¤Ÿé€šè¿‡æˆ‘ä»¬å£°æ˜çš„ yml æ–‡ä»¶æ¥å®Œæˆè¿™ä¸ªè¿‡ç¨‹ã€‚\n\n#### gitlab pipeline\n\nä¸€ä¸ªä½¿ç”¨ poetry çš„äºŒæ–¹åŒ…å‘å¸ƒçš„ gitlab pipeline æ–‡ä»¶å¯ä»¥å¦‚ä¸‹ï¼ˆé›†æˆäº†å•æµ‹ï¼‰ï¼š\n\n```YAML\nimage: sunpeek/poetry:py3.10-slim   # éœ€è¦å¸¦æœ‰poetryçš„pythoné•œåƒ\n\nstages:\n  - automatic_test\n  - package_build_push\n\n\nautomatic_test_job:   #\n  stage: automatic_test\n  only:\n    - dev\n  tags:\n    - golang\n  script:\n    - poetry config virtualenvs.create false  # åœ¨å®¹å™¨ä¸­ï¼Œä¸ç”¨åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ\n    - poetry lock     # é”å®šä¾èµ–ç‰ˆæœ¬\n    - poetry install  # ä¸‹è½½ä¾èµ–\n    - pytest tests/   # æ‰§è¡Œæµ‹è¯•\n\n\npackage_build_push_job:\n  stage: package_build_push\n  only:    # è§¦å‘æ¡ä»¶ï¼šåªæœ‰æ‰“tagä¹‹åæ‰ä¼šè§¦å‘è¯¥job\n    - tags\n  script:\n    - poetry config repositories.foo-pub https://pypi.example.org/legacy/   # æ·»åŠ å‘å¸ƒä»“åº“\n    - poetry config http-basic.foo-pub $FOO_USERNAME $FOO_PASSWORD          # æ·»åŠ å‘å¸ƒä»“åº“çš„ç”¨æˆ·åå¯†ç ï¼Œé€šè¿‡æµæ°´çº¿ç¯å¢ƒå˜é‡å¯ä»¥è®¾ç½®\n    - sed -i \"s/^version = \\\".*\\\"/version = \\\"$CI_COMMIT_TAG\\\"/\" pyproject.toml  # ä¿®æ”¹æ„å»ºç‰ˆæœ¬ï¼Œä¸TAGä¸€è‡´\n    - poetry publish --build  --repository foo-pub   # æ‰“åŒ…å¹¶æ¨é€\n```\n\nç®€å•æ¥è¯´ï¼Œgitlab åœ¨æˆ‘ä»¬æ‰“ä¸Šä¸€ä¸ª tag ä¹‹åï¼Œä¼šèµ·ä¸€ä¸ª runner æ‰§è¡Œè¿™ä¸ª yml æ–‡ä»¶çš„ scriptï¼ˆå…·ä½“è¿‡ç¨‹å¯è‡ªè¡Œäº†è§£ï¼‰ã€‚å› æ­¤å½“æˆ‘ä»¬æƒ³è¦å‘å¸ƒä¸€ä¸ªç‰ˆæœ¬æ—¶ï¼Œæ¨åˆ°é•œåƒä»“åº“åï¼Œæ‰“ä¸€ä¸ª tagï¼Œgitlab pipeline å°±ä¼šè¿›è¡Œæ‰“åŒ…ï¼Œæ¨é€ï¼Œå¹¶ä¸”æ¨é€åˆ°ä»“åº“çš„åŒ…çš„ç‰ˆæœ¬å’Œæˆ‘ä»¬çš„ TAG æ˜¯ä¸¥æ ¼å¯¹åº”çš„ã€‚\n\n#### github actions\n\n```YAML\nname: Release package           # workflowåå­—\n\non:                            # è§¦å‘æ¡ä»¶ï¼Œæ–°å»ºtagæ—¶è§¦å‘\n  push:\n    tags:\n      - '*'                  # ä»»æ„æ ‡ç­¾éƒ½ä¼šè§¦å‘å·¥ä½œæµ\n\njobs:\n  pkg:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4    # ä½¿ç”¨checkoutè¿™ä¸ªå·²æœ‰çš„actionæ¥åˆå§‹åŒ–gitç¯å¢ƒ\n      - name: Set up Python ${{ matrix.python-version }}   # ä½¿ç”¨setup-pythonæ¥åˆå§‹åŒ–pythonç¯å¢ƒ\n        uses: actions/setup-python@v3\n        with:\n          python-version: ${{ matrix.python-version }}     # æŒ‡å®špythonç‰ˆæœ¬\n      - name: Set up Poetry                 # ä½¿ç”¨setup-poetryè¿™ä¸ªå·²æœ‰çš„actionæ¥åˆå§‹åŒ–poetry\n        uses: Gr1N/setup-poetry@v9\n      - name: Extract version\n        id: extract_version\n        run: |\n          VERSION=\"${GITHUB_REF#refs/tags/}\"\n          echo \"VERSION=${VERSION}\" >> $GITHUB_ENV\n      - name: Replace version\n        run: |\n          sed -i \"s/^version = \\\".*\\\"/version = \\\"${{ env.VERSION }}\\\"/\" pyproject.toml\n      - name: Build Package        # æ‰“åŒ…\n        run: |\n          poetry config virtualenvs.create false\n          poetry build\n      - name: Publish Package    # å‘å¸ƒ\n        env:\n          PYPI_API_TOKEN: ${{ secrets.PYPI_API_TOKEN }}    # æå‰å®šä¹‰pypiçš„ api token\n        run: |\n          poetry config pypi-token.pypi $PYPI_API_TOKEN\n          poetry publish\n\n\n```\n\n#### æ€»ç»“\n\npoetry ä½œä¸ºé›†ç¯å¢ƒç®¡ç†ï¼Œä¾èµ–ç®¡ç†ï¼Œæ‰“åŒ…å‘å¸ƒä¸€ä½“çš„å·¥å…·ï¼Œè™½ç„¶æœ‰ä¸Šæ‰‹éš¾åº¦ï¼Œä½†ä»é•¿æœŸæ¥çœ‹æ˜¯å€¼å¾—ä½¿ç”¨çš„ï¼Œå¼ºçƒˆæ¨èã€‚gitlab pipeline/github actions çš„ä½¿ç”¨å€’æ˜¯å¯ä»¥çœ‹è‡ªèº«éœ€æ±‚ï¼Œå¦‚æœé¡¹ç›®æ¯”è¾ƒå°ï¼Œå‘å¸ƒæ¬¡æ•°å°‘ï¼Œä¸è¦æ±‚ä»£ç åˆ†æ”¯ä¸åŒ…çš„ç‰ˆæœ¬ä¸¥æ ¼å¯¹åº”ï¼Œæ˜¯å¯ä»¥ä¸ç”¨çš„ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨ gitlab pipeline æ—¶ä¹Ÿå¯ä»¥é€‚å½“æ²¡é‚£ä¹ˆâ€œä¸¥æ ¼â€ï¼Œæ¯”å¦‚ï¼Œä¸ºäº†å›¾æ–¹ä¾¿æˆ‘ä»¬å¯ä»¥åœ¨æœ¬åœ°å‘å¸ƒéæ­£å¼ç‰ˆæœ¬ï¼Œè€Œæ­£å¼ç‰ˆæœ¬åˆ™èµ° pipelineï¼Œä¿è¯æ­£å¼ç‰ˆæœ¬çš„ç¨³å®šã€‚\n\n## åº”ç”¨å‘å¸ƒ\n\nåº”ç”¨å‘å¸ƒå³è®©æˆ‘ä»¬çš„åº”ç”¨è¿è¡Œåœ¨æœºå™¨ä¸Šï¼Œå¯¹å¤–æä¾›æœåŠ¡ã€‚åº”ç”¨çš„è¿è¡Œå½¢æ€å¯ä»¥åŸºæœ¬åˆ†ä¸ºå®¹å™¨/è™šæ‹Ÿæœºï¼Œåæ–‡ä¸­éƒ½åŸºäºä½¿ç”¨æ›´å¹¿æ³›çš„å®¹å™¨æ¥è¿›è¡Œè¯´æ˜ã€‚\n\nåº”ç”¨å‘å¸ƒå¤§ä½“ä¸Šåˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼Œä¸€ä¸ªæ˜¯é•œåƒçš„æ‰“åŒ…ä¸æ¨é€ï¼Œå¦ä¸€ä¸ªæ˜¯é•œåƒæ‹‰å–å’Œå¯åŠ¨å®¹å™¨ã€‚å…¶ä¸­ï¼Œé•œåƒæ¨é€ï¼Œé•œåƒæ‹‰å–å’Œå¯åŠ¨å®¹å™¨å¯¹äºæ¯ä¸€ç§åº”ç”¨ç¨‹åºéƒ½æ˜¯å¤§å·®ä¸å·®çš„ï¼Œè€Œé•œåƒæ‰“åŒ…åˆ™æ˜¯å·®å¼‚æ¯”è¾ƒå¤§çš„ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘å°±é•œåƒæ‰“åŒ…å±•å¼€æ¥è®²ã€‚\n\n### é•œåƒæ‰“åŒ…\n\né•œåƒçš„å¤§å°å…³ä¹åˆ°æ¨é€å’Œæ‹‰å–çš„æ•ˆç‡ï¼Œå› æ­¤æˆ‘ä»¬è¦å°½å¯èƒ½åœ°å‡å°é•œåƒå¤§å°ã€‚python çš„åŸºç¡€é•œåƒä¸­ï¼Œ`slim`ç‰ˆæœ¬çš„åŸºç¡€é•œåƒç§»é™¤äº†ä¸å¿…è¦çš„ç³»ç»Ÿä¸ªå·¥å…·å’Œåº“ï¼Œå› æ­¤åŸºç¡€é•œåƒæˆ‘ä»¬é€‰æ‹©`slim`ç‰ˆæœ¬ï¼ˆ127MB å·¦å³ï¼‰ã€‚\n\næ­¤å¤–ï¼Œæˆ‘ä»¬å¦‚æœä½¿ç”¨äº† poetry æ¥ä½œä¸ºä¾èµ–ç®¡ç†çš„å·¥å…·ï¼Œé‚£åœ¨æ‰“åŒ…æ—¶å°±æœ‰ä¸¤ç§é€‰æ‹©ï¼šç¬¬ä¸€ç§æ˜¯ç›´æ¥å°† poetry æ‰“åˆ°åŸºç¡€é•œåƒä¸­ï¼Œç¬¬äºŒç§æ˜¯ä½¿ç”¨ multi-stage buildï¼Œå³åœ¨ç¬¬ä¸€ä¸ªé˜¶æ®µå…ˆä¸‹è½½ poetryï¼Œå¯¼å‡ºä¾èµ–åˆ° requirements.txtï¼Œç„¶ååœ¨ç¬¬äºŒä¸ªé˜¶æ®µä½¿ç”¨ pip install æ¥ä¸‹è½½ä¾èµ–ã€‚multi-stage build è™½ç„¶æœ€ç»ˆçš„é•œåƒé‡Œä¸åŒ…å« poetryï¼Œä½†æ˜¯ç¬¬ä¸€ä¸ªé˜¶æ®µä¸‹è½½ poetry å’Œå¯¼å‡ºä¾èµ–éƒ½éœ€è¦æ—¶é—´ï¼Œè€Œç¬¬ä¸€ç§æ–¹æ³•ä¸­ç›´æ¥å°† poetry æ‰“åˆ°åŸºç¡€é•œåƒä¸­ï¼Œé•œåƒå¤§å°ä¹Ÿåªå¢åŠ äº†ä¸åˆ° 100MBï¼Œåœ¨å¯ä»¥æ¥å—çš„èŒƒå›´å†…ï¼Œå› æ­¤æˆ‘æ›´æ¨èç¬¬ä¸€ç§ã€‚\n\nç¡®å®šå¥½é•œåƒç­–ç•¥åï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ Dockerfile é•¿å•¥æ ·ï¼ˆåŸºç¡€é•œåƒçš„æ‰“åŒ…å°±æ˜¯åœ¨ python åŸºç¡€é•œåƒçš„ä¸Šé¢ä½¿ç”¨ pip ä¸‹è½½ poetry å³å¯ï¼Œä¸å†èµ˜è¿°ï¼‰ï¼š\n\n```Dockerfile\n# åŒ…å«poetryçš„pythonåŸºç¡€é•œåƒ\nFROM sunpeek/poetry:py3.10-slim\nLABEL maintainer=\"robocanic@gmail.com\"\n# Keeps Python from generating .pyc files in the container\nENV PYTHONDONTWRITEBYTECODE=1\n# Turns off buffering for easier container logging\nENV PYTHONUNBUFFERED=1\n\n# mv source code to a specific directory\nWORKDIR /appruntime\nCOPY . /appruntime\n\n# no need to create virtual env\nRUN poetry config virtualenvs.create false\n# analyze deps\nRUN poetry lock\n# Install deps\nRUN poetry install\n\n# Creates a non-root user with an explicit UID and adds permission to access the /appruntime folder\nRUN adduser -u 5678 --disabled-password --gecos \"\" appuser && chown -R appuser /appruntime\nUSER appuser\n\nCMD [\"uvicorn\", \"poetry_fastapi_demo.main:app\", \"--host=0.0.0.0\", \"--port=8080\", \"--log-config=/appruntime/log.yaml\"]\n```\n\n### CI é›†æˆ\n\nå¦‚æœä½¿ç”¨äº† gitlab pipeline/github actionsï¼Œé‚£æˆ‘ä»¬å¯ä»¥å°†é•œåƒæ‰“åŒ…ï¼Œé•œåƒæ¨é€éƒ½ç»“åˆåˆ° CI ä¸­\n\n#### gitlab pipeline\n\n```YAML\nvariables:    # å˜é‡\n  IMAGE_NAME: $CI_PROJECT_PATH\n  PROJECT_NAME: $CI_PROJECT_NAME\n\n\nstages:\n  - automatic_test_dev\n  - package_build_push_dev\n  - deploy_dev\n\nautomatic_test_job_dev:   # æˆ‘ä»¬åªåœ¨è”è°ƒ/æµ‹è¯•æ—¶æ‰§è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œç”Ÿäº§ç¯å¢ƒä¸ºäº†åŠ å¿«å‘å¸ƒé€Ÿåº¦ï¼Œä¸æ‰§è¡Œæµ‹è¯•\n  image: sunpeek/poetry:py3.10-slim    # ä½¿ç”¨å¸¦poetryçš„pythoné•œåƒ\n  stage: automatic_test_dev\n  only:\n    - dev\n  tags:\n    - python\n  script:\n    - poetry config virtualenvs.create false  # åœ¨å®¹å™¨ä¸­ï¼Œä¸ç”¨åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ\n    - poetry lock     # é”å®šä¾èµ–ç‰ˆæœ¬\n    - poetry install  # ä¸‹è½½ä¾èµ–\n    - pytest tests/   # æ‰§è¡Œæµ‹è¯•\n\npackage_build_push_job_dev:\n  image: docker:27.3  # ä½¿ç”¨dockeré•œåƒ\n  stage: package_build_push_dev\n  only:\n    - dev\n  tags:\n    - python\n  artifacts:\n    paths:\n      - BUILDTIME   # ç¼“å­˜æ„å»ºæ—¶é—´æ–‡ä»¶ä¾›ä¸‹ä¸€ä¸ªjobä½¿ç”¨\n  script:\n    - date +'%Y%m%d%H%M' > BUILDTIME  # å°†æ„å»ºæ—¶é—´å†™åˆ°æ–‡ä»¶\n    - export IMAGE_TAG=dev-$(cat BUILDTIME)-$CI_COMMIT_SHORT_SHA # é•œåƒtag  dev-[å¹´æœˆæ—¥æ—¶åˆ†]-[commit idå‰å…«ä½]\n    - export IMAGE_NAME=$(echo $IMAGE_NAME | tr 'A-Z' 'a-z')  # æŠŠgitlabçš„ç›®å½•å’Œé¡¹ç›®åå°å†™ä½œä¸ºé•œåƒå\n    - docker login -u $REGISTRY_USERNAME -p $REGISTRY_PASSWORD\n    - docker build  -t $IMAGE_NAME:$IMAGE_TAG .\n    - docker push $IMAGE_NAME:$IMAGE_TAG\n```\n\n#### github actions\n\n```YAML\nname: Release deploy           # workflowåå­—\n\non:                            # è§¦å‘æ¡ä»¶ï¼Œæ–°å»ºtagæ—¶è§¦å‘\n  push:\n    tags:\n      - '*'                   # ä»»æ„æ ‡ç­¾éƒ½ä¼šè§¦å‘å·¥ä½œæµ\n\njobs:\n  pkg:\n    runs-on: ubuntu-latest\n    steps:\n      - name: Set up QEMU       # åˆå§‹åŒ–qemu\n        uses: docker/setup-qemu-action@v3\n      - name: Set up Docker Buildx   # åˆå§‹åŒ–buildx\n        uses: docker/setup-buildx-action@v3\n      - name: Login to Docker Hub   # ç™»å½•dockerhub\n        uses: docker/login-action@v3\n        with:\n          username: ${{ secrets.DOCKERHUB_USERNAME }}\n          password: ${{ secrets.DOCKERHUB_PASSWORD }}\n      - name: Extract version   # æå–tag\n        id: extract_version\n        run: |\n          VERSION=\"${GITHUB_REF#refs/tags/}\"\n          echo \"VERSION=${VERSION}\" >> $GITHUB_ENV\n      - name: Build and push   # æ„å»ºé•œåƒå¹¶æ¨é€\n        uses: docker/build-push-action@v6\n        with:\n          push: true\n          tags: ${{ github.repository }}:${{ env.VERSION }}\n```\n\n### æ€»ç»“\n\nå¦‚æœä½ ä½¿ç”¨ docker compose/docker swarm/k8s ç­‰åŸºç¡€è®¾æ–½ï¼Œä½ è¿˜å¯ä»¥ç»“åˆ docker/kubectl æˆ–è€… docker api/k8s api æ¥è¿›è¡Œ CDï¼Œä»è€Œå®ç°åº”ç”¨ä»å‘å¸ƒåˆ°éƒ¨ç½²å®Œå…¨æµæ°´çº¿åŒ–ã€‚\n\nåº”ç”¨çš„å‘å¸ƒåœ¨ä¸åŒçš„å›¢é˜Ÿï¼Œä¸åŒçš„å…¬å¸æ˜¯æœ‰ç€ä¸åŒçš„æµç¨‹å’Œåå¥½çš„ï¼Œä»¥ä¸Šåªæ˜¯æˆ‘æä¾›çš„ä¸€ç§å®ç°å‚è€ƒï¼Œä½†æ˜¯æ— è®ºæ˜¯ä»€ä¹ˆå‘å¸ƒæµç¨‹ï¼Œè€ƒè™‘çš„é‡ç‚¹å…¶å®æ˜¯å¤§å·®ä¸å·®çš„ï¼š\n\n1. é•œåƒå¤§å°è¦å°½å¯èƒ½å‹ç¼©\n\n2. å‘å¸ƒè¦åšåˆ°å¯å›æ»šï¼Œå¯ç°åº¦\n\n3. å‘å¸ƒæµç¨‹ä¸­çš„ä¿¡æ¯è¦å¯è¿½æº¯\n\n4. å‘å¸ƒä¸­ç”¨åˆ°çš„ç»„ä»¶å¤ç”¨åº¦è¦é«˜\n\n5. ......\n\næŒ‰ç…§è¿™äº›ä¸ªæ€è·¯å»ç¼–æ’å‘å¸ƒæµæ°´çº¿ï¼Œç›¸ä¿¡ä½ èƒ½å¾—åˆ°ä¸€ä¸ªç†æƒ³ä¸­çš„æµæ°´çº¿ã€‚\n","source":"_posts/Pythonå·¥ç¨‹åŒ–ä¸å®Œå…¨æŒ‡å—.md","raw":"---\ntitle: Pythonå·¥ç¨‹åŒ–ä¸å®Œå…¨æŒ‡å—\ndate: 2024-7-06 21:37:12\ntags: Python, æ—¥å¸¸å¼€å‘\ncategories: æ—¥å¸¸å¼€å‘\n---\n\nPython ä½œä¸ºä¸€ä¸ªå¼±ç±»å‹è¯­è¨€ï¼Œä¼¼ä¹ä»è¯ç”Ÿä¹‹åˆå°±è¢«å¾ˆå¤šäººè§‰å¾—è¿™æ˜¯ä¸€ä¸ªå¾ˆéšä¾¿çš„è¯­è¨€ï¼Œæ„å»ºä¸€ä¸ªå¯é çš„ Python é¡¹ç›®æ˜¯ä¸€ä¸ªå¾ˆéš¾çš„äº‹æƒ…ã€‚äº‹å®ä¹Ÿç¡®å®å¦‚æ­¤ï¼Œéšç€ AI çš„çˆ†å‘ï¼Œå…¥å‘ Python çš„äººè¶Šæ¥è¶Šå¤šï¼Œä½†å¯¹ Python çš„è¯Ÿç—…å´åªå¢ä¸å‡ã€‚ä¸è¿‡ï¼ŒPython å·¥ç¨‹åŒ–è¿˜æ˜¯åœ¨è¯Ÿç—…ä¸­æ›²æŠ˜å‰è¿›çš„ï¼Œåˆ°ä»Šå¤©ä¸ºæ­¢ï¼Œå°½ç®¡è¿˜å­˜åœ¨ç€ä¸€äº›æ··ä¹±ï¼ŒPython å·¥ç¨‹åŒ–çš„æ ‡å‡†è¶‹äºåŸºæœ¬å®Œå–„ã€‚æœ¬ç¯‡å°†ä»â€œè¿‡æ¥äººâ€çš„è§†è§’ï¼Œç”±æµ…å…¥æ·±åœ°è®²è¿° python å·¥ç¨‹åŒ–çš„æ–¹æ–¹é¢é¢ï¼Œæä¾›ä¸€ä¸ªæœ€ä½³å®è·µä¾›ä½ å‚è€ƒã€‚\n\n# é¡¹ç›®ç›®å½•ç»“æ„\n\nPython ä½œä¸ºè„šæœ¬è¯­è¨€ï¼Œä¸€ä¸ª.py æ–‡ä»¶èƒ½æ”¾åœ¨ä»»ä½•åœ°æ–¹è¿è¡Œï¼Œä½†æ˜¯**ä¸€ä¸ªæ¸…æ™°çš„ç›®å½•ç»“æ„ä¸ä»…æ˜“äºæ’æŸ¥é—®é¢˜ï¼Œæ›´æ–¹ä¾¿åˆ«äººè¯»æ‡‚æˆ‘ä»¬çš„ä»£ç ï¼Œæ›´åŠ ä¼˜é›…**ã€‚Python ç”±äºå…¶åº”ç”¨å¹¿æ³›ï¼Œä¸åŒç±»å‹çš„ Python é¡¹ç›®ä¹Ÿæœ‰ç€ä¸åŒçš„ç›®å½•ç»“æ„è§„çº¦ã€‚è¿™é‡Œæˆ‘é€‰å–æ™®é€šåº”ç”¨å·¥ç¨‹å’Œæ•°æ®/AI å·¥ç¨‹è¿™ä¸¤ç§æœ€ä¸ºå¹¿æ³›çš„ç±»å‹è¿›è¡Œè¯´æ˜ã€‚\n\n## æ™®é€šåº”ç”¨å·¥ç¨‹\n\nå‡å®šæˆ‘ä»¬çš„é¡¹ç›®åä¸º`robocanic-project`ï¼Œæ™®é€šåº”ç”¨å·¥ç¨‹æœ€å¸¸ç”¨çš„ç›®å½•ç»“æ„é£æ ¼å¦‚ä¸‹æ‰€ç¤ºï¼š\n\n```Plain Text\nÂ robocanic-project/\nÂ â”‚\nÂ â”œâ”€â”€ robocanic_project/ Â  Â   # ä¸»åŒ…ï¼Œæˆ‘ä»¬çš„æ ¸å¿ƒä»£ç éƒ½åœ¨è¿™é‡Œé¢\nÂ â”‚ Â  â”œâ”€â”€ __init__.py Â  Â  Â  Â  # åŒ…åˆå§‹åŒ–æ–‡ä»¶\nÂ â”‚ Â  â”œâ”€â”€ module1.py Â  Â  Â  Â   # æ¨¡å—1\nÂ â”‚ Â  â”œâ”€â”€ module2.py Â  Â  Â  Â   # æ¨¡å—2\nÂ â”‚ Â  â””â”€â”€ main.py Â  Â  Â  Â      # ä¸»ç¨‹åºå…¥å£\nÂ â”‚\nÂ â”œâ”€â”€ tests/ Â  Â  Â  Â  Â  Â  Â  Â   # æµ‹è¯•ç›®å½•\nÂ â”‚ Â  â”œâ”€â”€ __init__.py\nÂ â”‚ Â  â”œâ”€â”€ test_module1.py\nÂ â”‚ Â  â””â”€â”€ test_module2.py\nÂ â”‚\nÂ â”œâ”€â”€ requirements.txt Â  Â  Â   # ä¾èµ–æ–‡ä»¶\nÂ â”œâ”€â”€ setup.py Â  Â  Â  Â  Â  Â  Â   # å®‰è£…è„šæœ¬\nÂ â”œâ”€â”€ README.md Â  Â  Â  Â  Â  Â  Â  # é¡¹ç›®è¯´æ˜\nÂ â””â”€â”€ .gitignore Â  Â  Â  Â  Â  Â   # Gitå¿½ç•¥æ–‡ä»¶\n```\n\né‚£ä¸Šé¢è¿™ç§è¿˜æ¯”è¾ƒå®½æ³›ï¼Œå¦‚æœä»¥å‰åç«¯åˆ†ç¦»çš„åç«¯ Web åº”ç”¨è¿™ç§æ¯”è¾ƒå¸¸è§çš„é¡¹ç›®ä¸ºä¾‹ï¼Œç›®å½•ç»“æ„å¯ä»¥æ˜¯ä¸‹é¢è¿™æ ·çš„ï¼š\n\n```Plain Text\nrobocanic-project/\nâ”œâ”€â”€ robocanic_project/                     # ä¸»åº”ç”¨ç¨‹åºç›®å½•\nâ”‚   â”œâ”€â”€ __init__.py          # å°†è¯¥ç›®å½•æ ‡è¯†ä¸ºåŒ…ï¼Œé€šå¸¸åˆå§‹åŒ– FastAPI å®ä¾‹\nâ”‚   â”œâ”€â”€ main.py              # ä¸»æ–‡ä»¶ï¼ŒåŒ…å«åº”ç”¨å®ä¾‹å’Œè·¯ç”±\nâ”‚   â”œâ”€â”€ api/                 # API è·¯ç”±ç›®å½•\nâ”‚   â”‚   â”œâ”€â”€ __init__.py\nâ”‚   â”‚   â”œâ”€â”€ v1/              # API çš„ v1 ç‰ˆæœ¬ï¼ˆå¯é€‰åˆ†ç‰ˆæœ¬ç›®å½•ï¼‰\nâ”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py\nâ”‚   â”‚   â”‚   â”œâ”€â”€ routes/   # å…·ä½“çš„ API ç«¯ç‚¹\nâ”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py\nâ”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ user.py  # ç”¨æˆ·ç›¸å…³çš„ API è·¯ç”±\nâ”‚   â”‚   â”‚   â”‚   â””â”€â”€ item.py  # å…¶ä»–æ¨¡å—ï¼ˆå¦‚å•†å“ï¼‰çš„ API è·¯ç”±\nâ”‚   â”‚   â”‚   â””â”€â”€ ...          # æ›´å¤š API è·¯ç”±\nâ”‚   â”œâ”€â”€ core/                # æ ¸å¿ƒé…ç½®æ¨¡å—\nâ”‚   â”‚   â”œâ”€â”€ __init__.py\nâ”‚   â”‚   â”œâ”€â”€ config.py        # é…ç½®æ–‡ä»¶ï¼ŒåŒ…å«æ•°æ®åº“è¿æ¥ã€ç¬¬ä¸‰æ–¹æœåŠ¡é…ç½®ç­‰\nâ”‚   â”‚   â”œâ”€â”€ security.py      # å®‰å…¨ç›¸å…³çš„è®¾ç½®ï¼Œä¾‹å¦‚ OAuth2ã€JWT\nâ”‚   â”œâ”€â”€ models/              # æ•°æ®åº“æ¨¡å‹\nâ”‚   â”‚   â”œâ”€â”€ __init__.py\nâ”‚   â”‚   â””â”€â”€ user.py          # ç”¨æˆ·æ¨¡å‹\nâ”‚   â”‚   â””â”€â”€ item.py          # å…¶ä»–æ•°æ®æ¨¡å‹\nâ”‚   â”œâ”€â”€ crud/                # å¢åˆ æ”¹æŸ¥æ“ä½œçš„å°è£…\nâ”‚   â”‚   â”œâ”€â”€ __init__.py\nâ”‚   â”‚   â”œâ”€â”€ user.py          # ç”¨æˆ·çš„ CRUD æ“ä½œ\nâ”‚   â”‚   â””â”€â”€ item.py          # å…¶ä»–æ•°æ®çš„ CRUD æ“ä½œ\nâ”‚   â”œâ”€â”€ db/                  # æ•°æ®åº“åˆå§‹åŒ–åŠè¿æ¥\nâ”‚   â”‚   â”œâ”€â”€ __init__.py\nâ”‚   â”‚   â”œâ”€â”€ base.py          # åŸºç¡€çš„æ•°æ®åº“æ¨¡å‹\nâ”‚   â”‚   â””â”€â”€ session.py       # æ•°æ®åº“ä¼šè¯ï¼ˆSQLAlchemy ä¼šè¯ï¼‰\nâ”‚   â”œâ”€â”€ tests/               # æµ‹è¯•ç›®å½•\nâ”‚   â”‚   â”œâ”€â”€ __init__.py\nâ”‚   â”‚   â””â”€â”€ test_user.py     # ç”¨æˆ·ç›¸å…³çš„æµ‹è¯•æ–‡ä»¶\nâ”‚   â”‚   â””â”€â”€ test_item.py     # å…¶ä»–æ¨¡å—çš„æµ‹è¯•æ–‡ä»¶\nâ”‚   â”œâ”€â”€ utils/               # å·¥å…·å‡½æ•°ç›®å½•\nâ”‚   â”‚   â”œâ”€â”€ __init__.py\nâ”‚   â”‚   â””â”€â”€ hashing.py       # ç”¨äºå¯†ç åŠ å¯†/è§£å¯†ç­‰å®ç”¨å·¥å…·\n    â”œâ”€â”€ alembic/             # æ•°æ®åº“è¿ç§»å·¥å…· Alembic ç›¸å…³æ–‡ä»¶ï¼ˆå¦‚æœä½¿ç”¨ï¼‰\nâ”‚   â”‚   â”œâ”€â”€ versions/        # æ¯ä¸ªè¿ç§»æ–‡ä»¶éƒ½ä¿å­˜åœ¨è¿™ä¸ªç›®å½•ä¸­\nâ”‚   â”‚   â”œâ”€â”€ env.py           # Alembic ç¯å¢ƒé…ç½®æ–‡ä»¶\nâ”‚   â”‚   â”œâ”€â”€ README           # Alembic è¯´æ˜\nâ”‚   â”‚   â””â”€â”€ script.py.mako   # Alembic è„šæœ¬æ¨¡æ¿\nâ”‚   â””â”€â”€ ...\nâ”œâ”€â”€ .env                     # ç¯å¢ƒå˜é‡æ–‡ä»¶ï¼ˆæ•æ„Ÿä¿¡æ¯ï¼Œä¸åº”æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶ï¼‰\nâ”œâ”€â”€ .gitignore               # Git å¿½ç•¥æ–‡ä»¶åˆ—è¡¨\nâ”œâ”€â”€ requirements.txt         # ä¾èµ–åŒ…åˆ—è¡¨ï¼ˆå¦‚æœä½¿ç”¨ pipï¼‰\nâ”œâ”€â”€ setup.py Â  Â  Â  Â  Â  Â  Â    # å®‰è£…è„šæœ¬ï¼ˆå¦‚æœä½¿ç”¨setuptoolsï¼‰\nâ”œâ”€â”€ pyproject.toml           # é¡¹ç›®å…ƒæ•°æ®åŠä¾èµ–ç®¡ç†ï¼ˆå¦‚æœä½¿ç”¨ poetryï¼‰\nâ”œâ”€â”€ README.md                # é¡¹ç›®è¯´æ˜æ–‡ä»¶\nâ””â”€â”€ Dockerfile               # Docker é…ç½®æ–‡ä»¶ï¼ˆå¦‚æœä½¿ç”¨å®¹å™¨åŒ–ï¼‰\n```\n\nä¸€ä¸ªä»¥ FastAPI ä¸ºåŸºç¡€ Web æ¡†æ¶çš„é¡¹ç›®çš„ç›®å½•ç»“æ„å¦‚ä¸Šæ‰€ç¤ºã€‚å…¶ä¸­ï¼Œé™¤äº†`api`ï¼Œ`models`ï¼Œ`crud`ï¼Œ`utils`è¿™ç±»è§åçŸ¥æ„çš„ç›®å½•ï¼Œè¿˜æœ‰ä¸€ä¸ªä¸å¤ªå¸¸è§çš„`alembic`è¿™ä¸ªç›®å½•ï¼Œalembic å…¶å®æ˜¯æ•°æ®åº“è¿ç§»ï¼ˆ**Database Migration**ï¼‰çš„å·¥å…·ã€‚è€Œæ•°æ®åº“è¿ç§»å°±æ˜¯æŒ‡åœ¨æˆ‘ä»¬çš„åº”ç”¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå½“æ¶‰åŠåˆ°éœ€è¦ä¿®æ”¹ ORM å¯¹åº”çš„æ•°æ®åº“ç»“æ„ï¼ˆä¾‹å¦‚è¡¨ã€å­—æ®µã€ç´¢å¼•ç­‰ï¼‰æ—¶ï¼Œå¼•å…¥çš„ä¸€å¥—é€æ­¥æ¼”è¿›æ•°æ®åº“çš„çŠ¶æ€ï¼Œä½¿å…¶ä¸åº”ç”¨ä»£ç ä¿æŒä¸€è‡´çš„å·¥å…·ã€‚è¿™å¥—å·¥å…·ä¸€èˆ¬æ˜¯åŠè‡ªåŠ¨æˆ–è€…å…¨è‡ªåŠ¨çš„ï¼Œå¯ä»¥å¤§å¤§é™ä½æ‰‹åŠ¨æ“ä½œæ•°æ®åº“å¸¦æ¥çš„é£é™©ã€‚\n\n## æ•°æ®/AI å·¥ç¨‹\n\nè€Œå¯¹äºæ•°æ®ç§‘å­¦ï¼Œæ¨¡å‹è®­ç»ƒï¼Œç§‘å­¦è®¡ç®—è¿™ç±»é¡¹ç›®ï¼Œåˆ™æœ‰ç€å¦ä¸€å¥—å®Œå…¨ä¸ä¸€æ ·çš„ç›®å½•é£æ ¼ï¼š\n\n```Plain Text\nrobocanic-project/\nâ”œâ”€â”€ data/\nâ”œâ”€â”€ notebooks/\nâ”œâ”€â”€ scripts/\nâ”œâ”€â”€ requirements.txt\nâ””â”€â”€ README.md\n\n```\n\nä»¥ä¸Šæ˜¯æ¯”è¾ƒç®€ç•¥çš„ç›®å½•ç»“æ„ï¼Œå±•å¼€æ¥çœ‹ï¼š\n\n```Plain Text\nrobocanic-project/\nâ”œâ”€â”€ data/\nâ”‚   â”œâ”€â”€ raw/                  # åŸå§‹æ•°æ®ï¼ˆæœªå¤„ç†çš„æ•°æ®ï¼‰\nâ”‚   â”œâ”€â”€ processed/            # å¤„ç†åçš„æ•°æ®ï¼ˆæ¸…æ´—åçš„æ•°æ®ã€ç‰¹å¾å·¥ç¨‹åçš„æ•°æ®ï¼‰\nâ”‚   â””â”€â”€ external/             # å¤–éƒ¨æ•°æ®æºï¼ˆå¯èƒ½æ˜¯APIæˆ–ç¬¬ä¸‰æ–¹æä¾›çš„æ•°æ®ï¼‰\nâ”‚\nâ”œâ”€â”€ notebooks/                # Jupyter Notebooksï¼ˆæ¢ç´¢æ€§åˆ†æå’Œåˆæ­¥æ¨¡å‹ï¼‰\nâ”‚   â”œâ”€â”€ 01_data_exploration.ipynb  # æ•°æ®æ¢ç´¢\nâ”‚   â”œâ”€â”€ 02_data_cleaning.ipynb     # æ•°æ®æ¸…ç†\nâ”‚   â””â”€â”€ 03_model_training.ipynb    # æ¨¡å‹è®­ç»ƒ\nâ”‚\nâ”œâ”€â”€ scripts/                  # æ•°æ®å¤„ç†å’Œæ¨¡å‹è®­ç»ƒçš„Pythonè„šæœ¬\nâ”‚   â”œâ”€â”€ data_preprocessing.py  # æ•°æ®é¢„å¤„ç†è„šæœ¬\nâ”‚   â”œâ”€â”€ train_model.py         # æ¨¡å‹è®­ç»ƒè„šæœ¬\nâ”‚   â””â”€â”€ evaluate_model.py      # æ¨¡å‹è¯„ä¼°è„šæœ¬\nâ”‚\nâ”œâ”€â”€ models/                   # ä¿å­˜çš„æ¨¡å‹ï¼ˆè®­ç»ƒå¥½çš„æ¨¡å‹ã€æ ‡è®°åŒ–æ–‡ä»¶ç­‰ï¼‰\nâ”‚   â””â”€â”€ model_v1.pkl           # ä¿å­˜çš„æ¨¡å‹æ–‡ä»¶\nâ”‚\nâ”œâ”€â”€ reports/                  # é¡¹ç›®æŠ¥å‘Šä¸ç»“æœå±•ç¤º\nâ”‚   â”œâ”€â”€ figures/              # å›¾è¡¨å’Œå¯è§†åŒ–ç»“æœ\nâ”‚   â””â”€â”€ final_report.pdf      # æœ€ç»ˆæŠ¥å‘Šæˆ–ç»“æœæ€»ç»“\nâ”‚\nâ”œâ”€â”€ requirements.txt          # é¡¹ç›®æ‰€éœ€çš„ä¾èµ–åº“åˆ—è¡¨\nâ”œâ”€â”€ environment.yml           # Conda ç¯å¢ƒé…ç½®æ–‡ä»¶\nâ”œâ”€â”€ README.md                 # é¡¹ç›®è¯´æ˜æ–‡ä»¶\nâ””â”€â”€ .gitignore                # Gitå¿½ç•¥æ–‡ä»¶\n\n```\n\nå¯ä»¥çœ‹å‡ºæ•°æ®/AI é¡¹ç›®å’Œæ™®é€šçš„åº”ç”¨è¿˜æ˜¯æœ‰å¾ˆå¤§åŒºåˆ«çš„ã€‚**æ•°æ®/AI é¡¹ç›®æ›´å¤šæ˜¯ä»æ•°æ®çš„æµå‘æ¥è¿›è¡Œç›®å½•ç»“æ„çš„åˆ’åˆ†ï¼Œä»æ•°æ®é‡‡é›† â†’ æ•°æ®å¤„ç† â†’ æ¨¡å‹è®­ç»ƒï¼ˆæ•°æ®èšåˆï¼‰â†’ æ¨¡å‹è¯„ä¼°ï¼ˆæ•°æ®è¯„ä¼°ï¼‰â†’...... è€Œæ™®é€šåº”ç”¨é¡¹ç›®åˆ™æ›´å¤šæ˜¯æŒ‰åŠŸèƒ½æ¨¡å—æ¥åˆ’åˆ†ï¼Œæ¯”å¦‚ MVC çš„åˆ’åˆ†æ¨¡å¼ï¼Œä»¥ APP ä¸ºæ ¸å¿ƒçš„åˆ’åˆ†æ¨¡å‹ç­‰ã€‚**\n\næ€»çš„æ¥è¯´ï¼ŒPython å·¥ç¨‹çš„ç›®å½•è¿˜æ˜¯æ¯”è¾ƒçµæ´»çš„ï¼Œæˆ‘ä»¬åœ¨æ„å»ºæˆ‘ä»¬è‡ªå·±çš„é¡¹ç›®ç›®å½•æ—¶å¯ä»¥ä¸æ‹˜æ³¥äºå›ºå®šçš„ç›®å½•ç»“æ„ï¼Œä½†ä¹Ÿè¦éµå¾ªä¸Šé¢æåˆ°çš„ä¸€äº›åŸºæœ¬è§„å¾‹ï¼Œè¿™æ ·åˆ«äººä¸Šæ‰‹æˆ‘ä»¬çš„é¡¹ç›®æ—¶èƒ½å¤Ÿå¿«é€Ÿè¯»æ‡‚æˆ‘ä»¬çš„é¡¹ç›®ç»“æ„ï¼Œè¿›è€Œè¯»æ‡‚ä»£ç ã€‚\n\n# é¡¹ç›®ç¯å¢ƒä¸ä¾èµ–ç®¡ç†\n\næ¥ä¸‹æ¥è¦è°ˆåˆ°çš„éƒ¨åˆ†ä¸ªäººè®¤ä¸ºæ˜¯ python ä¸­æœ€æ··ä¹±çš„éƒ¨åˆ†â€”â€”ä¾èµ–ç®¡ç†ã€‚ä½†æ˜¯è®² Python çš„ä¾èµ–ç®¡ç†ä¸èƒ½åªè®²ä¾èµ–ç®¡ç†ï¼Œè¿˜è¦è¿å¸¦ç€**è™šæ‹Ÿç¯å¢ƒ(Virtual Environment)**ä¸€èµ·è®²ã€‚\n\nä¸åŒäº Javaï¼ŒGo è¿™ç±»ä¾èµ–è·Ÿç€é¡¹ç›®èµ°çš„åšæ³•ï¼ŒPython é¡¹ç›®çš„ä¾èµ–æ˜¯å¯¹äºå½“å‰è™šæ‹Ÿç¯å¢ƒè€Œè¨€çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ä½ åœ¨å‘½ä»¤è¡Œä¸­æ•²ä¸‹`pip install fastapi`å»ä¸‹è½½ fastapi è¿™ä¸ªåŒ…æ—¶ï¼Œè¿™ä¸ªä¾èµ–æ˜¯å¯¹å½“å‰ç¯å¢ƒæœ‰æ•ˆçš„ï¼Œå¦‚æœé¡¹ç›® A å’Œé¡¹ç›® B éƒ½ä½¿ç”¨äº†è™šæ‹Ÿç¯å¢ƒ Eï¼Œé‚£é¡¹ç›® A å’Œé¡¹ç›® B éƒ½å¯ä»¥ä½¿ç”¨`fastapi`è¿™ä¸ªä¾èµ–ï¼Œå¦‚æœæœ‰å¤šä¸ªé¡¹ç›®éƒ½éœ€è¦ä¾èµ–`fastapi`ï¼Œé‚£æ˜¯ä¸æ˜¯æŠŠä»–ä»¬æ”¾åˆ°ä¸€ä¸ªè™šæ‹ŸåŒ–ç¯å¢ƒé‡Œå°±è¡Œï¼Ÿç­”æ¡ˆæ˜¯å¦å®šçš„ï¼Œå› ä¸ºä¸€èˆ¬æ¥è¯´ï¼Œä¸€ä¸ªé¡¹ç›®ä¸å•å•åªä¾èµ–ä¸€ä¸ª`fastapi`ï¼Œè¿˜æœ‰å…¶ä»–çš„ä¾èµ–ã€‚æ¯”å¦‚ä¸¤ä¸ªé¡¹ç›® A å’Œ B ä¾èµ–äº†ä¸€ä¸ªå…±åŒçš„åŒ…`pymysql`ï¼Œä½†æ˜¯ä¾èµ–çš„ç‰ˆæœ¬ä¸ä¸€æ ·ï¼Œè¿™æ ·å°±ä¼šå‘ç”Ÿä¾èµ–å†²çªã€‚å› æ­¤æˆ‘ä»¬åœ¨åˆ›å»º Python é¡¹ç›®æ—¶ï¼Œä¸€èˆ¬éƒ½ä¼šåˆ›å»ºä¸€ä¸ªå¯¹åº”çš„è™šæ‹Ÿç¯å¢ƒæ¥é˜²æ­¢ä¾èµ–å†²çªã€‚æ‰€ä»¥åˆ°è¿™ä½ å°±ä¼šå‘ç°è™šæ‹Ÿç¯å¢ƒå…¶å®è¿˜æ˜¯é¡¹ç›®å±‚é¢çš„ï¼Œä¸€ä¸ªé¡¹ç›®å°±å¯¹åº”ä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒï¼Œè™šæ‹Ÿç¯å¢ƒçš„è¿™ä¸ªè®¾è®¡è¯´å®è¯å¾ˆé¸¡è‚‹ï¼Œä¸ä»…ç›¸åŒç‰ˆæœ¬çš„åŒ…ä¸èƒ½å¾—åˆ°å¤ç”¨ï¼Œè¿˜å˜ç›¸åœ°æé«˜äº†ä¾èµ–ç®¡ç†çš„å¤æ‚åº¦ã€‚\n\nåæ§½å®Œä¹‹åï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ç°é˜¶æ®µç¯å¢ƒç®¡ç†ä»¥åŠä¾èµ–ç®¡ç†çš„æœ€ä½³å®è·µã€‚è¿™ä¸ªæœ€ä½³å®è·µåŒ…æ‹¬ä¸æ¨èçš„æ–¹å¼ venv/virtualenv+pipï¼Œä»¥åŠä¸¤ç§æ¨èçš„æ–¹å¼ï¼šconda+pipï¼Œpoetryã€‚\n\n## venv/virtualenv+pipï¼ˆä¸æ¨èï¼‰\n\nvenv å’Œ virtualenv éƒ½æ˜¯ç”¨æ¥åˆ›å»º python è™šæ‹Ÿç¯å¢ƒçš„å·¥å…·ï¼Œä¸åŒçš„åœ°æ–¹åœ¨äº venv æ˜¯ python3.3 åè‡ªå¸¦çš„è½»é‡çº§è™šæ‹Ÿç¯å¢ƒåˆ›å»ºå·¥å…·ï¼Œåªèƒ½ç”¨äº python3ï¼›è€Œ virtualenv åˆ™éœ€è¦å¦å¤–å®‰è£…ï¼Œå¯ä»¥ç”¨äº py2 ä»¥åŠ py3ï¼Œè¿˜æœ‰ä¸€äº› venv æ²¡æœ‰çš„åŠŸèƒ½ï¼ˆä¸ªäººè§‰å¾—å¯æœ‰å¯æ— ï¼‰ã€‚é‚£å¯¹äº python3.3 ä»¥åçš„é¡¹ç›®ï¼Œç°åœ¨éƒ½æ¨èè‡ªå¸¦çš„ venv äº†ã€‚venv ä½¿ç”¨èµ·æ¥ä¹Ÿå¾ˆç®€å•ï¼š\n\n1.  `python -m venv venv`å‘½ä»¤çš„ç¬¬ä¸€ä¸ª venvï¼Œæ˜¯è¿è¡Œ venv è¿™ä¸ªæ¨¡å—æ¥åˆ›å»ºä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒã€‚ç¬¬äºŒä¸ª venv æ˜¯æŒ‡è™šæ‹Ÿç¯å¢ƒçš„æ–‡ä»¶å¤¹çš„åå­—ï¼Œè¿™ä¸ªå¯ä»¥æ ¹æ®éœ€è¦æ¥ä¿®æ”¹ã€‚å‘½ä»¤æ‰§è¡Œåï¼Œä¼šåœ¨å½“å‰æ–‡ä»¶å¤¹ä¸­ï¼Œå»ºç«‹ä¸€ä¸ª venv ç›®å½•ã€‚ åœ¨è¿™ä¸ª venv ç›®å½•ä¸­ï¼Œä¼šé»˜è®¤æ”¾ç½® python.exeã€pip.exe ç­‰ä¸ç³»ç»Ÿç›®å½•éš”ç¦»çš„å¯æ‰§è¡Œæ–‡ä»¶å’Œä¾èµ–ã€‚ä¸€èˆ¬ venv ä¼šæ”¾ç½®åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹ã€‚\n\n2.  è¿›å…¥åˆ°`venv/Scipts`æ–‡ä»¶å¤¹ï¼Œæ‰§è¡Œ`activate`ï¼Œå¯ä»¥æ¿€æ´»å½“å‰çš„è™šæ‹Ÿç¯å¢ƒ; æ‰§è¡Œ`deactivate`ï¼Œå¯ä»¥åœç”¨å½“å‰è™šæ‹Ÿç¯å¢ƒ\n\n3.  åˆ é™¤è¿™ä¸ªè™šæ‹Ÿç¯å¢ƒåªéœ€è¦åˆ é™¤æ‰é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ venv æ–‡ä»¶å¤¹å³å¯ã€‚\n\nvenv æ²¡æœ‰ç®¡ç†è™šæ‹Ÿç¯å¢ƒçš„åŠŸèƒ½ï¼Œè¿™æ˜¯å› ä¸ºè™šæ‹Ÿç¯å¢ƒçš„ä¾èµ–éƒ½è·Ÿç€é¡¹ç›®èµ°äº†ï¼ˆvenv æ–‡ä»¶å¤¹åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼‰ã€‚å› æ­¤å®ƒè¶³å¤Ÿçš„è½»é‡ã€‚\n\npip æ˜¯ä¸€ä¸ªè½»é‡çº§åŒ…ç®¡ç†å·¥å…·ï¼Œå®‰è£… python æ—¶éƒ½ä¼šè‡ªå¸¦ pipã€‚pip æœ€å¸¸ç”¨çš„å‘½ä»¤æœ‰ç”¨äºä¸‹è½½ä¾èµ–çš„`pip install deps`ã€`pip install -r requirements`å’Œç”¨äºåˆ é™¤ä¾èµ–çš„`pip uninstall deps`ã€‚å¾ˆå¤šäººåœ¨ä¸€å¼€å§‹ä½¿ç”¨ pip æ—¶è¿˜è§‰å¾—ç®€å•å¥½ç”¨ï¼Œä½†åœ¨ä½¿ç”¨å¤šäº†ä¹‹åå°±æ·±æ¶ç—›ç»ã€‚pip è®©äººæ·±æ¶ç—›ç»çš„æœ€ä¸»è¦çš„ä¸¤ä¸ªåŸå› å¦‚ä¸‹ï¼š\n\n1. åœ¨å‘½ä»¤è¡Œæ‰§è¡Œå®Œ`pip install deps`åä¸‹è½½çš„ä¾èµ–ä¸ä¼šåŒæ­¥åˆ° requirements.txt ä¸­ï¼ŒåŒæ ·`pip uninstall deps`åˆ é™¤çš„ä¾èµ–ä¹Ÿä¸ä¼šåˆ é™¤ requirements ä¸­å£°æ˜çš„ä¾èµ–ã€‚\n\n2. **`pip uninstall deps`åªä¼šåˆ é™¤`deps`è¿™ä¸ªç›´æ¥ä¾èµ–ï¼Œè€Œä¸ä¼šåˆ é™¤æœ€åˆä¸‹è½½`deps`è¿™ä¸ªåŒ…å¼•å…¥çš„é—´æ¥ä¾èµ–**\n\nå…¶ä¸­ï¼Œç¬¬ä¸€ç‚¹è¿˜å¯ä»¥ä½¿ç”¨`pip freeze > requirements.txt`æ¥å®Œæˆæ‰‹åŠ¨åŒæ­¥ï¼Œç¬¬äºŒç‚¹åˆ™æ˜¯åæ§½æœ€å¤šçš„ç‚¹ã€‚è¿™ä¸¤ç‚¹ç»å¸¸ä¼šå¼•èµ·ä¾èµ–å†²çªï¼Œç”Ÿäº§ç¯å¢ƒä¸æœ¬åœ°å¼€å‘ç¯å¢ƒä¸ä¸€è‡´çš„æƒ…å†µå‡ºç°ã€‚æ‰€ä»¥åœ¨ä½¿ç”¨ venv+pip ç»„åˆæ—¶ï¼Œå¾—éµå¾ªä¸€ä¸ªå¼€å‘èŒƒå¼ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºä»¥ä¸‹å‡ ç‚¹\n\n1. ç›´æ¥ä¾èµ–éœ€è¦å†™å…¥ requirements.txt ä¸­ï¼Œä½¿ç”¨`pip install -r requirements`æ¥ä¸‹è½½ä¾èµ–ï¼Œæ‘ˆå¼ƒ`pip install deps`ï¼Œä¿è¯é¡¹ç›®ä¾èµ–ç›¸å¯¹æ¸…æ™°\n\n2. å‘ç‰ˆæ—¶å¿…é¡»æ‰§è¡Œ`pip freeze > requirements.txt`æ¥ä¿è¯æœ¬åœ°ä¸äº‘ç«¯ç¯å¢ƒä¸€è‡´\n\n## conda+pipï¼ˆæ¨èç”¨äºæ•°æ®/AI é¢†åŸŸï¼‰\n\nconda ä¸ä»…æ˜¯ä¸€ä¸ªåŒ…ç®¡ç†å·¥å…·åº“ï¼Œè¿˜æ˜¯ä¸€ä¸ªç¯å¢ƒç®¡ç†å·¥å…·ï¼Œå¹¿æ³›ç”¨äºç§‘å­¦è®¡ç®—é¢†åŸŸï¼Œconda å‘½ä»¤ä¹Ÿæ¯”è¾ƒç®€å•æ˜“ç”¨ï¼Œä½¿ç”¨ conda çš„åŸºæœ¬æ­¥éª¤å¦‚ä¸‹ï¼š\n\n1. `conda create -n my-ns`åˆ›å»ºä¸€ä¸ªéš”ç¦»çš„è™šæ‹Ÿç¯å¢ƒ\n\n2. `conda activate my-ns`ï¼Œæ¿€æ´»è™šæ‹Ÿç¯å¢ƒ\n\n3. `conda install dps`ä¸‹è½½ä¾èµ–\n\n4. `conda remve deps` å¸è½½ä¾èµ–ï¼Œconda åœ¨å¸è½½ä¾èµ–æ—¶ä¼šæ™ºèƒ½åœ°å¤„ç†åŒ…çš„ä¾èµ–å…³ç³»ï¼Œå°†é—´æ¥ä¾èµ–ä¸­æ— ç”¨çš„åŒ…ä¹Ÿä¼šä¸€å¹¶å¸è½½\n\n5. `conda remove --name my-ns --all`åˆ é™¤è™šæ‹Ÿç¯å¢ƒ\n\nå…¶ä¸­ï¼Œconda åˆ›å»ºçš„è™šæ‹Ÿç¯å¢ƒä¼šç»´æŠ¤ä¸€ä¸ªä¸ç¯å¢ƒååŒåçš„æ–‡ä»¶ç›®å½•ï¼ˆç±»ä¼¼ venvï¼‰ï¼Œä½†è¿™ä¸ªæ–‡ä»¶ç›®å½•ä¼šç»Ÿä¸€æ”¾åœ¨ä¸€ä¸ªåœ°æ–¹ï¼Œä¸ä¼šæ”¾åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼Œè¿™ä¹Ÿè®©å¤šä¸ªä½¿ç”¨ conda çš„é¡¹ç›®â€œæœ‰äº†å…±äº«è™šæ‹Ÿç¯å¢ƒçš„å¯èƒ½â€ã€‚é‚£ conda æ—¢èƒ½ç®¡ç†ç¯å¢ƒï¼Œåˆèƒ½ç®¡ç†ä¾èµ–ï¼Œæ˜¯ä¸æ˜¯å°±èƒ½æ›¿ä»£ pipï¼Ÿå¾ˆé—æ†¾è¿˜æ˜¯ä¸èƒ½ï¼Œä¸»è¦åŸå› æœ‰ä¸¤ç‚¹ï¼š\n\n1. conda ä¸»è¦ç”¨äºæ•°æ®ç§‘å­¦é¢†åŸŸï¼Œæ•´ä¸ªç¯å¢ƒå®‰è£…èµ·æ¥å°±æ¯”è¾ƒé‡ï¼Œç¯å¢ƒåˆå§‹æ—¶å°±è‡ªå¸¦äº†å¾ˆå¤šä¾èµ–ï¼Œå¾ˆå¤šä¾èµ–æ˜¯æ™®é€šé¡¹ç›®ä¸éœ€è¦çš„ã€‚æ­¤å¤–ï¼Œconda ä¸‹è½½ä¾èµ–çš„é€Ÿåº¦ä¹Ÿä¼šæ…¢ä¸€äº›ã€‚\n\n2. conda çš„åŒ…ä¸ pip å®‰è£…çš„åŒ…ä¸ä¸€æ ·ï¼Œconda åŒ…æ˜¯äºŒè¿›åˆ¶æ ¼å¼çš„ï¼Œé™¤äº†æ•°æ®ç§‘å­¦é¢†åŸŸï¼Œå¾ˆå¤š python åº“éƒ½ä¼šåœ¨ PyPI ä¸Šå‘å¸ƒï¼Œä½†ä¸ä¼šåœ¨ Anaconda repository ä¸Šå‘å¸ƒ\n\næ‰€ä»¥ä»¥ä¸Šä¸¤ç‚¹å°±é™åˆ¶äº† conda çš„åº”ç”¨é¢†åŸŸï¼Œé™¤äº†æ•°æ®ç§‘å­¦é¢†åŸŸï¼Œconda å°±åªèƒ½ä½œä¸ºä¸€ä¸ªç¯å¢ƒç®¡ç†çš„å·¥å…·ã€‚é‚£å¯¹äºä½¿ç”¨ conda æ¥ç®¡ç†ç¯å¢ƒçš„æƒ…å†µï¼Œpip ä¸€èˆ¬ä¹Ÿæ˜¯ä¸å¯æˆ–ç¼ºçš„ï¼Œä½¿ç”¨æ—¶çš„æ³¨æ„ç‚¹åŒä¸Šé¢çš„`venv+pip`\n\n## poetryï¼ˆæ¨èï¼‰\n\n> ä»¥ä¸‹ä»£ç åœ°å€: [https://github.com/robocanic/poetry-fastapi-demo.git](https://github.com/robocanic/poetry-fastapi-demo.git)\n\nä¸Šé¢ä¸¤ç§ç¯å¢ƒä¸ä¾èµ–ç®¡ç†çš„æ–¹å¼éƒ½æœ‰ä¸€ä¸ªæ¯”è¾ƒæ£˜æ‰‹çš„ç‚¹æ— æ³•è§£å†³ï¼Œé‚£å°±æ˜¯ pip å¸è½½ä¾èµ–æ—¶æ— æ³•åˆ é™¤å¼•å…¥çš„é—´æ¥ä¾èµ–ï¼Œè¿™å¾ˆå¯èƒ½ä¼šå¯¼è‡´**ä¾èµ–è‡ƒè‚¿ï¼Œä¾èµ–å†²çª**ç­‰é—®é¢˜ã€‚\n\npoetry æ˜¯ä¸€ä¸ª python ä¾èµ–ç®¡ç†ä¸ç¯å¢ƒç®¡ç†çš„å·¥å…·ï¼Œå®ƒèƒ½å¤Ÿåˆ†æå‡ºå“ªäº›æ˜¯ç›´æ¥ä¾èµ–ï¼Œå“ªäº›æ˜¯é—´æ¥ä¾èµ–ï¼Œåœ¨åˆ é™¤ä¾èµ–æ—¶èƒ½å¤Ÿåˆ æ‰æ— ç”¨çš„é—´æ¥ä¾èµ–ï¼Œä¿æŒé¡¹ç›®ä¾èµ–çš„æ¸…çˆ½ã€‚æ­¤å¤–ï¼Œpoetry è¿˜æœ‰æŒ‡å®šæ¨¡ç³Šä¾èµ–ï¼Œä¾èµ–å¿«é€Ÿå‡çº§ç­‰å®ç”¨çš„åŠŸèƒ½ï¼Œè¿™è®©å®ƒåœ¨ä¾èµ–ç®¡ç†æ–¹é¢ç›´æ¥ç”©äº† pip å¥½å‡ æ¡è¡—ã€‚è‡³äºç¯å¢ƒç®¡ç†ï¼Œpoetry åˆ™æ˜¯åœ¨ virtualenv çš„åŸºç¡€ä¸Šï¼Œå¢å¼ºäº†ä¸€äº›åŠŸèƒ½ï¼Œå¦‚è‡ªåŠ¨åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼Œé›†ä¸­/åˆ†ç¦»çš„ç¯å¢ƒç®¡ç†ç­‰ç­‰ã€‚\n\npoetry çš„å‘½ä»¤ä¼šç›¸å¯¹å¤šä¸€äº›ï¼Œä½†å¸¸ç”¨çš„ä¹Ÿåªæœ‰å‡ ä¸ªï¼Œä¸‹é¢ä»å»ºç«‹ä¸€ä¸ªæ–°é¡¹ç›®çš„æµç¨‹æ¥ç†Ÿæ‚‰ä¸€ä¸‹å¦‚ä½•ä½¿ç”¨ poetryï¼š\n\n#### åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ\n\nåœ¨åˆ›å»ºæ–‡ä»¶å¤¹åï¼Œæ‰§è¡Œ`poetry init`ï¼Œä¼šæœ‰ä¸€ç³»åˆ—äº’åŠ¨çš„ command æ¥å¼•å¯¼ä½ åˆ›å»º`pyproject.toml`:\n\n```YAML\nÂ PS D:\\code\\python-projects\\poetry-fastapi-demo>poetry init\nÂ â€‹\nÂ This command will guide you through creating your pyproject.toml config.\nÂ â€‹\nÂ Package name [poetry-fastapi-demo]: Â \nÂ Version [0.1.0]: Â \nÂ Description []:  A web project template using poetry and fastapi.\nÂ Author [robocanic <robocanic@example.com>, n to skip]: Â \nÂ License []:  Apache 2.0\nÂ Compatible Python versions [^3.11]:  ~3.10\nÂ â€‹\nÂ Would you like to define your main dependencies interactively? (yes/no) [yes] no\nÂ Would you like to define your development dependencies interactively? (yes/no) [yes] no\nÂ Generated file\nÂ â€‹\nÂ [tool.poetry]\nÂ name = \"poetry-fastapi-demo\"\nÂ version = \"0.1.0\"\nÂ description = \"A web project template using poetry and fastapi.\"\nÂ authors = [\"robocanic <robocanic@example.com>\"]\nÂ license = \"Apache 2.0\"\nÂ readme = \"README.md\"\nÂ â€‹\nÂ [tool.poetry.dependencies]\nÂ python = \"~3.10\"\nÂ â€‹\nÂ â€‹\nÂ [build-system]\nÂ requires = [\"poetry-core\"]\nÂ build-backend = \"poetry.core.masonry.api\"\nÂ â€‹\nÂ â€‹\nÂ Do you confirm generation? (yes/no) [yes]\n```\n\nè¿™é‡Œä½ åœ¨å‘½ä»¤è¡Œè¾“å…¥çš„åœ¨åé¢éƒ½æ˜¯å¯ä»¥é€šè¿‡ä¿®æ”¹`pyproject.toml`æ¥åŒæ­¥çš„ï¼Œå› æ­¤ä¸€èˆ¬æˆ‘ä»¬éƒ½ä¼šå¿«é€Ÿåœ°è·³è¿‡è¿™ä¸ªé˜¶æ®µã€‚ç”Ÿæˆçš„`pyproject.toml`å¦‚ä¸‹æ‰€ç¤ºï¼š\n\n```YAML\nÂ [tool.poetry] #é¡¹ç›®ä¿¡æ¯\nÂ name = \"poetry-fastapi-demo\"\nÂ version = \"0.1.0\"\nÂ description = \"A web project template using poetry and fastapi.\"\nÂ authors = [\"robocanic <robocanic@example.com>\"]\nÂ license = \"Apache 2.0\"\nÂ readme = \"README.md\"\nÂ â€‹\nÂ [tool.poetry.dependencies] Â #ä¸»è¦ä¾èµ–\nÂ python = \"~3.10\"\nÂ â€‹\nÂ â€‹\nÂ [build-system] Â # æ„å»ºå·¥å…·\nÂ requires = [\"poetry-core\"]\nÂ build-backend = \"poetry.core.masonry.api\"\nÂ â€‹\n```\n\nåœ¨åˆ›å»º`pyproject.toml`åï¼Œåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ‰§è¡Œ`poetry env use python`ï¼Œä¼šåˆ›å»ºä¸€ä¸ªè¯¥é¡¹ç›®ä¸“æœ‰çš„è™šæ‹Ÿç¯å¢ƒï¼š\n\n```YAML\nÂ PS D:\\code\\python-projects\\poetry-fastapi-demo> poetry config virtualenvs.in-project true\nÂ PS D:\\code\\python-projects\\poetry-fastapi-demo> poetry env use D:\\env\\python\\python.exe\nÂ Creating virtualenv poetry-fastapi-demo in D:\\code\\python-projects\\poetry-fastapi-demo\\.venv\nÂ Using virtualenv: D:\\code\\python-projects\\poetry-fastapi-demo\\.venv\n```\n\nè¿™é‡Œæˆ‘æŒ‡å®šäº† poetry è™šæ‹Ÿç¯å¢ƒçš„è·¯å¾„æ”¾ç½®åœ¨é¡¹ç›®æ ¹ç›®å½•çš„.venv ç›®å½•ä¸‹ï¼Œæˆ‘è§‰å¾—è¿™æ ·çš„é¡¹ç›®ç»„ç»‡æ–¹å¼æ›´æ¸…æ™°ã€‚`poetry env use python` è¿™ä¸ªå‘½ä»¤é»˜è®¤ä½¿ç”¨ç³»ç»Ÿç¯å¢ƒå˜é‡ä¸­çš„ pythonï¼Œå¦‚æœä½ æƒ³ä½¿ç”¨æŒ‡å®šç‰ˆæœ¬çš„ pythonï¼Œå¯ä»¥å°† python æ¢æˆ`path/to/your/py`ã€‚\n\n#### æ·»åŠ ä¾èµ–\n\næˆ‘ä»¬å¯ä»¥ç¼–è¾‘`pyproject.toml`ï¼Œæ·»åŠ æŒ‡å®šçš„ä¾èµ–ï¼Œå†å…ˆåæ‰§è¡Œ`poetry lock` å’Œ`poetry install`ï¼Œ`poetry lock`ä¼šè§£æ`pyproject.toml`ä¸­çš„ä¸»è¦ä¾èµ–ä¸å¼€å‘ä¾èµ–ä»¥åŠé—´æ¥ä¾èµ–ï¼Œé€‰æ‹©åˆé€‚çš„ä¾èµ–ç‰ˆæœ¬ï¼Œè®°å½•åˆ° poetry.lock è¿™ä¸ªæ–‡ä»¶ä¸­ã€‚poetry.lock çš„ä½œç”¨ç±»ä¼¼äº requirements.txtï¼Œå³â€œé”å®šâ€é¡¹ç›®éœ€è¦çš„ä¾èµ–ï¼ˆåŒ…æ‹¬ç›´æ¥ä¾èµ–å’Œé—´æ¥ä¾èµ–ï¼‰ç‰ˆæœ¬ã€‚ç´§æ¥ç€çš„`poetry install`å°±ä¼šæ ¹æ® poetry.lock ä¸­çš„å†…å®¹å»ä¸‹è½½ç›¸åº”ç‰ˆæœ¬çš„ä¾èµ–ã€‚\n\n```Toml\n[tool.poetry] # é¡¹ç›®ä¿¡æ¯\nname = \"poetry-fastapi-demo\"\nversion = \"0.1.0\"\ndescription = \"A web project template using poetry and fastapi.\"\nauthors = [\"robocanic <robocanic@example.com>\"]\nlicense = \"Apache 2.0\"\nreadme = \"README.md\"\n\n[tool.poetry.dependencies]  # ä¸»è¦ä¾èµ–\npython = \"~3.10\"        # pythonç‰ˆæœ¬>=3.10 ä¸” <3.20\nfastapi = \"^0.115.0\"    # fastapiç‰ˆæœ¬ >=0.115.0 ä¸” <0.116.0\nsqlalchemy = \"^2.0.36\"  # sqlalchemyç‰ˆæœ¬ >=2.0.36 ä¸” < 3.0\npyyaml = \"^6.0.2\"       # pyyamlç‰ˆæœ¬ >=6.0.2 ä¸” < 7.0.0\n\n[tool.poetry.group.dev.dependencies]  # å¼€å‘ä¾èµ–\npytest = \"^8.3.3\"       # pytestç‰ˆæœ¬ >=8.3.3 ä¸” < 9.0.0\n\n[build-system]  # æ„å»ºå·¥å…·\nrequires = [\"poetry-core\"]\nbuild-backend = \"poetry.core.masonry.api\"\n\n```\n\næˆ‘ä»¬å¯ä»¥æŒ‡å®šä¸»è¦ä¾èµ–å’Œå¼€å‘ä¾èµ–ï¼Œåœ¨å‘å¸ƒéƒ¨ç½²æ—¶åªæ‰“åŒ…ä¸»è¦ä¾èµ–ï¼Œè¿™æ ·å°±å¯ä»¥å‡å°åŒ…çš„ä½“ç§¯ã€‚åŒæ—¶æˆ‘ä»¬å¯ä»¥æŒ‡å®šä¾èµ–çš„ç‰ˆæœ¬èŒƒå›´ï¼Œä¸åŒçš„ç¬¦å·æœ‰ä¸åŒçš„æŒ‡å®šèŒƒå›´ç­–ç•¥ï¼Œè¿™ä¸€å—å¯ä»¥å‚è€ƒ poetry å®˜æ–¹æ–‡æ¡£ï¼š[https://python-poetry.org/docs/dependency-specification/](https://python-poetry.org/docs/dependency-specification/)\n\næ­¤å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨å‘½ä»¤è¡Œ`poetry add deps`æ¥ä¸‹è½½åŒ…ï¼Œè¿™ä¸ªå‘½ä»¤ä¼šè‡ªåŠ¨åœ°æ›´æ–°`pyproject.toml`ä»¥åŠ`poetry.lock`æ–‡ä»¶ï¼Œä¿è¯ç¯å¢ƒä¸­çš„ä¾èµ–ä¸`pyproject.toml`ä¸­çš„çš„ä¾èµ–çš„ä¸€è‡´æ€§ã€‚\n\n#### åˆ é™¤ä¾èµ–\n\næˆ‘ä»¬å¯ä»¥é€šè¿‡ç¼–è¾‘`pyproject.toml`ï¼Œåˆ é™¤å¯¹åº”çš„ä¾èµ–å£°æ˜ï¼Œç„¶åæ‰§è¡Œ`poetry lock` å³å¯ï¼Œpoetry ä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬æŠŠä¾èµ–åˆ é™¤ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨`poetry remove deps`æ¥åˆ é™¤ä¾èµ–ã€‚\n\npoetry çš„è¿™ä¸¤ç§åˆ é™¤æ–¹å¼éƒ½ä¼šè§£æ`deps`çš„æ— ç”¨çš„é—´æ¥ä¾èµ–ï¼Œå°†å…¶ä¸€å¹¶åˆ é™¤ã€‚\n\n#### åˆ é™¤è™šæ‹Ÿç¯å¢ƒ\n\næ‰§è¡Œ`poetry env remove poetry-demo`ï¼Œå³å¯åˆ é™¤è™šæ‹Ÿç¯å¢ƒã€‚\n\n> å¦‚æœåœ¨ poetry çš„é…ç½®ä¸­æŒ‡å®šäº†`poetry config virtualenvs.in-project true`ï¼Œè™šæ‹Ÿç¯å¢ƒç»´æŠ¤çš„ç›®å½•å°±ä¼šæ”¾åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹ã€‚ç±»ä¼¼äº venv çš„æ–¹å¼ï¼Œå› æ­¤è¿™ç§æƒ…å†µä¸‹åˆ é™¤.venv æ–‡ä»¶å¤¹å°±ç­‰åŒäºåˆ é™¤è™šæ‹Ÿç¯å¢ƒ\n\n#### æŸ¥çœ‹ä¾èµ–æ ‘\n\npoetry ä¸­å¾ˆå®ç”¨çš„ä¸€ä¸ªåŠŸèƒ½æ˜¯å®ƒå¯ä»¥ä½¿ç”¨`poetry show --tree`æ¥æŸ¥çœ‹ä¾èµ–å…³ç³»ï¼Œä»è€Œåœ¨ä¾èµ–é”™è¯¯æ—¶èƒ½å¤Ÿæ›´å¥½åœ°å®šä½å¼‚å¸¸ï¼Œæ›´å¿«é€Ÿåœ°è§£å†³é—®é¢˜ã€‚\n\n![poetry-show--tree](https://image.robocanic.com/notes/image-20241104154436296.png)\n\n#### å¯¼å‡ºä¾èµ–\n\nç†è®ºä¸Šæ¥è¯´ï¼Œæœ‰äº† poetry ä¸å†éœ€è¦ pip äº†ï¼Œè‡ªç„¶ä¹Ÿä¸éœ€è¦ requirements.txt äº†ï¼Œä½†æ˜¯åœ¨åé¢çš„é¡¹ç›®å‘å¸ƒç®¡ç†ä¸­æˆ‘ä»¬ä¼šæåˆ°ï¼Œå½“ä½¿ç”¨å®¹å™¨åŒ–éƒ¨ç½²æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›æˆ‘ä»¬çš„é•œåƒå°½å¯èƒ½åœ°ç²¾ç®€ï¼Œæˆ‘ä»¬çš„é¡¹ç›®éƒ¨ç½²èƒ½å°½å¯èƒ½å¿«é€Ÿã€‚ä»ç²¾ç®€é•œåƒè¿™ä¸ªè§’åº¦æ¥çœ‹ï¼Œpoetry å¯¹äºæˆ‘ä»¬çš„é¡¹ç›®è€Œè¨€åªæ˜¯å¼€å‘æ—¶ä¾èµ–ï¼Œåœ¨è¿è¡Œæ—¶æˆ‘ä»¬å¸Œæœ›åªç”¨æœ€ç®€å•çš„ä¾èµ–å°±èƒ½æŠŠé¡¹ç›®è·‘èµ·æ¥ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦å°† poetry.lock ä¸­çš„ä¾èµ–è½¬åŒ–ä¸º requirements.txtï¼Œè¿™æ ·éƒ¨ç½²æ—¶ä½¿ç”¨`pip install -r requirements.txt`ä¸‹å®Œä¾èµ–ä¹‹åç›´æ¥å°±èƒ½ run èµ·æ¥é¡¹ç›®ã€‚\n\npoetry æœ¬èº«ä¹Ÿæ”¯æŒå¯¼å‡ºç¯å¢ƒå†…çš„ä¾èµ–ï¼Œä½¿ç”¨`poetry export -f requirements.txt -o requirements.txt`å°±å¯ä»¥å°†ç¯å¢ƒä¸­çš„æ‰€æœ‰ä¾èµ–å¯¼å‡ºåˆ° requirements.txt ä¸­ã€‚\n\n#### æ€»ç»“\n\npoetry ä½œä¸ºç¯å¢ƒç®¡ç†ä¸ä¾èµ–ç®¡ç†åˆäºŒä¸ºä¸€çš„é“¶å¼¹ï¼Œåœ¨ä½“éªŒä¸‹æ¥ï¼Œé™¤äº†æ•°æ®ç§‘å­¦/AI é¢†åŸŸçš„é¡¹ç›®ï¼Œæˆ‘è®¤ä¸º poetry æ˜¯å¼€å‘å¤§å¤šæ•° python é¡¹ç›®çš„æœ€ä½³ç¯å¢ƒä¸ä¾èµ–çš„ç®¡ç†æ–¹å¼ã€‚\n\n# é¡¹ç›®æ—¥å¿—\n\n> ä»¥ä¸‹ä»£ç åœ°å€: [https://github.com/robocanic/poetry-fastapi-demo.git](https://github.com/robocanic/poetry-fastapi-demo.git)\n\n## ç›®æ ‡\n\næ—¥å¿—çš„é‡è¦æ€§ä¸è¨€è€Œå–»ï¼Œæˆ‘ä»¬è¿™é‡Œæ¢è®¨çš„â€œé¡¹ç›®æ—¥å¿—â€ï¼Œæ›´å‡†ç¡®åœ°æ¥è¯´æ˜¯æ€ä¹ˆä½¿ç”¨æ—¥å¿—èƒ½å¤Ÿå¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„æ•ˆæœã€‚é€šå¸¸ï¼Œæˆ‘ä»¬å¯¹äºæ—¥å¿—ä¼šæœ‰ä¸€äº›è¦æ±‚ï¼š\n\n1. æˆ‘ä»¬å¸Œæœ›æˆ‘ä»¬çš„æ—¥å¿—èƒ½å¤Ÿæ˜¾ç¤ºå‡ºæ—¥å¿—æ—¶é—´ï¼Œæ—¥å¿—ç­‰çº§(INFO, WARN, ERROR .....)ï¼Œæ—¥å¿—å†…å®¹ï¼Œæ‰€åœ¨çº¿ç¨‹ï¼Œæ˜¯ç”±å“ªä¸ªç»„ä»¶/py æ–‡ä»¶æ‰“å°çš„......\n\n2. å¯¹äºä»¥ä¸Šæ—¥å¿—ä¿¡æ¯ï¼Œä¸ç®¡æ˜¯è‡ªå·±é¡¹ç›®ä¸­çš„è¿˜æ˜¯ä¾èµ–åŒ…ä¸­çš„ï¼Œéƒ½æœ‰ä¸€ä¸ªç»Ÿä¸€çš„æ ¼å¼æ‰“å°å‡ºæ¥\n\n3. ä¸ä»…è¦åœ¨æ§åˆ¶å°æ‰“å°ï¼Œè¿˜éœ€è¦ä¿å­˜åˆ°æ–‡ä»¶ä¸­ï¼Œä»¥ä¾¿åç»­æ’æŸ¥é”™è¯¯æ—¶èƒ½å¤Ÿè¿½æº¯ã€‚\n\n4. æ›´è¿›ä¸€æ­¥ï¼Œæˆ‘ä»¬å¸Œæœ› ERROR çº§åˆ«çš„æ—¥å¿—èƒ½å¤Ÿå•ç‹¬æ”¾åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œæ¯å¤©çš„æ—¥å¿—æŒ‰ç…§æ—¥æœŸåšä¸€ä¸ªåˆ‡å‰²åˆ†å—......\n\n## åŸç†\n\nåœ¨é˜æ˜æ—¥å¿—éœ€è¦è¾¾åˆ°çš„æ•ˆæœä¹‹åï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ python ä¸­çš„ logging æ¨¡å—ï¼Œè¿™ä¸ªæ¨¡å—æ˜¯ python è‡ªå¸¦çš„ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆæ¥è¯•ç”¨ä¸€ä¸‹ï¼š\n\n```Python\nimport logging\nlogging.info(\"this is a info log\")\nlogging.warning(\"this is a warning log\")\nlogging.error(\"this is a error log\")\nlogging.critical(\"this is a critical log\")\n\"\"\"\noutput:\nWARNING:root:this is a warning log\nERROR:root:this is a error log\nCRITICAL:root:this is a critical log\n\"\"\"\n```\n\nè¿è¡Œè¿™ä¸ª python æ–‡ä»¶ä¼šå‘ç°æ§åˆ¶å°å¹¶æ²¡æœ‰æ‰“å°å‡º info çº§åˆ«çš„æ—¥å¿—ï¼Œè¿™æ˜¯å› ä¸º logging æ¨¡å—æä¾›çš„æ—¥å¿—è®°å½•å‡½æ•°æ‰€ä½¿ç”¨çš„æ—¥å¿—å™¨è®¾ç½®çš„æ—¥å¿—çº§åˆ«æ˜¯`WARNING`ï¼Œå› æ­¤åªæœ‰`WARNING`çº§åˆ«çš„æ—¥å¿—è®°å½•ä»¥åŠå¤§äºå®ƒçš„`ERROR`å’Œ`CRITICAL`çº§åˆ«çš„æ—¥å¿—è®°å½•è¢«è¾“å‡ºäº†ï¼Œè€Œå°äºå®ƒçš„`INFO`çº§åˆ«çš„æ—¥å¿—è®°å½•è¢«ä¸¢å¼ƒäº†ã€‚\n\næˆ‘ä»¬å¯ä»¥è§‚å¯Ÿæ¯æ¡æ—¥å¿—ï¼Œæ¯ä¸ªæ—¥å¿—éƒ½ç”±ä¸‰éƒ¨åˆ†æ„æˆï¼š`æ—¥å¿—çº§åˆ«:æ—¥å¿—å™¨åç§°:æ—¥å¿—å†…å®¹`ï¼Œè¿™æ˜¯å› ä¸º logging æ¨¡å—æä¾›çš„æ—¥å¿—è®°å½•å‡½æ•°æ‰€ä½¿ç”¨çš„æ—¥å¿—å™¨è®¾ç½®çš„æ—¥å¿—æ ¼å¼é»˜è®¤ä¸º`%(levelname)s:%(name)s:%(message)s`ã€‚\n\né‚£è‡ªç„¶æˆ‘ä»¬ä¼šæƒ³åˆ°ï¼Œå¯ä¸å¯ä»¥é€šè¿‡è®¾ç½® logging çš„æ—¥å¿—çº§åˆ«ä¸æ—¥å¿—æ ¼å¼ï¼Œæ¥ç”Ÿæˆæˆ‘ä»¬æƒ³è¦çš„æ—¥å¿—æ ¼å¼ï¼Ÿè¿›ä¸€æ­¥ï¼Œæˆ‘ä»¬å¯ä¸å¯ä»¥è°ƒæ•´æ—¥å¿—è¾“å‡ºçš„ä½ç½®ï¼ŒåŒæ—¶è¾“å‡ºåœ¨æ§åˆ¶å°å’Œæ–‡ä»¶ï¼Ÿ\n\nåœ¨å›ç­”è¿™ä¸ªé—®é¢˜ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥æ¥å…ˆç®€å•çœ‹ä¸‹ logging æ¨¡å—æ¶‰åŠåˆ°çš„å››ä¸ªç»„ä»¶\n\n1. æ—¥å¿—å™¨ï¼ˆLoggerï¼‰ï¼Œæä¾›äº†æˆ‘ä»¬çš„ä»£ç å¯ä»¥ä½¿ç”¨çš„æ¥å£ï¼Œå³ log.infoï¼Œlog.warningï¼Œlog.error ç­‰\n\n2. å¤„ç†å™¨ï¼ˆHandlerï¼‰ï¼Œå°† logger åˆ›å»ºçš„æ—¥å¿—è®°å½•å‘é€åˆ°åˆé€‚çš„ç›®çš„è¾“å‡º\n\n3. è¿‡æ»¤å™¨ï¼ˆFilterï¼‰ï¼Œæä¾›äº†æ›´ç»†ç²’åº¦çš„æ§åˆ¶å·¥å…·æ¥å†³å®šè¾“å‡ºå“ªæ¡æ—¥å¿—è®°å½•ï¼Œä¸¢å¼ƒå“ªæ¡æ—¥å¿—è®°å½•\n\n4. æ ¼å¼å™¨ï¼ˆFormatterï¼‰ï¼Œå†³å®šæ—¥å¿—è®°å½•çš„è¾“å‡ºæ ¼å¼\n\nè¿™äº›ç»„ä»¶çš„å…³ç³»å¤§è‡´å¦‚ä¸‹ï¼šæ—¥å¿—å™¨ï¼ˆLoggerï¼‰éœ€è¦é€šè¿‡å¤„ç†å™¨ï¼ˆHandlerï¼‰å°†æ—¥å¿—ä¿¡æ¯è¾“å‡ºåˆ°ç›®æ ‡ä½ç½®ï¼ˆæ–‡ä»¶ï¼Œæ§åˆ¶å°ï¼Œç½‘ç»œç­‰ï¼‰ã€‚è€Œå¤„ç†å™¨ï¼ˆHandlerï¼‰å¯ä»¥è®¾ç½®è¿‡æ»¤å™¨ï¼ˆFilterï¼‰å’Œæ ¼å¼å™¨ï¼ˆFormatterï¼‰æ¥å¯¹æ—¥å¿—è¿›è¡Œè¿‡æ»¤å’Œæ ¼å¼åŒ–ï¼Œå†è¾“å‡ºåˆ°æŒ‡å®šçš„ç›®æ ‡ä½ç½®ã€‚\n\nå› æ­¤ä¸Šé¢çš„é—®é¢˜ä¹Ÿæœ‰äº†ç­”æ¡ˆï¼šé€šè¿‡è°ƒæ•´ Loggerï¼ŒHandlerï¼ŒFilterï¼ŒFormatter çš„è®¾ç½®å’Œç»„åˆå…³ç³»ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„æ—¥å¿—ã€‚\n\næˆ‘ä»¬å¯ä»¥é€šè¿‡ 3 ç§æ–¹å¼æ¥é…ç½® loggingï¼š\n\n1. ä½¿ç”¨ Python ä»£ç æ˜¾å¼çš„åˆ›å»º loggerï¼Œhandleï¼Œfilterï¼Œformatter å¹¶åˆ†åˆ«è°ƒç”¨å®ƒä»¬çš„é…ç½®å‡½æ•°\n\n2. åˆ›å»ºä¸€ä¸ªæ—¥å¿—é…ç½®æ–‡ä»¶ï¼Œç„¶åä½¿ç”¨`fileConfig()`å‡½æ•°æ¥è¯»å–è¯¥æ–‡ä»¶çš„å†…å®¹ï¼›\n\n3. åˆ›å»ºä¸€ä¸ªåŒ…å«é…ç½®ä¿¡æ¯çš„ dictï¼Œç„¶åæŠŠå®ƒä¼ é€’ç»™`dictConfig()`å‡½æ•°ï¼›\n\n## å®è·µ\n\nè¿™é‡Œæˆ‘ä»‹ç»ä¸€ä¸‹ç¬¬ä¸‰ç§ï¼Œå…¶ä»–ä¸¤ç§å¯ä»¥è‡ªè¡Œç ”ç©¶ã€‚ç¬¬ä¸‰ç§æˆ‘ä»¬é€šå¸¸ä¼šç”¨ä¸€ä¸ª yaml/json æ–‡ä»¶æ¥æè¿°é…ç½®ï¼Œç„¶åä½¿ç”¨`yaml.load`è¯»å–æ—¥å¿—é…ç½®æ–‡ä»¶ï¼Œè½¬åŒ–æˆ dictï¼Œè¿›è€Œä¼ é€’ç»™`dictConfig()`ï¼Œå®Œæˆ logging çš„é…ç½®ã€‚\n\nyaml å½¢å¼çš„æ—¥å¿—é…ç½®å¦‚ä¸‹ï¼š\n\n```YAML\nversion: 1\nformatters:  # å®šä¹‰æ ¼å¼å™¨\n  default:   # æ ¼å¼å™¨å\n    format: '%(asctime)s - %(name)s - %(levelname)s -%(threadName)s%(thread)d - %(message)s'  # æ—¥å¿—æ ¼å¼ï¼šæ—¶é—´ - æ—¥å¿—å™¨å - æ—¥å¿—ç­‰çº§ - çº¿ç¨‹å çº¿ç¨‹ID - æ—¥å¿—å†…å®¹\n    datefmt: '%Y-%m-%d %H:%M:%S'   # æ—¶é—´æ ¼å¼\n    use_colors: true   # ä½¿ç”¨é¢œè‰²\nhandlers:     # å®šä¹‰å¤„ç†å™¨\n  console:    # å¤„ç†å™¨å\n    class: logging.StreamHandler  # ä½¿ç”¨çš„handler\n    level: INFO    # æ—¥å¿—ç­‰çº§\n    formatter: default  # ä½¿ç”¨çš„formatteråå­—\n    stream: ext://sys.stdout  # è¾“å‡ºåˆ°æ§åˆ¶å°\n  file:\n    class: logging.FileHandler\n    level: INFO\n    formatter: default\n    filename: app.log   # è¾“å‡ºåˆ°app.log\nloggers:         # å®šä¹‰æ—¥å¿—å™¨\n  poetry_fastapi_demo:   # æ—¥å¿—å™¨åç§°\n    level: INFO  # æ—¥å¿—ç­‰çº§\n    handlers:    # ä½¿ç”¨çš„handler\n      - file\n      - console\n    propagate: false   # æ˜¯å¦ä¼ æ’­åˆ°çˆ¶loggerå†å¤„ç†\n  poetry_fastapi_demo.routers:  # poetry_fastapi_demoçš„å­logger\n    level: INFO\n    handlers:\n      - console\n      - file\n    propagate: false   # æ˜¯å¦ä¼ æ’­åˆ°çˆ¶loggerå†å¤„ç†\n  uvicorn:\n    level: INFO\n    handlers:\n      - console\n      - file\n    propagate: false\nroot:            # æ ¹æ—¥å¿—å™¨ï¼Œæ‰€æœ‰æ²¡æœ‰å½’å±çš„æ—¥å¿—éƒ½ä¼šç”±rootæ¥å¤„ç†\n  level: INFO\n  handlers:\n    - console\n    - file\n```\n\nå…¶ä¸­ï¼Œlogger æ˜¯æœ‰å±‚çº§ç»“æ„çš„ï¼Œlogger çš„åç§°æ˜¯ä¸€ä¸ªä»¥'.'åˆ†å‰²çš„ç»“æ„ï¼Œæ¯ä¸ª'.'åé¢çš„ logger éƒ½æ˜¯'.'å‰é¢çš„ logger çš„ childrenã€‚è€Œ root æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ loggerï¼Œå®ƒä¼šæ•æ‰æ²¡æœ‰è¢«å…¶ä»– logger å¤„ç†çš„æ—¥å¿—æ¶ˆæ¯ï¼Œæˆ‘ä»¬ä¾èµ–çš„ä¸‰æ–¹åŒ…æ‰“å°çš„æ—¥å¿—å¤§éƒ¨åˆ†éƒ½ä¼šç”± root logger æ•è·åˆ°è¿›è¡Œå¤„ç†ï¼Œå› æ­¤ root æ˜¯å¾ˆé‡è¦çš„å…œåº• loggerã€‚\n\nåœ¨å®Œå–„å¥½`log.yaml`åï¼Œæˆ‘ä»¬åšä¸€ä¸ªéªŒè¯ï¼Œ`poetry-fastapi-demo`é¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼š\n\n```Plain Text\n poetry-fastapi-demo/\nÂ â”‚\nÂ â”œâ”€â”€ poetry_fastapi_demo/ Â  Â   Â  Â \nÂ â”‚ Â  â”œâ”€â”€ models Â  Â  Â  Â      # æ¨¡å‹\n â”‚   â”‚   â”œâ”€â”€ __init__.py\n |   |   â”œâ”€â”€ user.py\n |   â”œâ”€â”€ routers Â  Â  Â  Â      # è·¯ç”±\n |   |   â”œâ”€â”€ __init__.py\n |   |   â”œâ”€â”€ user.py\n |   â”œâ”€â”€ tables              # å¢åˆ æ”¹æŸ¥\n |   |   â”œâ”€â”€ __init__.py\n |   |   â”œâ”€â”€ user.py\n â”‚ Â  â”œâ”€â”€ __init__.py Â  Â \n â”‚   â””â”€â”€ main.py Â  Â  Â  Â      # ä¸»ç¨‹åºå…¥å£\n```\n\n`poetry_fastapi_demo/__init__.py`çš„å†…å®¹å¦‚ä¸‹ï¼Œè¿™é‡Œæˆ‘ä»¬å°† log.yaml çš„è·¯å¾„ä»¥ç¯å¢ƒå˜é‡ä¼ å…¥ï¼Œç„¶åä½¿ç”¨`.dictConfig`å®Œæˆæ—¥å¿—çš„é…ç½®\n\n```Python\nimport logging.config\nimport os\nimport yaml\n\nlog_conf_path = os.environ.get(\"LOG_CONFIG\")\nwith open(log_conf_path, 'r', encoding='utf-8') as f:\n    dict_conf = yaml.safe_load(f)\nlogging.config.dictConfig(dict_conf)\n\n```\n\n`poetry_fastapi_demo/routers/user.py`çš„å†…å®¹å¦‚ä¸‹\n\n```Python\nimport logging\n\nfrom fastapi import APIRouter\n\nfrom poetry_fastapi_demo.models import User\nfrom poetry_fastapi_demo.tables import user_table\n\nlog = logging.getLogger(__name__)\nrouter = APIRouter()\n\n\n@router.get(\"\")\ndef get_all_users():\n    return user_table.get_all_users()\n\n\n@router.get(\"/{user_id}\")\ndef get_user(user_id: int):\n    return user_table.get_user_by_id(user_id)\n\n\n@router.post(\"\")\ndef create_user(user: User):\n    log.info(f\"Creating user: {user}\")\n    return user_table.add_user(user)\n\n\n@router.delete(\"/{user_id}\")\ndef delete_user(user_id: int):\n    log.warning(f\"Deleting user with id: {user_id}\")\n    return user_table.delete_user(user_id)\n\n\n@router.put(\"\")\ndef update_user(user: User):\n    log.warning(f\"Updating user: {user}\")\n    return user_table.update_user(user)\n\n```\n\nè¿è¡Œ main.pyï¼ˆè®°å¾—è®¾ç½®ç¯å¢ƒå˜é‡ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ§åˆ¶å°ä¸­çœ‹åˆ°æ—¥å¿—è¾“å‡ºï¼ŒåŒæ—¶åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹ä¹Ÿä¼šç”Ÿæˆ app.log æ—¥å¿—æ–‡ä»¶ï¼Œè®°å½•è¿è¡Œçš„æ—¥å¿—ã€‚\n\n![app-log](https://image.robocanic.com/notes/app-log.png)\n\næˆ‘ä»¬å‘èµ·ä¸€ä¸ªæ–°å¢ user çš„è¯·æ±‚ï¼š\n\n```Shell\ncurl --request POST \\\n  --url http://localhost:8080/api/v1/user \\\n  --header 'content-type: application/json' \\\n  --data '{\n  \"id\": 6,\n  \"name\": \"robb\",\n  \"email\": \"robocanic@gmail.com\",\n \"password\": \"xclkjva\",\n  \"role\": \"user\"\n}'\n```\n\næˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ—¥å¿—æ˜¾ç¤ºå¦‚ä¸‹ï¼š\n\n![create-user-log](https://image.robocanic.com/notes/create-user-log.png)\n\nåˆ°è¿™ï¼ŒåŸºæœ¬çš„æ—¥å¿—éœ€æ±‚å°±æ»¡è¶³äº†ï¼Œæˆ‘ä»¬æ— éœ€è°ƒæ•´ä»£ç ï¼Œä»…é€šè¿‡è°ƒæ•´é…ç½®æ–‡ä»¶å°±èƒ½é€‚æ—¶è°ƒæ•´æ—¥å¿—ã€‚é‚£å¯¹äºç›®æ ‡ä¸­çš„ç¬¬ 4 ç‚¹â€œæˆ‘ä»¬å¸Œæœ› ERROR çº§åˆ«çš„æ—¥å¿—èƒ½å¤Ÿå•ç‹¬æ”¾åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œæ¯å¤©çš„æ—¥å¿—æŒ‰ç…§æ—¥æœŸåšä¸€ä¸ªåˆ‡å‰²åˆ†å—â€ï¼Œç›¸ä¿¡ä½ å¯ä»¥ä¸¾ä¸€åä¸‰\n\n# é¡¹ç›®æµ‹è¯•\n\n> ä»¥ä¸‹ä»£ç åœ°å€: [https://github.com/robocanic/poetry-fastapi-demo.git](https://github.com/robocanic/poetry-fastapi-demo.git)\n\nä¸€ä¸ªé¡¹ç›®å¯é çš„é¡¹ç›®ç¦»ä¸å¼€å®Œå¤‡çš„æµ‹è¯•ï¼Œæµ‹è¯•ä¸€èˆ¬åˆ†ä¸ºå•å…ƒæµ‹è¯•å’Œæ¥å£æµ‹è¯•ï¼Œå•æµ‹é’ˆå¯¹æŸä¸ªå‡½æ•°æˆ–è€…æŸä¸ªæ¨¡å—ï¼Œæµ‹è¯•è¿”å›çš„å‚æ•°æ˜¯å¦ç¬¦åˆé¢„æœŸï¼Œè€Œæ¥å£æµ‹è¯•æ˜¯é’ˆå¯¹äº HTTPï¼ˆRPCï¼‰æ¥å£ï¼Œæµ‹è¯•çš„æ˜¯æŸä¸€å—åŠŸèƒ½çš„å®Œå¤‡æ€§ã€‚\n\nè¿™é‡Œæˆ‘ä»¬è®¨è®ºçš„ä»…é™äºå•å…ƒæµ‹è¯•ã€‚åœ¨ python ä¸­ï¼Œå•å…ƒæµ‹è¯•å¯ä»¥ä½¿ç”¨ unittest æ¨¡å—å’Œ pytestï¼Œuninttest æ˜¯ python è‡ªå¸¦çš„æµ‹è¯•æ¨¡å—ï¼Œè€Œ pytest æ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹æ¨¡å—ï¼Œåœ¨å…¼å®¹ unittest çš„åŸºç¡€ä¸Šï¼Œå¢åŠ äº†é›†æˆæµ‹è¯•çš„åŠŸèƒ½ï¼Œæ–¹ä¾¿æˆ‘ä»¬è¿›è¡Œæ‰¹é‡çš„å•å…ƒæµ‹è¯•ï¼Œä¸ CI è¿›è¡Œç»“åˆã€‚å› æ­¤åæ–‡ä¸­ä½¿ç”¨ pytest æ¥è¿›è¡Œè®²è§£ã€‚\n\npytest å¯ä»¥è‡ªåŠ¨é€’å½’æŒ‡å®šè·¯å¾„ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼Œåªè¦ç¬¦åˆ`test_`æˆ–è€…`_test`å¼€å¤´çš„ py æ–‡ä»¶éƒ½ä¼šè¢«è¯†åˆ«ä¸ºæµ‹è¯•ç”¨ä¾‹æ–‡ä»¶ã€‚éƒ½ä¼šåœ¨æµ‹è¯•è®¡åˆ’ä¸­æ‰§è¡Œã€‚\n\n## å®è·µ\n\nåœ¨ä½¿ç”¨ pytest ä¹‹å‰éœ€è¦ä½¿ç”¨ pip æˆ–è€… poetry ä¸‹è½½ï¼Œæˆ‘ä»¬å¯ä»¥å°† pytest ä¸‹è½½åˆ°`dev`åˆ†ç»„çš„ä¾èµ–ï¼Œä¹Ÿå°±æ˜¯å¼€å‘æ—¶ä¾èµ–ï¼ˆå¦‚`poetry add pytest --group dev`ï¼‰ï¼Œä»¥ä¾¿ç”Ÿäº§éƒ¨ç½²æ—¶ç²¾ç®€æ‰å¼€å‘æ—¶ä¾èµ–ã€‚\n\né¡¹ç›®ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š\n\n```Plain Text\n poetry-fastapi-demo/\nÂ â”‚\nÂ â”œâ”€â”€ poetry_fastapi_demo/ Â  # ç¨‹åºä¸»åŒ… Â  Â \nÂ â”‚ Â  â”œâ”€â”€ models/ Â  Â  Â  Â      # æ¨¡å‹\n â”‚   â”‚   â”œâ”€â”€ __init__.py\n |   |   â”œâ”€â”€ user.py\n |   â”œâ”€â”€ routers/ Â  Â  Â  Â      # è·¯ç”±\n |   |   â”œâ”€â”€ __init__.py\n |   |   â”œâ”€â”€ user.py\n |   â”œâ”€â”€ tables/              # å¢åˆ æ”¹æŸ¥\n |   |   â”œâ”€â”€ __init__.py\n |   |   â”œâ”€â”€ user.py\n â”‚ Â  â”œâ”€â”€ __init__.py Â  Â \n â”‚   â””â”€â”€ main.py Â  Â  Â  Â      # ä¸»ç¨‹åºå…¥å£\n â”œâ”€â”€ tests/                  # æµ‹è¯•æ–‡ä»¶\n |   â”œâ”€â”€ test_user_table.py Â  Â # æ¨¡å‹\n ......\n```\n\nå…¶ä¸­ï¼Œ`poetry_fastapi_demo/tables/user.py`å†…å®¹å¦‚ä¸‹ï¼š\n\n```Python\nfrom typing import Optional, List\n\nfrom poetry_fastapi_demo.models import User\n\nuser_list = [\n    User(\n        id=1,\n        name=\"Chris\",\n        email=\"chris@gmail.com\",\n        password=\"pso3sd5xv\",\n        role=\"admin\"\n    ),\n    User(\n        id=2,\n        name=\"Jon\",\n        email=\"jon@gmail.com\",\n        password=\"rthdfwe5sdf\",\n        role=\"user\"\n    ),\n    User(\n        id=3,\n        name=\"Arya\",\n        email=\"arya@gmail.com\",\n        password=\"ndddrwe42\",\n        role=\"user\"\n    )\n\n]\n\n\nclass UserTable:\n\n    def get_all_users(self) -> List[User]:\n        return user_list\n\n    def get_user_by_id(self, user_id: int) -> Optional[User]:\n        for user in user_list:\n            if user.id == user_id:\n                return user\n        return None\n\n    def update_user(self, user: User) -> bool:\n        for u in user_list:\n            if u.id == user.id:\n                u.name = user.name\n                u.email = user.email\n                u.password = user.password\n                u.role = user.role\n                return True\n        return False\n\n    def delete_user(self, user_id: int) -> bool:\n        for i, u in enumerate(user_list):\n            if u.id == user_id:\n                del user_list[i]\n                return True\n        return False\n\n    def add_user(self, user: User) -> bool:\n        for u in user_list:\n            if u.id == user.id:\n                return False\n        user_list.append(user)\n        return True\n\n\nuser_table = UserTable()\n\n```\n\næµ‹è¯•æ¡ˆä¾‹`test_user_table.py`å†…å®¹å¦‚ä¸‹ï¼š\n\n```Python\nfrom poetry_fastapi_demo.models import User\nfrom poetry_fastapi_demo.tables import user_table\n\n\nclass TestUserTable:\n\n    def test_get_all(self):\n        user_table.get_all_users()\n\n    def test_get_by_id(self):\n        user = user_table.get_user_by_id(1)\n        assert user.name == \"Chris\"\n\n    def test_update_user(self):\n        user = user_table.get_user_by_id(1)\n        user.name = \"Chris2\"\n        assert user_table.update_user(user) is True\n        assert user_table.get_user_by_id(1).name == \"Chris\"   # æ•…æ„å†™é”™\n\n    def test_delete_user(self):\n        assert user_table.delete_user(1) is True\n        assert user_table.get_user_by_id(1) is None\n\n    def test_add_user(self):\n        result = user_table.add_user(User(\n            id=4,\n            name=\"robb\",\n            email=\"robb@gmail.com\",\n            password=\"loqjwnd[as;\",\n            role=\"admin\"\n        ))\n        assert result is True\n        assert user_table.get_user_by_id(4).name == \"robb\"\n\n\n\n```\n\nç„¶åæˆ‘ä»¬åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ`pytest tests/ -v`ï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š\n\n![py-test](https://image.robocanic.com/notes/py-test.png)\n\npytest ä¼šé€’å½’åœ°åœ¨ tests æ–‡ä»¶å¤¹ä¸‹å¯»æ‰¾ä»¥`test_`æˆ–`_test`å¼€å¤´çš„ py æ–‡ä»¶ï¼Œåœ¨ py æ–‡ä»¶ä¸­ï¼Œä¼šå¯»æ‰¾ä»¥`test_`æˆ–`_test`å¼€å¤´çš„å‡½æ•°æˆ–è€…ç±»ï¼Œå¯¹äºæˆ‘ä»¬è¿™ä¸ªæ¡ˆä¾‹æ¥è¯´ï¼Œä¸€å…±æœ‰ 5 ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œåœ¨è¾“å‡ºä¸­æˆ‘ä»¬ä¹Ÿèƒ½è¯¦ç»†åœ°æŸ¥çœ‹åˆ°é€šè¿‡å’Œå¤±è´¥çš„å…·ä½“ç”¨ä¾‹ï¼Œé”™è¯¯çš„åŸå› ï¼Œæ‰§è¡Œçš„æ—¶é—´ç­‰ç­‰ã€‚æ­¤å¤–ï¼Œpytest è¿˜æœ‰å…¶ä»–çš„åŠŸèƒ½ï¼ˆå¯å‚è€ƒ[https://learning-pytest.readthedocs.io/zh/latest/index.html](https://learning-pytest.readthedocs.io/zh/latest/index.html)ï¼‰ï¼Œå¦‚æµ‹è¯•å‰å’Œæµ‹è¯•åçš„é¢„å¤„ç†å’Œåå¤„ç†ï¼Œä½¿ç”¨æ’ä»¶ç”Ÿæˆæµ‹è¯•æŠ¥å‘Šç­‰ï¼Œè¿™é‡Œå°±ç®—æŠ›ç –å¼•ç‰ç»™å¤§å®¶ã€‚\n\n## CI é›†æˆ\n\næŒ‰ç…§å¼€å‘æµç¨‹æ¥è¯´ï¼Œæˆ‘ä»¬åœ¨æœ¬åœ°å¼€å‘å¹¶å•æµ‹å®Œåï¼Œä¼šå‘å¸ƒåˆ°æµ‹è¯•ç¯å¢ƒä¸­è¿›è¡Œè¿›ä¸€æ­¥åœ°è°ƒè¯•éªŒè¯ã€‚æœ‰æ—¶å€™æˆ‘ä»¬ä¿®æ”¹å®Œä»£ç åå¿˜è®°æ‰§è¡Œå¯¹åº”çš„å•æµ‹å°±æäº¤äº†ï¼Œç„¶ååœ¨è°ƒè¯•ä¸­æ‰å‘ç°äº†é”™è¯¯ï¼Œç„¶ååˆå›ç‚‰é‡é€ ã€‚ä¸ºäº†å°½é‡å‡å°‘ä¿®æ”¹å°é”™è¯¯åå¤å‘å¸ƒçš„æ—¶é—´ï¼Œæˆ‘ä»¬å¯ä»¥å°†è‡ªåŠ¨åŒ–æµ‹è¯•é›†æˆåˆ° gitlab pipelineï¼ˆä½¿ç”¨å‚è€ƒ[https://docs.gitlab.com/ee/ci/pipelines/](https://docs.gitlab.com/ee/ci/pipelines/)ï¼‰æˆ– github actions(ä½¿ç”¨å‚è€ƒ[https://docs.github.com/zh/actions](https://docs.github.com/zh/actions))ã€‚\n\n#### github actions\n\n```YAML\nname: Python ci           # workflowåå­—\n\non:                            # è§¦å‘æ¡ä»¶ï¼Œpushæˆ–mergeåˆ°devä¸­è§¦å‘\n  push:\n    branches: [ \"dev\" ]\n  pull_request:\n    branches: [ \"dev\" ]\n\njobs:\n  build:\n    runs-on: ubuntu-latest    # è·‘åœ¨ubuntuè™šæ‹Ÿæœºä¸Š\n    strategy:                 # æ‰§è¡Œç­–ç•¥\n      fail-fast: false\n      matrix:\n        python-version: [\"3.10\"]\n\n    steps:                    # æ‰§è¡Œæ­¥éª¤\n    - uses: actions/checkout@v4    # ä½¿ç”¨checkoutè¿™ä¸ªå·²æœ‰çš„actionæ¥åˆå§‹åŒ–gitç¯å¢ƒ\n    - name: Set up Python ${{ matrix.python-version }}   # ä½¿ç”¨setup-pythonæ¥åˆå§‹åŒ–pythonç¯å¢ƒ\n      uses: actions/setup-python@v3\n      with:\n        python-version: ${{ matrix.python-version }}     # æŒ‡å®špythonç‰ˆæœ¬\n    - name: Set up Poetry                 # ä½¿ç”¨setup-poetryè¿™ä¸ªå·²æœ‰çš„actionæ¥åˆå§‹åŒ–poetry\n      uses: Gr1N/setup-poetry@v9\n    - name: Install dependencies         # ä½¿ç”¨poetryä¸‹è½½ä¾èµ–ï¼Œå› ä¸ºæ˜¯åœ¨ä¸€ä¸ªå•ç‹¬çš„è™šæ‹Ÿæœº/å®¹å™¨ä¸­ï¼Œæ‰€ä»¥æ— éœ€åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ\n      run: |\n        poetry config virtualenvs.create false\n        poetry lock\n        poetry install --all-extras\n    - name: Test with pytest            # ä½¿ç”¨pytestæ‰§è¡Œé›†æˆæµ‹è¯•\n      env:\n        LOG_CONFIG: ./log.yaml\n      run: |\n        pytest tests/ -v\n```\n\næˆ‘ä»¬æŠŠä¸Šé¢è¿™ä¸ª yml å‘½åä¸º ci.ymlï¼Œå¹¶æ”¾ç½®åœ¨é¡¹ç›®æ ¹ç›®å½•.github/workflows ç›®å½•ä¸‹ï¼Œç„¶å github ä¼šè‡ªåŠ¨æ£€æµ‹åˆ° workflow çš„å­˜åœ¨å¹¶æŒ‰ç…§ yml ä¸­å®šä¹‰çš„æ­¥éª¤ä¾æ¬¡æ‰§è¡Œã€‚ç„¶åæˆ‘ä»¬åœ¨ dev åˆ†æ”¯ push åˆ°è¿œç¨‹ï¼Œç„¶åæˆ‘ä»¬ä¼šåœ¨ actions ä¸­å‘ç°å†å²æ‰§è¡Œ/æ­£åœ¨æ‰§è¡Œçš„ workflowã€‚\n\n![github-action](https://image.robocanic.com/notes/github-action.png)\n\næˆ‘ä»¬ç‚¹è¿›æŸä¸€ä¸ª workflow å¯ä»¥çœ‹åˆ° job çš„æ‰§è¡Œç»“æœæ˜¯æˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼š\n\n![github-workflow-job](https://image.robocanic.com/notes/github-workflow-job.png)\n\nè¿›ä¸€æ­¥ï¼Œæˆ‘ä»¬è¿›å…¥ build è¿™ä¸ª jobï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°é›†æˆæµ‹è¯•çš„ä¿¡æ¯ï¼š\n\n![job-test](https://image.robocanic.com/notes/job-test.png)\n\næ­¤å¤–ï¼Œgithub actions è¿˜å¯ä»¥æ¢ç´¢æ›´å¤šçš„ç©æ³•ï¼Œæ¯”å¦‚ï¼šå½“ job å¤±è´¥äº†å‘é€é‚®ä»¶åˆ°è‡ªå·±çš„é‚®ç®±æç¤ºæµæ°´çº¿å¤±è´¥äº†ï¼Œå½“ job å¤±è´¥äº†å›æ»šåˆ°ä¸Šä¸€ä¸ª commit çš„çŠ¶æ€ç­‰ç­‰ï¼Œè¿™äº›å°±éƒ½ç•™ç»™ä½ å»æ¢ç´¢äº†\n\n#### gitlab pipeline\n\n```YAML\nstages:\n  - automatic_test_dev\n\nautomatic_test_job_dev:   # æˆ‘ä»¬åªåœ¨æµ‹è¯•ç¯å¢ƒæ‰§è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œç”Ÿäº§ç¯å¢ƒä¸ºäº†åŠ å¿«å‘å¸ƒé€Ÿåº¦ï¼Œä¸æ‰§è¡Œæµ‹è¯•\n  image: sunpeek/poetry:py3.10-slim    # ä½¿ç”¨å¸¦poetryçš„pythoné•œåƒ\n  stage: automatic_test_dev\n  only:\n    - dev                 # åªæœ‰devåˆ†æ”¯å‘ç”Ÿå˜åŒ–ï¼ˆmergeæˆ–pushï¼‰æ—¶è§¦å‘\n  tags:                   # åŒ¹é…pythonæ ‡ç­¾çš„runneræ‰è¿è¡Œ\n    - python\n  script:                 # æ‰§è¡Œè„šæœ¬\n    - poetry config virtualenvs.create false  # åœ¨å®¹å™¨ä¸­ï¼Œä¸ç”¨åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ\n    - poetry lock     # é”å®šä¾èµ–ç‰ˆæœ¬\n    - poetry install  # ä¸‹è½½ä¾èµ–\n    - pytest tests/   # æ‰§è¡Œæµ‹è¯•\n```\n\næˆ‘ä»¬å°†è¿™ä¸ª yml æ–‡ä»¶å‘½åä¸º.gitlab-ci.ymlï¼Œç„¶å push åˆ° dev åˆ†æ”¯ï¼Œå°±ä¼šè§¦å‘ pipelineã€‚gitlab pipeline æœ¬è´¨ä¸Šå’Œ github actions æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯å£°æ˜å¼çš„æµæ°´çº¿ï¼Œå› æ­¤è¿™é‡Œå°±ä¸å†èµ˜è¿°ï¼Œä½ å¯ä»¥æŸ¥é˜…å®˜æ–¹æ–‡æ¡£ï¼ˆ[https://docs.gitlab.com/ee/ci/pipelines/](https://docs.gitlab.com/ee/ci/pipelines/)ï¼‰æ¥ç»„åˆå‡ºä½ çš„ pipelineã€‚\n\n# é¡¹ç›®å‘å¸ƒç®¡ç†\n\nå½“æˆ‘ä»¬é¡¹ç›®åœ¨æœ¬åœ°è¿è¡Œ okï¼Œæµ‹è¯•ä¹Ÿ ok åï¼Œè¯¥è€ƒè™‘å‘å¸ƒåˆ°å„ä¸ªç¯å¢ƒï¼ˆè”è°ƒï¼Œæµ‹è¯•ï¼Œç”Ÿäº§ç­‰ï¼‰ã€‚è¿™ä¸ªè¿‡ç¨‹æ ¹æ®é¡¹ç›®çš„å±æ€§åˆ†ä¸ºä¸¤ç±»ï¼Œä¸€ç±»æ˜¯äºŒæ–¹åŒ…çš„å‘å¸ƒï¼Œå¦ä¸€ç±»åˆ™æ˜¯æ­£ç»åº”ç”¨å‘å¸ƒã€‚\n\nåœ¨è°ˆè¿™ä¸¤ç±»å‘å¸ƒä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥ç¡®è®¤å‘å¸ƒè¿‡ç¨‹ä¸­æˆ‘ä»¬æƒ³è¦è¾¾åˆ°çš„ç›®æ ‡ï¼ˆè¦æ±‚ï¼‰ï¼š\n\n1. å¯¹äºäºŒæ–¹åŒ…å‘å¸ƒï¼Œæˆ‘ä»¬å¸Œæœ›å®ƒåœ¨æœ¬åœ°å°±èƒ½å¤Ÿå‘å¸ƒ beta ç‰ˆæœ¬ï¼Œä»¥ä¾¿äºå¿«é€ŸéªŒè¯ã€‚æ­¤å¤–ï¼Œæ­£å¼ç‰ˆæœ¬çš„å‘å¸ƒï¼Œæˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿé›†æˆåˆ° CI ä¸­ã€‚\n\n2. å¯¹äºåº”ç”¨å‘å¸ƒï¼Œæˆ‘ä»¬å¸Œæœ›å®ƒå‘å¸ƒæ—¶è¶³å¤Ÿè¿…é€Ÿï¼Œä»¥ä¾¿åœ¨å‡ºç°é—®é¢˜æ—¶å¿«é€Ÿæ¨é€è¡¥ä¸è§£å†³é—®é¢˜ã€‚\n\n3. æ— è®ºæ˜¯äºŒæ–¹åŒ…è¿˜æ˜¯åº”ç”¨å‘å¸ƒï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨å‘å¸ƒçš„æ—¶å€™è‡ªåŠ¨æ‰§è¡Œé›†æˆæµ‹è¯•ï¼ˆç”Ÿäº§é™¤å¤–ï¼‰ï¼Œç”Ÿæˆä¸€ä»½æµ‹è¯•æŠ¥å‘Šã€‚\n\n## äºŒæ–¹åŒ…å‘å¸ƒ\n\näºŒæ–¹åŒ…çš„å‘å¸ƒæ ¹æ®æˆ‘ä»¬ä½¿ç”¨çš„é¡¹ç›®ç¯å¢ƒå’Œä¾èµ–ç®¡ç†å·¥å…·å¯ä»¥åˆ’åˆ†ä¸ºä¸¤ç±»ï¼Œç¬¬ä¸€ç±»æ˜¯ä½¿ç”¨ conda+pip æˆ–è€… venv+pip åçš„å‘å¸ƒæµç¨‹ï¼Œå¦ä¸€ç±»æ˜¯ä½¿ç”¨ poetry åçš„å‘å¸ƒæµç¨‹ã€‚\n\n### setuptools+twine\n\nå‘å¸ƒåˆ†ä¸ºæ‰“åŒ…å’Œæ¨é€ä¸¤ä¸ªæ­¥éª¤ï¼Œsetuptools è´Ÿè´£å°†æˆ‘ä»¬çš„ python ä»£ç æ‰“åŒ…ï¼Œè€Œ twine åˆ™è´Ÿè´£å°†æ‰“åŒ…åçš„ pkg æ¨é€åˆ° PyPI ä»“åº“ã€‚\n\nsetuptools æ˜¯å¾ˆå¤šå¹´æ¥ python æ‰“åŒ…çš„é¦–é€‰å·¥å…·ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦æ‰§è¡Œ`pip install setuptools`æ¥ä¸‹è½½è¿™ä¸ªå·¥å…·ã€‚ç„¶ååœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª`setup.py`æ–‡ä»¶æ¥å†™æ‰“åŒ…æ—¶çš„é…ç½®ï¼Œä¸€ä¸ª setup.py å¦‚ä¸‹æ‰€ç¤ºï¼š\n\n```Python\nfrom setuptools import setup, find_packages\n\nwith open(\"README.md\", \"r\", encoding=\"UTF-8\") as fh:\n    long_description = fh.read()\nversion= os.environ.get(\"GITHUB_REF_NAME\", \"0.0.1b0\") # åŒ…çš„ç‰ˆæœ¬ï¼ŒGITHUB_REF_NAMEæ˜¯github tag nameçš„ç¯å¢ƒå˜é‡ï¼Œä»£è¡¨ä»£ç åˆ†æ”¯TAGï¼›0.0.1b0 æ˜¯0.0.1-BETA0çš„ç¼©å†™\nsetup(\n    name='poetry_fastapi_demo',  # åŒ…å\n    version=version,     # æ„å»ºç‰ˆæœ¬\n    author='robocanic',  # ä½œè€…\n    author_email='robocanic@gmail.com',\n    description='A web project template using poetry and fastapi.',   # æè¿°\n    long_description=long_description,  # é•¿çš„æè¿°\n    long_description_content_type=\"text/markdown\",\n    url='https://github.com/robocanic/poetry-fastapi-demo',\n    packages=find_packages(),  # æ‰“åŒ…æ‰€æœ‰åŒ…ç›®å½•\n    classifiers=[\n        \"Development Status :: 2 - Beta\"    # å¼€å‘é˜¶æ®µ\n        \"Programming Language :: Python :: 3.10\",   # ä½¿ç”¨çš„è¯­è¨€\n        \"Operating System:: OS Independent\",   # ä¸é™å®šOS\n    ],\n    install_requires=[     # è¯¥é¡¹ç›®çš„ä¾èµ–ï¼Œåˆ«äººä¸‹è½½æˆ‘ä»¬çš„åŒ…æ—¶ä¼šè‡ªåŠ¨ä¸‹è½½è¿™äº›ä¾èµ–\n        \"fastapi==0.115.0\",\n        \"sqlalchemy==2.0.36\",\n        \"pyyaml==6.0.2\",\n        \"uvicorn=0.32.0\"\n    ],\n    python_requires='>=3.10'    # pythonè¦æ±‚\n)\n\n```\n\n`setup.py`ä½¿ç”¨ä»£ç çš„æ–¹å¼å£°æ˜äº†æˆ‘ä»¬æ‰“åŒ…çš„é…ç½®ï¼ŒåŒ…æ‹¬æ„å»ºç‰ˆæœ¬ï¼Œç›´æ¥ä¾èµ–ï¼Œpython ç‰ˆæœ¬è¦æ±‚ç­‰ç­‰ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬åªéœ€è¦æ‰§è¡Œ`python setup.py sdist`å°±èƒ½å°†é¡¹ç›®æ‰“åŒ…æˆ.tar.gz æ–‡ä»¶ï¼Œå½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥æŒ‡å®šæ‰“åŒ…æ ¼å¼ä¸º`bdist_wheel`ï¼Œæ‰“åŒ…æˆ.wheel æ–‡ä»¶ã€‚æ‰“åŒ…åçš„æ–‡ä»¶é»˜è®¤æ”¾åœ¨ dist ç›®å½•ä¸‹ã€‚\n\næ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦ä½¿ç”¨ twine ä¸Šä¼ åˆ° PyPI ä»“åº“ï¼Œtwine ä¹Ÿæ˜¯ä¸€ä¸ª python åŒ…ï¼Œåœ¨ä½¿ç”¨ä¹‹å‰éœ€è¦é€šè¿‡`pip install twine`ä¸‹è½½ã€‚ç„¶åæ‰§è¡Œ`twine upload dist/*`å°±ä¸Šä¼ åˆ°äº†ä»“åº“ã€‚\n\n> å¦‚æœè¦ä¸Šä¼ åˆ°ç§æœ‰çš„ PyPI ä»“åº“ï¼Œåˆ™éœ€è¦é…ç½®ä¸Šä¼ çš„ç”¨æˆ·åå’Œå¯†ç ï¼ŒåŒæ—¶åœ¨ä¸Šä¼ æ—¶éœ€è¦æŒ‡å®šç§æœ‰ä»“åº“ã€‚æœ€ä¾¿æ·çš„æ–¹æ³•æ˜¯åœ¨ root ç›®å½•ä¸‹æ–°å¢ä¸€ä¸ª.pypirc æ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹ä¸ºï¼š\n\n    [distutils]\n\n\n    index-servers = private-pypi\n\n    [nexus]\n\nrepository=https://private-pypi.com/simple/\nusername=foo\npassword=bar\nç„¶åä½¿ç”¨`twine upload -r private-pypi dist/*` æ¥ä¸Šä¼ åˆ°æŒ‡å®šçš„ç§æœ‰ä»“åº“\n\n### poetry\n\nå¦‚æœä½ ä½¿ç”¨äº† poetryï¼Œé‚£ poetry å°±è‡ªå¸¦äº†æ‰“åŒ…å’Œä¸Šä¼ çš„åŠŸèƒ½ã€‚poetry æ‰“åŒ…éå¸¸ç®€å•ï¼Œåªéœ€è¦æ‰§è¡Œ`poetry build`ï¼Œå®ƒå°±ä¼šå‚ç…§`pyproject.toml`ä¸­çš„é…ç½®è¿›è¡Œæ‰“åŒ…ã€‚æ‰“åŒ…ç”Ÿæˆçš„æ–‡ä»¶é»˜è®¤ä¹Ÿä¼šæ”¾åœ¨ dist ç›®å½•ä¸‹ã€‚\n\nç„¶åæˆ‘ä»¬æ‰§è¡Œ`poetry publish`å°±å¯ä»¥å‘å¸ƒåˆ° PyPI ä»“åº“\n\n> åŒæ ·ï¼Œè‹¥è¦ä½¿ç”¨ poetry ä¸Šä¼ åˆ°ç§æœ‰çš„ PyPI ä»“åº“ã€‚ä¹Ÿéœ€è¦é¢å¤–çš„é…ç½®ï¼š\n> `poetry config repositories.foo-pub [https://pypi.example.org/legacy/](https://pypi.example.org/legacy/)` > `poetry config http-basic.foo-pub <username> <password>` > `poetry publish --repository foo-pub`\n\n### CI é›†æˆ\n\nå¾ˆå¤šæ—¶å€™æˆ‘ä»¬å‘ç°äº†ç‰¹å®šç‰ˆæœ¬åŒ…çš„ä¸€äº›é—®é¢˜ï¼Œæˆ‘ä»¬æƒ³è¦è¿™ä¸ªç‰¹å®šç‰ˆæœ¬çš„åŒ…å¯¹åº”çš„æºä»£ç ï¼Œå¹¶åœ¨æ­¤åŸºç¡€ä¸ŠåŠ ä¸€ä¸ªè¡¥ä¸ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦å°†æˆ‘ä»¬åŒ…çš„ç‰ˆæœ¬å’Œæˆ‘ä»¬ä»£ç çš„ç‰¹å®šåˆ†æ”¯ä¸€ä¸€å¯¹åº”ã€‚é€šè¿‡äººå·¥å®Œæˆè¿™ä¸ªè¿‡ç¨‹æ˜¯å¯è¡Œçš„ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨æ¯æ¬¡æ‰“åŒ…å‰/å åŠ ä¸€ä¸ª commitï¼Œæ¨åˆ°è¿œç¨‹ä»“åº“ï¼Œæ‰“ä¸€ä¸ª tag å°±èƒ½å¯¹åº”èµ·æ¥ã€‚ä½†æ˜¯è¿™ä»¶é‡å¤çš„å·¥ä½œæˆ‘ä»¬æ—¶å¸¸ä¼šå¿˜è®°ï¼Œè¿™ä¸ªé‡å¤çš„å·¥ä½œå¯ä»¥äº¤ç»™ä¸€ä¸ªå•ç‹¬çš„ç¨‹åºæ¥åšå—ï¼Ÿç­”æ¡ˆå½“ç„¶æ˜¯è‚¯å®šçš„ï¼Œæ¯•ç«Ÿç¨‹åºå‘˜æœ€ä¹ æƒ¯çš„äº‹å°±æ˜¯å°†é‡å¤çš„å·¥ä½œç¨‹åºåŒ–ï¼Œå¤æ‚çš„å·¥ä½œæµç¨‹åŒ–ã€‚gitlab pipeline/github actions èƒ½å¤Ÿé€šè¿‡æˆ‘ä»¬å£°æ˜çš„ yml æ–‡ä»¶æ¥å®Œæˆè¿™ä¸ªè¿‡ç¨‹ã€‚\n\n#### gitlab pipeline\n\nä¸€ä¸ªä½¿ç”¨ poetry çš„äºŒæ–¹åŒ…å‘å¸ƒçš„ gitlab pipeline æ–‡ä»¶å¯ä»¥å¦‚ä¸‹ï¼ˆé›†æˆäº†å•æµ‹ï¼‰ï¼š\n\n```YAML\nimage: sunpeek/poetry:py3.10-slim   # éœ€è¦å¸¦æœ‰poetryçš„pythoné•œåƒ\n\nstages:\n  - automatic_test\n  - package_build_push\n\n\nautomatic_test_job:   #\n  stage: automatic_test\n  only:\n    - dev\n  tags:\n    - golang\n  script:\n    - poetry config virtualenvs.create false  # åœ¨å®¹å™¨ä¸­ï¼Œä¸ç”¨åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ\n    - poetry lock     # é”å®šä¾èµ–ç‰ˆæœ¬\n    - poetry install  # ä¸‹è½½ä¾èµ–\n    - pytest tests/   # æ‰§è¡Œæµ‹è¯•\n\n\npackage_build_push_job:\n  stage: package_build_push\n  only:    # è§¦å‘æ¡ä»¶ï¼šåªæœ‰æ‰“tagä¹‹åæ‰ä¼šè§¦å‘è¯¥job\n    - tags\n  script:\n    - poetry config repositories.foo-pub https://pypi.example.org/legacy/   # æ·»åŠ å‘å¸ƒä»“åº“\n    - poetry config http-basic.foo-pub $FOO_USERNAME $FOO_PASSWORD          # æ·»åŠ å‘å¸ƒä»“åº“çš„ç”¨æˆ·åå¯†ç ï¼Œé€šè¿‡æµæ°´çº¿ç¯å¢ƒå˜é‡å¯ä»¥è®¾ç½®\n    - sed -i \"s/^version = \\\".*\\\"/version = \\\"$CI_COMMIT_TAG\\\"/\" pyproject.toml  # ä¿®æ”¹æ„å»ºç‰ˆæœ¬ï¼Œä¸TAGä¸€è‡´\n    - poetry publish --build  --repository foo-pub   # æ‰“åŒ…å¹¶æ¨é€\n```\n\nç®€å•æ¥è¯´ï¼Œgitlab åœ¨æˆ‘ä»¬æ‰“ä¸Šä¸€ä¸ª tag ä¹‹åï¼Œä¼šèµ·ä¸€ä¸ª runner æ‰§è¡Œè¿™ä¸ª yml æ–‡ä»¶çš„ scriptï¼ˆå…·ä½“è¿‡ç¨‹å¯è‡ªè¡Œäº†è§£ï¼‰ã€‚å› æ­¤å½“æˆ‘ä»¬æƒ³è¦å‘å¸ƒä¸€ä¸ªç‰ˆæœ¬æ—¶ï¼Œæ¨åˆ°é•œåƒä»“åº“åï¼Œæ‰“ä¸€ä¸ª tagï¼Œgitlab pipeline å°±ä¼šè¿›è¡Œæ‰“åŒ…ï¼Œæ¨é€ï¼Œå¹¶ä¸”æ¨é€åˆ°ä»“åº“çš„åŒ…çš„ç‰ˆæœ¬å’Œæˆ‘ä»¬çš„ TAG æ˜¯ä¸¥æ ¼å¯¹åº”çš„ã€‚\n\n#### github actions\n\n```YAML\nname: Release package           # workflowåå­—\n\non:                            # è§¦å‘æ¡ä»¶ï¼Œæ–°å»ºtagæ—¶è§¦å‘\n  push:\n    tags:\n      - '*'                  # ä»»æ„æ ‡ç­¾éƒ½ä¼šè§¦å‘å·¥ä½œæµ\n\njobs:\n  pkg:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4    # ä½¿ç”¨checkoutè¿™ä¸ªå·²æœ‰çš„actionæ¥åˆå§‹åŒ–gitç¯å¢ƒ\n      - name: Set up Python ${{ matrix.python-version }}   # ä½¿ç”¨setup-pythonæ¥åˆå§‹åŒ–pythonç¯å¢ƒ\n        uses: actions/setup-python@v3\n        with:\n          python-version: ${{ matrix.python-version }}     # æŒ‡å®špythonç‰ˆæœ¬\n      - name: Set up Poetry                 # ä½¿ç”¨setup-poetryè¿™ä¸ªå·²æœ‰çš„actionæ¥åˆå§‹åŒ–poetry\n        uses: Gr1N/setup-poetry@v9\n      - name: Extract version\n        id: extract_version\n        run: |\n          VERSION=\"${GITHUB_REF#refs/tags/}\"\n          echo \"VERSION=${VERSION}\" >> $GITHUB_ENV\n      - name: Replace version\n        run: |\n          sed -i \"s/^version = \\\".*\\\"/version = \\\"${{ env.VERSION }}\\\"/\" pyproject.toml\n      - name: Build Package        # æ‰“åŒ…\n        run: |\n          poetry config virtualenvs.create false\n          poetry build\n      - name: Publish Package    # å‘å¸ƒ\n        env:\n          PYPI_API_TOKEN: ${{ secrets.PYPI_API_TOKEN }}    # æå‰å®šä¹‰pypiçš„ api token\n        run: |\n          poetry config pypi-token.pypi $PYPI_API_TOKEN\n          poetry publish\n\n\n```\n\n#### æ€»ç»“\n\npoetry ä½œä¸ºé›†ç¯å¢ƒç®¡ç†ï¼Œä¾èµ–ç®¡ç†ï¼Œæ‰“åŒ…å‘å¸ƒä¸€ä½“çš„å·¥å…·ï¼Œè™½ç„¶æœ‰ä¸Šæ‰‹éš¾åº¦ï¼Œä½†ä»é•¿æœŸæ¥çœ‹æ˜¯å€¼å¾—ä½¿ç”¨çš„ï¼Œå¼ºçƒˆæ¨èã€‚gitlab pipeline/github actions çš„ä½¿ç”¨å€’æ˜¯å¯ä»¥çœ‹è‡ªèº«éœ€æ±‚ï¼Œå¦‚æœé¡¹ç›®æ¯”è¾ƒå°ï¼Œå‘å¸ƒæ¬¡æ•°å°‘ï¼Œä¸è¦æ±‚ä»£ç åˆ†æ”¯ä¸åŒ…çš„ç‰ˆæœ¬ä¸¥æ ¼å¯¹åº”ï¼Œæ˜¯å¯ä»¥ä¸ç”¨çš„ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨ gitlab pipeline æ—¶ä¹Ÿå¯ä»¥é€‚å½“æ²¡é‚£ä¹ˆâ€œä¸¥æ ¼â€ï¼Œæ¯”å¦‚ï¼Œä¸ºäº†å›¾æ–¹ä¾¿æˆ‘ä»¬å¯ä»¥åœ¨æœ¬åœ°å‘å¸ƒéæ­£å¼ç‰ˆæœ¬ï¼Œè€Œæ­£å¼ç‰ˆæœ¬åˆ™èµ° pipelineï¼Œä¿è¯æ­£å¼ç‰ˆæœ¬çš„ç¨³å®šã€‚\n\n## åº”ç”¨å‘å¸ƒ\n\nåº”ç”¨å‘å¸ƒå³è®©æˆ‘ä»¬çš„åº”ç”¨è¿è¡Œåœ¨æœºå™¨ä¸Šï¼Œå¯¹å¤–æä¾›æœåŠ¡ã€‚åº”ç”¨çš„è¿è¡Œå½¢æ€å¯ä»¥åŸºæœ¬åˆ†ä¸ºå®¹å™¨/è™šæ‹Ÿæœºï¼Œåæ–‡ä¸­éƒ½åŸºäºä½¿ç”¨æ›´å¹¿æ³›çš„å®¹å™¨æ¥è¿›è¡Œè¯´æ˜ã€‚\n\nåº”ç”¨å‘å¸ƒå¤§ä½“ä¸Šåˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼Œä¸€ä¸ªæ˜¯é•œåƒçš„æ‰“åŒ…ä¸æ¨é€ï¼Œå¦ä¸€ä¸ªæ˜¯é•œåƒæ‹‰å–å’Œå¯åŠ¨å®¹å™¨ã€‚å…¶ä¸­ï¼Œé•œåƒæ¨é€ï¼Œé•œåƒæ‹‰å–å’Œå¯åŠ¨å®¹å™¨å¯¹äºæ¯ä¸€ç§åº”ç”¨ç¨‹åºéƒ½æ˜¯å¤§å·®ä¸å·®çš„ï¼Œè€Œé•œåƒæ‰“åŒ…åˆ™æ˜¯å·®å¼‚æ¯”è¾ƒå¤§çš„ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘å°±é•œåƒæ‰“åŒ…å±•å¼€æ¥è®²ã€‚\n\n### é•œåƒæ‰“åŒ…\n\né•œåƒçš„å¤§å°å…³ä¹åˆ°æ¨é€å’Œæ‹‰å–çš„æ•ˆç‡ï¼Œå› æ­¤æˆ‘ä»¬è¦å°½å¯èƒ½åœ°å‡å°é•œåƒå¤§å°ã€‚python çš„åŸºç¡€é•œåƒä¸­ï¼Œ`slim`ç‰ˆæœ¬çš„åŸºç¡€é•œåƒç§»é™¤äº†ä¸å¿…è¦çš„ç³»ç»Ÿä¸ªå·¥å…·å’Œåº“ï¼Œå› æ­¤åŸºç¡€é•œåƒæˆ‘ä»¬é€‰æ‹©`slim`ç‰ˆæœ¬ï¼ˆ127MB å·¦å³ï¼‰ã€‚\n\næ­¤å¤–ï¼Œæˆ‘ä»¬å¦‚æœä½¿ç”¨äº† poetry æ¥ä½œä¸ºä¾èµ–ç®¡ç†çš„å·¥å…·ï¼Œé‚£åœ¨æ‰“åŒ…æ—¶å°±æœ‰ä¸¤ç§é€‰æ‹©ï¼šç¬¬ä¸€ç§æ˜¯ç›´æ¥å°† poetry æ‰“åˆ°åŸºç¡€é•œåƒä¸­ï¼Œç¬¬äºŒç§æ˜¯ä½¿ç”¨ multi-stage buildï¼Œå³åœ¨ç¬¬ä¸€ä¸ªé˜¶æ®µå…ˆä¸‹è½½ poetryï¼Œå¯¼å‡ºä¾èµ–åˆ° requirements.txtï¼Œç„¶ååœ¨ç¬¬äºŒä¸ªé˜¶æ®µä½¿ç”¨ pip install æ¥ä¸‹è½½ä¾èµ–ã€‚multi-stage build è™½ç„¶æœ€ç»ˆçš„é•œåƒé‡Œä¸åŒ…å« poetryï¼Œä½†æ˜¯ç¬¬ä¸€ä¸ªé˜¶æ®µä¸‹è½½ poetry å’Œå¯¼å‡ºä¾èµ–éƒ½éœ€è¦æ—¶é—´ï¼Œè€Œç¬¬ä¸€ç§æ–¹æ³•ä¸­ç›´æ¥å°† poetry æ‰“åˆ°åŸºç¡€é•œåƒä¸­ï¼Œé•œåƒå¤§å°ä¹Ÿåªå¢åŠ äº†ä¸åˆ° 100MBï¼Œåœ¨å¯ä»¥æ¥å—çš„èŒƒå›´å†…ï¼Œå› æ­¤æˆ‘æ›´æ¨èç¬¬ä¸€ç§ã€‚\n\nç¡®å®šå¥½é•œåƒç­–ç•¥åï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ Dockerfile é•¿å•¥æ ·ï¼ˆåŸºç¡€é•œåƒçš„æ‰“åŒ…å°±æ˜¯åœ¨ python åŸºç¡€é•œåƒçš„ä¸Šé¢ä½¿ç”¨ pip ä¸‹è½½ poetry å³å¯ï¼Œä¸å†èµ˜è¿°ï¼‰ï¼š\n\n```Dockerfile\n# åŒ…å«poetryçš„pythonåŸºç¡€é•œåƒ\nFROM sunpeek/poetry:py3.10-slim\nLABEL maintainer=\"robocanic@gmail.com\"\n# Keeps Python from generating .pyc files in the container\nENV PYTHONDONTWRITEBYTECODE=1\n# Turns off buffering for easier container logging\nENV PYTHONUNBUFFERED=1\n\n# mv source code to a specific directory\nWORKDIR /appruntime\nCOPY . /appruntime\n\n# no need to create virtual env\nRUN poetry config virtualenvs.create false\n# analyze deps\nRUN poetry lock\n# Install deps\nRUN poetry install\n\n# Creates a non-root user with an explicit UID and adds permission to access the /appruntime folder\nRUN adduser -u 5678 --disabled-password --gecos \"\" appuser && chown -R appuser /appruntime\nUSER appuser\n\nCMD [\"uvicorn\", \"poetry_fastapi_demo.main:app\", \"--host=0.0.0.0\", \"--port=8080\", \"--log-config=/appruntime/log.yaml\"]\n```\n\n### CI é›†æˆ\n\nå¦‚æœä½¿ç”¨äº† gitlab pipeline/github actionsï¼Œé‚£æˆ‘ä»¬å¯ä»¥å°†é•œåƒæ‰“åŒ…ï¼Œé•œåƒæ¨é€éƒ½ç»“åˆåˆ° CI ä¸­\n\n#### gitlab pipeline\n\n```YAML\nvariables:    # å˜é‡\n  IMAGE_NAME: $CI_PROJECT_PATH\n  PROJECT_NAME: $CI_PROJECT_NAME\n\n\nstages:\n  - automatic_test_dev\n  - package_build_push_dev\n  - deploy_dev\n\nautomatic_test_job_dev:   # æˆ‘ä»¬åªåœ¨è”è°ƒ/æµ‹è¯•æ—¶æ‰§è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œç”Ÿäº§ç¯å¢ƒä¸ºäº†åŠ å¿«å‘å¸ƒé€Ÿåº¦ï¼Œä¸æ‰§è¡Œæµ‹è¯•\n  image: sunpeek/poetry:py3.10-slim    # ä½¿ç”¨å¸¦poetryçš„pythoné•œåƒ\n  stage: automatic_test_dev\n  only:\n    - dev\n  tags:\n    - python\n  script:\n    - poetry config virtualenvs.create false  # åœ¨å®¹å™¨ä¸­ï¼Œä¸ç”¨åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ\n    - poetry lock     # é”å®šä¾èµ–ç‰ˆæœ¬\n    - poetry install  # ä¸‹è½½ä¾èµ–\n    - pytest tests/   # æ‰§è¡Œæµ‹è¯•\n\npackage_build_push_job_dev:\n  image: docker:27.3  # ä½¿ç”¨dockeré•œåƒ\n  stage: package_build_push_dev\n  only:\n    - dev\n  tags:\n    - python\n  artifacts:\n    paths:\n      - BUILDTIME   # ç¼“å­˜æ„å»ºæ—¶é—´æ–‡ä»¶ä¾›ä¸‹ä¸€ä¸ªjobä½¿ç”¨\n  script:\n    - date +'%Y%m%d%H%M' > BUILDTIME  # å°†æ„å»ºæ—¶é—´å†™åˆ°æ–‡ä»¶\n    - export IMAGE_TAG=dev-$(cat BUILDTIME)-$CI_COMMIT_SHORT_SHA # é•œåƒtag  dev-[å¹´æœˆæ—¥æ—¶åˆ†]-[commit idå‰å…«ä½]\n    - export IMAGE_NAME=$(echo $IMAGE_NAME | tr 'A-Z' 'a-z')  # æŠŠgitlabçš„ç›®å½•å’Œé¡¹ç›®åå°å†™ä½œä¸ºé•œåƒå\n    - docker login -u $REGISTRY_USERNAME -p $REGISTRY_PASSWORD\n    - docker build  -t $IMAGE_NAME:$IMAGE_TAG .\n    - docker push $IMAGE_NAME:$IMAGE_TAG\n```\n\n#### github actions\n\n```YAML\nname: Release deploy           # workflowåå­—\n\non:                            # è§¦å‘æ¡ä»¶ï¼Œæ–°å»ºtagæ—¶è§¦å‘\n  push:\n    tags:\n      - '*'                   # ä»»æ„æ ‡ç­¾éƒ½ä¼šè§¦å‘å·¥ä½œæµ\n\njobs:\n  pkg:\n    runs-on: ubuntu-latest\n    steps:\n      - name: Set up QEMU       # åˆå§‹åŒ–qemu\n        uses: docker/setup-qemu-action@v3\n      - name: Set up Docker Buildx   # åˆå§‹åŒ–buildx\n        uses: docker/setup-buildx-action@v3\n      - name: Login to Docker Hub   # ç™»å½•dockerhub\n        uses: docker/login-action@v3\n        with:\n          username: ${{ secrets.DOCKERHUB_USERNAME }}\n          password: ${{ secrets.DOCKERHUB_PASSWORD }}\n      - name: Extract version   # æå–tag\n        id: extract_version\n        run: |\n          VERSION=\"${GITHUB_REF#refs/tags/}\"\n          echo \"VERSION=${VERSION}\" >> $GITHUB_ENV\n      - name: Build and push   # æ„å»ºé•œåƒå¹¶æ¨é€\n        uses: docker/build-push-action@v6\n        with:\n          push: true\n          tags: ${{ github.repository }}:${{ env.VERSION }}\n```\n\n### æ€»ç»“\n\nå¦‚æœä½ ä½¿ç”¨ docker compose/docker swarm/k8s ç­‰åŸºç¡€è®¾æ–½ï¼Œä½ è¿˜å¯ä»¥ç»“åˆ docker/kubectl æˆ–è€… docker api/k8s api æ¥è¿›è¡Œ CDï¼Œä»è€Œå®ç°åº”ç”¨ä»å‘å¸ƒåˆ°éƒ¨ç½²å®Œå…¨æµæ°´çº¿åŒ–ã€‚\n\nåº”ç”¨çš„å‘å¸ƒåœ¨ä¸åŒçš„å›¢é˜Ÿï¼Œä¸åŒçš„å…¬å¸æ˜¯æœ‰ç€ä¸åŒçš„æµç¨‹å’Œåå¥½çš„ï¼Œä»¥ä¸Šåªæ˜¯æˆ‘æä¾›çš„ä¸€ç§å®ç°å‚è€ƒï¼Œä½†æ˜¯æ— è®ºæ˜¯ä»€ä¹ˆå‘å¸ƒæµç¨‹ï¼Œè€ƒè™‘çš„é‡ç‚¹å…¶å®æ˜¯å¤§å·®ä¸å·®çš„ï¼š\n\n1. é•œåƒå¤§å°è¦å°½å¯èƒ½å‹ç¼©\n\n2. å‘å¸ƒè¦åšåˆ°å¯å›æ»šï¼Œå¯ç°åº¦\n\n3. å‘å¸ƒæµç¨‹ä¸­çš„ä¿¡æ¯è¦å¯è¿½æº¯\n\n4. å‘å¸ƒä¸­ç”¨åˆ°çš„ç»„ä»¶å¤ç”¨åº¦è¦é«˜\n\n5. ......\n\næŒ‰ç…§è¿™äº›ä¸ªæ€è·¯å»ç¼–æ’å‘å¸ƒæµæ°´çº¿ï¼Œç›¸ä¿¡ä½ èƒ½å¾—åˆ°ä¸€ä¸ªç†æƒ³ä¸­çš„æµæ°´çº¿ã€‚\n","slug":"Pythonå·¥ç¨‹åŒ–ä¸å®Œå…¨æŒ‡å—","published":1,"updated":"2024-12-26T14:31:55.380Z","_id":"cm521ppgw00000kwbdm7l44jx","comments":1,"layout":"post","photos":[],"content":"<p>Python ä½œä¸ºä¸€ä¸ªå¼±ç±»å‹è¯­è¨€ï¼Œä¼¼ä¹ä»è¯ç”Ÿä¹‹åˆå°±è¢«å¾ˆå¤šäººè§‰å¾—è¿™æ˜¯ä¸€ä¸ªå¾ˆéšä¾¿çš„è¯­è¨€ï¼Œæ„å»ºä¸€ä¸ªå¯é çš„ Python é¡¹ç›®æ˜¯ä¸€ä¸ªå¾ˆéš¾çš„äº‹æƒ…ã€‚äº‹å®ä¹Ÿç¡®å®å¦‚æ­¤ï¼Œéšç€ AI çš„çˆ†å‘ï¼Œå…¥å‘ Python çš„äººè¶Šæ¥è¶Šå¤šï¼Œä½†å¯¹ Python çš„è¯Ÿç—…å´åªå¢ä¸å‡ã€‚ä¸è¿‡ï¼ŒPython å·¥ç¨‹åŒ–è¿˜æ˜¯åœ¨è¯Ÿç—…ä¸­æ›²æŠ˜å‰è¿›çš„ï¼Œåˆ°ä»Šå¤©ä¸ºæ­¢ï¼Œå°½ç®¡è¿˜å­˜åœ¨ç€ä¸€äº›æ··ä¹±ï¼ŒPython å·¥ç¨‹åŒ–çš„æ ‡å‡†è¶‹äºåŸºæœ¬å®Œå–„ã€‚æœ¬ç¯‡å°†ä»â€œè¿‡æ¥äººâ€çš„è§†è§’ï¼Œç”±æµ…å…¥æ·±åœ°è®²è¿° python å·¥ç¨‹åŒ–çš„æ–¹æ–¹é¢é¢ï¼Œæä¾›ä¸€ä¸ªæœ€ä½³å®è·µä¾›ä½ å‚è€ƒã€‚</p>\n<h1 id=\"é¡¹ç›®ç›®å½•ç»“æ„\"><a href=\"#é¡¹ç›®ç›®å½•ç»“æ„\" class=\"headerlink\" title=\"é¡¹ç›®ç›®å½•ç»“æ„\"></a>é¡¹ç›®ç›®å½•ç»“æ„</h1><p>Python ä½œä¸ºè„šæœ¬è¯­è¨€ï¼Œä¸€ä¸ª.py æ–‡ä»¶èƒ½æ”¾åœ¨ä»»ä½•åœ°æ–¹è¿è¡Œï¼Œä½†æ˜¯<strong>ä¸€ä¸ªæ¸…æ™°çš„ç›®å½•ç»“æ„ä¸ä»…æ˜“äºæ’æŸ¥é—®é¢˜ï¼Œæ›´æ–¹ä¾¿åˆ«äººè¯»æ‡‚æˆ‘ä»¬çš„ä»£ç ï¼Œæ›´åŠ ä¼˜é›…</strong>ã€‚Python ç”±äºå…¶åº”ç”¨å¹¿æ³›ï¼Œä¸åŒç±»å‹çš„ Python é¡¹ç›®ä¹Ÿæœ‰ç€ä¸åŒçš„ç›®å½•ç»“æ„è§„çº¦ã€‚è¿™é‡Œæˆ‘é€‰å–æ™®é€šåº”ç”¨å·¥ç¨‹å’Œæ•°æ®&#x2F;AI å·¥ç¨‹è¿™ä¸¤ç§æœ€ä¸ºå¹¿æ³›çš„ç±»å‹è¿›è¡Œè¯´æ˜ã€‚</p>\n<h2 id=\"æ™®é€šåº”ç”¨å·¥ç¨‹\"><a href=\"#æ™®é€šåº”ç”¨å·¥ç¨‹\" class=\"headerlink\" title=\"æ™®é€šåº”ç”¨å·¥ç¨‹\"></a>æ™®é€šåº”ç”¨å·¥ç¨‹</h2><p>å‡å®šæˆ‘ä»¬çš„é¡¹ç›®åä¸º<code>robocanic-project</code>ï¼Œæ™®é€šåº”ç”¨å·¥ç¨‹æœ€å¸¸ç”¨çš„ç›®å½•ç»“æ„é£æ ¼å¦‚ä¸‹æ‰€ç¤ºï¼š</p>\n<figure class=\"highlight plaintext\"><figcaption><span>Text</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Â robocanic-project/</span><br><span class=\"line\">Â â”‚</span><br><span class=\"line\">Â â”œâ”€â”€ robocanic_project/ Â  Â   # ä¸»åŒ…ï¼Œæˆ‘ä»¬çš„æ ¸å¿ƒä»£ç éƒ½åœ¨è¿™é‡Œé¢</span><br><span class=\"line\">Â â”‚ Â  â”œâ”€â”€ __init__.py Â  Â  Â  Â  # åŒ…åˆå§‹åŒ–æ–‡ä»¶</span><br><span class=\"line\">Â â”‚ Â  â”œâ”€â”€ module1.py Â  Â  Â  Â   # æ¨¡å—1</span><br><span class=\"line\">Â â”‚ Â  â”œâ”€â”€ module2.py Â  Â  Â  Â   # æ¨¡å—2</span><br><span class=\"line\">Â â”‚ Â  â””â”€â”€ main.py Â  Â  Â  Â      # ä¸»ç¨‹åºå…¥å£</span><br><span class=\"line\">Â â”‚</span><br><span class=\"line\">Â â”œâ”€â”€ tests/ Â  Â  Â  Â  Â  Â  Â  Â   # æµ‹è¯•ç›®å½•</span><br><span class=\"line\">Â â”‚ Â  â”œâ”€â”€ __init__.py</span><br><span class=\"line\">Â â”‚ Â  â”œâ”€â”€ test_module1.py</span><br><span class=\"line\">Â â”‚ Â  â””â”€â”€ test_module2.py</span><br><span class=\"line\">Â â”‚</span><br><span class=\"line\">Â â”œâ”€â”€ requirements.txt Â  Â  Â   # ä¾èµ–æ–‡ä»¶</span><br><span class=\"line\">Â â”œâ”€â”€ setup.py Â  Â  Â  Â  Â  Â  Â   # å®‰è£…è„šæœ¬</span><br><span class=\"line\">Â â”œâ”€â”€ README.md Â  Â  Â  Â  Â  Â  Â  # é¡¹ç›®è¯´æ˜</span><br><span class=\"line\">Â â””â”€â”€ .gitignore Â  Â  Â  Â  Â  Â   # Gitå¿½ç•¥æ–‡ä»¶</span><br></pre></td></tr></table></figure>\n\n<p>é‚£ä¸Šé¢è¿™ç§è¿˜æ¯”è¾ƒå®½æ³›ï¼Œå¦‚æœä»¥å‰åç«¯åˆ†ç¦»çš„åç«¯ Web åº”ç”¨è¿™ç§æ¯”è¾ƒå¸¸è§çš„é¡¹ç›®ä¸ºä¾‹ï¼Œç›®å½•ç»“æ„å¯ä»¥æ˜¯ä¸‹é¢è¿™æ ·çš„ï¼š</p>\n<figure class=\"highlight plaintext\"><figcaption><span>Text</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">robocanic-project/</span><br><span class=\"line\">â”œâ”€â”€ robocanic_project/                     # ä¸»åº”ç”¨ç¨‹åºç›®å½•</span><br><span class=\"line\">â”‚   â”œâ”€â”€ __init__.py          # å°†è¯¥ç›®å½•æ ‡è¯†ä¸ºåŒ…ï¼Œé€šå¸¸åˆå§‹åŒ– FastAPI å®ä¾‹</span><br><span class=\"line\">â”‚   â”œâ”€â”€ main.py              # ä¸»æ–‡ä»¶ï¼ŒåŒ…å«åº”ç”¨å®ä¾‹å’Œè·¯ç”±</span><br><span class=\"line\">â”‚   â”œâ”€â”€ api/                 # API è·¯ç”±ç›®å½•</span><br><span class=\"line\">â”‚   â”‚   â”œâ”€â”€ __init__.py</span><br><span class=\"line\">â”‚   â”‚   â”œâ”€â”€ v1/              # API çš„ v1 ç‰ˆæœ¬ï¼ˆå¯é€‰åˆ†ç‰ˆæœ¬ç›®å½•ï¼‰</span><br><span class=\"line\">â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py</span><br><span class=\"line\">â”‚   â”‚   â”‚   â”œâ”€â”€ routes/   # å…·ä½“çš„ API ç«¯ç‚¹</span><br><span class=\"line\">â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py</span><br><span class=\"line\">â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ user.py  # ç”¨æˆ·ç›¸å…³çš„ API è·¯ç”±</span><br><span class=\"line\">â”‚   â”‚   â”‚   â”‚   â””â”€â”€ item.py  # å…¶ä»–æ¨¡å—ï¼ˆå¦‚å•†å“ï¼‰çš„ API è·¯ç”±</span><br><span class=\"line\">â”‚   â”‚   â”‚   â””â”€â”€ ...          # æ›´å¤š API è·¯ç”±</span><br><span class=\"line\">â”‚   â”œâ”€â”€ core/                # æ ¸å¿ƒé…ç½®æ¨¡å—</span><br><span class=\"line\">â”‚   â”‚   â”œâ”€â”€ __init__.py</span><br><span class=\"line\">â”‚   â”‚   â”œâ”€â”€ config.py        # é…ç½®æ–‡ä»¶ï¼ŒåŒ…å«æ•°æ®åº“è¿æ¥ã€ç¬¬ä¸‰æ–¹æœåŠ¡é…ç½®ç­‰</span><br><span class=\"line\">â”‚   â”‚   â”œâ”€â”€ security.py      # å®‰å…¨ç›¸å…³çš„è®¾ç½®ï¼Œä¾‹å¦‚ OAuth2ã€JWT</span><br><span class=\"line\">â”‚   â”œâ”€â”€ models/              # æ•°æ®åº“æ¨¡å‹</span><br><span class=\"line\">â”‚   â”‚   â”œâ”€â”€ __init__.py</span><br><span class=\"line\">â”‚   â”‚   â””â”€â”€ user.py          # ç”¨æˆ·æ¨¡å‹</span><br><span class=\"line\">â”‚   â”‚   â””â”€â”€ item.py          # å…¶ä»–æ•°æ®æ¨¡å‹</span><br><span class=\"line\">â”‚   â”œâ”€â”€ crud/                # å¢åˆ æ”¹æŸ¥æ“ä½œçš„å°è£…</span><br><span class=\"line\">â”‚   â”‚   â”œâ”€â”€ __init__.py</span><br><span class=\"line\">â”‚   â”‚   â”œâ”€â”€ user.py          # ç”¨æˆ·çš„ CRUD æ“ä½œ</span><br><span class=\"line\">â”‚   â”‚   â””â”€â”€ item.py          # å…¶ä»–æ•°æ®çš„ CRUD æ“ä½œ</span><br><span class=\"line\">â”‚   â”œâ”€â”€ db/                  # æ•°æ®åº“åˆå§‹åŒ–åŠè¿æ¥</span><br><span class=\"line\">â”‚   â”‚   â”œâ”€â”€ __init__.py</span><br><span class=\"line\">â”‚   â”‚   â”œâ”€â”€ base.py          # åŸºç¡€çš„æ•°æ®åº“æ¨¡å‹</span><br><span class=\"line\">â”‚   â”‚   â””â”€â”€ session.py       # æ•°æ®åº“ä¼šè¯ï¼ˆSQLAlchemy ä¼šè¯ï¼‰</span><br><span class=\"line\">â”‚   â”œâ”€â”€ tests/               # æµ‹è¯•ç›®å½•</span><br><span class=\"line\">â”‚   â”‚   â”œâ”€â”€ __init__.py</span><br><span class=\"line\">â”‚   â”‚   â””â”€â”€ test_user.py     # ç”¨æˆ·ç›¸å…³çš„æµ‹è¯•æ–‡ä»¶</span><br><span class=\"line\">â”‚   â”‚   â””â”€â”€ test_item.py     # å…¶ä»–æ¨¡å—çš„æµ‹è¯•æ–‡ä»¶</span><br><span class=\"line\">â”‚   â”œâ”€â”€ utils/               # å·¥å…·å‡½æ•°ç›®å½•</span><br><span class=\"line\">â”‚   â”‚   â”œâ”€â”€ __init__.py</span><br><span class=\"line\">â”‚   â”‚   â””â”€â”€ hashing.py       # ç”¨äºå¯†ç åŠ å¯†/è§£å¯†ç­‰å®ç”¨å·¥å…·</span><br><span class=\"line\">    â”œâ”€â”€ alembic/             # æ•°æ®åº“è¿ç§»å·¥å…· Alembic ç›¸å…³æ–‡ä»¶ï¼ˆå¦‚æœä½¿ç”¨ï¼‰</span><br><span class=\"line\">â”‚   â”‚   â”œâ”€â”€ versions/        # æ¯ä¸ªè¿ç§»æ–‡ä»¶éƒ½ä¿å­˜åœ¨è¿™ä¸ªç›®å½•ä¸­</span><br><span class=\"line\">â”‚   â”‚   â”œâ”€â”€ env.py           # Alembic ç¯å¢ƒé…ç½®æ–‡ä»¶</span><br><span class=\"line\">â”‚   â”‚   â”œâ”€â”€ README           # Alembic è¯´æ˜</span><br><span class=\"line\">â”‚   â”‚   â””â”€â”€ script.py.mako   # Alembic è„šæœ¬æ¨¡æ¿</span><br><span class=\"line\">â”‚   â””â”€â”€ ...</span><br><span class=\"line\">â”œâ”€â”€ .env                     # ç¯å¢ƒå˜é‡æ–‡ä»¶ï¼ˆæ•æ„Ÿä¿¡æ¯ï¼Œä¸åº”æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶ï¼‰</span><br><span class=\"line\">â”œâ”€â”€ .gitignore               # Git å¿½ç•¥æ–‡ä»¶åˆ—è¡¨</span><br><span class=\"line\">â”œâ”€â”€ requirements.txt         # ä¾èµ–åŒ…åˆ—è¡¨ï¼ˆå¦‚æœä½¿ç”¨ pipï¼‰</span><br><span class=\"line\">â”œâ”€â”€ setup.py Â  Â  Â  Â  Â  Â  Â    # å®‰è£…è„šæœ¬ï¼ˆå¦‚æœä½¿ç”¨setuptoolsï¼‰</span><br><span class=\"line\">â”œâ”€â”€ pyproject.toml           # é¡¹ç›®å…ƒæ•°æ®åŠä¾èµ–ç®¡ç†ï¼ˆå¦‚æœä½¿ç”¨ poetryï¼‰</span><br><span class=\"line\">â”œâ”€â”€ README.md                # é¡¹ç›®è¯´æ˜æ–‡ä»¶</span><br><span class=\"line\">â””â”€â”€ Dockerfile               # Docker é…ç½®æ–‡ä»¶ï¼ˆå¦‚æœä½¿ç”¨å®¹å™¨åŒ–ï¼‰</span><br></pre></td></tr></table></figure>\n\n<p>ä¸€ä¸ªä»¥ FastAPI ä¸ºåŸºç¡€ Web æ¡†æ¶çš„é¡¹ç›®çš„ç›®å½•ç»“æ„å¦‚ä¸Šæ‰€ç¤ºã€‚å…¶ä¸­ï¼Œé™¤äº†<code>api</code>ï¼Œ<code>models</code>ï¼Œ<code>crud</code>ï¼Œ<code>utils</code>è¿™ç±»è§åçŸ¥æ„çš„ç›®å½•ï¼Œè¿˜æœ‰ä¸€ä¸ªä¸å¤ªå¸¸è§çš„<code>alembic</code>è¿™ä¸ªç›®å½•ï¼Œalembic å…¶å®æ˜¯æ•°æ®åº“è¿ç§»ï¼ˆ<strong>Database Migration</strong>ï¼‰çš„å·¥å…·ã€‚è€Œæ•°æ®åº“è¿ç§»å°±æ˜¯æŒ‡åœ¨æˆ‘ä»¬çš„åº”ç”¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå½“æ¶‰åŠåˆ°éœ€è¦ä¿®æ”¹ ORM å¯¹åº”çš„æ•°æ®åº“ç»“æ„ï¼ˆä¾‹å¦‚è¡¨ã€å­—æ®µã€ç´¢å¼•ç­‰ï¼‰æ—¶ï¼Œå¼•å…¥çš„ä¸€å¥—é€æ­¥æ¼”è¿›æ•°æ®åº“çš„çŠ¶æ€ï¼Œä½¿å…¶ä¸åº”ç”¨ä»£ç ä¿æŒä¸€è‡´çš„å·¥å…·ã€‚è¿™å¥—å·¥å…·ä¸€èˆ¬æ˜¯åŠè‡ªåŠ¨æˆ–è€…å…¨è‡ªåŠ¨çš„ï¼Œå¯ä»¥å¤§å¤§é™ä½æ‰‹åŠ¨æ“ä½œæ•°æ®åº“å¸¦æ¥çš„é£é™©ã€‚</p>\n<h2 id=\"æ•°æ®-AI-å·¥ç¨‹\"><a href=\"#æ•°æ®-AI-å·¥ç¨‹\" class=\"headerlink\" title=\"æ•°æ®&#x2F;AI å·¥ç¨‹\"></a>æ•°æ®&#x2F;AI å·¥ç¨‹</h2><p>è€Œå¯¹äºæ•°æ®ç§‘å­¦ï¼Œæ¨¡å‹è®­ç»ƒï¼Œç§‘å­¦è®¡ç®—è¿™ç±»é¡¹ç›®ï¼Œåˆ™æœ‰ç€å¦ä¸€å¥—å®Œå…¨ä¸ä¸€æ ·çš„ç›®å½•é£æ ¼ï¼š</p>\n<figure class=\"highlight plaintext\"><figcaption><span>Text</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">robocanic-project/</span><br><span class=\"line\">â”œâ”€â”€ data/</span><br><span class=\"line\">â”œâ”€â”€ notebooks/</span><br><span class=\"line\">â”œâ”€â”€ scripts/</span><br><span class=\"line\">â”œâ”€â”€ requirements.txt</span><br><span class=\"line\">â””â”€â”€ README.md</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>ä»¥ä¸Šæ˜¯æ¯”è¾ƒç®€ç•¥çš„ç›®å½•ç»“æ„ï¼Œå±•å¼€æ¥çœ‹ï¼š</p>\n<figure class=\"highlight plaintext\"><figcaption><span>Text</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">robocanic-project/</span><br><span class=\"line\">â”œâ”€â”€ data/</span><br><span class=\"line\">â”‚   â”œâ”€â”€ raw/                  # åŸå§‹æ•°æ®ï¼ˆæœªå¤„ç†çš„æ•°æ®ï¼‰</span><br><span class=\"line\">â”‚   â”œâ”€â”€ processed/            # å¤„ç†åçš„æ•°æ®ï¼ˆæ¸…æ´—åçš„æ•°æ®ã€ç‰¹å¾å·¥ç¨‹åçš„æ•°æ®ï¼‰</span><br><span class=\"line\">â”‚   â””â”€â”€ external/             # å¤–éƒ¨æ•°æ®æºï¼ˆå¯èƒ½æ˜¯APIæˆ–ç¬¬ä¸‰æ–¹æä¾›çš„æ•°æ®ï¼‰</span><br><span class=\"line\">â”‚</span><br><span class=\"line\">â”œâ”€â”€ notebooks/                # Jupyter Notebooksï¼ˆæ¢ç´¢æ€§åˆ†æå’Œåˆæ­¥æ¨¡å‹ï¼‰</span><br><span class=\"line\">â”‚   â”œâ”€â”€ 01_data_exploration.ipynb  # æ•°æ®æ¢ç´¢</span><br><span class=\"line\">â”‚   â”œâ”€â”€ 02_data_cleaning.ipynb     # æ•°æ®æ¸…ç†</span><br><span class=\"line\">â”‚   â””â”€â”€ 03_model_training.ipynb    # æ¨¡å‹è®­ç»ƒ</span><br><span class=\"line\">â”‚</span><br><span class=\"line\">â”œâ”€â”€ scripts/                  # æ•°æ®å¤„ç†å’Œæ¨¡å‹è®­ç»ƒçš„Pythonè„šæœ¬</span><br><span class=\"line\">â”‚   â”œâ”€â”€ data_preprocessing.py  # æ•°æ®é¢„å¤„ç†è„šæœ¬</span><br><span class=\"line\">â”‚   â”œâ”€â”€ train_model.py         # æ¨¡å‹è®­ç»ƒè„šæœ¬</span><br><span class=\"line\">â”‚   â””â”€â”€ evaluate_model.py      # æ¨¡å‹è¯„ä¼°è„šæœ¬</span><br><span class=\"line\">â”‚</span><br><span class=\"line\">â”œâ”€â”€ models/                   # ä¿å­˜çš„æ¨¡å‹ï¼ˆè®­ç»ƒå¥½çš„æ¨¡å‹ã€æ ‡è®°åŒ–æ–‡ä»¶ç­‰ï¼‰</span><br><span class=\"line\">â”‚   â””â”€â”€ model_v1.pkl           # ä¿å­˜çš„æ¨¡å‹æ–‡ä»¶</span><br><span class=\"line\">â”‚</span><br><span class=\"line\">â”œâ”€â”€ reports/                  # é¡¹ç›®æŠ¥å‘Šä¸ç»“æœå±•ç¤º</span><br><span class=\"line\">â”‚   â”œâ”€â”€ figures/              # å›¾è¡¨å’Œå¯è§†åŒ–ç»“æœ</span><br><span class=\"line\">â”‚   â””â”€â”€ final_report.pdf      # æœ€ç»ˆæŠ¥å‘Šæˆ–ç»“æœæ€»ç»“</span><br><span class=\"line\">â”‚</span><br><span class=\"line\">â”œâ”€â”€ requirements.txt          # é¡¹ç›®æ‰€éœ€çš„ä¾èµ–åº“åˆ—è¡¨</span><br><span class=\"line\">â”œâ”€â”€ environment.yml           # Conda ç¯å¢ƒé…ç½®æ–‡ä»¶</span><br><span class=\"line\">â”œâ”€â”€ README.md                 # é¡¹ç›®è¯´æ˜æ–‡ä»¶</span><br><span class=\"line\">â””â”€â”€ .gitignore                # Gitå¿½ç•¥æ–‡ä»¶</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>å¯ä»¥çœ‹å‡ºæ•°æ®&#x2F;AI é¡¹ç›®å’Œæ™®é€šçš„åº”ç”¨è¿˜æ˜¯æœ‰å¾ˆå¤§åŒºåˆ«çš„ã€‚<strong>æ•°æ®&#x2F;AI é¡¹ç›®æ›´å¤šæ˜¯ä»æ•°æ®çš„æµå‘æ¥è¿›è¡Œç›®å½•ç»“æ„çš„åˆ’åˆ†ï¼Œä»æ•°æ®é‡‡é›† â†’ æ•°æ®å¤„ç† â†’ æ¨¡å‹è®­ç»ƒï¼ˆæ•°æ®èšåˆï¼‰â†’ æ¨¡å‹è¯„ä¼°ï¼ˆæ•°æ®è¯„ä¼°ï¼‰â†’â€¦â€¦ è€Œæ™®é€šåº”ç”¨é¡¹ç›®åˆ™æ›´å¤šæ˜¯æŒ‰åŠŸèƒ½æ¨¡å—æ¥åˆ’åˆ†ï¼Œæ¯”å¦‚ MVC çš„åˆ’åˆ†æ¨¡å¼ï¼Œä»¥ APP ä¸ºæ ¸å¿ƒçš„åˆ’åˆ†æ¨¡å‹ç­‰ã€‚</strong></p>\n<p>æ€»çš„æ¥è¯´ï¼ŒPython å·¥ç¨‹çš„ç›®å½•è¿˜æ˜¯æ¯”è¾ƒçµæ´»çš„ï¼Œæˆ‘ä»¬åœ¨æ„å»ºæˆ‘ä»¬è‡ªå·±çš„é¡¹ç›®ç›®å½•æ—¶å¯ä»¥ä¸æ‹˜æ³¥äºå›ºå®šçš„ç›®å½•ç»“æ„ï¼Œä½†ä¹Ÿè¦éµå¾ªä¸Šé¢æåˆ°çš„ä¸€äº›åŸºæœ¬è§„å¾‹ï¼Œè¿™æ ·åˆ«äººä¸Šæ‰‹æˆ‘ä»¬çš„é¡¹ç›®æ—¶èƒ½å¤Ÿå¿«é€Ÿè¯»æ‡‚æˆ‘ä»¬çš„é¡¹ç›®ç»“æ„ï¼Œè¿›è€Œè¯»æ‡‚ä»£ç ã€‚</p>\n<h1 id=\"é¡¹ç›®ç¯å¢ƒä¸ä¾èµ–ç®¡ç†\"><a href=\"#é¡¹ç›®ç¯å¢ƒä¸ä¾èµ–ç®¡ç†\" class=\"headerlink\" title=\"é¡¹ç›®ç¯å¢ƒä¸ä¾èµ–ç®¡ç†\"></a>é¡¹ç›®ç¯å¢ƒä¸ä¾èµ–ç®¡ç†</h1><p>æ¥ä¸‹æ¥è¦è°ˆåˆ°çš„éƒ¨åˆ†ä¸ªäººè®¤ä¸ºæ˜¯ python ä¸­æœ€æ··ä¹±çš„éƒ¨åˆ†â€”â€”ä¾èµ–ç®¡ç†ã€‚ä½†æ˜¯è®² Python çš„ä¾èµ–ç®¡ç†ä¸èƒ½åªè®²ä¾èµ–ç®¡ç†ï¼Œè¿˜è¦è¿å¸¦ç€**è™šæ‹Ÿç¯å¢ƒ(Virtual Environment)**ä¸€èµ·è®²ã€‚</p>\n<p>ä¸åŒäº Javaï¼ŒGo è¿™ç±»ä¾èµ–è·Ÿç€é¡¹ç›®èµ°çš„åšæ³•ï¼ŒPython é¡¹ç›®çš„ä¾èµ–æ˜¯å¯¹äºå½“å‰è™šæ‹Ÿç¯å¢ƒè€Œè¨€çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ä½ åœ¨å‘½ä»¤è¡Œä¸­æ•²ä¸‹<code>pip install fastapi</code>å»ä¸‹è½½ fastapi è¿™ä¸ªåŒ…æ—¶ï¼Œè¿™ä¸ªä¾èµ–æ˜¯å¯¹å½“å‰ç¯å¢ƒæœ‰æ•ˆçš„ï¼Œå¦‚æœé¡¹ç›® A å’Œé¡¹ç›® B éƒ½ä½¿ç”¨äº†è™šæ‹Ÿç¯å¢ƒ Eï¼Œé‚£é¡¹ç›® A å’Œé¡¹ç›® B éƒ½å¯ä»¥ä½¿ç”¨<code>fastapi</code>è¿™ä¸ªä¾èµ–ï¼Œå¦‚æœæœ‰å¤šä¸ªé¡¹ç›®éƒ½éœ€è¦ä¾èµ–<code>fastapi</code>ï¼Œé‚£æ˜¯ä¸æ˜¯æŠŠä»–ä»¬æ”¾åˆ°ä¸€ä¸ªè™šæ‹ŸåŒ–ç¯å¢ƒé‡Œå°±è¡Œï¼Ÿç­”æ¡ˆæ˜¯å¦å®šçš„ï¼Œå› ä¸ºä¸€èˆ¬æ¥è¯´ï¼Œä¸€ä¸ªé¡¹ç›®ä¸å•å•åªä¾èµ–ä¸€ä¸ª<code>fastapi</code>ï¼Œè¿˜æœ‰å…¶ä»–çš„ä¾èµ–ã€‚æ¯”å¦‚ä¸¤ä¸ªé¡¹ç›® A å’Œ B ä¾èµ–äº†ä¸€ä¸ªå…±åŒçš„åŒ…<code>pymysql</code>ï¼Œä½†æ˜¯ä¾èµ–çš„ç‰ˆæœ¬ä¸ä¸€æ ·ï¼Œè¿™æ ·å°±ä¼šå‘ç”Ÿä¾èµ–å†²çªã€‚å› æ­¤æˆ‘ä»¬åœ¨åˆ›å»º Python é¡¹ç›®æ—¶ï¼Œä¸€èˆ¬éƒ½ä¼šåˆ›å»ºä¸€ä¸ªå¯¹åº”çš„è™šæ‹Ÿç¯å¢ƒæ¥é˜²æ­¢ä¾èµ–å†²çªã€‚æ‰€ä»¥åˆ°è¿™ä½ å°±ä¼šå‘ç°è™šæ‹Ÿç¯å¢ƒå…¶å®è¿˜æ˜¯é¡¹ç›®å±‚é¢çš„ï¼Œä¸€ä¸ªé¡¹ç›®å°±å¯¹åº”ä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒï¼Œè™šæ‹Ÿç¯å¢ƒçš„è¿™ä¸ªè®¾è®¡è¯´å®è¯å¾ˆé¸¡è‚‹ï¼Œä¸ä»…ç›¸åŒç‰ˆæœ¬çš„åŒ…ä¸èƒ½å¾—åˆ°å¤ç”¨ï¼Œè¿˜å˜ç›¸åœ°æé«˜äº†ä¾èµ–ç®¡ç†çš„å¤æ‚åº¦ã€‚</p>\n<p>åæ§½å®Œä¹‹åï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ç°é˜¶æ®µç¯å¢ƒç®¡ç†ä»¥åŠä¾èµ–ç®¡ç†çš„æœ€ä½³å®è·µã€‚è¿™ä¸ªæœ€ä½³å®è·µåŒ…æ‹¬ä¸æ¨èçš„æ–¹å¼ venv&#x2F;virtualenv+pipï¼Œä»¥åŠä¸¤ç§æ¨èçš„æ–¹å¼ï¼šconda+pipï¼Œpoetryã€‚</p>\n<h2 id=\"venv-virtualenv-pipï¼ˆä¸æ¨èï¼‰\"><a href=\"#venv-virtualenv-pipï¼ˆä¸æ¨èï¼‰\" class=\"headerlink\" title=\"venv&#x2F;virtualenv+pipï¼ˆä¸æ¨èï¼‰\"></a>venv&#x2F;virtualenv+pipï¼ˆä¸æ¨èï¼‰</h2><p>venv å’Œ virtualenv éƒ½æ˜¯ç”¨æ¥åˆ›å»º python è™šæ‹Ÿç¯å¢ƒçš„å·¥å…·ï¼Œä¸åŒçš„åœ°æ–¹åœ¨äº venv æ˜¯ python3.3 åè‡ªå¸¦çš„è½»é‡çº§è™šæ‹Ÿç¯å¢ƒåˆ›å»ºå·¥å…·ï¼Œåªèƒ½ç”¨äº python3ï¼›è€Œ virtualenv åˆ™éœ€è¦å¦å¤–å®‰è£…ï¼Œå¯ä»¥ç”¨äº py2 ä»¥åŠ py3ï¼Œè¿˜æœ‰ä¸€äº› venv æ²¡æœ‰çš„åŠŸèƒ½ï¼ˆä¸ªäººè§‰å¾—å¯æœ‰å¯æ— ï¼‰ã€‚é‚£å¯¹äº python3.3 ä»¥åçš„é¡¹ç›®ï¼Œç°åœ¨éƒ½æ¨èè‡ªå¸¦çš„ venv äº†ã€‚venv ä½¿ç”¨èµ·æ¥ä¹Ÿå¾ˆç®€å•ï¼š</p>\n<ol>\n<li><p><code>python -m venv venv</code>å‘½ä»¤çš„ç¬¬ä¸€ä¸ª venvï¼Œæ˜¯è¿è¡Œ venv è¿™ä¸ªæ¨¡å—æ¥åˆ›å»ºä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒã€‚ç¬¬äºŒä¸ª venv æ˜¯æŒ‡è™šæ‹Ÿç¯å¢ƒçš„æ–‡ä»¶å¤¹çš„åå­—ï¼Œè¿™ä¸ªå¯ä»¥æ ¹æ®éœ€è¦æ¥ä¿®æ”¹ã€‚å‘½ä»¤æ‰§è¡Œåï¼Œä¼šåœ¨å½“å‰æ–‡ä»¶å¤¹ä¸­ï¼Œå»ºç«‹ä¸€ä¸ª venv ç›®å½•ã€‚ åœ¨è¿™ä¸ª venv ç›®å½•ä¸­ï¼Œä¼šé»˜è®¤æ”¾ç½® python.exeã€pip.exe ç­‰ä¸ç³»ç»Ÿç›®å½•éš”ç¦»çš„å¯æ‰§è¡Œæ–‡ä»¶å’Œä¾èµ–ã€‚ä¸€èˆ¬ venv ä¼šæ”¾ç½®åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹ã€‚</p>\n</li>\n<li><p>è¿›å…¥åˆ°<code>venv/Scipts</code>æ–‡ä»¶å¤¹ï¼Œæ‰§è¡Œ<code>activate</code>ï¼Œå¯ä»¥æ¿€æ´»å½“å‰çš„è™šæ‹Ÿç¯å¢ƒ; æ‰§è¡Œ<code>deactivate</code>ï¼Œå¯ä»¥åœç”¨å½“å‰è™šæ‹Ÿç¯å¢ƒ</p>\n</li>\n<li><p>åˆ é™¤è¿™ä¸ªè™šæ‹Ÿç¯å¢ƒåªéœ€è¦åˆ é™¤æ‰é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ venv æ–‡ä»¶å¤¹å³å¯ã€‚</p>\n</li>\n</ol>\n<p>venv æ²¡æœ‰ç®¡ç†è™šæ‹Ÿç¯å¢ƒçš„åŠŸèƒ½ï¼Œè¿™æ˜¯å› ä¸ºè™šæ‹Ÿç¯å¢ƒçš„ä¾èµ–éƒ½è·Ÿç€é¡¹ç›®èµ°äº†ï¼ˆvenv æ–‡ä»¶å¤¹åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼‰ã€‚å› æ­¤å®ƒè¶³å¤Ÿçš„è½»é‡ã€‚</p>\n<p>pip æ˜¯ä¸€ä¸ªè½»é‡çº§åŒ…ç®¡ç†å·¥å…·ï¼Œå®‰è£… python æ—¶éƒ½ä¼šè‡ªå¸¦ pipã€‚pip æœ€å¸¸ç”¨çš„å‘½ä»¤æœ‰ç”¨äºä¸‹è½½ä¾èµ–çš„<code>pip install deps</code>ã€<code>pip install -r requirements</code>å’Œç”¨äºåˆ é™¤ä¾èµ–çš„<code>pip uninstall deps</code>ã€‚å¾ˆå¤šäººåœ¨ä¸€å¼€å§‹ä½¿ç”¨ pip æ—¶è¿˜è§‰å¾—ç®€å•å¥½ç”¨ï¼Œä½†åœ¨ä½¿ç”¨å¤šäº†ä¹‹åå°±æ·±æ¶ç—›ç»ã€‚pip è®©äººæ·±æ¶ç—›ç»çš„æœ€ä¸»è¦çš„ä¸¤ä¸ªåŸå› å¦‚ä¸‹ï¼š</p>\n<ol>\n<li><p>åœ¨å‘½ä»¤è¡Œæ‰§è¡Œå®Œ<code>pip install deps</code>åä¸‹è½½çš„ä¾èµ–ä¸ä¼šåŒæ­¥åˆ° requirements.txt ä¸­ï¼ŒåŒæ ·<code>pip uninstall deps</code>åˆ é™¤çš„ä¾èµ–ä¹Ÿä¸ä¼šåˆ é™¤ requirements ä¸­å£°æ˜çš„ä¾èµ–ã€‚</p>\n</li>\n<li><p><strong><code>pip uninstall deps</code>åªä¼šåˆ é™¤<code>deps</code>è¿™ä¸ªç›´æ¥ä¾èµ–ï¼Œè€Œä¸ä¼šåˆ é™¤æœ€åˆä¸‹è½½<code>deps</code>è¿™ä¸ªåŒ…å¼•å…¥çš„é—´æ¥ä¾èµ–</strong></p>\n</li>\n</ol>\n<p>å…¶ä¸­ï¼Œç¬¬ä¸€ç‚¹è¿˜å¯ä»¥ä½¿ç”¨<code>pip freeze &gt; requirements.txt</code>æ¥å®Œæˆæ‰‹åŠ¨åŒæ­¥ï¼Œç¬¬äºŒç‚¹åˆ™æ˜¯åæ§½æœ€å¤šçš„ç‚¹ã€‚è¿™ä¸¤ç‚¹ç»å¸¸ä¼šå¼•èµ·ä¾èµ–å†²çªï¼Œç”Ÿäº§ç¯å¢ƒä¸æœ¬åœ°å¼€å‘ç¯å¢ƒä¸ä¸€è‡´çš„æƒ…å†µå‡ºç°ã€‚æ‰€ä»¥åœ¨ä½¿ç”¨ venv+pip ç»„åˆæ—¶ï¼Œå¾—éµå¾ªä¸€ä¸ªå¼€å‘èŒƒå¼ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºä»¥ä¸‹å‡ ç‚¹</p>\n<ol>\n<li><p>ç›´æ¥ä¾èµ–éœ€è¦å†™å…¥ requirements.txt ä¸­ï¼Œä½¿ç”¨<code>pip install -r requirements</code>æ¥ä¸‹è½½ä¾èµ–ï¼Œæ‘ˆå¼ƒ<code>pip install deps</code>ï¼Œä¿è¯é¡¹ç›®ä¾èµ–ç›¸å¯¹æ¸…æ™°</p>\n</li>\n<li><p>å‘ç‰ˆæ—¶å¿…é¡»æ‰§è¡Œ<code>pip freeze &gt; requirements.txt</code>æ¥ä¿è¯æœ¬åœ°ä¸äº‘ç«¯ç¯å¢ƒä¸€è‡´</p>\n</li>\n</ol>\n<h2 id=\"conda-pipï¼ˆæ¨èç”¨äºæ•°æ®-AI-é¢†åŸŸï¼‰\"><a href=\"#conda-pipï¼ˆæ¨èç”¨äºæ•°æ®-AI-é¢†åŸŸï¼‰\" class=\"headerlink\" title=\"conda+pipï¼ˆæ¨èç”¨äºæ•°æ®&#x2F;AI é¢†åŸŸï¼‰\"></a>conda+pipï¼ˆæ¨èç”¨äºæ•°æ®&#x2F;AI é¢†åŸŸï¼‰</h2><p>conda ä¸ä»…æ˜¯ä¸€ä¸ªåŒ…ç®¡ç†å·¥å…·åº“ï¼Œè¿˜æ˜¯ä¸€ä¸ªç¯å¢ƒç®¡ç†å·¥å…·ï¼Œå¹¿æ³›ç”¨äºç§‘å­¦è®¡ç®—é¢†åŸŸï¼Œconda å‘½ä»¤ä¹Ÿæ¯”è¾ƒç®€å•æ˜“ç”¨ï¼Œä½¿ç”¨ conda çš„åŸºæœ¬æ­¥éª¤å¦‚ä¸‹ï¼š</p>\n<ol>\n<li><p><code>conda create -n my-ns</code>åˆ›å»ºä¸€ä¸ªéš”ç¦»çš„è™šæ‹Ÿç¯å¢ƒ</p>\n</li>\n<li><p><code>conda activate my-ns</code>ï¼Œæ¿€æ´»è™šæ‹Ÿç¯å¢ƒ</p>\n</li>\n<li><p><code>conda install dps</code>ä¸‹è½½ä¾èµ–</p>\n</li>\n<li><p><code>conda remve deps</code> å¸è½½ä¾èµ–ï¼Œconda åœ¨å¸è½½ä¾èµ–æ—¶ä¼šæ™ºèƒ½åœ°å¤„ç†åŒ…çš„ä¾èµ–å…³ç³»ï¼Œå°†é—´æ¥ä¾èµ–ä¸­æ— ç”¨çš„åŒ…ä¹Ÿä¼šä¸€å¹¶å¸è½½</p>\n</li>\n<li><p><code>conda remove --name my-ns --all</code>åˆ é™¤è™šæ‹Ÿç¯å¢ƒ</p>\n</li>\n</ol>\n<p>å…¶ä¸­ï¼Œconda åˆ›å»ºçš„è™šæ‹Ÿç¯å¢ƒä¼šç»´æŠ¤ä¸€ä¸ªä¸ç¯å¢ƒååŒåçš„æ–‡ä»¶ç›®å½•ï¼ˆç±»ä¼¼ venvï¼‰ï¼Œä½†è¿™ä¸ªæ–‡ä»¶ç›®å½•ä¼šç»Ÿä¸€æ”¾åœ¨ä¸€ä¸ªåœ°æ–¹ï¼Œä¸ä¼šæ”¾åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼Œè¿™ä¹Ÿè®©å¤šä¸ªä½¿ç”¨ conda çš„é¡¹ç›®â€œæœ‰äº†å…±äº«è™šæ‹Ÿç¯å¢ƒçš„å¯èƒ½â€ã€‚é‚£ conda æ—¢èƒ½ç®¡ç†ç¯å¢ƒï¼Œåˆèƒ½ç®¡ç†ä¾èµ–ï¼Œæ˜¯ä¸æ˜¯å°±èƒ½æ›¿ä»£ pipï¼Ÿå¾ˆé—æ†¾è¿˜æ˜¯ä¸èƒ½ï¼Œä¸»è¦åŸå› æœ‰ä¸¤ç‚¹ï¼š</p>\n<ol>\n<li><p>conda ä¸»è¦ç”¨äºæ•°æ®ç§‘å­¦é¢†åŸŸï¼Œæ•´ä¸ªç¯å¢ƒå®‰è£…èµ·æ¥å°±æ¯”è¾ƒé‡ï¼Œç¯å¢ƒåˆå§‹æ—¶å°±è‡ªå¸¦äº†å¾ˆå¤šä¾èµ–ï¼Œå¾ˆå¤šä¾èµ–æ˜¯æ™®é€šé¡¹ç›®ä¸éœ€è¦çš„ã€‚æ­¤å¤–ï¼Œconda ä¸‹è½½ä¾èµ–çš„é€Ÿåº¦ä¹Ÿä¼šæ…¢ä¸€äº›ã€‚</p>\n</li>\n<li><p>conda çš„åŒ…ä¸ pip å®‰è£…çš„åŒ…ä¸ä¸€æ ·ï¼Œconda åŒ…æ˜¯äºŒè¿›åˆ¶æ ¼å¼çš„ï¼Œé™¤äº†æ•°æ®ç§‘å­¦é¢†åŸŸï¼Œå¾ˆå¤š python åº“éƒ½ä¼šåœ¨ PyPI ä¸Šå‘å¸ƒï¼Œä½†ä¸ä¼šåœ¨ Anaconda repository ä¸Šå‘å¸ƒ</p>\n</li>\n</ol>\n<p>æ‰€ä»¥ä»¥ä¸Šä¸¤ç‚¹å°±é™åˆ¶äº† conda çš„åº”ç”¨é¢†åŸŸï¼Œé™¤äº†æ•°æ®ç§‘å­¦é¢†åŸŸï¼Œconda å°±åªèƒ½ä½œä¸ºä¸€ä¸ªç¯å¢ƒç®¡ç†çš„å·¥å…·ã€‚é‚£å¯¹äºä½¿ç”¨ conda æ¥ç®¡ç†ç¯å¢ƒçš„æƒ…å†µï¼Œpip ä¸€èˆ¬ä¹Ÿæ˜¯ä¸å¯æˆ–ç¼ºçš„ï¼Œä½¿ç”¨æ—¶çš„æ³¨æ„ç‚¹åŒä¸Šé¢çš„<code>venv+pip</code></p>\n<h2 id=\"poetryï¼ˆæ¨èï¼‰\"><a href=\"#poetryï¼ˆæ¨èï¼‰\" class=\"headerlink\" title=\"poetryï¼ˆæ¨èï¼‰\"></a>poetryï¼ˆæ¨èï¼‰</h2><blockquote>\n<p>ä»¥ä¸‹ä»£ç åœ°å€: <a href=\"https://github.com/robocanic/poetry-fastapi-demo.git\">https://github.com/robocanic/poetry-fastapi-demo.git</a></p>\n</blockquote>\n<p>ä¸Šé¢ä¸¤ç§ç¯å¢ƒä¸ä¾èµ–ç®¡ç†çš„æ–¹å¼éƒ½æœ‰ä¸€ä¸ªæ¯”è¾ƒæ£˜æ‰‹çš„ç‚¹æ— æ³•è§£å†³ï¼Œé‚£å°±æ˜¯ pip å¸è½½ä¾èµ–æ—¶æ— æ³•åˆ é™¤å¼•å…¥çš„é—´æ¥ä¾èµ–ï¼Œè¿™å¾ˆå¯èƒ½ä¼šå¯¼è‡´<strong>ä¾èµ–è‡ƒè‚¿ï¼Œä¾èµ–å†²çª</strong>ç­‰é—®é¢˜ã€‚</p>\n<p>poetry æ˜¯ä¸€ä¸ª python ä¾èµ–ç®¡ç†ä¸ç¯å¢ƒç®¡ç†çš„å·¥å…·ï¼Œå®ƒèƒ½å¤Ÿåˆ†æå‡ºå“ªäº›æ˜¯ç›´æ¥ä¾èµ–ï¼Œå“ªäº›æ˜¯é—´æ¥ä¾èµ–ï¼Œåœ¨åˆ é™¤ä¾èµ–æ—¶èƒ½å¤Ÿåˆ æ‰æ— ç”¨çš„é—´æ¥ä¾èµ–ï¼Œä¿æŒé¡¹ç›®ä¾èµ–çš„æ¸…çˆ½ã€‚æ­¤å¤–ï¼Œpoetry è¿˜æœ‰æŒ‡å®šæ¨¡ç³Šä¾èµ–ï¼Œä¾èµ–å¿«é€Ÿå‡çº§ç­‰å®ç”¨çš„åŠŸèƒ½ï¼Œè¿™è®©å®ƒåœ¨ä¾èµ–ç®¡ç†æ–¹é¢ç›´æ¥ç”©äº† pip å¥½å‡ æ¡è¡—ã€‚è‡³äºç¯å¢ƒç®¡ç†ï¼Œpoetry åˆ™æ˜¯åœ¨ virtualenv çš„åŸºç¡€ä¸Šï¼Œå¢å¼ºäº†ä¸€äº›åŠŸèƒ½ï¼Œå¦‚è‡ªåŠ¨åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼Œé›†ä¸­&#x2F;åˆ†ç¦»çš„ç¯å¢ƒç®¡ç†ç­‰ç­‰ã€‚</p>\n<p>poetry çš„å‘½ä»¤ä¼šç›¸å¯¹å¤šä¸€äº›ï¼Œä½†å¸¸ç”¨çš„ä¹Ÿåªæœ‰å‡ ä¸ªï¼Œä¸‹é¢ä»å»ºç«‹ä¸€ä¸ªæ–°é¡¹ç›®çš„æµç¨‹æ¥ç†Ÿæ‚‰ä¸€ä¸‹å¦‚ä½•ä½¿ç”¨ poetryï¼š</p>\n<h4 id=\"åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ\"><a href=\"#åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ\" class=\"headerlink\" title=\"åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ\"></a>åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ</h4><p>åœ¨åˆ›å»ºæ–‡ä»¶å¤¹åï¼Œæ‰§è¡Œ<code>poetry init</code>ï¼Œä¼šæœ‰ä¸€ç³»åˆ—äº’åŠ¨çš„ command æ¥å¼•å¯¼ä½ åˆ›å»º<code>pyproject.toml</code>:</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Â <span class=\"string\">PS</span> <span class=\"string\">D:\\code\\python-projects\\poetry-fastapi-demo&gt;poetry</span> <span class=\"string\">init</span></span><br><span class=\"line\">Â <span class=\"string\">â€‹</span></span><br><span class=\"line\">Â <span class=\"string\">This</span> <span class=\"string\">command</span> <span class=\"string\">will</span> <span class=\"string\">guide</span> <span class=\"string\">you</span> <span class=\"string\">through</span> <span class=\"string\">creating</span> <span class=\"string\">your</span> <span class=\"string\">pyproject.toml</span> <span class=\"string\">config.</span></span><br><span class=\"line\">Â <span class=\"string\">â€‹</span></span><br><span class=\"line\">Â <span class=\"string\">Package</span> <span class=\"string\">name</span> [<span class=\"string\">poetry-fastapi-demo</span>]<span class=\"string\">:</span> Â </span><br><span class=\"line\">Â <span class=\"string\">Version</span> [<span class=\"number\">0.1</span><span class=\"number\">.0</span>]<span class=\"string\">:</span> Â </span><br><span class=\"line\">Â <span class=\"string\">Description</span> []<span class=\"string\">:</span>  <span class=\"string\">A</span> <span class=\"string\">web</span> <span class=\"string\">project</span> <span class=\"string\">template</span> <span class=\"string\">using</span> <span class=\"string\">poetry</span> <span class=\"string\">and</span> <span class=\"string\">fastapi.</span></span><br><span class=\"line\">Â <span class=\"string\">Author</span> [<span class=\"string\">robocanic</span> <span class=\"string\">&lt;robocanic@example.com&gt;</span>, <span class=\"string\">n</span> <span class=\"string\">to</span> <span class=\"string\">skip</span>]<span class=\"string\">:</span> Â </span><br><span class=\"line\">Â <span class=\"string\">License</span> []<span class=\"string\">:</span>  <span class=\"string\">Apache</span> <span class=\"number\">2.0</span></span><br><span class=\"line\">Â <span class=\"string\">Compatible</span> <span class=\"string\">Python</span> <span class=\"string\">versions</span> [<span class=\"string\">^3.11</span>]<span class=\"string\">:</span>  <span class=\"string\">~3.10</span></span><br><span class=\"line\">Â <span class=\"string\">â€‹</span></span><br><span class=\"line\">Â <span class=\"string\">Would</span> <span class=\"string\">you</span> <span class=\"string\">like</span> <span class=\"string\">to</span> <span class=\"string\">define</span> <span class=\"string\">your</span> <span class=\"string\">main</span> <span class=\"string\">dependencies</span> <span class=\"string\">interactively?</span> <span class=\"string\">(yes/no)</span> [<span class=\"literal\">yes</span>] <span class=\"literal\">no</span></span><br><span class=\"line\">Â <span class=\"string\">Would</span> <span class=\"string\">you</span> <span class=\"string\">like</span> <span class=\"string\">to</span> <span class=\"string\">define</span> <span class=\"string\">your</span> <span class=\"string\">development</span> <span class=\"string\">dependencies</span> <span class=\"string\">interactively?</span> <span class=\"string\">(yes/no)</span> [<span class=\"literal\">yes</span>] <span class=\"literal\">no</span></span><br><span class=\"line\">Â <span class=\"string\">Generated</span> <span class=\"string\">file</span></span><br><span class=\"line\">Â <span class=\"string\">â€‹</span></span><br><span class=\"line\">Â [<span class=\"string\">tool.poetry</span>]</span><br><span class=\"line\">Â <span class=\"string\">name</span> <span class=\"string\">=</span> <span class=\"string\">&quot;poetry-fastapi-demo&quot;</span></span><br><span class=\"line\">Â <span class=\"string\">version</span> <span class=\"string\">=</span> <span class=\"string\">&quot;0.1.0&quot;</span></span><br><span class=\"line\">Â <span class=\"string\">description</span> <span class=\"string\">=</span> <span class=\"string\">&quot;A web project template using poetry and fastapi.&quot;</span></span><br><span class=\"line\">Â <span class=\"string\">authors</span> <span class=\"string\">=</span> [<span class=\"string\">&quot;robocanic &lt;robocanic@example.com&gt;&quot;</span>]</span><br><span class=\"line\">Â <span class=\"string\">license</span> <span class=\"string\">=</span> <span class=\"string\">&quot;Apache 2.0&quot;</span></span><br><span class=\"line\">Â <span class=\"string\">readme</span> <span class=\"string\">=</span> <span class=\"string\">&quot;README.md&quot;</span></span><br><span class=\"line\">Â <span class=\"string\">â€‹</span></span><br><span class=\"line\">Â [<span class=\"string\">tool.poetry.dependencies</span>]</span><br><span class=\"line\">Â <span class=\"string\">python</span> <span class=\"string\">=</span> <span class=\"string\">&quot;~3.10&quot;</span></span><br><span class=\"line\">Â <span class=\"string\">â€‹</span></span><br><span class=\"line\">Â <span class=\"string\">â€‹</span></span><br><span class=\"line\">Â [<span class=\"string\">build-system</span>]</span><br><span class=\"line\">Â <span class=\"string\">requires</span> <span class=\"string\">=</span> [<span class=\"string\">&quot;poetry-core&quot;</span>]</span><br><span class=\"line\">Â <span class=\"string\">build-backend</span> <span class=\"string\">=</span> <span class=\"string\">&quot;poetry.core.masonry.api&quot;</span></span><br><span class=\"line\">Â <span class=\"string\">â€‹</span></span><br><span class=\"line\">Â <span class=\"string\">â€‹</span></span><br><span class=\"line\">Â <span class=\"string\">Do</span> <span class=\"string\">you</span> <span class=\"string\">confirm</span> <span class=\"string\">generation?</span> <span class=\"string\">(yes/no)</span> [<span class=\"literal\">yes</span>]</span><br></pre></td></tr></table></figure>\n\n<p>è¿™é‡Œä½ åœ¨å‘½ä»¤è¡Œè¾“å…¥çš„åœ¨åé¢éƒ½æ˜¯å¯ä»¥é€šè¿‡ä¿®æ”¹<code>pyproject.toml</code>æ¥åŒæ­¥çš„ï¼Œå› æ­¤ä¸€èˆ¬æˆ‘ä»¬éƒ½ä¼šå¿«é€Ÿåœ°è·³è¿‡è¿™ä¸ªé˜¶æ®µã€‚ç”Ÿæˆçš„<code>pyproject.toml</code>å¦‚ä¸‹æ‰€ç¤ºï¼š</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Â [<span class=\"string\">tool.poetry</span>] <span class=\"comment\">#é¡¹ç›®ä¿¡æ¯</span></span><br><span class=\"line\">Â <span class=\"string\">name</span> <span class=\"string\">=</span> <span class=\"string\">&quot;poetry-fastapi-demo&quot;</span></span><br><span class=\"line\">Â <span class=\"string\">version</span> <span class=\"string\">=</span> <span class=\"string\">&quot;0.1.0&quot;</span></span><br><span class=\"line\">Â <span class=\"string\">description</span> <span class=\"string\">=</span> <span class=\"string\">&quot;A web project template using poetry and fastapi.&quot;</span></span><br><span class=\"line\">Â <span class=\"string\">authors</span> <span class=\"string\">=</span> [<span class=\"string\">&quot;robocanic &lt;robocanic@example.com&gt;&quot;</span>]</span><br><span class=\"line\">Â <span class=\"string\">license</span> <span class=\"string\">=</span> <span class=\"string\">&quot;Apache 2.0&quot;</span></span><br><span class=\"line\">Â <span class=\"string\">readme</span> <span class=\"string\">=</span> <span class=\"string\">&quot;README.md&quot;</span></span><br><span class=\"line\">Â <span class=\"string\">â€‹</span></span><br><span class=\"line\">Â [<span class=\"string\">tool.poetry.dependencies</span>] Â <span class=\"comment\">#ä¸»è¦ä¾èµ–</span></span><br><span class=\"line\">Â <span class=\"string\">python</span> <span class=\"string\">=</span> <span class=\"string\">&quot;~3.10&quot;</span></span><br><span class=\"line\">Â <span class=\"string\">â€‹</span></span><br><span class=\"line\">Â <span class=\"string\">â€‹</span></span><br><span class=\"line\">Â [<span class=\"string\">build-system</span>] Â <span class=\"comment\"># æ„å»ºå·¥å…·</span></span><br><span class=\"line\">Â <span class=\"string\">requires</span> <span class=\"string\">=</span> [<span class=\"string\">&quot;poetry-core&quot;</span>]</span><br><span class=\"line\">Â <span class=\"string\">build-backend</span> <span class=\"string\">=</span> <span class=\"string\">&quot;poetry.core.masonry.api&quot;</span></span><br><span class=\"line\">Â <span class=\"string\">â€‹</span></span><br></pre></td></tr></table></figure>\n\n<p>åœ¨åˆ›å»º<code>pyproject.toml</code>åï¼Œåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ‰§è¡Œ<code>poetry env use python</code>ï¼Œä¼šåˆ›å»ºä¸€ä¸ªè¯¥é¡¹ç›®ä¸“æœ‰çš„è™šæ‹Ÿç¯å¢ƒï¼š</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Â <span class=\"string\">PS</span> <span class=\"string\">D:\\code\\python-projects\\poetry-fastapi-demo&gt;</span> <span class=\"string\">poetry</span> <span class=\"string\">config</span> <span class=\"string\">virtualenvs.in-project</span> <span class=\"literal\">true</span></span><br><span class=\"line\">Â <span class=\"string\">PS</span> <span class=\"string\">D:\\code\\python-projects\\poetry-fastapi-demo&gt;</span> <span class=\"string\">poetry</span> <span class=\"string\">env</span> <span class=\"string\">use</span> <span class=\"string\">D:\\env\\python\\python.exe</span></span><br><span class=\"line\">Â <span class=\"string\">Creating</span> <span class=\"string\">virtualenv</span> <span class=\"string\">poetry-fastapi-demo</span> <span class=\"string\">in</span> <span class=\"string\">D:\\code\\python-projects\\poetry-fastapi-demo\\.venv</span></span><br><span class=\"line\">Â <span class=\"attr\">Using virtualenv:</span> <span class=\"string\">D:\\code\\python-projects\\poetry-fastapi-demo\\.venv</span></span><br></pre></td></tr></table></figure>\n\n<p>è¿™é‡Œæˆ‘æŒ‡å®šäº† poetry è™šæ‹Ÿç¯å¢ƒçš„è·¯å¾„æ”¾ç½®åœ¨é¡¹ç›®æ ¹ç›®å½•çš„.venv ç›®å½•ä¸‹ï¼Œæˆ‘è§‰å¾—è¿™æ ·çš„é¡¹ç›®ç»„ç»‡æ–¹å¼æ›´æ¸…æ™°ã€‚<code>poetry env use python</code> è¿™ä¸ªå‘½ä»¤é»˜è®¤ä½¿ç”¨ç³»ç»Ÿç¯å¢ƒå˜é‡ä¸­çš„ pythonï¼Œå¦‚æœä½ æƒ³ä½¿ç”¨æŒ‡å®šç‰ˆæœ¬çš„ pythonï¼Œå¯ä»¥å°† python æ¢æˆ<code>path/to/your/py</code>ã€‚</p>\n<h4 id=\"æ·»åŠ ä¾èµ–\"><a href=\"#æ·»åŠ ä¾èµ–\" class=\"headerlink\" title=\"æ·»åŠ ä¾èµ–\"></a>æ·»åŠ ä¾èµ–</h4><p>æˆ‘ä»¬å¯ä»¥ç¼–è¾‘<code>pyproject.toml</code>ï¼Œæ·»åŠ æŒ‡å®šçš„ä¾èµ–ï¼Œå†å…ˆåæ‰§è¡Œ<code>poetry lock</code> å’Œ<code>poetry install</code>ï¼Œ<code>poetry lock</code>ä¼šè§£æ<code>pyproject.toml</code>ä¸­çš„ä¸»è¦ä¾èµ–ä¸å¼€å‘ä¾èµ–ä»¥åŠé—´æ¥ä¾èµ–ï¼Œé€‰æ‹©åˆé€‚çš„ä¾èµ–ç‰ˆæœ¬ï¼Œè®°å½•åˆ° poetry.lock è¿™ä¸ªæ–‡ä»¶ä¸­ã€‚poetry.lock çš„ä½œç”¨ç±»ä¼¼äº requirements.txtï¼Œå³â€œé”å®šâ€é¡¹ç›®éœ€è¦çš„ä¾èµ–ï¼ˆåŒ…æ‹¬ç›´æ¥ä¾èµ–å’Œé—´æ¥ä¾èµ–ï¼‰ç‰ˆæœ¬ã€‚ç´§æ¥ç€çš„<code>poetry install</code>å°±ä¼šæ ¹æ® poetry.lock ä¸­çš„å†…å®¹å»ä¸‹è½½ç›¸åº”ç‰ˆæœ¬çš„ä¾èµ–ã€‚</p>\n<figure class=\"highlight toml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"section\">[tool.poetry]</span> <span class=\"comment\"># é¡¹ç›®ä¿¡æ¯</span></span><br><span class=\"line\"><span class=\"attr\">name</span> = <span class=\"string\">&quot;poetry-fastapi-demo&quot;</span></span><br><span class=\"line\"><span class=\"attr\">version</span> = <span class=\"string\">&quot;0.1.0&quot;</span></span><br><span class=\"line\"><span class=\"attr\">description</span> = <span class=\"string\">&quot;A web project template using poetry and fastapi.&quot;</span></span><br><span class=\"line\"><span class=\"attr\">authors</span> = [<span class=\"string\">&quot;robocanic &lt;robocanic@example.com&gt;&quot;</span>]</span><br><span class=\"line\"><span class=\"attr\">license</span> = <span class=\"string\">&quot;Apache 2.0&quot;</span></span><br><span class=\"line\"><span class=\"attr\">readme</span> = <span class=\"string\">&quot;README.md&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"section\">[tool.poetry.dependencies]</span>  <span class=\"comment\"># ä¸»è¦ä¾èµ–</span></span><br><span class=\"line\"><span class=\"attr\">python</span> = <span class=\"string\">&quot;~3.10&quot;</span>        <span class=\"comment\"># pythonç‰ˆæœ¬&gt;=3.10 ä¸” &lt;3.20</span></span><br><span class=\"line\"><span class=\"attr\">fastapi</span> = <span class=\"string\">&quot;^0.115.0&quot;</span>    <span class=\"comment\"># fastapiç‰ˆæœ¬ &gt;=0.115.0 ä¸” &lt;0.116.0</span></span><br><span class=\"line\"><span class=\"attr\">sqlalchemy</span> = <span class=\"string\">&quot;^2.0.36&quot;</span>  <span class=\"comment\"># sqlalchemyç‰ˆæœ¬ &gt;=2.0.36 ä¸” &lt; 3.0</span></span><br><span class=\"line\"><span class=\"attr\">pyyaml</span> = <span class=\"string\">&quot;^6.0.2&quot;</span>       <span class=\"comment\"># pyyamlç‰ˆæœ¬ &gt;=6.0.2 ä¸” &lt; 7.0.0</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"section\">[tool.poetry.group.dev.dependencies]</span>  <span class=\"comment\"># å¼€å‘ä¾èµ–</span></span><br><span class=\"line\"><span class=\"attr\">pytest</span> = <span class=\"string\">&quot;^8.3.3&quot;</span>       <span class=\"comment\"># pytestç‰ˆæœ¬ &gt;=8.3.3 ä¸” &lt; 9.0.0</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"section\">[build-system]</span>  <span class=\"comment\"># æ„å»ºå·¥å…·</span></span><br><span class=\"line\"><span class=\"attr\">requires</span> = [<span class=\"string\">&quot;poetry-core&quot;</span>]</span><br><span class=\"line\"><span class=\"attr\">build-backend</span> = <span class=\"string\">&quot;poetry.core.masonry.api&quot;</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>æˆ‘ä»¬å¯ä»¥æŒ‡å®šä¸»è¦ä¾èµ–å’Œå¼€å‘ä¾èµ–ï¼Œåœ¨å‘å¸ƒéƒ¨ç½²æ—¶åªæ‰“åŒ…ä¸»è¦ä¾èµ–ï¼Œè¿™æ ·å°±å¯ä»¥å‡å°åŒ…çš„ä½“ç§¯ã€‚åŒæ—¶æˆ‘ä»¬å¯ä»¥æŒ‡å®šä¾èµ–çš„ç‰ˆæœ¬èŒƒå›´ï¼Œä¸åŒçš„ç¬¦å·æœ‰ä¸åŒçš„æŒ‡å®šèŒƒå›´ç­–ç•¥ï¼Œè¿™ä¸€å—å¯ä»¥å‚è€ƒ poetry å®˜æ–¹æ–‡æ¡£ï¼š<a href=\"https://python-poetry.org/docs/dependency-specification/\">https://python-poetry.org/docs/dependency-specification/</a></p>\n<p>æ­¤å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨å‘½ä»¤è¡Œ<code>poetry add deps</code>æ¥ä¸‹è½½åŒ…ï¼Œè¿™ä¸ªå‘½ä»¤ä¼šè‡ªåŠ¨åœ°æ›´æ–°<code>pyproject.toml</code>ä»¥åŠ<code>poetry.lock</code>æ–‡ä»¶ï¼Œä¿è¯ç¯å¢ƒä¸­çš„ä¾èµ–ä¸<code>pyproject.toml</code>ä¸­çš„çš„ä¾èµ–çš„ä¸€è‡´æ€§ã€‚</p>\n<h4 id=\"åˆ é™¤ä¾èµ–\"><a href=\"#åˆ é™¤ä¾èµ–\" class=\"headerlink\" title=\"åˆ é™¤ä¾èµ–\"></a>åˆ é™¤ä¾èµ–</h4><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ç¼–è¾‘<code>pyproject.toml</code>ï¼Œåˆ é™¤å¯¹åº”çš„ä¾èµ–å£°æ˜ï¼Œç„¶åæ‰§è¡Œ<code>poetry lock</code> å³å¯ï¼Œpoetry ä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬æŠŠä¾èµ–åˆ é™¤ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨<code>poetry remove deps</code>æ¥åˆ é™¤ä¾èµ–ã€‚</p>\n<p>poetry çš„è¿™ä¸¤ç§åˆ é™¤æ–¹å¼éƒ½ä¼šè§£æ<code>deps</code>çš„æ— ç”¨çš„é—´æ¥ä¾èµ–ï¼Œå°†å…¶ä¸€å¹¶åˆ é™¤ã€‚</p>\n<h4 id=\"åˆ é™¤è™šæ‹Ÿç¯å¢ƒ\"><a href=\"#åˆ é™¤è™šæ‹Ÿç¯å¢ƒ\" class=\"headerlink\" title=\"åˆ é™¤è™šæ‹Ÿç¯å¢ƒ\"></a>åˆ é™¤è™šæ‹Ÿç¯å¢ƒ</h4><p>æ‰§è¡Œ<code>poetry env remove poetry-demo</code>ï¼Œå³å¯åˆ é™¤è™šæ‹Ÿç¯å¢ƒã€‚</p>\n<blockquote>\n<p>å¦‚æœåœ¨ poetry çš„é…ç½®ä¸­æŒ‡å®šäº†<code>poetry config virtualenvs.in-project true</code>ï¼Œè™šæ‹Ÿç¯å¢ƒç»´æŠ¤çš„ç›®å½•å°±ä¼šæ”¾åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹ã€‚ç±»ä¼¼äº venv çš„æ–¹å¼ï¼Œå› æ­¤è¿™ç§æƒ…å†µä¸‹åˆ é™¤.venv æ–‡ä»¶å¤¹å°±ç­‰åŒäºåˆ é™¤è™šæ‹Ÿç¯å¢ƒ</p>\n</blockquote>\n<h4 id=\"æŸ¥çœ‹ä¾èµ–æ ‘\"><a href=\"#æŸ¥çœ‹ä¾èµ–æ ‘\" class=\"headerlink\" title=\"æŸ¥çœ‹ä¾èµ–æ ‘\"></a>æŸ¥çœ‹ä¾èµ–æ ‘</h4><p>poetry ä¸­å¾ˆå®ç”¨çš„ä¸€ä¸ªåŠŸèƒ½æ˜¯å®ƒå¯ä»¥ä½¿ç”¨<code>poetry show --tree</code>æ¥æŸ¥çœ‹ä¾èµ–å…³ç³»ï¼Œä»è€Œåœ¨ä¾èµ–é”™è¯¯æ—¶èƒ½å¤Ÿæ›´å¥½åœ°å®šä½å¼‚å¸¸ï¼Œæ›´å¿«é€Ÿåœ°è§£å†³é—®é¢˜ã€‚</p>\n<p><img src=\"https://image.robocanic.com/notes/image-20241104154436296.png\" alt=\"poetry-show--tree\"></p>\n<h4 id=\"å¯¼å‡ºä¾èµ–\"><a href=\"#å¯¼å‡ºä¾èµ–\" class=\"headerlink\" title=\"å¯¼å‡ºä¾èµ–\"></a>å¯¼å‡ºä¾èµ–</h4><p>ç†è®ºä¸Šæ¥è¯´ï¼Œæœ‰äº† poetry ä¸å†éœ€è¦ pip äº†ï¼Œè‡ªç„¶ä¹Ÿä¸éœ€è¦ requirements.txt äº†ï¼Œä½†æ˜¯åœ¨åé¢çš„é¡¹ç›®å‘å¸ƒç®¡ç†ä¸­æˆ‘ä»¬ä¼šæåˆ°ï¼Œå½“ä½¿ç”¨å®¹å™¨åŒ–éƒ¨ç½²æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›æˆ‘ä»¬çš„é•œåƒå°½å¯èƒ½åœ°ç²¾ç®€ï¼Œæˆ‘ä»¬çš„é¡¹ç›®éƒ¨ç½²èƒ½å°½å¯èƒ½å¿«é€Ÿã€‚ä»ç²¾ç®€é•œåƒè¿™ä¸ªè§’åº¦æ¥çœ‹ï¼Œpoetry å¯¹äºæˆ‘ä»¬çš„é¡¹ç›®è€Œè¨€åªæ˜¯å¼€å‘æ—¶ä¾èµ–ï¼Œåœ¨è¿è¡Œæ—¶æˆ‘ä»¬å¸Œæœ›åªç”¨æœ€ç®€å•çš„ä¾èµ–å°±èƒ½æŠŠé¡¹ç›®è·‘èµ·æ¥ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦å°† poetry.lock ä¸­çš„ä¾èµ–è½¬åŒ–ä¸º requirements.txtï¼Œè¿™æ ·éƒ¨ç½²æ—¶ä½¿ç”¨<code>pip install -r requirements.txt</code>ä¸‹å®Œä¾èµ–ä¹‹åç›´æ¥å°±èƒ½ run èµ·æ¥é¡¹ç›®ã€‚</p>\n<p>poetry æœ¬èº«ä¹Ÿæ”¯æŒå¯¼å‡ºç¯å¢ƒå†…çš„ä¾èµ–ï¼Œä½¿ç”¨<code>poetry export -f requirements.txt -o requirements.txt</code>å°±å¯ä»¥å°†ç¯å¢ƒä¸­çš„æ‰€æœ‰ä¾èµ–å¯¼å‡ºåˆ° requirements.txt ä¸­ã€‚</p>\n<h4 id=\"æ€»ç»“\"><a href=\"#æ€»ç»“\" class=\"headerlink\" title=\"æ€»ç»“\"></a>æ€»ç»“</h4><p>poetry ä½œä¸ºç¯å¢ƒç®¡ç†ä¸ä¾èµ–ç®¡ç†åˆäºŒä¸ºä¸€çš„é“¶å¼¹ï¼Œåœ¨ä½“éªŒä¸‹æ¥ï¼Œé™¤äº†æ•°æ®ç§‘å­¦&#x2F;AI é¢†åŸŸçš„é¡¹ç›®ï¼Œæˆ‘è®¤ä¸º poetry æ˜¯å¼€å‘å¤§å¤šæ•° python é¡¹ç›®çš„æœ€ä½³ç¯å¢ƒä¸ä¾èµ–çš„ç®¡ç†æ–¹å¼ã€‚</p>\n<h1 id=\"é¡¹ç›®æ—¥å¿—\"><a href=\"#é¡¹ç›®æ—¥å¿—\" class=\"headerlink\" title=\"é¡¹ç›®æ—¥å¿—\"></a>é¡¹ç›®æ—¥å¿—</h1><blockquote>\n<p>ä»¥ä¸‹ä»£ç åœ°å€: <a href=\"https://github.com/robocanic/poetry-fastapi-demo.git\">https://github.com/robocanic/poetry-fastapi-demo.git</a></p>\n</blockquote>\n<h2 id=\"ç›®æ ‡\"><a href=\"#ç›®æ ‡\" class=\"headerlink\" title=\"ç›®æ ‡\"></a>ç›®æ ‡</h2><p>æ—¥å¿—çš„é‡è¦æ€§ä¸è¨€è€Œå–»ï¼Œæˆ‘ä»¬è¿™é‡Œæ¢è®¨çš„â€œé¡¹ç›®æ—¥å¿—â€ï¼Œæ›´å‡†ç¡®åœ°æ¥è¯´æ˜¯æ€ä¹ˆä½¿ç”¨æ—¥å¿—èƒ½å¤Ÿå¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„æ•ˆæœã€‚é€šå¸¸ï¼Œæˆ‘ä»¬å¯¹äºæ—¥å¿—ä¼šæœ‰ä¸€äº›è¦æ±‚ï¼š</p>\n<ol>\n<li><p>æˆ‘ä»¬å¸Œæœ›æˆ‘ä»¬çš„æ—¥å¿—èƒ½å¤Ÿæ˜¾ç¤ºå‡ºæ—¥å¿—æ—¶é—´ï¼Œæ—¥å¿—ç­‰çº§(INFO, WARN, ERROR â€¦..)ï¼Œæ—¥å¿—å†…å®¹ï¼Œæ‰€åœ¨çº¿ç¨‹ï¼Œæ˜¯ç”±å“ªä¸ªç»„ä»¶&#x2F;py æ–‡ä»¶æ‰“å°çš„â€¦â€¦</p>\n</li>\n<li><p>å¯¹äºä»¥ä¸Šæ—¥å¿—ä¿¡æ¯ï¼Œä¸ç®¡æ˜¯è‡ªå·±é¡¹ç›®ä¸­çš„è¿˜æ˜¯ä¾èµ–åŒ…ä¸­çš„ï¼Œéƒ½æœ‰ä¸€ä¸ªç»Ÿä¸€çš„æ ¼å¼æ‰“å°å‡ºæ¥</p>\n</li>\n<li><p>ä¸ä»…è¦åœ¨æ§åˆ¶å°æ‰“å°ï¼Œè¿˜éœ€è¦ä¿å­˜åˆ°æ–‡ä»¶ä¸­ï¼Œä»¥ä¾¿åç»­æ’æŸ¥é”™è¯¯æ—¶èƒ½å¤Ÿè¿½æº¯ã€‚</p>\n</li>\n<li><p>æ›´è¿›ä¸€æ­¥ï¼Œæˆ‘ä»¬å¸Œæœ› ERROR çº§åˆ«çš„æ—¥å¿—èƒ½å¤Ÿå•ç‹¬æ”¾åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œæ¯å¤©çš„æ—¥å¿—æŒ‰ç…§æ—¥æœŸåšä¸€ä¸ªåˆ‡å‰²åˆ†å—â€¦â€¦</p>\n</li>\n</ol>\n<h2 id=\"åŸç†\"><a href=\"#åŸç†\" class=\"headerlink\" title=\"åŸç†\"></a>åŸç†</h2><p>åœ¨é˜æ˜æ—¥å¿—éœ€è¦è¾¾åˆ°çš„æ•ˆæœä¹‹åï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ python ä¸­çš„ logging æ¨¡å—ï¼Œè¿™ä¸ªæ¨¡å—æ˜¯ python è‡ªå¸¦çš„ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆæ¥è¯•ç”¨ä¸€ä¸‹ï¼š</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> logging</span><br><span class=\"line\">logging.info(<span class=\"string\">&quot;this is a info log&quot;</span>)</span><br><span class=\"line\">logging.warning(<span class=\"string\">&quot;this is a warning log&quot;</span>)</span><br><span class=\"line\">logging.error(<span class=\"string\">&quot;this is a error log&quot;</span>)</span><br><span class=\"line\">logging.critical(<span class=\"string\">&quot;this is a critical log&quot;</span>)</span><br><span class=\"line\"><span class=\"string\">&quot;&quot;&quot;</span></span><br><span class=\"line\"><span class=\"string\">output:</span></span><br><span class=\"line\"><span class=\"string\">WARNING:root:this is a warning log</span></span><br><span class=\"line\"><span class=\"string\">ERROR:root:this is a error log</span></span><br><span class=\"line\"><span class=\"string\">CRITICAL:root:this is a critical log</span></span><br><span class=\"line\"><span class=\"string\">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>\n\n<p>è¿è¡Œè¿™ä¸ª python æ–‡ä»¶ä¼šå‘ç°æ§åˆ¶å°å¹¶æ²¡æœ‰æ‰“å°å‡º info çº§åˆ«çš„æ—¥å¿—ï¼Œè¿™æ˜¯å› ä¸º logging æ¨¡å—æä¾›çš„æ—¥å¿—è®°å½•å‡½æ•°æ‰€ä½¿ç”¨çš„æ—¥å¿—å™¨è®¾ç½®çš„æ—¥å¿—çº§åˆ«æ˜¯<code>WARNING</code>ï¼Œå› æ­¤åªæœ‰<code>WARNING</code>çº§åˆ«çš„æ—¥å¿—è®°å½•ä»¥åŠå¤§äºå®ƒçš„<code>ERROR</code>å’Œ<code>CRITICAL</code>çº§åˆ«çš„æ—¥å¿—è®°å½•è¢«è¾“å‡ºäº†ï¼Œè€Œå°äºå®ƒçš„<code>INFO</code>çº§åˆ«çš„æ—¥å¿—è®°å½•è¢«ä¸¢å¼ƒäº†ã€‚</p>\n<p>æˆ‘ä»¬å¯ä»¥è§‚å¯Ÿæ¯æ¡æ—¥å¿—ï¼Œæ¯ä¸ªæ—¥å¿—éƒ½ç”±ä¸‰éƒ¨åˆ†æ„æˆï¼š<code>æ—¥å¿—çº§åˆ«:æ—¥å¿—å™¨åç§°:æ—¥å¿—å†…å®¹</code>ï¼Œè¿™æ˜¯å› ä¸º logging æ¨¡å—æä¾›çš„æ—¥å¿—è®°å½•å‡½æ•°æ‰€ä½¿ç”¨çš„æ—¥å¿—å™¨è®¾ç½®çš„æ—¥å¿—æ ¼å¼é»˜è®¤ä¸º<code>%(levelname)s:%(name)s:%(message)s</code>ã€‚</p>\n<p>é‚£è‡ªç„¶æˆ‘ä»¬ä¼šæƒ³åˆ°ï¼Œå¯ä¸å¯ä»¥é€šè¿‡è®¾ç½® logging çš„æ—¥å¿—çº§åˆ«ä¸æ—¥å¿—æ ¼å¼ï¼Œæ¥ç”Ÿæˆæˆ‘ä»¬æƒ³è¦çš„æ—¥å¿—æ ¼å¼ï¼Ÿè¿›ä¸€æ­¥ï¼Œæˆ‘ä»¬å¯ä¸å¯ä»¥è°ƒæ•´æ—¥å¿—è¾“å‡ºçš„ä½ç½®ï¼ŒåŒæ—¶è¾“å‡ºåœ¨æ§åˆ¶å°å’Œæ–‡ä»¶ï¼Ÿ</p>\n<p>åœ¨å›ç­”è¿™ä¸ªé—®é¢˜ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥æ¥å…ˆç®€å•çœ‹ä¸‹ logging æ¨¡å—æ¶‰åŠåˆ°çš„å››ä¸ªç»„ä»¶</p>\n<ol>\n<li><p>æ—¥å¿—å™¨ï¼ˆLoggerï¼‰ï¼Œæä¾›äº†æˆ‘ä»¬çš„ä»£ç å¯ä»¥ä½¿ç”¨çš„æ¥å£ï¼Œå³ log.infoï¼Œlog.warningï¼Œlog.error ç­‰</p>\n</li>\n<li><p>å¤„ç†å™¨ï¼ˆHandlerï¼‰ï¼Œå°† logger åˆ›å»ºçš„æ—¥å¿—è®°å½•å‘é€åˆ°åˆé€‚çš„ç›®çš„è¾“å‡º</p>\n</li>\n<li><p>è¿‡æ»¤å™¨ï¼ˆFilterï¼‰ï¼Œæä¾›äº†æ›´ç»†ç²’åº¦çš„æ§åˆ¶å·¥å…·æ¥å†³å®šè¾“å‡ºå“ªæ¡æ—¥å¿—è®°å½•ï¼Œä¸¢å¼ƒå“ªæ¡æ—¥å¿—è®°å½•</p>\n</li>\n<li><p>æ ¼å¼å™¨ï¼ˆFormatterï¼‰ï¼Œå†³å®šæ—¥å¿—è®°å½•çš„è¾“å‡ºæ ¼å¼</p>\n</li>\n</ol>\n<p>è¿™äº›ç»„ä»¶çš„å…³ç³»å¤§è‡´å¦‚ä¸‹ï¼šæ—¥å¿—å™¨ï¼ˆLoggerï¼‰éœ€è¦é€šè¿‡å¤„ç†å™¨ï¼ˆHandlerï¼‰å°†æ—¥å¿—ä¿¡æ¯è¾“å‡ºåˆ°ç›®æ ‡ä½ç½®ï¼ˆæ–‡ä»¶ï¼Œæ§åˆ¶å°ï¼Œç½‘ç»œç­‰ï¼‰ã€‚è€Œå¤„ç†å™¨ï¼ˆHandlerï¼‰å¯ä»¥è®¾ç½®è¿‡æ»¤å™¨ï¼ˆFilterï¼‰å’Œæ ¼å¼å™¨ï¼ˆFormatterï¼‰æ¥å¯¹æ—¥å¿—è¿›è¡Œè¿‡æ»¤å’Œæ ¼å¼åŒ–ï¼Œå†è¾“å‡ºåˆ°æŒ‡å®šçš„ç›®æ ‡ä½ç½®ã€‚</p>\n<p>å› æ­¤ä¸Šé¢çš„é—®é¢˜ä¹Ÿæœ‰äº†ç­”æ¡ˆï¼šé€šè¿‡è°ƒæ•´ Loggerï¼ŒHandlerï¼ŒFilterï¼ŒFormatter çš„è®¾ç½®å’Œç»„åˆå…³ç³»ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„æ—¥å¿—ã€‚</p>\n<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ 3 ç§æ–¹å¼æ¥é…ç½® loggingï¼š</p>\n<ol>\n<li><p>ä½¿ç”¨ Python ä»£ç æ˜¾å¼çš„åˆ›å»º loggerï¼Œhandleï¼Œfilterï¼Œformatter å¹¶åˆ†åˆ«è°ƒç”¨å®ƒä»¬çš„é…ç½®å‡½æ•°</p>\n</li>\n<li><p>åˆ›å»ºä¸€ä¸ªæ—¥å¿—é…ç½®æ–‡ä»¶ï¼Œç„¶åä½¿ç”¨<code>fileConfig()</code>å‡½æ•°æ¥è¯»å–è¯¥æ–‡ä»¶çš„å†…å®¹ï¼›</p>\n</li>\n<li><p>åˆ›å»ºä¸€ä¸ªåŒ…å«é…ç½®ä¿¡æ¯çš„ dictï¼Œç„¶åæŠŠå®ƒä¼ é€’ç»™<code>dictConfig()</code>å‡½æ•°ï¼›</p>\n</li>\n</ol>\n<h2 id=\"å®è·µ\"><a href=\"#å®è·µ\" class=\"headerlink\" title=\"å®è·µ\"></a>å®è·µ</h2><p>è¿™é‡Œæˆ‘ä»‹ç»ä¸€ä¸‹ç¬¬ä¸‰ç§ï¼Œå…¶ä»–ä¸¤ç§å¯ä»¥è‡ªè¡Œç ”ç©¶ã€‚ç¬¬ä¸‰ç§æˆ‘ä»¬é€šå¸¸ä¼šç”¨ä¸€ä¸ª yaml&#x2F;json æ–‡ä»¶æ¥æè¿°é…ç½®ï¼Œç„¶åä½¿ç”¨<code>yaml.load</code>è¯»å–æ—¥å¿—é…ç½®æ–‡ä»¶ï¼Œè½¬åŒ–æˆ dictï¼Œè¿›è€Œä¼ é€’ç»™<code>dictConfig()</code>ï¼Œå®Œæˆ logging çš„é…ç½®ã€‚</p>\n<p>yaml å½¢å¼çš„æ—¥å¿—é…ç½®å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">version:</span> <span class=\"number\">1</span></span><br><span class=\"line\"><span class=\"attr\">formatters:</span>  <span class=\"comment\"># å®šä¹‰æ ¼å¼å™¨</span></span><br><span class=\"line\">  <span class=\"attr\">default:</span>   <span class=\"comment\"># æ ¼å¼å™¨å</span></span><br><span class=\"line\">    <span class=\"attr\">format:</span> <span class=\"string\">&#x27;%(asctime)s - %(name)s - %(levelname)s -%(threadName)s%(thread)d - %(message)s&#x27;</span>  <span class=\"comment\"># æ—¥å¿—æ ¼å¼ï¼šæ—¶é—´ - æ—¥å¿—å™¨å - æ—¥å¿—ç­‰çº§ - çº¿ç¨‹å çº¿ç¨‹ID - æ—¥å¿—å†…å®¹</span></span><br><span class=\"line\">    <span class=\"attr\">datefmt:</span> <span class=\"string\">&#x27;%Y-%m-%d %H:%M:%S&#x27;</span>   <span class=\"comment\"># æ—¶é—´æ ¼å¼</span></span><br><span class=\"line\">    <span class=\"attr\">use_colors:</span> <span class=\"literal\">true</span>   <span class=\"comment\"># ä½¿ç”¨é¢œè‰²</span></span><br><span class=\"line\"><span class=\"attr\">handlers:</span>     <span class=\"comment\"># å®šä¹‰å¤„ç†å™¨</span></span><br><span class=\"line\">  <span class=\"attr\">console:</span>    <span class=\"comment\"># å¤„ç†å™¨å</span></span><br><span class=\"line\">    <span class=\"attr\">class:</span> <span class=\"string\">logging.StreamHandler</span>  <span class=\"comment\"># ä½¿ç”¨çš„handler</span></span><br><span class=\"line\">    <span class=\"attr\">level:</span> <span class=\"string\">INFO</span>    <span class=\"comment\"># æ—¥å¿—ç­‰çº§</span></span><br><span class=\"line\">    <span class=\"attr\">formatter:</span> <span class=\"string\">default</span>  <span class=\"comment\"># ä½¿ç”¨çš„formatteråå­—</span></span><br><span class=\"line\">    <span class=\"attr\">stream:</span> <span class=\"string\">ext://sys.stdout</span>  <span class=\"comment\"># è¾“å‡ºåˆ°æ§åˆ¶å°</span></span><br><span class=\"line\">  <span class=\"attr\">file:</span></span><br><span class=\"line\">    <span class=\"attr\">class:</span> <span class=\"string\">logging.FileHandler</span></span><br><span class=\"line\">    <span class=\"attr\">level:</span> <span class=\"string\">INFO</span></span><br><span class=\"line\">    <span class=\"attr\">formatter:</span> <span class=\"string\">default</span></span><br><span class=\"line\">    <span class=\"attr\">filename:</span> <span class=\"string\">app.log</span>   <span class=\"comment\"># è¾“å‡ºåˆ°app.log</span></span><br><span class=\"line\"><span class=\"attr\">loggers:</span>         <span class=\"comment\"># å®šä¹‰æ—¥å¿—å™¨</span></span><br><span class=\"line\">  <span class=\"attr\">poetry_fastapi_demo:</span>   <span class=\"comment\"># æ—¥å¿—å™¨åç§°</span></span><br><span class=\"line\">    <span class=\"attr\">level:</span> <span class=\"string\">INFO</span>  <span class=\"comment\"># æ—¥å¿—ç­‰çº§</span></span><br><span class=\"line\">    <span class=\"attr\">handlers:</span>    <span class=\"comment\"># ä½¿ç”¨çš„handler</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">file</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">console</span></span><br><span class=\"line\">    <span class=\"attr\">propagate:</span> <span class=\"literal\">false</span>   <span class=\"comment\"># æ˜¯å¦ä¼ æ’­åˆ°çˆ¶loggerå†å¤„ç†</span></span><br><span class=\"line\">  <span class=\"attr\">poetry_fastapi_demo.routers:</span>  <span class=\"comment\"># poetry_fastapi_demoçš„å­logger</span></span><br><span class=\"line\">    <span class=\"attr\">level:</span> <span class=\"string\">INFO</span></span><br><span class=\"line\">    <span class=\"attr\">handlers:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">console</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">file</span></span><br><span class=\"line\">    <span class=\"attr\">propagate:</span> <span class=\"literal\">false</span>   <span class=\"comment\"># æ˜¯å¦ä¼ æ’­åˆ°çˆ¶loggerå†å¤„ç†</span></span><br><span class=\"line\">  <span class=\"attr\">uvicorn:</span></span><br><span class=\"line\">    <span class=\"attr\">level:</span> <span class=\"string\">INFO</span></span><br><span class=\"line\">    <span class=\"attr\">handlers:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">console</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">file</span></span><br><span class=\"line\">    <span class=\"attr\">propagate:</span> <span class=\"literal\">false</span></span><br><span class=\"line\"><span class=\"attr\">root:</span>            <span class=\"comment\"># æ ¹æ—¥å¿—å™¨ï¼Œæ‰€æœ‰æ²¡æœ‰å½’å±çš„æ—¥å¿—éƒ½ä¼šç”±rootæ¥å¤„ç†</span></span><br><span class=\"line\">  <span class=\"attr\">level:</span> <span class=\"string\">INFO</span></span><br><span class=\"line\">  <span class=\"attr\">handlers:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">console</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">file</span></span><br></pre></td></tr></table></figure>\n\n<p>å…¶ä¸­ï¼Œlogger æ˜¯æœ‰å±‚çº§ç»“æ„çš„ï¼Œlogger çš„åç§°æ˜¯ä¸€ä¸ªä»¥â€™.â€™åˆ†å‰²çš„ç»“æ„ï¼Œæ¯ä¸ªâ€™.â€™åé¢çš„ logger éƒ½æ˜¯â€™.â€™å‰é¢çš„ logger çš„ childrenã€‚è€Œ root æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ loggerï¼Œå®ƒä¼šæ•æ‰æ²¡æœ‰è¢«å…¶ä»– logger å¤„ç†çš„æ—¥å¿—æ¶ˆæ¯ï¼Œæˆ‘ä»¬ä¾èµ–çš„ä¸‰æ–¹åŒ…æ‰“å°çš„æ—¥å¿—å¤§éƒ¨åˆ†éƒ½ä¼šç”± root logger æ•è·åˆ°è¿›è¡Œå¤„ç†ï¼Œå› æ­¤ root æ˜¯å¾ˆé‡è¦çš„å…œåº• loggerã€‚</p>\n<p>åœ¨å®Œå–„å¥½<code>log.yaml</code>åï¼Œæˆ‘ä»¬åšä¸€ä¸ªéªŒè¯ï¼Œ<code>poetry-fastapi-demo</code>é¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight plaintext\"><figcaption><span>Text</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">poetry-fastapi-demo/</span><br><span class=\"line\">Â â”‚</span><br><span class=\"line\">Â â”œâ”€â”€ poetry_fastapi_demo/ Â  Â   Â  Â </span><br><span class=\"line\">Â â”‚ Â  â”œâ”€â”€ models Â  Â  Â  Â      # æ¨¡å‹</span><br><span class=\"line\">â”‚   â”‚   â”œâ”€â”€ __init__.py</span><br><span class=\"line\">|   |   â”œâ”€â”€ user.py</span><br><span class=\"line\">|   â”œâ”€â”€ routers Â  Â  Â  Â      # è·¯ç”±</span><br><span class=\"line\">|   |   â”œâ”€â”€ __init__.py</span><br><span class=\"line\">|   |   â”œâ”€â”€ user.py</span><br><span class=\"line\">|   â”œâ”€â”€ tables              # å¢åˆ æ”¹æŸ¥</span><br><span class=\"line\">|   |   â”œâ”€â”€ __init__.py</span><br><span class=\"line\">|   |   â”œâ”€â”€ user.py</span><br><span class=\"line\">â”‚ Â  â”œâ”€â”€ __init__.py Â  Â </span><br><span class=\"line\">â”‚   â””â”€â”€ main.py Â  Â  Â  Â      # ä¸»ç¨‹åºå…¥å£</span><br></pre></td></tr></table></figure>\n\n<p><code>poetry_fastapi_demo/__init__.py</code>çš„å†…å®¹å¦‚ä¸‹ï¼Œè¿™é‡Œæˆ‘ä»¬å°† log.yaml çš„è·¯å¾„ä»¥ç¯å¢ƒå˜é‡ä¼ å…¥ï¼Œç„¶åä½¿ç”¨<code>.dictConfig</code>å®Œæˆæ—¥å¿—çš„é…ç½®</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> logging.config</span><br><span class=\"line\"><span class=\"keyword\">import</span> os</span><br><span class=\"line\"><span class=\"keyword\">import</span> yaml</span><br><span class=\"line\"></span><br><span class=\"line\">log_conf_path = os.environ.get(<span class=\"string\">&quot;LOG_CONFIG&quot;</span>)</span><br><span class=\"line\"><span class=\"keyword\">with</span> <span class=\"built_in\">open</span>(log_conf_path, <span class=\"string\">&#x27;r&#x27;</span>, encoding=<span class=\"string\">&#x27;utf-8&#x27;</span>) <span class=\"keyword\">as</span> f:</span><br><span class=\"line\">    dict_conf = yaml.safe_load(f)</span><br><span class=\"line\">logging.config.dictConfig(dict_conf)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p><code>poetry_fastapi_demo/routers/user.py</code>çš„å†…å®¹å¦‚ä¸‹</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> logging</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">from</span> fastapi <span class=\"keyword\">import</span> APIRouter</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">from</span> poetry_fastapi_demo.models <span class=\"keyword\">import</span> User</span><br><span class=\"line\"><span class=\"keyword\">from</span> poetry_fastapi_demo.tables <span class=\"keyword\">import</span> user_table</span><br><span class=\"line\"></span><br><span class=\"line\">log = logging.getLogger(__name__)</span><br><span class=\"line\">router = APIRouter()</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@router.get(<span class=\"params\"><span class=\"string\">&quot;&quot;</span></span>)</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">get_all_users</span>():</span><br><span class=\"line\">    <span class=\"keyword\">return</span> user_table.get_all_users()</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@router.get(<span class=\"params\"><span class=\"string\">&quot;/&#123;user_id&#125;&quot;</span></span>)</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">get_user</span>(<span class=\"params\">user_id: <span class=\"built_in\">int</span></span>):</span><br><span class=\"line\">    <span class=\"keyword\">return</span> user_table.get_user_by_id(user_id)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@router.post(<span class=\"params\"><span class=\"string\">&quot;&quot;</span></span>)</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">create_user</span>(<span class=\"params\">user: User</span>):</span><br><span class=\"line\">    log.info(<span class=\"string\">f&quot;Creating user: <span class=\"subst\">&#123;user&#125;</span>&quot;</span>)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> user_table.add_user(user)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@router.delete(<span class=\"params\"><span class=\"string\">&quot;/&#123;user_id&#125;&quot;</span></span>)</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">delete_user</span>(<span class=\"params\">user_id: <span class=\"built_in\">int</span></span>):</span><br><span class=\"line\">    log.warning(<span class=\"string\">f&quot;Deleting user with id: <span class=\"subst\">&#123;user_id&#125;</span>&quot;</span>)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> user_table.delete_user(user_id)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@router.put(<span class=\"params\"><span class=\"string\">&quot;&quot;</span></span>)</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">update_user</span>(<span class=\"params\">user: User</span>):</span><br><span class=\"line\">    log.warning(<span class=\"string\">f&quot;Updating user: <span class=\"subst\">&#123;user&#125;</span>&quot;</span>)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> user_table.update_user(user)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>è¿è¡Œ main.pyï¼ˆè®°å¾—è®¾ç½®ç¯å¢ƒå˜é‡ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ§åˆ¶å°ä¸­çœ‹åˆ°æ—¥å¿—è¾“å‡ºï¼ŒåŒæ—¶åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹ä¹Ÿä¼šç”Ÿæˆ app.log æ—¥å¿—æ–‡ä»¶ï¼Œè®°å½•è¿è¡Œçš„æ—¥å¿—ã€‚</p>\n<p><img src=\"https://image.robocanic.com/notes/app-log.png\" alt=\"app-log\"></p>\n<p>æˆ‘ä»¬å‘èµ·ä¸€ä¸ªæ–°å¢ user çš„è¯·æ±‚ï¼š</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl --request POST \\</span><br><span class=\"line\">  --url http://localhost:8080/api/v1/user \\</span><br><span class=\"line\">  --header &#x27;content-type: application/json&#x27; \\</span><br><span class=\"line\">  --data &#x27;&#123;</span><br><span class=\"line\">  &quot;id&quot;: 6,</span><br><span class=\"line\">  &quot;name&quot;: &quot;robb&quot;,</span><br><span class=\"line\">  &quot;email&quot;: &quot;robocanic@gmail.com&quot;,</span><br><span class=\"line\"> &quot;password&quot;: &quot;xclkjva&quot;,</span><br><span class=\"line\">  &quot;role&quot;: &quot;user&quot;</span><br><span class=\"line\">&#125;&#x27;</span><br></pre></td></tr></table></figure>\n\n<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ—¥å¿—æ˜¾ç¤ºå¦‚ä¸‹ï¼š</p>\n<p><img src=\"https://image.robocanic.com/notes/create-user-log.png\" alt=\"create-user-log\"></p>\n<p>åˆ°è¿™ï¼ŒåŸºæœ¬çš„æ—¥å¿—éœ€æ±‚å°±æ»¡è¶³äº†ï¼Œæˆ‘ä»¬æ— éœ€è°ƒæ•´ä»£ç ï¼Œä»…é€šè¿‡è°ƒæ•´é…ç½®æ–‡ä»¶å°±èƒ½é€‚æ—¶è°ƒæ•´æ—¥å¿—ã€‚é‚£å¯¹äºç›®æ ‡ä¸­çš„ç¬¬ 4 ç‚¹â€œæˆ‘ä»¬å¸Œæœ› ERROR çº§åˆ«çš„æ—¥å¿—èƒ½å¤Ÿå•ç‹¬æ”¾åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œæ¯å¤©çš„æ—¥å¿—æŒ‰ç…§æ—¥æœŸåšä¸€ä¸ªåˆ‡å‰²åˆ†å—â€ï¼Œç›¸ä¿¡ä½ å¯ä»¥ä¸¾ä¸€åä¸‰</p>\n<h1 id=\"é¡¹ç›®æµ‹è¯•\"><a href=\"#é¡¹ç›®æµ‹è¯•\" class=\"headerlink\" title=\"é¡¹ç›®æµ‹è¯•\"></a>é¡¹ç›®æµ‹è¯•</h1><blockquote>\n<p>ä»¥ä¸‹ä»£ç åœ°å€: <a href=\"https://github.com/robocanic/poetry-fastapi-demo.git\">https://github.com/robocanic/poetry-fastapi-demo.git</a></p>\n</blockquote>\n<p>ä¸€ä¸ªé¡¹ç›®å¯é çš„é¡¹ç›®ç¦»ä¸å¼€å®Œå¤‡çš„æµ‹è¯•ï¼Œæµ‹è¯•ä¸€èˆ¬åˆ†ä¸ºå•å…ƒæµ‹è¯•å’Œæ¥å£æµ‹è¯•ï¼Œå•æµ‹é’ˆå¯¹æŸä¸ªå‡½æ•°æˆ–è€…æŸä¸ªæ¨¡å—ï¼Œæµ‹è¯•è¿”å›çš„å‚æ•°æ˜¯å¦ç¬¦åˆé¢„æœŸï¼Œè€Œæ¥å£æµ‹è¯•æ˜¯é’ˆå¯¹äº HTTPï¼ˆRPCï¼‰æ¥å£ï¼Œæµ‹è¯•çš„æ˜¯æŸä¸€å—åŠŸèƒ½çš„å®Œå¤‡æ€§ã€‚</p>\n<p>è¿™é‡Œæˆ‘ä»¬è®¨è®ºçš„ä»…é™äºå•å…ƒæµ‹è¯•ã€‚åœ¨ python ä¸­ï¼Œå•å…ƒæµ‹è¯•å¯ä»¥ä½¿ç”¨ unittest æ¨¡å—å’Œ pytestï¼Œuninttest æ˜¯ python è‡ªå¸¦çš„æµ‹è¯•æ¨¡å—ï¼Œè€Œ pytest æ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹æ¨¡å—ï¼Œåœ¨å…¼å®¹ unittest çš„åŸºç¡€ä¸Šï¼Œå¢åŠ äº†é›†æˆæµ‹è¯•çš„åŠŸèƒ½ï¼Œæ–¹ä¾¿æˆ‘ä»¬è¿›è¡Œæ‰¹é‡çš„å•å…ƒæµ‹è¯•ï¼Œä¸ CI è¿›è¡Œç»“åˆã€‚å› æ­¤åæ–‡ä¸­ä½¿ç”¨ pytest æ¥è¿›è¡Œè®²è§£ã€‚</p>\n<p>pytest å¯ä»¥è‡ªåŠ¨é€’å½’æŒ‡å®šè·¯å¾„ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼Œåªè¦ç¬¦åˆ<code>test_</code>æˆ–è€…<code>_test</code>å¼€å¤´çš„ py æ–‡ä»¶éƒ½ä¼šè¢«è¯†åˆ«ä¸ºæµ‹è¯•ç”¨ä¾‹æ–‡ä»¶ã€‚éƒ½ä¼šåœ¨æµ‹è¯•è®¡åˆ’ä¸­æ‰§è¡Œã€‚</p>\n<h2 id=\"å®è·µ-1\"><a href=\"#å®è·µ-1\" class=\"headerlink\" title=\"å®è·µ\"></a>å®è·µ</h2><p>åœ¨ä½¿ç”¨ pytest ä¹‹å‰éœ€è¦ä½¿ç”¨ pip æˆ–è€… poetry ä¸‹è½½ï¼Œæˆ‘ä»¬å¯ä»¥å°† pytest ä¸‹è½½åˆ°<code>dev</code>åˆ†ç»„çš„ä¾èµ–ï¼Œä¹Ÿå°±æ˜¯å¼€å‘æ—¶ä¾èµ–ï¼ˆå¦‚<code>poetry add pytest --group dev</code>ï¼‰ï¼Œä»¥ä¾¿ç”Ÿäº§éƒ¨ç½²æ—¶ç²¾ç®€æ‰å¼€å‘æ—¶ä¾èµ–ã€‚</p>\n<p>é¡¹ç›®ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight plaintext\"><figcaption><span>Text</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">poetry-fastapi-demo/</span><br><span class=\"line\">Â â”‚</span><br><span class=\"line\">Â â”œâ”€â”€ poetry_fastapi_demo/ Â  # ç¨‹åºä¸»åŒ… Â  Â </span><br><span class=\"line\">Â â”‚ Â  â”œâ”€â”€ models/ Â  Â  Â  Â      # æ¨¡å‹</span><br><span class=\"line\">â”‚   â”‚   â”œâ”€â”€ __init__.py</span><br><span class=\"line\">|   |   â”œâ”€â”€ user.py</span><br><span class=\"line\">|   â”œâ”€â”€ routers/ Â  Â  Â  Â      # è·¯ç”±</span><br><span class=\"line\">|   |   â”œâ”€â”€ __init__.py</span><br><span class=\"line\">|   |   â”œâ”€â”€ user.py</span><br><span class=\"line\">|   â”œâ”€â”€ tables/              # å¢åˆ æ”¹æŸ¥</span><br><span class=\"line\">|   |   â”œâ”€â”€ __init__.py</span><br><span class=\"line\">|   |   â”œâ”€â”€ user.py</span><br><span class=\"line\">â”‚ Â  â”œâ”€â”€ __init__.py Â  Â </span><br><span class=\"line\">â”‚   â””â”€â”€ main.py Â  Â  Â  Â      # ä¸»ç¨‹åºå…¥å£</span><br><span class=\"line\">â”œâ”€â”€ tests/                  # æµ‹è¯•æ–‡ä»¶</span><br><span class=\"line\">|   â”œâ”€â”€ test_user_table.py Â  Â # æ¨¡å‹</span><br><span class=\"line\">......</span><br></pre></td></tr></table></figure>\n\n<p>å…¶ä¸­ï¼Œ<code>poetry_fastapi_demo/tables/user.py</code>å†…å®¹å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> typing <span class=\"keyword\">import</span> <span class=\"type\">Optional</span>, <span class=\"type\">List</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">from</span> poetry_fastapi_demo.models <span class=\"keyword\">import</span> User</span><br><span class=\"line\"></span><br><span class=\"line\">user_list = [</span><br><span class=\"line\">    User(</span><br><span class=\"line\">        <span class=\"built_in\">id</span>=<span class=\"number\">1</span>,</span><br><span class=\"line\">        name=<span class=\"string\">&quot;Chris&quot;</span>,</span><br><span class=\"line\">        email=<span class=\"string\">&quot;chris@gmail.com&quot;</span>,</span><br><span class=\"line\">        password=<span class=\"string\">&quot;pso3sd5xv&quot;</span>,</span><br><span class=\"line\">        role=<span class=\"string\">&quot;admin&quot;</span></span><br><span class=\"line\">    ),</span><br><span class=\"line\">    User(</span><br><span class=\"line\">        <span class=\"built_in\">id</span>=<span class=\"number\">2</span>,</span><br><span class=\"line\">        name=<span class=\"string\">&quot;Jon&quot;</span>,</span><br><span class=\"line\">        email=<span class=\"string\">&quot;jon@gmail.com&quot;</span>,</span><br><span class=\"line\">        password=<span class=\"string\">&quot;rthdfwe5sdf&quot;</span>,</span><br><span class=\"line\">        role=<span class=\"string\">&quot;user&quot;</span></span><br><span class=\"line\">    ),</span><br><span class=\"line\">    User(</span><br><span class=\"line\">        <span class=\"built_in\">id</span>=<span class=\"number\">3</span>,</span><br><span class=\"line\">        name=<span class=\"string\">&quot;Arya&quot;</span>,</span><br><span class=\"line\">        email=<span class=\"string\">&quot;arya@gmail.com&quot;</span>,</span><br><span class=\"line\">        password=<span class=\"string\">&quot;ndddrwe42&quot;</span>,</span><br><span class=\"line\">        role=<span class=\"string\">&quot;user&quot;</span></span><br><span class=\"line\">    )</span><br><span class=\"line\"></span><br><span class=\"line\">]</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">UserTable</span>:</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">get_all_users</span>(<span class=\"params\">self</span>) -&gt; <span class=\"type\">List</span>[User]:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> user_list</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">get_user_by_id</span>(<span class=\"params\">self, user_id: <span class=\"built_in\">int</span></span>) -&gt; <span class=\"type\">Optional</span>[User]:</span><br><span class=\"line\">        <span class=\"keyword\">for</span> user <span class=\"keyword\">in</span> user_list:</span><br><span class=\"line\">            <span class=\"keyword\">if</span> user.<span class=\"built_in\">id</span> == user_id:</span><br><span class=\"line\">                <span class=\"keyword\">return</span> user</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">None</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">update_user</span>(<span class=\"params\">self, user: User</span>) -&gt; <span class=\"built_in\">bool</span>:</span><br><span class=\"line\">        <span class=\"keyword\">for</span> u <span class=\"keyword\">in</span> user_list:</span><br><span class=\"line\">            <span class=\"keyword\">if</span> u.<span class=\"built_in\">id</span> == user.<span class=\"built_in\">id</span>:</span><br><span class=\"line\">                u.name = user.name</span><br><span class=\"line\">                u.email = user.email</span><br><span class=\"line\">                u.password = user.password</span><br><span class=\"line\">                u.role = user.role</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">True</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">False</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">delete_user</span>(<span class=\"params\">self, user_id: <span class=\"built_in\">int</span></span>) -&gt; <span class=\"built_in\">bool</span>:</span><br><span class=\"line\">        <span class=\"keyword\">for</span> i, u <span class=\"keyword\">in</span> <span class=\"built_in\">enumerate</span>(user_list):</span><br><span class=\"line\">            <span class=\"keyword\">if</span> u.<span class=\"built_in\">id</span> == user_id:</span><br><span class=\"line\">                <span class=\"keyword\">del</span> user_list[i]</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">True</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">False</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">add_user</span>(<span class=\"params\">self, user: User</span>) -&gt; <span class=\"built_in\">bool</span>:</span><br><span class=\"line\">        <span class=\"keyword\">for</span> u <span class=\"keyword\">in</span> user_list:</span><br><span class=\"line\">            <span class=\"keyword\">if</span> u.<span class=\"built_in\">id</span> == user.<span class=\"built_in\">id</span>:</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">False</span></span><br><span class=\"line\">        user_list.append(user)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">True</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">user_table = UserTable()</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>æµ‹è¯•æ¡ˆä¾‹<code>test_user_table.py</code>å†…å®¹å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> poetry_fastapi_demo.models <span class=\"keyword\">import</span> User</span><br><span class=\"line\"><span class=\"keyword\">from</span> poetry_fastapi_demo.tables <span class=\"keyword\">import</span> user_table</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">TestUserTable</span>:</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">test_get_all</span>(<span class=\"params\">self</span>):</span><br><span class=\"line\">        user_table.get_all_users()</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">test_get_by_id</span>(<span class=\"params\">self</span>):</span><br><span class=\"line\">        user = user_table.get_user_by_id(<span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">assert</span> user.name == <span class=\"string\">&quot;Chris&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">test_update_user</span>(<span class=\"params\">self</span>):</span><br><span class=\"line\">        user = user_table.get_user_by_id(<span class=\"number\">1</span>)</span><br><span class=\"line\">        user.name = <span class=\"string\">&quot;Chris2&quot;</span></span><br><span class=\"line\">        <span class=\"keyword\">assert</span> user_table.update_user(user) <span class=\"keyword\">is</span> <span class=\"literal\">True</span></span><br><span class=\"line\">        <span class=\"keyword\">assert</span> user_table.get_user_by_id(<span class=\"number\">1</span>).name == <span class=\"string\">&quot;Chris&quot;</span>   <span class=\"comment\"># æ•…æ„å†™é”™</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">test_delete_user</span>(<span class=\"params\">self</span>):</span><br><span class=\"line\">        <span class=\"keyword\">assert</span> user_table.delete_user(<span class=\"number\">1</span>) <span class=\"keyword\">is</span> <span class=\"literal\">True</span></span><br><span class=\"line\">        <span class=\"keyword\">assert</span> user_table.get_user_by_id(<span class=\"number\">1</span>) <span class=\"keyword\">is</span> <span class=\"literal\">None</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">test_add_user</span>(<span class=\"params\">self</span>):</span><br><span class=\"line\">        result = user_table.add_user(User(</span><br><span class=\"line\">            <span class=\"built_in\">id</span>=<span class=\"number\">4</span>,</span><br><span class=\"line\">            name=<span class=\"string\">&quot;robb&quot;</span>,</span><br><span class=\"line\">            email=<span class=\"string\">&quot;robb@gmail.com&quot;</span>,</span><br><span class=\"line\">            password=<span class=\"string\">&quot;loqjwnd[as;&quot;</span>,</span><br><span class=\"line\">            role=<span class=\"string\">&quot;admin&quot;</span></span><br><span class=\"line\">        ))</span><br><span class=\"line\">        <span class=\"keyword\">assert</span> result <span class=\"keyword\">is</span> <span class=\"literal\">True</span></span><br><span class=\"line\">        <span class=\"keyword\">assert</span> user_table.get_user_by_id(<span class=\"number\">4</span>).name == <span class=\"string\">&quot;robb&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>ç„¶åæˆ‘ä»¬åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ<code>pytest tests/ -v</code>ï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š</p>\n<p><img src=\"https://image.robocanic.com/notes/py-test.png\" alt=\"py-test\"></p>\n<p>pytest ä¼šé€’å½’åœ°åœ¨ tests æ–‡ä»¶å¤¹ä¸‹å¯»æ‰¾ä»¥<code>test_</code>æˆ–<code>_test</code>å¼€å¤´çš„ py æ–‡ä»¶ï¼Œåœ¨ py æ–‡ä»¶ä¸­ï¼Œä¼šå¯»æ‰¾ä»¥<code>test_</code>æˆ–<code>_test</code>å¼€å¤´çš„å‡½æ•°æˆ–è€…ç±»ï¼Œå¯¹äºæˆ‘ä»¬è¿™ä¸ªæ¡ˆä¾‹æ¥è¯´ï¼Œä¸€å…±æœ‰ 5 ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œåœ¨è¾“å‡ºä¸­æˆ‘ä»¬ä¹Ÿèƒ½è¯¦ç»†åœ°æŸ¥çœ‹åˆ°é€šè¿‡å’Œå¤±è´¥çš„å…·ä½“ç”¨ä¾‹ï¼Œé”™è¯¯çš„åŸå› ï¼Œæ‰§è¡Œçš„æ—¶é—´ç­‰ç­‰ã€‚æ­¤å¤–ï¼Œpytest è¿˜æœ‰å…¶ä»–çš„åŠŸèƒ½ï¼ˆå¯å‚è€ƒ<a href=\"https://learning-pytest.readthedocs.io/zh/latest/index.html\">https://learning-pytest.readthedocs.io/zh/latest/index.html</a>ï¼‰ï¼Œå¦‚æµ‹è¯•å‰å’Œæµ‹è¯•åçš„é¢„å¤„ç†å’Œåå¤„ç†ï¼Œä½¿ç”¨æ’ä»¶ç”Ÿæˆæµ‹è¯•æŠ¥å‘Šç­‰ï¼Œè¿™é‡Œå°±ç®—æŠ›ç –å¼•ç‰ç»™å¤§å®¶ã€‚</p>\n<h2 id=\"CI-é›†æˆ\"><a href=\"#CI-é›†æˆ\" class=\"headerlink\" title=\"CI é›†æˆ\"></a>CI é›†æˆ</h2><p>æŒ‰ç…§å¼€å‘æµç¨‹æ¥è¯´ï¼Œæˆ‘ä»¬åœ¨æœ¬åœ°å¼€å‘å¹¶å•æµ‹å®Œåï¼Œä¼šå‘å¸ƒåˆ°æµ‹è¯•ç¯å¢ƒä¸­è¿›è¡Œè¿›ä¸€æ­¥åœ°è°ƒè¯•éªŒè¯ã€‚æœ‰æ—¶å€™æˆ‘ä»¬ä¿®æ”¹å®Œä»£ç åå¿˜è®°æ‰§è¡Œå¯¹åº”çš„å•æµ‹å°±æäº¤äº†ï¼Œç„¶ååœ¨è°ƒè¯•ä¸­æ‰å‘ç°äº†é”™è¯¯ï¼Œç„¶ååˆå›ç‚‰é‡é€ ã€‚ä¸ºäº†å°½é‡å‡å°‘ä¿®æ”¹å°é”™è¯¯åå¤å‘å¸ƒçš„æ—¶é—´ï¼Œæˆ‘ä»¬å¯ä»¥å°†è‡ªåŠ¨åŒ–æµ‹è¯•é›†æˆåˆ° gitlab pipelineï¼ˆä½¿ç”¨å‚è€ƒ<a href=\"https://docs.gitlab.com/ee/ci/pipelines/\">https://docs.gitlab.com/ee/ci/pipelines/</a>ï¼‰æˆ– github actions(ä½¿ç”¨å‚è€ƒ<a href=\"https://docs.github.com/zh/actions\">https://docs.github.com/zh/actions</a>)ã€‚</p>\n<h4 id=\"github-actions\"><a href=\"#github-actions\" class=\"headerlink\" title=\"github actions\"></a>github actions</h4><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">name:</span> <span class=\"string\">Python</span> <span class=\"string\">ci</span>           <span class=\"comment\"># workflowåå­—</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">on:</span>                            <span class=\"comment\"># è§¦å‘æ¡ä»¶ï¼Œpushæˆ–mergeåˆ°devä¸­è§¦å‘</span></span><br><span class=\"line\">  <span class=\"attr\">push:</span></span><br><span class=\"line\">    <span class=\"attr\">branches:</span> [ <span class=\"string\">&quot;dev&quot;</span> ]</span><br><span class=\"line\">  <span class=\"attr\">pull_request:</span></span><br><span class=\"line\">    <span class=\"attr\">branches:</span> [ <span class=\"string\">&quot;dev&quot;</span> ]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">jobs:</span></span><br><span class=\"line\">  <span class=\"attr\">build:</span></span><br><span class=\"line\">    <span class=\"attr\">runs-on:</span> <span class=\"string\">ubuntu-latest</span>    <span class=\"comment\"># è·‘åœ¨ubuntuè™šæ‹Ÿæœºä¸Š</span></span><br><span class=\"line\">    <span class=\"attr\">strategy:</span>                 <span class=\"comment\"># æ‰§è¡Œç­–ç•¥</span></span><br><span class=\"line\">      <span class=\"attr\">fail-fast:</span> <span class=\"literal\">false</span></span><br><span class=\"line\">      <span class=\"attr\">matrix:</span></span><br><span class=\"line\">        <span class=\"attr\">python-version:</span> [<span class=\"string\">&quot;3.10&quot;</span>]</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"attr\">steps:</span>                    <span class=\"comment\"># æ‰§è¡Œæ­¥éª¤</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">uses:</span> <span class=\"string\">actions/checkout@v4</span>    <span class=\"comment\"># ä½¿ç”¨checkoutè¿™ä¸ªå·²æœ‰çš„actionæ¥åˆå§‹åŒ–gitç¯å¢ƒ</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Set</span> <span class=\"string\">up</span> <span class=\"string\">Python</span> <span class=\"string\">$&#123;&#123;</span> <span class=\"string\">matrix.python-version</span> <span class=\"string\">&#125;&#125;</span>   <span class=\"comment\"># ä½¿ç”¨setup-pythonæ¥åˆå§‹åŒ–pythonç¯å¢ƒ</span></span><br><span class=\"line\">      <span class=\"attr\">uses:</span> <span class=\"string\">actions/setup-python@v3</span></span><br><span class=\"line\">      <span class=\"attr\">with:</span></span><br><span class=\"line\">        <span class=\"attr\">python-version:</span> <span class=\"string\">$&#123;&#123;</span> <span class=\"string\">matrix.python-version</span> <span class=\"string\">&#125;&#125;</span>     <span class=\"comment\"># æŒ‡å®špythonç‰ˆæœ¬</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Set</span> <span class=\"string\">up</span> <span class=\"string\">Poetry</span>                 <span class=\"comment\"># ä½¿ç”¨setup-poetryè¿™ä¸ªå·²æœ‰çš„actionæ¥åˆå§‹åŒ–poetry</span></span><br><span class=\"line\">      <span class=\"attr\">uses:</span> <span class=\"string\">Gr1N/setup-poetry@v9</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Install</span> <span class=\"string\">dependencies</span>         <span class=\"comment\"># ä½¿ç”¨poetryä¸‹è½½ä¾èµ–ï¼Œå› ä¸ºæ˜¯åœ¨ä¸€ä¸ªå•ç‹¬çš„è™šæ‹Ÿæœº/å®¹å™¨ä¸­ï¼Œæ‰€ä»¥æ— éœ€åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ</span></span><br><span class=\"line\">      <span class=\"attr\">run:</span> <span class=\"string\">|</span></span><br><span class=\"line\"><span class=\"string\">        poetry config virtualenvs.create false</span></span><br><span class=\"line\"><span class=\"string\">        poetry lock</span></span><br><span class=\"line\"><span class=\"string\">        poetry install --all-extras</span></span><br><span class=\"line\"><span class=\"string\"></span>    <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Test</span> <span class=\"string\">with</span> <span class=\"string\">pytest</span>            <span class=\"comment\"># ä½¿ç”¨pytestæ‰§è¡Œé›†æˆæµ‹è¯•</span></span><br><span class=\"line\">      <span class=\"attr\">env:</span></span><br><span class=\"line\">        <span class=\"attr\">LOG_CONFIG:</span> <span class=\"string\">./log.yaml</span></span><br><span class=\"line\">      <span class=\"attr\">run:</span> <span class=\"string\">|</span></span><br><span class=\"line\">        <span class=\"string\">pytest</span> <span class=\"string\">tests/</span> <span class=\"string\">-v</span></span><br></pre></td></tr></table></figure>\n\n<p>æˆ‘ä»¬æŠŠä¸Šé¢è¿™ä¸ª yml å‘½åä¸º ci.ymlï¼Œå¹¶æ”¾ç½®åœ¨é¡¹ç›®æ ¹ç›®å½•.github&#x2F;workflows ç›®å½•ä¸‹ï¼Œç„¶å github ä¼šè‡ªåŠ¨æ£€æµ‹åˆ° workflow çš„å­˜åœ¨å¹¶æŒ‰ç…§ yml ä¸­å®šä¹‰çš„æ­¥éª¤ä¾æ¬¡æ‰§è¡Œã€‚ç„¶åæˆ‘ä»¬åœ¨ dev åˆ†æ”¯ push åˆ°è¿œç¨‹ï¼Œç„¶åæˆ‘ä»¬ä¼šåœ¨ actions ä¸­å‘ç°å†å²æ‰§è¡Œ&#x2F;æ­£åœ¨æ‰§è¡Œçš„ workflowã€‚</p>\n<p><img src=\"https://image.robocanic.com/notes/github-action.png\" alt=\"github-action\"></p>\n<p>æˆ‘ä»¬ç‚¹è¿›æŸä¸€ä¸ª workflow å¯ä»¥çœ‹åˆ° job çš„æ‰§è¡Œç»“æœæ˜¯æˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼š</p>\n<p><img src=\"https://image.robocanic.com/notes/github-workflow-job.png\" alt=\"github-workflow-job\"></p>\n<p>è¿›ä¸€æ­¥ï¼Œæˆ‘ä»¬è¿›å…¥ build è¿™ä¸ª jobï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°é›†æˆæµ‹è¯•çš„ä¿¡æ¯ï¼š</p>\n<p><img src=\"https://image.robocanic.com/notes/job-test.png\" alt=\"job-test\"></p>\n<p>æ­¤å¤–ï¼Œgithub actions è¿˜å¯ä»¥æ¢ç´¢æ›´å¤šçš„ç©æ³•ï¼Œæ¯”å¦‚ï¼šå½“ job å¤±è´¥äº†å‘é€é‚®ä»¶åˆ°è‡ªå·±çš„é‚®ç®±æç¤ºæµæ°´çº¿å¤±è´¥äº†ï¼Œå½“ job å¤±è´¥äº†å›æ»šåˆ°ä¸Šä¸€ä¸ª commit çš„çŠ¶æ€ç­‰ç­‰ï¼Œè¿™äº›å°±éƒ½ç•™ç»™ä½ å»æ¢ç´¢äº†</p>\n<h4 id=\"gitlab-pipeline\"><a href=\"#gitlab-pipeline\" class=\"headerlink\" title=\"gitlab pipeline\"></a>gitlab pipeline</h4><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">stages:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">automatic_test_dev</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">automatic_test_job_dev:</span>   <span class=\"comment\"># æˆ‘ä»¬åªåœ¨æµ‹è¯•ç¯å¢ƒæ‰§è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œç”Ÿäº§ç¯å¢ƒä¸ºäº†åŠ å¿«å‘å¸ƒé€Ÿåº¦ï¼Œä¸æ‰§è¡Œæµ‹è¯•</span></span><br><span class=\"line\">  <span class=\"attr\">image:</span> <span class=\"string\">sunpeek/poetry:py3.10-slim</span>    <span class=\"comment\"># ä½¿ç”¨å¸¦poetryçš„pythoné•œåƒ</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">automatic_test_dev</span></span><br><span class=\"line\">  <span class=\"attr\">only:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">dev</span>                 <span class=\"comment\"># åªæœ‰devåˆ†æ”¯å‘ç”Ÿå˜åŒ–ï¼ˆmergeæˆ–pushï¼‰æ—¶è§¦å‘</span></span><br><span class=\"line\">  <span class=\"attr\">tags:</span>                   <span class=\"comment\"># åŒ¹é…pythonæ ‡ç­¾çš„runneræ‰è¿è¡Œ</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">python</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span>                 <span class=\"comment\"># æ‰§è¡Œè„šæœ¬</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">poetry</span> <span class=\"string\">config</span> <span class=\"string\">virtualenvs.create</span> <span class=\"literal\">false</span>  <span class=\"comment\"># åœ¨å®¹å™¨ä¸­ï¼Œä¸ç”¨åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">poetry</span> <span class=\"string\">lock</span>     <span class=\"comment\"># é”å®šä¾èµ–ç‰ˆæœ¬</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">poetry</span> <span class=\"string\">install</span>  <span class=\"comment\"># ä¸‹è½½ä¾èµ–</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">pytest</span> <span class=\"string\">tests/</span>   <span class=\"comment\"># æ‰§è¡Œæµ‹è¯•</span></span><br></pre></td></tr></table></figure>\n\n<p>æˆ‘ä»¬å°†è¿™ä¸ª yml æ–‡ä»¶å‘½åä¸º.gitlab-ci.ymlï¼Œç„¶å push åˆ° dev åˆ†æ”¯ï¼Œå°±ä¼šè§¦å‘ pipelineã€‚gitlab pipeline æœ¬è´¨ä¸Šå’Œ github actions æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯å£°æ˜å¼çš„æµæ°´çº¿ï¼Œå› æ­¤è¿™é‡Œå°±ä¸å†èµ˜è¿°ï¼Œä½ å¯ä»¥æŸ¥é˜…å®˜æ–¹æ–‡æ¡£ï¼ˆ<a href=\"https://docs.gitlab.com/ee/ci/pipelines/\">https://docs.gitlab.com/ee/ci/pipelines/</a>ï¼‰æ¥ç»„åˆå‡ºä½ çš„ pipelineã€‚</p>\n<h1 id=\"é¡¹ç›®å‘å¸ƒç®¡ç†\"><a href=\"#é¡¹ç›®å‘å¸ƒç®¡ç†\" class=\"headerlink\" title=\"é¡¹ç›®å‘å¸ƒç®¡ç†\"></a>é¡¹ç›®å‘å¸ƒç®¡ç†</h1><p>å½“æˆ‘ä»¬é¡¹ç›®åœ¨æœ¬åœ°è¿è¡Œ okï¼Œæµ‹è¯•ä¹Ÿ ok åï¼Œè¯¥è€ƒè™‘å‘å¸ƒåˆ°å„ä¸ªç¯å¢ƒï¼ˆè”è°ƒï¼Œæµ‹è¯•ï¼Œç”Ÿäº§ç­‰ï¼‰ã€‚è¿™ä¸ªè¿‡ç¨‹æ ¹æ®é¡¹ç›®çš„å±æ€§åˆ†ä¸ºä¸¤ç±»ï¼Œä¸€ç±»æ˜¯äºŒæ–¹åŒ…çš„å‘å¸ƒï¼Œå¦ä¸€ç±»åˆ™æ˜¯æ­£ç»åº”ç”¨å‘å¸ƒã€‚</p>\n<p>åœ¨è°ˆè¿™ä¸¤ç±»å‘å¸ƒä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥ç¡®è®¤å‘å¸ƒè¿‡ç¨‹ä¸­æˆ‘ä»¬æƒ³è¦è¾¾åˆ°çš„ç›®æ ‡ï¼ˆè¦æ±‚ï¼‰ï¼š</p>\n<ol>\n<li><p>å¯¹äºäºŒæ–¹åŒ…å‘å¸ƒï¼Œæˆ‘ä»¬å¸Œæœ›å®ƒåœ¨æœ¬åœ°å°±èƒ½å¤Ÿå‘å¸ƒ beta ç‰ˆæœ¬ï¼Œä»¥ä¾¿äºå¿«é€ŸéªŒè¯ã€‚æ­¤å¤–ï¼Œæ­£å¼ç‰ˆæœ¬çš„å‘å¸ƒï¼Œæˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿé›†æˆåˆ° CI ä¸­ã€‚</p>\n</li>\n<li><p>å¯¹äºåº”ç”¨å‘å¸ƒï¼Œæˆ‘ä»¬å¸Œæœ›å®ƒå‘å¸ƒæ—¶è¶³å¤Ÿè¿…é€Ÿï¼Œä»¥ä¾¿åœ¨å‡ºç°é—®é¢˜æ—¶å¿«é€Ÿæ¨é€è¡¥ä¸è§£å†³é—®é¢˜ã€‚</p>\n</li>\n<li><p>æ— è®ºæ˜¯äºŒæ–¹åŒ…è¿˜æ˜¯åº”ç”¨å‘å¸ƒï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨å‘å¸ƒçš„æ—¶å€™è‡ªåŠ¨æ‰§è¡Œé›†æˆæµ‹è¯•ï¼ˆç”Ÿäº§é™¤å¤–ï¼‰ï¼Œç”Ÿæˆä¸€ä»½æµ‹è¯•æŠ¥å‘Šã€‚</p>\n</li>\n</ol>\n<h2 id=\"äºŒæ–¹åŒ…å‘å¸ƒ\"><a href=\"#äºŒæ–¹åŒ…å‘å¸ƒ\" class=\"headerlink\" title=\"äºŒæ–¹åŒ…å‘å¸ƒ\"></a>äºŒæ–¹åŒ…å‘å¸ƒ</h2><p>äºŒæ–¹åŒ…çš„å‘å¸ƒæ ¹æ®æˆ‘ä»¬ä½¿ç”¨çš„é¡¹ç›®ç¯å¢ƒå’Œä¾èµ–ç®¡ç†å·¥å…·å¯ä»¥åˆ’åˆ†ä¸ºä¸¤ç±»ï¼Œç¬¬ä¸€ç±»æ˜¯ä½¿ç”¨ conda+pip æˆ–è€… venv+pip åçš„å‘å¸ƒæµç¨‹ï¼Œå¦ä¸€ç±»æ˜¯ä½¿ç”¨ poetry åçš„å‘å¸ƒæµç¨‹ã€‚</p>\n<h3 id=\"setuptools-twine\"><a href=\"#setuptools-twine\" class=\"headerlink\" title=\"setuptools+twine\"></a>setuptools+twine</h3><p>å‘å¸ƒåˆ†ä¸ºæ‰“åŒ…å’Œæ¨é€ä¸¤ä¸ªæ­¥éª¤ï¼Œsetuptools è´Ÿè´£å°†æˆ‘ä»¬çš„ python ä»£ç æ‰“åŒ…ï¼Œè€Œ twine åˆ™è´Ÿè´£å°†æ‰“åŒ…åçš„ pkg æ¨é€åˆ° PyPI ä»“åº“ã€‚</p>\n<p>setuptools æ˜¯å¾ˆå¤šå¹´æ¥ python æ‰“åŒ…çš„é¦–é€‰å·¥å…·ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦æ‰§è¡Œ<code>pip install setuptools</code>æ¥ä¸‹è½½è¿™ä¸ªå·¥å…·ã€‚ç„¶ååœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª<code>setup.py</code>æ–‡ä»¶æ¥å†™æ‰“åŒ…æ—¶çš„é…ç½®ï¼Œä¸€ä¸ª setup.py å¦‚ä¸‹æ‰€ç¤ºï¼š</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> setuptools <span class=\"keyword\">import</span> setup, find_packages</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">with</span> <span class=\"built_in\">open</span>(<span class=\"string\">&quot;README.md&quot;</span>, <span class=\"string\">&quot;r&quot;</span>, encoding=<span class=\"string\">&quot;UTF-8&quot;</span>) <span class=\"keyword\">as</span> fh:</span><br><span class=\"line\">    long_description = fh.read()</span><br><span class=\"line\">version= os.environ.get(<span class=\"string\">&quot;GITHUB_REF_NAME&quot;</span>, <span class=\"string\">&quot;0.0.1b0&quot;</span>) <span class=\"comment\"># åŒ…çš„ç‰ˆæœ¬ï¼ŒGITHUB_REF_NAMEæ˜¯github tag nameçš„ç¯å¢ƒå˜é‡ï¼Œä»£è¡¨ä»£ç åˆ†æ”¯TAGï¼›0.0.1b0 æ˜¯0.0.1-BETA0çš„ç¼©å†™</span></span><br><span class=\"line\">setup(</span><br><span class=\"line\">    name=<span class=\"string\">&#x27;poetry_fastapi_demo&#x27;</span>,  <span class=\"comment\"># åŒ…å</span></span><br><span class=\"line\">    version=version,     <span class=\"comment\"># æ„å»ºç‰ˆæœ¬</span></span><br><span class=\"line\">    author=<span class=\"string\">&#x27;robocanic&#x27;</span>,  <span class=\"comment\"># ä½œè€…</span></span><br><span class=\"line\">    author_email=<span class=\"string\">&#x27;robocanic@gmail.com&#x27;</span>,</span><br><span class=\"line\">    description=<span class=\"string\">&#x27;A web project template using poetry and fastapi.&#x27;</span>,   <span class=\"comment\"># æè¿°</span></span><br><span class=\"line\">    long_description=long_description,  <span class=\"comment\"># é•¿çš„æè¿°</span></span><br><span class=\"line\">    long_description_content_type=<span class=\"string\">&quot;text/markdown&quot;</span>,</span><br><span class=\"line\">    url=<span class=\"string\">&#x27;https://github.com/robocanic/poetry-fastapi-demo&#x27;</span>,</span><br><span class=\"line\">    packages=find_packages(),  <span class=\"comment\"># æ‰“åŒ…æ‰€æœ‰åŒ…ç›®å½•</span></span><br><span class=\"line\">    classifiers=[</span><br><span class=\"line\">        <span class=\"string\">&quot;Development Status :: 2 - Beta&quot;</span>    <span class=\"comment\"># å¼€å‘é˜¶æ®µ</span></span><br><span class=\"line\">        <span class=\"string\">&quot;Programming Language :: Python :: 3.10&quot;</span>,   <span class=\"comment\"># ä½¿ç”¨çš„è¯­è¨€</span></span><br><span class=\"line\">        <span class=\"string\">&quot;Operating System:: OS Independent&quot;</span>,   <span class=\"comment\"># ä¸é™å®šOS</span></span><br><span class=\"line\">    ],</span><br><span class=\"line\">    install_requires=[     <span class=\"comment\"># è¯¥é¡¹ç›®çš„ä¾èµ–ï¼Œåˆ«äººä¸‹è½½æˆ‘ä»¬çš„åŒ…æ—¶ä¼šè‡ªåŠ¨ä¸‹è½½è¿™äº›ä¾èµ–</span></span><br><span class=\"line\">        <span class=\"string\">&quot;fastapi==0.115.0&quot;</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;sqlalchemy==2.0.36&quot;</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;pyyaml==6.0.2&quot;</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;uvicorn=0.32.0&quot;</span></span><br><span class=\"line\">    ],</span><br><span class=\"line\">    python_requires=<span class=\"string\">&#x27;&gt;=3.10&#x27;</span>    <span class=\"comment\"># pythonè¦æ±‚</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p><code>setup.py</code>ä½¿ç”¨ä»£ç çš„æ–¹å¼å£°æ˜äº†æˆ‘ä»¬æ‰“åŒ…çš„é…ç½®ï¼ŒåŒ…æ‹¬æ„å»ºç‰ˆæœ¬ï¼Œç›´æ¥ä¾èµ–ï¼Œpython ç‰ˆæœ¬è¦æ±‚ç­‰ç­‰ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬åªéœ€è¦æ‰§è¡Œ<code>python setup.py sdist</code>å°±èƒ½å°†é¡¹ç›®æ‰“åŒ…æˆ.tar.gz æ–‡ä»¶ï¼Œå½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥æŒ‡å®šæ‰“åŒ…æ ¼å¼ä¸º<code>bdist_wheel</code>ï¼Œæ‰“åŒ…æˆ.wheel æ–‡ä»¶ã€‚æ‰“åŒ…åçš„æ–‡ä»¶é»˜è®¤æ”¾åœ¨ dist ç›®å½•ä¸‹ã€‚</p>\n<p>æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦ä½¿ç”¨ twine ä¸Šä¼ åˆ° PyPI ä»“åº“ï¼Œtwine ä¹Ÿæ˜¯ä¸€ä¸ª python åŒ…ï¼Œåœ¨ä½¿ç”¨ä¹‹å‰éœ€è¦é€šè¿‡<code>pip install twine</code>ä¸‹è½½ã€‚ç„¶åæ‰§è¡Œ<code>twine upload dist/*</code>å°±ä¸Šä¼ åˆ°äº†ä»“åº“ã€‚</p>\n<blockquote>\n<p>å¦‚æœè¦ä¸Šä¼ åˆ°ç§æœ‰çš„ PyPI ä»“åº“ï¼Œåˆ™éœ€è¦é…ç½®ä¸Šä¼ çš„ç”¨æˆ·åå’Œå¯†ç ï¼ŒåŒæ—¶åœ¨ä¸Šä¼ æ—¶éœ€è¦æŒ‡å®šç§æœ‰ä»“åº“ã€‚æœ€ä¾¿æ·çš„æ–¹æ³•æ˜¯åœ¨ root ç›®å½•ä¸‹æ–°å¢ä¸€ä¸ª.pypirc æ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹ä¸ºï¼š</p>\n</blockquote>\n<pre><code>[distutils]\n\n\nindex-servers = private-pypi\n\n[nexus]\n</code></pre>\n<p>repository&#x3D;<a href=\"https://private-pypi.com/simple/\">https://private-pypi.com/simple/</a><br>username&#x3D;foo<br>password&#x3D;bar<br>ç„¶åä½¿ç”¨<code>twine upload -r private-pypi dist/*</code> æ¥ä¸Šä¼ åˆ°æŒ‡å®šçš„ç§æœ‰ä»“åº“</p>\n<h3 id=\"poetry\"><a href=\"#poetry\" class=\"headerlink\" title=\"poetry\"></a>poetry</h3><p>å¦‚æœä½ ä½¿ç”¨äº† poetryï¼Œé‚£ poetry å°±è‡ªå¸¦äº†æ‰“åŒ…å’Œä¸Šä¼ çš„åŠŸèƒ½ã€‚poetry æ‰“åŒ…éå¸¸ç®€å•ï¼Œåªéœ€è¦æ‰§è¡Œ<code>poetry build</code>ï¼Œå®ƒå°±ä¼šå‚ç…§<code>pyproject.toml</code>ä¸­çš„é…ç½®è¿›è¡Œæ‰“åŒ…ã€‚æ‰“åŒ…ç”Ÿæˆçš„æ–‡ä»¶é»˜è®¤ä¹Ÿä¼šæ”¾åœ¨ dist ç›®å½•ä¸‹ã€‚</p>\n<p>ç„¶åæˆ‘ä»¬æ‰§è¡Œ<code>poetry publish</code>å°±å¯ä»¥å‘å¸ƒåˆ° PyPI ä»“åº“</p>\n<blockquote>\n<p>åŒæ ·ï¼Œè‹¥è¦ä½¿ç”¨ poetry ä¸Šä¼ åˆ°ç§æœ‰çš„ PyPI ä»“åº“ã€‚ä¹Ÿéœ€è¦é¢å¤–çš„é…ç½®ï¼š<br><code>poetry config repositories.foo-pub [https://pypi.example.org/legacy/](https://pypi.example.org/legacy/)</code> &gt; <code>poetry config http-basic.foo-pub &lt;username&gt; &lt;password&gt;</code> &gt; <code>poetry publish --repository foo-pub</code></p>\n</blockquote>\n<h3 id=\"CI-é›†æˆ-1\"><a href=\"#CI-é›†æˆ-1\" class=\"headerlink\" title=\"CI é›†æˆ\"></a>CI é›†æˆ</h3><p>å¾ˆå¤šæ—¶å€™æˆ‘ä»¬å‘ç°äº†ç‰¹å®šç‰ˆæœ¬åŒ…çš„ä¸€äº›é—®é¢˜ï¼Œæˆ‘ä»¬æƒ³è¦è¿™ä¸ªç‰¹å®šç‰ˆæœ¬çš„åŒ…å¯¹åº”çš„æºä»£ç ï¼Œå¹¶åœ¨æ­¤åŸºç¡€ä¸ŠåŠ ä¸€ä¸ªè¡¥ä¸ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦å°†æˆ‘ä»¬åŒ…çš„ç‰ˆæœ¬å’Œæˆ‘ä»¬ä»£ç çš„ç‰¹å®šåˆ†æ”¯ä¸€ä¸€å¯¹åº”ã€‚é€šè¿‡äººå·¥å®Œæˆè¿™ä¸ªè¿‡ç¨‹æ˜¯å¯è¡Œçš„ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨æ¯æ¬¡æ‰“åŒ…å‰&#x2F;å åŠ ä¸€ä¸ª commitï¼Œæ¨åˆ°è¿œç¨‹ä»“åº“ï¼Œæ‰“ä¸€ä¸ª tag å°±èƒ½å¯¹åº”èµ·æ¥ã€‚ä½†æ˜¯è¿™ä»¶é‡å¤çš„å·¥ä½œæˆ‘ä»¬æ—¶å¸¸ä¼šå¿˜è®°ï¼Œè¿™ä¸ªé‡å¤çš„å·¥ä½œå¯ä»¥äº¤ç»™ä¸€ä¸ªå•ç‹¬çš„ç¨‹åºæ¥åšå—ï¼Ÿç­”æ¡ˆå½“ç„¶æ˜¯è‚¯å®šçš„ï¼Œæ¯•ç«Ÿç¨‹åºå‘˜æœ€ä¹ æƒ¯çš„äº‹å°±æ˜¯å°†é‡å¤çš„å·¥ä½œç¨‹åºåŒ–ï¼Œå¤æ‚çš„å·¥ä½œæµç¨‹åŒ–ã€‚gitlab pipeline&#x2F;github actions èƒ½å¤Ÿé€šè¿‡æˆ‘ä»¬å£°æ˜çš„ yml æ–‡ä»¶æ¥å®Œæˆè¿™ä¸ªè¿‡ç¨‹ã€‚</p>\n<h4 id=\"gitlab-pipeline-1\"><a href=\"#gitlab-pipeline-1\" class=\"headerlink\" title=\"gitlab pipeline\"></a>gitlab pipeline</h4><p>ä¸€ä¸ªä½¿ç”¨ poetry çš„äºŒæ–¹åŒ…å‘å¸ƒçš„ gitlab pipeline æ–‡ä»¶å¯ä»¥å¦‚ä¸‹ï¼ˆé›†æˆäº†å•æµ‹ï¼‰ï¼š</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">image:</span> <span class=\"string\">sunpeek/poetry:py3.10-slim</span>   <span class=\"comment\"># éœ€è¦å¸¦æœ‰poetryçš„pythoné•œåƒ</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">stages:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">automatic_test</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">package_build_push</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">automatic_test_job:</span>   <span class=\"comment\">#</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">automatic_test</span></span><br><span class=\"line\">  <span class=\"attr\">only:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">dev</span></span><br><span class=\"line\">  <span class=\"attr\">tags:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">golang</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">poetry</span> <span class=\"string\">config</span> <span class=\"string\">virtualenvs.create</span> <span class=\"literal\">false</span>  <span class=\"comment\"># åœ¨å®¹å™¨ä¸­ï¼Œä¸ç”¨åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">poetry</span> <span class=\"string\">lock</span>     <span class=\"comment\"># é”å®šä¾èµ–ç‰ˆæœ¬</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">poetry</span> <span class=\"string\">install</span>  <span class=\"comment\"># ä¸‹è½½ä¾èµ–</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">pytest</span> <span class=\"string\">tests/</span>   <span class=\"comment\"># æ‰§è¡Œæµ‹è¯•</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">package_build_push_job:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">package_build_push</span></span><br><span class=\"line\">  <span class=\"attr\">only:</span>    <span class=\"comment\"># è§¦å‘æ¡ä»¶ï¼šåªæœ‰æ‰“tagä¹‹åæ‰ä¼šè§¦å‘è¯¥job</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">tags</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">poetry</span> <span class=\"string\">config</span> <span class=\"string\">repositories.foo-pub</span> <span class=\"string\">https://pypi.example.org/legacy/</span>   <span class=\"comment\"># æ·»åŠ å‘å¸ƒä»“åº“</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">poetry</span> <span class=\"string\">config</span> <span class=\"string\">http-basic.foo-pub</span> <span class=\"string\">$FOO_USERNAME</span> <span class=\"string\">$FOO_PASSWORD</span>          <span class=\"comment\"># æ·»åŠ å‘å¸ƒä»“åº“çš„ç”¨æˆ·åå¯†ç ï¼Œé€šè¿‡æµæ°´çº¿ç¯å¢ƒå˜é‡å¯ä»¥è®¾ç½®</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">sed</span> <span class=\"string\">-i</span> <span class=\"string\">&quot;s/^version = \\&quot;.*\\&quot;/version = \\&quot;$CI_COMMIT_TAG\\&quot;/&quot;</span> <span class=\"string\">pyproject.toml</span>  <span class=\"comment\"># ä¿®æ”¹æ„å»ºç‰ˆæœ¬ï¼Œä¸TAGä¸€è‡´</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">poetry</span> <span class=\"string\">publish</span> <span class=\"string\">--build</span>  <span class=\"string\">--repository</span> <span class=\"string\">foo-pub</span>   <span class=\"comment\"># æ‰“åŒ…å¹¶æ¨é€</span></span><br></pre></td></tr></table></figure>\n\n<p>ç®€å•æ¥è¯´ï¼Œgitlab åœ¨æˆ‘ä»¬æ‰“ä¸Šä¸€ä¸ª tag ä¹‹åï¼Œä¼šèµ·ä¸€ä¸ª runner æ‰§è¡Œè¿™ä¸ª yml æ–‡ä»¶çš„ scriptï¼ˆå…·ä½“è¿‡ç¨‹å¯è‡ªè¡Œäº†è§£ï¼‰ã€‚å› æ­¤å½“æˆ‘ä»¬æƒ³è¦å‘å¸ƒä¸€ä¸ªç‰ˆæœ¬æ—¶ï¼Œæ¨åˆ°é•œåƒä»“åº“åï¼Œæ‰“ä¸€ä¸ª tagï¼Œgitlab pipeline å°±ä¼šè¿›è¡Œæ‰“åŒ…ï¼Œæ¨é€ï¼Œå¹¶ä¸”æ¨é€åˆ°ä»“åº“çš„åŒ…çš„ç‰ˆæœ¬å’Œæˆ‘ä»¬çš„ TAG æ˜¯ä¸¥æ ¼å¯¹åº”çš„ã€‚</p>\n<h4 id=\"github-actions-1\"><a href=\"#github-actions-1\" class=\"headerlink\" title=\"github actions\"></a>github actions</h4><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">name:</span> <span class=\"string\">Release</span> <span class=\"string\">package</span>           <span class=\"comment\"># workflowåå­—</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">on:</span>                            <span class=\"comment\"># è§¦å‘æ¡ä»¶ï¼Œæ–°å»ºtagæ—¶è§¦å‘</span></span><br><span class=\"line\">  <span class=\"attr\">push:</span></span><br><span class=\"line\">    <span class=\"attr\">tags:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">&#x27;*&#x27;</span>                  <span class=\"comment\"># ä»»æ„æ ‡ç­¾éƒ½ä¼šè§¦å‘å·¥ä½œæµ</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">jobs:</span></span><br><span class=\"line\">  <span class=\"attr\">pkg:</span></span><br><span class=\"line\">    <span class=\"attr\">runs-on:</span> <span class=\"string\">ubuntu-latest</span></span><br><span class=\"line\">    <span class=\"attr\">steps:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"attr\">uses:</span> <span class=\"string\">actions/checkout@v4</span>    <span class=\"comment\"># ä½¿ç”¨checkoutè¿™ä¸ªå·²æœ‰çš„actionæ¥åˆå§‹åŒ–gitç¯å¢ƒ</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Set</span> <span class=\"string\">up</span> <span class=\"string\">Python</span> <span class=\"string\">$&#123;&#123;</span> <span class=\"string\">matrix.python-version</span> <span class=\"string\">&#125;&#125;</span>   <span class=\"comment\"># ä½¿ç”¨setup-pythonæ¥åˆå§‹åŒ–pythonç¯å¢ƒ</span></span><br><span class=\"line\">        <span class=\"attr\">uses:</span> <span class=\"string\">actions/setup-python@v3</span></span><br><span class=\"line\">        <span class=\"attr\">with:</span></span><br><span class=\"line\">          <span class=\"attr\">python-version:</span> <span class=\"string\">$&#123;&#123;</span> <span class=\"string\">matrix.python-version</span> <span class=\"string\">&#125;&#125;</span>     <span class=\"comment\"># æŒ‡å®špythonç‰ˆæœ¬</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Set</span> <span class=\"string\">up</span> <span class=\"string\">Poetry</span>                 <span class=\"comment\"># ä½¿ç”¨setup-poetryè¿™ä¸ªå·²æœ‰çš„actionæ¥åˆå§‹åŒ–poetry</span></span><br><span class=\"line\">        <span class=\"attr\">uses:</span> <span class=\"string\">Gr1N/setup-poetry@v9</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Extract</span> <span class=\"string\">version</span></span><br><span class=\"line\">        <span class=\"attr\">id:</span> <span class=\"string\">extract_version</span></span><br><span class=\"line\">        <span class=\"attr\">run:</span> <span class=\"string\">|</span></span><br><span class=\"line\"><span class=\"string\">          VERSION=&quot;$&#123;GITHUB_REF#refs/tags/&#125;&quot;</span></span><br><span class=\"line\"><span class=\"string\">          echo &quot;VERSION=$&#123;VERSION&#125;&quot; &gt;&gt; $GITHUB_ENV</span></span><br><span class=\"line\"><span class=\"string\"></span>      <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Replace</span> <span class=\"string\">version</span></span><br><span class=\"line\">        <span class=\"attr\">run:</span> <span class=\"string\">|</span></span><br><span class=\"line\"><span class=\"string\">          sed -i &quot;s/^version = \\&quot;.*\\&quot;/version = \\&quot;$&#123;&#123; env.VERSION &#125;&#125;\\&quot;/&quot; pyproject.toml</span></span><br><span class=\"line\"><span class=\"string\"></span>      <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Build</span> <span class=\"string\">Package</span>        <span class=\"comment\"># æ‰“åŒ…</span></span><br><span class=\"line\">        <span class=\"attr\">run:</span> <span class=\"string\">|</span></span><br><span class=\"line\"><span class=\"string\">          poetry config virtualenvs.create false</span></span><br><span class=\"line\"><span class=\"string\">          poetry build</span></span><br><span class=\"line\"><span class=\"string\"></span>      <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Publish</span> <span class=\"string\">Package</span>    <span class=\"comment\"># å‘å¸ƒ</span></span><br><span class=\"line\">        <span class=\"attr\">env:</span></span><br><span class=\"line\">          <span class=\"attr\">PYPI_API_TOKEN:</span> <span class=\"string\">$&#123;&#123;</span> <span class=\"string\">secrets.PYPI_API_TOKEN</span> <span class=\"string\">&#125;&#125;</span>    <span class=\"comment\"># æå‰å®šä¹‰pypiçš„ api token</span></span><br><span class=\"line\">        <span class=\"attr\">run:</span> <span class=\"string\">|</span></span><br><span class=\"line\"><span class=\"string\">          poetry config pypi-token.pypi $PYPI_API_TOKEN</span></span><br><span class=\"line\"><span class=\"string\">          poetry publish</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"æ€»ç»“-1\"><a href=\"#æ€»ç»“-1\" class=\"headerlink\" title=\"æ€»ç»“\"></a>æ€»ç»“</h4><p>poetry ä½œä¸ºé›†ç¯å¢ƒç®¡ç†ï¼Œä¾èµ–ç®¡ç†ï¼Œæ‰“åŒ…å‘å¸ƒä¸€ä½“çš„å·¥å…·ï¼Œè™½ç„¶æœ‰ä¸Šæ‰‹éš¾åº¦ï¼Œä½†ä»é•¿æœŸæ¥çœ‹æ˜¯å€¼å¾—ä½¿ç”¨çš„ï¼Œå¼ºçƒˆæ¨èã€‚gitlab pipeline&#x2F;github actions çš„ä½¿ç”¨å€’æ˜¯å¯ä»¥çœ‹è‡ªèº«éœ€æ±‚ï¼Œå¦‚æœé¡¹ç›®æ¯”è¾ƒå°ï¼Œå‘å¸ƒæ¬¡æ•°å°‘ï¼Œä¸è¦æ±‚ä»£ç åˆ†æ”¯ä¸åŒ…çš„ç‰ˆæœ¬ä¸¥æ ¼å¯¹åº”ï¼Œæ˜¯å¯ä»¥ä¸ç”¨çš„ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨ gitlab pipeline æ—¶ä¹Ÿå¯ä»¥é€‚å½“æ²¡é‚£ä¹ˆâ€œä¸¥æ ¼â€ï¼Œæ¯”å¦‚ï¼Œä¸ºäº†å›¾æ–¹ä¾¿æˆ‘ä»¬å¯ä»¥åœ¨æœ¬åœ°å‘å¸ƒéæ­£å¼ç‰ˆæœ¬ï¼Œè€Œæ­£å¼ç‰ˆæœ¬åˆ™èµ° pipelineï¼Œä¿è¯æ­£å¼ç‰ˆæœ¬çš„ç¨³å®šã€‚</p>\n<h2 id=\"åº”ç”¨å‘å¸ƒ\"><a href=\"#åº”ç”¨å‘å¸ƒ\" class=\"headerlink\" title=\"åº”ç”¨å‘å¸ƒ\"></a>åº”ç”¨å‘å¸ƒ</h2><p>åº”ç”¨å‘å¸ƒå³è®©æˆ‘ä»¬çš„åº”ç”¨è¿è¡Œåœ¨æœºå™¨ä¸Šï¼Œå¯¹å¤–æä¾›æœåŠ¡ã€‚åº”ç”¨çš„è¿è¡Œå½¢æ€å¯ä»¥åŸºæœ¬åˆ†ä¸ºå®¹å™¨&#x2F;è™šæ‹Ÿæœºï¼Œåæ–‡ä¸­éƒ½åŸºäºä½¿ç”¨æ›´å¹¿æ³›çš„å®¹å™¨æ¥è¿›è¡Œè¯´æ˜ã€‚</p>\n<p>åº”ç”¨å‘å¸ƒå¤§ä½“ä¸Šåˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼Œä¸€ä¸ªæ˜¯é•œåƒçš„æ‰“åŒ…ä¸æ¨é€ï¼Œå¦ä¸€ä¸ªæ˜¯é•œåƒæ‹‰å–å’Œå¯åŠ¨å®¹å™¨ã€‚å…¶ä¸­ï¼Œé•œåƒæ¨é€ï¼Œé•œåƒæ‹‰å–å’Œå¯åŠ¨å®¹å™¨å¯¹äºæ¯ä¸€ç§åº”ç”¨ç¨‹åºéƒ½æ˜¯å¤§å·®ä¸å·®çš„ï¼Œè€Œé•œåƒæ‰“åŒ…åˆ™æ˜¯å·®å¼‚æ¯”è¾ƒå¤§çš„ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘å°±é•œåƒæ‰“åŒ…å±•å¼€æ¥è®²ã€‚</p>\n<h3 id=\"é•œåƒæ‰“åŒ…\"><a href=\"#é•œåƒæ‰“åŒ…\" class=\"headerlink\" title=\"é•œåƒæ‰“åŒ…\"></a>é•œåƒæ‰“åŒ…</h3><p>é•œåƒçš„å¤§å°å…³ä¹åˆ°æ¨é€å’Œæ‹‰å–çš„æ•ˆç‡ï¼Œå› æ­¤æˆ‘ä»¬è¦å°½å¯èƒ½åœ°å‡å°é•œåƒå¤§å°ã€‚python çš„åŸºç¡€é•œåƒä¸­ï¼Œ<code>slim</code>ç‰ˆæœ¬çš„åŸºç¡€é•œåƒç§»é™¤äº†ä¸å¿…è¦çš„ç³»ç»Ÿä¸ªå·¥å…·å’Œåº“ï¼Œå› æ­¤åŸºç¡€é•œåƒæˆ‘ä»¬é€‰æ‹©<code>slim</code>ç‰ˆæœ¬ï¼ˆ127MB å·¦å³ï¼‰ã€‚</p>\n<p>æ­¤å¤–ï¼Œæˆ‘ä»¬å¦‚æœä½¿ç”¨äº† poetry æ¥ä½œä¸ºä¾èµ–ç®¡ç†çš„å·¥å…·ï¼Œé‚£åœ¨æ‰“åŒ…æ—¶å°±æœ‰ä¸¤ç§é€‰æ‹©ï¼šç¬¬ä¸€ç§æ˜¯ç›´æ¥å°† poetry æ‰“åˆ°åŸºç¡€é•œåƒä¸­ï¼Œç¬¬äºŒç§æ˜¯ä½¿ç”¨ multi-stage buildï¼Œå³åœ¨ç¬¬ä¸€ä¸ªé˜¶æ®µå…ˆä¸‹è½½ poetryï¼Œå¯¼å‡ºä¾èµ–åˆ° requirements.txtï¼Œç„¶ååœ¨ç¬¬äºŒä¸ªé˜¶æ®µä½¿ç”¨ pip install æ¥ä¸‹è½½ä¾èµ–ã€‚multi-stage build è™½ç„¶æœ€ç»ˆçš„é•œåƒé‡Œä¸åŒ…å« poetryï¼Œä½†æ˜¯ç¬¬ä¸€ä¸ªé˜¶æ®µä¸‹è½½ poetry å’Œå¯¼å‡ºä¾èµ–éƒ½éœ€è¦æ—¶é—´ï¼Œè€Œç¬¬ä¸€ç§æ–¹æ³•ä¸­ç›´æ¥å°† poetry æ‰“åˆ°åŸºç¡€é•œåƒä¸­ï¼Œé•œåƒå¤§å°ä¹Ÿåªå¢åŠ äº†ä¸åˆ° 100MBï¼Œåœ¨å¯ä»¥æ¥å—çš„èŒƒå›´å†…ï¼Œå› æ­¤æˆ‘æ›´æ¨èç¬¬ä¸€ç§ã€‚</p>\n<p>ç¡®å®šå¥½é•œåƒç­–ç•¥åï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ Dockerfile é•¿å•¥æ ·ï¼ˆåŸºç¡€é•œåƒçš„æ‰“åŒ…å°±æ˜¯åœ¨ python åŸºç¡€é•œåƒçš„ä¸Šé¢ä½¿ç”¨ pip ä¸‹è½½ poetry å³å¯ï¼Œä¸å†èµ˜è¿°ï¼‰ï¼š</p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># åŒ…å«poetryçš„pythonåŸºç¡€é•œåƒ</span></span><br><span class=\"line\"><span class=\"keyword\">FROM</span> sunpeek/poetry:py3.<span class=\"number\">10</span>-slim</span><br><span class=\"line\"><span class=\"keyword\">LABEL</span><span class=\"language-bash\"> maintainer=<span class=\"string\">&quot;robocanic@gmail.com&quot;</span></span></span><br><span class=\"line\"><span class=\"comment\"># Keeps Python from generating .pyc files in the container</span></span><br><span class=\"line\"><span class=\"keyword\">ENV</span> PYTHONDONTWRITEBYTECODE=<span class=\"number\">1</span></span><br><span class=\"line\"><span class=\"comment\"># Turns off buffering for easier container logging</span></span><br><span class=\"line\"><span class=\"keyword\">ENV</span> PYTHONUNBUFFERED=<span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># mv source code to a specific directory</span></span><br><span class=\"line\"><span class=\"keyword\">WORKDIR</span><span class=\"language-bash\"> /appruntime</span></span><br><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"language-bash\"> . /appruntime</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># no need to create virtual env</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"language-bash\"> poetry config virtualenvs.create <span class=\"literal\">false</span></span></span><br><span class=\"line\"><span class=\"comment\"># analyze deps</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"language-bash\"> poetry lock</span></span><br><span class=\"line\"><span class=\"comment\"># Install deps</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"language-bash\"> poetry install</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Creates a non-root user with an explicit UID and adds permission to access the /appruntime folder</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"language-bash\"> adduser -u 5678 --disabled-password --gecos <span class=\"string\">&quot;&quot;</span> appuser &amp;&amp; <span class=\"built_in\">chown</span> -R appuser /appruntime</span></span><br><span class=\"line\"><span class=\"keyword\">USER</span> appuser</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">CMD</span><span class=\"language-bash\"> [<span class=\"string\">&quot;uvicorn&quot;</span>, <span class=\"string\">&quot;poetry_fastapi_demo.main:app&quot;</span>, <span class=\"string\">&quot;--host=0.0.0.0&quot;</span>, <span class=\"string\">&quot;--port=8080&quot;</span>, <span class=\"string\">&quot;--log-config=/appruntime/log.yaml&quot;</span>]</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"CI-é›†æˆ-2\"><a href=\"#CI-é›†æˆ-2\" class=\"headerlink\" title=\"CI é›†æˆ\"></a>CI é›†æˆ</h3><p>å¦‚æœä½¿ç”¨äº† gitlab pipeline&#x2F;github actionsï¼Œé‚£æˆ‘ä»¬å¯ä»¥å°†é•œåƒæ‰“åŒ…ï¼Œé•œåƒæ¨é€éƒ½ç»“åˆåˆ° CI ä¸­</p>\n<h4 id=\"gitlab-pipeline-2\"><a href=\"#gitlab-pipeline-2\" class=\"headerlink\" title=\"gitlab pipeline\"></a>gitlab pipeline</h4><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">variables:</span>    <span class=\"comment\"># å˜é‡</span></span><br><span class=\"line\">  <span class=\"attr\">IMAGE_NAME:</span> <span class=\"string\">$CI_PROJECT_PATH</span></span><br><span class=\"line\">  <span class=\"attr\">PROJECT_NAME:</span> <span class=\"string\">$CI_PROJECT_NAME</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">stages:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">automatic_test_dev</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">package_build_push_dev</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">deploy_dev</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">automatic_test_job_dev:</span>   <span class=\"comment\"># æˆ‘ä»¬åªåœ¨è”è°ƒ/æµ‹è¯•æ—¶æ‰§è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œç”Ÿäº§ç¯å¢ƒä¸ºäº†åŠ å¿«å‘å¸ƒé€Ÿåº¦ï¼Œä¸æ‰§è¡Œæµ‹è¯•</span></span><br><span class=\"line\">  <span class=\"attr\">image:</span> <span class=\"string\">sunpeek/poetry:py3.10-slim</span>    <span class=\"comment\"># ä½¿ç”¨å¸¦poetryçš„pythoné•œåƒ</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">automatic_test_dev</span></span><br><span class=\"line\">  <span class=\"attr\">only:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">dev</span></span><br><span class=\"line\">  <span class=\"attr\">tags:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">python</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">poetry</span> <span class=\"string\">config</span> <span class=\"string\">virtualenvs.create</span> <span class=\"literal\">false</span>  <span class=\"comment\"># åœ¨å®¹å™¨ä¸­ï¼Œä¸ç”¨åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">poetry</span> <span class=\"string\">lock</span>     <span class=\"comment\"># é”å®šä¾èµ–ç‰ˆæœ¬</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">poetry</span> <span class=\"string\">install</span>  <span class=\"comment\"># ä¸‹è½½ä¾èµ–</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">pytest</span> <span class=\"string\">tests/</span>   <span class=\"comment\"># æ‰§è¡Œæµ‹è¯•</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">package_build_push_job_dev:</span></span><br><span class=\"line\">  <span class=\"attr\">image:</span> <span class=\"string\">docker:27.3</span>  <span class=\"comment\"># ä½¿ç”¨dockeré•œåƒ</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">package_build_push_dev</span></span><br><span class=\"line\">  <span class=\"attr\">only:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">dev</span></span><br><span class=\"line\">  <span class=\"attr\">tags:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">python</span></span><br><span class=\"line\">  <span class=\"attr\">artifacts:</span></span><br><span class=\"line\">    <span class=\"attr\">paths:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">BUILDTIME</span>   <span class=\"comment\"># ç¼“å­˜æ„å»ºæ—¶é—´æ–‡ä»¶ä¾›ä¸‹ä¸€ä¸ªjobä½¿ç”¨</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">date</span> <span class=\"string\">+&#x27;%Y%m%d%H%M&#x27;</span> <span class=\"string\">&gt;</span> <span class=\"string\">BUILDTIME</span>  <span class=\"comment\"># å°†æ„å»ºæ—¶é—´å†™åˆ°æ–‡ä»¶</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">export</span> <span class=\"string\">IMAGE_TAG=dev-$(cat</span> <span class=\"string\">BUILDTIME)-$CI_COMMIT_SHORT_SHA</span> <span class=\"comment\"># é•œåƒtag  dev-[å¹´æœˆæ—¥æ—¶åˆ†]-[commit idå‰å…«ä½]</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">export</span> <span class=\"string\">IMAGE_NAME=$(echo</span> <span class=\"string\">$IMAGE_NAME</span> <span class=\"string\">|</span> <span class=\"string\">tr</span> <span class=\"string\">&#x27;A-Z&#x27;</span> <span class=\"string\">&#x27;a-z&#x27;</span><span class=\"string\">)</span>  <span class=\"comment\"># æŠŠgitlabçš„ç›®å½•å’Œé¡¹ç›®åå°å†™ä½œä¸ºé•œåƒå</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker</span> <span class=\"string\">login</span> <span class=\"string\">-u</span> <span class=\"string\">$REGISTRY_USERNAME</span> <span class=\"string\">-p</span> <span class=\"string\">$REGISTRY_PASSWORD</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker</span> <span class=\"string\">build</span>  <span class=\"string\">-t</span> <span class=\"string\">$IMAGE_NAME:$IMAGE_TAG</span> <span class=\"string\">.</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker</span> <span class=\"string\">push</span> <span class=\"string\">$IMAGE_NAME:$IMAGE_TAG</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"github-actions-2\"><a href=\"#github-actions-2\" class=\"headerlink\" title=\"github actions\"></a>github actions</h4><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">name:</span> <span class=\"string\">Release</span> <span class=\"string\">deploy</span>           <span class=\"comment\"># workflowåå­—</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">on:</span>                            <span class=\"comment\"># è§¦å‘æ¡ä»¶ï¼Œæ–°å»ºtagæ—¶è§¦å‘</span></span><br><span class=\"line\">  <span class=\"attr\">push:</span></span><br><span class=\"line\">    <span class=\"attr\">tags:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">&#x27;*&#x27;</span>                   <span class=\"comment\"># ä»»æ„æ ‡ç­¾éƒ½ä¼šè§¦å‘å·¥ä½œæµ</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">jobs:</span></span><br><span class=\"line\">  <span class=\"attr\">pkg:</span></span><br><span class=\"line\">    <span class=\"attr\">runs-on:</span> <span class=\"string\">ubuntu-latest</span></span><br><span class=\"line\">    <span class=\"attr\">steps:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Set</span> <span class=\"string\">up</span> <span class=\"string\">QEMU</span>       <span class=\"comment\"># åˆå§‹åŒ–qemu</span></span><br><span class=\"line\">        <span class=\"attr\">uses:</span> <span class=\"string\">docker/setup-qemu-action@v3</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Set</span> <span class=\"string\">up</span> <span class=\"string\">Docker</span> <span class=\"string\">Buildx</span>   <span class=\"comment\"># åˆå§‹åŒ–buildx</span></span><br><span class=\"line\">        <span class=\"attr\">uses:</span> <span class=\"string\">docker/setup-buildx-action@v3</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Login</span> <span class=\"string\">to</span> <span class=\"string\">Docker</span> <span class=\"string\">Hub</span>   <span class=\"comment\"># ç™»å½•dockerhub</span></span><br><span class=\"line\">        <span class=\"attr\">uses:</span> <span class=\"string\">docker/login-action@v3</span></span><br><span class=\"line\">        <span class=\"attr\">with:</span></span><br><span class=\"line\">          <span class=\"attr\">username:</span> <span class=\"string\">$&#123;&#123;</span> <span class=\"string\">secrets.DOCKERHUB_USERNAME</span> <span class=\"string\">&#125;&#125;</span></span><br><span class=\"line\">          <span class=\"attr\">password:</span> <span class=\"string\">$&#123;&#123;</span> <span class=\"string\">secrets.DOCKERHUB_PASSWORD</span> <span class=\"string\">&#125;&#125;</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Extract</span> <span class=\"string\">version</span>   <span class=\"comment\"># æå–tag</span></span><br><span class=\"line\">        <span class=\"attr\">id:</span> <span class=\"string\">extract_version</span></span><br><span class=\"line\">        <span class=\"attr\">run:</span> <span class=\"string\">|</span></span><br><span class=\"line\"><span class=\"string\">          VERSION=&quot;$&#123;GITHUB_REF#refs/tags/&#125;&quot;</span></span><br><span class=\"line\"><span class=\"string\">          echo &quot;VERSION=$&#123;VERSION&#125;&quot; &gt;&gt; $GITHUB_ENV</span></span><br><span class=\"line\"><span class=\"string\"></span>      <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Build</span> <span class=\"string\">and</span> <span class=\"string\">push</span>   <span class=\"comment\"># æ„å»ºé•œåƒå¹¶æ¨é€</span></span><br><span class=\"line\">        <span class=\"attr\">uses:</span> <span class=\"string\">docker/build-push-action@v6</span></span><br><span class=\"line\">        <span class=\"attr\">with:</span></span><br><span class=\"line\">          <span class=\"attr\">push:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">          <span class=\"attr\">tags:</span> <span class=\"string\">$&#123;&#123;</span> <span class=\"string\">github.repository</span> <span class=\"string\">&#125;&#125;:$&#123;&#123;</span> <span class=\"string\">env.VERSION</span> <span class=\"string\">&#125;&#125;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"æ€»ç»“-2\"><a href=\"#æ€»ç»“-2\" class=\"headerlink\" title=\"æ€»ç»“\"></a>æ€»ç»“</h3><p>å¦‚æœä½ ä½¿ç”¨ docker compose&#x2F;docker swarm&#x2F;k8s ç­‰åŸºç¡€è®¾æ–½ï¼Œä½ è¿˜å¯ä»¥ç»“åˆ docker&#x2F;kubectl æˆ–è€… docker api&#x2F;k8s api æ¥è¿›è¡Œ CDï¼Œä»è€Œå®ç°åº”ç”¨ä»å‘å¸ƒåˆ°éƒ¨ç½²å®Œå…¨æµæ°´çº¿åŒ–ã€‚</p>\n<p>åº”ç”¨çš„å‘å¸ƒåœ¨ä¸åŒçš„å›¢é˜Ÿï¼Œä¸åŒçš„å…¬å¸æ˜¯æœ‰ç€ä¸åŒçš„æµç¨‹å’Œåå¥½çš„ï¼Œä»¥ä¸Šåªæ˜¯æˆ‘æä¾›çš„ä¸€ç§å®ç°å‚è€ƒï¼Œä½†æ˜¯æ— è®ºæ˜¯ä»€ä¹ˆå‘å¸ƒæµç¨‹ï¼Œè€ƒè™‘çš„é‡ç‚¹å…¶å®æ˜¯å¤§å·®ä¸å·®çš„ï¼š</p>\n<ol>\n<li><p>é•œåƒå¤§å°è¦å°½å¯èƒ½å‹ç¼©</p>\n</li>\n<li><p>å‘å¸ƒè¦åšåˆ°å¯å›æ»šï¼Œå¯ç°åº¦</p>\n</li>\n<li><p>å‘å¸ƒæµç¨‹ä¸­çš„ä¿¡æ¯è¦å¯è¿½æº¯</p>\n</li>\n<li><p>å‘å¸ƒä¸­ç”¨åˆ°çš„ç»„ä»¶å¤ç”¨åº¦è¦é«˜</p>\n</li>\n<li><p>â€¦â€¦</p>\n</li>\n</ol>\n<p>æŒ‰ç…§è¿™äº›ä¸ªæ€è·¯å»ç¼–æ’å‘å¸ƒæµæ°´çº¿ï¼Œç›¸ä¿¡ä½ èƒ½å¾—åˆ°ä¸€ä¸ªç†æƒ³ä¸­çš„æµæ°´çº¿ã€‚</p>\n","excerpt":"","more":"<p>Python ä½œä¸ºä¸€ä¸ªå¼±ç±»å‹è¯­è¨€ï¼Œä¼¼ä¹ä»è¯ç”Ÿä¹‹åˆå°±è¢«å¾ˆå¤šäººè§‰å¾—è¿™æ˜¯ä¸€ä¸ªå¾ˆéšä¾¿çš„è¯­è¨€ï¼Œæ„å»ºä¸€ä¸ªå¯é çš„ Python é¡¹ç›®æ˜¯ä¸€ä¸ªå¾ˆéš¾çš„äº‹æƒ…ã€‚äº‹å®ä¹Ÿç¡®å®å¦‚æ­¤ï¼Œéšç€ AI çš„çˆ†å‘ï¼Œå…¥å‘ Python çš„äººè¶Šæ¥è¶Šå¤šï¼Œä½†å¯¹ Python çš„è¯Ÿç—…å´åªå¢ä¸å‡ã€‚ä¸è¿‡ï¼ŒPython å·¥ç¨‹åŒ–è¿˜æ˜¯åœ¨è¯Ÿç—…ä¸­æ›²æŠ˜å‰è¿›çš„ï¼Œåˆ°ä»Šå¤©ä¸ºæ­¢ï¼Œå°½ç®¡è¿˜å­˜åœ¨ç€ä¸€äº›æ··ä¹±ï¼ŒPython å·¥ç¨‹åŒ–çš„æ ‡å‡†è¶‹äºåŸºæœ¬å®Œå–„ã€‚æœ¬ç¯‡å°†ä»â€œè¿‡æ¥äººâ€çš„è§†è§’ï¼Œç”±æµ…å…¥æ·±åœ°è®²è¿° python å·¥ç¨‹åŒ–çš„æ–¹æ–¹é¢é¢ï¼Œæä¾›ä¸€ä¸ªæœ€ä½³å®è·µä¾›ä½ å‚è€ƒã€‚</p>\n<h1 id=\"é¡¹ç›®ç›®å½•ç»“æ„\"><a href=\"#é¡¹ç›®ç›®å½•ç»“æ„\" class=\"headerlink\" title=\"é¡¹ç›®ç›®å½•ç»“æ„\"></a>é¡¹ç›®ç›®å½•ç»“æ„</h1><p>Python ä½œä¸ºè„šæœ¬è¯­è¨€ï¼Œä¸€ä¸ª.py æ–‡ä»¶èƒ½æ”¾åœ¨ä»»ä½•åœ°æ–¹è¿è¡Œï¼Œä½†æ˜¯<strong>ä¸€ä¸ªæ¸…æ™°çš„ç›®å½•ç»“æ„ä¸ä»…æ˜“äºæ’æŸ¥é—®é¢˜ï¼Œæ›´æ–¹ä¾¿åˆ«äººè¯»æ‡‚æˆ‘ä»¬çš„ä»£ç ï¼Œæ›´åŠ ä¼˜é›…</strong>ã€‚Python ç”±äºå…¶åº”ç”¨å¹¿æ³›ï¼Œä¸åŒç±»å‹çš„ Python é¡¹ç›®ä¹Ÿæœ‰ç€ä¸åŒçš„ç›®å½•ç»“æ„è§„çº¦ã€‚è¿™é‡Œæˆ‘é€‰å–æ™®é€šåº”ç”¨å·¥ç¨‹å’Œæ•°æ®&#x2F;AI å·¥ç¨‹è¿™ä¸¤ç§æœ€ä¸ºå¹¿æ³›çš„ç±»å‹è¿›è¡Œè¯´æ˜ã€‚</p>\n<h2 id=\"æ™®é€šåº”ç”¨å·¥ç¨‹\"><a href=\"#æ™®é€šåº”ç”¨å·¥ç¨‹\" class=\"headerlink\" title=\"æ™®é€šåº”ç”¨å·¥ç¨‹\"></a>æ™®é€šåº”ç”¨å·¥ç¨‹</h2><p>å‡å®šæˆ‘ä»¬çš„é¡¹ç›®åä¸º<code>robocanic-project</code>ï¼Œæ™®é€šåº”ç”¨å·¥ç¨‹æœ€å¸¸ç”¨çš„ç›®å½•ç»“æ„é£æ ¼å¦‚ä¸‹æ‰€ç¤ºï¼š</p>\n<figure class=\"highlight plaintext\"><figcaption><span>Text</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Â robocanic-project/</span><br><span class=\"line\">Â â”‚</span><br><span class=\"line\">Â â”œâ”€â”€ robocanic_project/ Â  Â   # ä¸»åŒ…ï¼Œæˆ‘ä»¬çš„æ ¸å¿ƒä»£ç éƒ½åœ¨è¿™é‡Œé¢</span><br><span class=\"line\">Â â”‚ Â  â”œâ”€â”€ __init__.py Â  Â  Â  Â  # åŒ…åˆå§‹åŒ–æ–‡ä»¶</span><br><span class=\"line\">Â â”‚ Â  â”œâ”€â”€ module1.py Â  Â  Â  Â   # æ¨¡å—1</span><br><span class=\"line\">Â â”‚ Â  â”œâ”€â”€ module2.py Â  Â  Â  Â   # æ¨¡å—2</span><br><span class=\"line\">Â â”‚ Â  â””â”€â”€ main.py Â  Â  Â  Â      # ä¸»ç¨‹åºå…¥å£</span><br><span class=\"line\">Â â”‚</span><br><span class=\"line\">Â â”œâ”€â”€ tests/ Â  Â  Â  Â  Â  Â  Â  Â   # æµ‹è¯•ç›®å½•</span><br><span class=\"line\">Â â”‚ Â  â”œâ”€â”€ __init__.py</span><br><span class=\"line\">Â â”‚ Â  â”œâ”€â”€ test_module1.py</span><br><span class=\"line\">Â â”‚ Â  â””â”€â”€ test_module2.py</span><br><span class=\"line\">Â â”‚</span><br><span class=\"line\">Â â”œâ”€â”€ requirements.txt Â  Â  Â   # ä¾èµ–æ–‡ä»¶</span><br><span class=\"line\">Â â”œâ”€â”€ setup.py Â  Â  Â  Â  Â  Â  Â   # å®‰è£…è„šæœ¬</span><br><span class=\"line\">Â â”œâ”€â”€ README.md Â  Â  Â  Â  Â  Â  Â  # é¡¹ç›®è¯´æ˜</span><br><span class=\"line\">Â â””â”€â”€ .gitignore Â  Â  Â  Â  Â  Â   # Gitå¿½ç•¥æ–‡ä»¶</span><br></pre></td></tr></table></figure>\n\n<p>é‚£ä¸Šé¢è¿™ç§è¿˜æ¯”è¾ƒå®½æ³›ï¼Œå¦‚æœä»¥å‰åç«¯åˆ†ç¦»çš„åç«¯ Web åº”ç”¨è¿™ç§æ¯”è¾ƒå¸¸è§çš„é¡¹ç›®ä¸ºä¾‹ï¼Œç›®å½•ç»“æ„å¯ä»¥æ˜¯ä¸‹é¢è¿™æ ·çš„ï¼š</p>\n<figure class=\"highlight plaintext\"><figcaption><span>Text</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">robocanic-project/</span><br><span class=\"line\">â”œâ”€â”€ robocanic_project/                     # ä¸»åº”ç”¨ç¨‹åºç›®å½•</span><br><span class=\"line\">â”‚   â”œâ”€â”€ __init__.py          # å°†è¯¥ç›®å½•æ ‡è¯†ä¸ºåŒ…ï¼Œé€šå¸¸åˆå§‹åŒ– FastAPI å®ä¾‹</span><br><span class=\"line\">â”‚   â”œâ”€â”€ main.py              # ä¸»æ–‡ä»¶ï¼ŒåŒ…å«åº”ç”¨å®ä¾‹å’Œè·¯ç”±</span><br><span class=\"line\">â”‚   â”œâ”€â”€ api/                 # API è·¯ç”±ç›®å½•</span><br><span class=\"line\">â”‚   â”‚   â”œâ”€â”€ __init__.py</span><br><span class=\"line\">â”‚   â”‚   â”œâ”€â”€ v1/              # API çš„ v1 ç‰ˆæœ¬ï¼ˆå¯é€‰åˆ†ç‰ˆæœ¬ç›®å½•ï¼‰</span><br><span class=\"line\">â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py</span><br><span class=\"line\">â”‚   â”‚   â”‚   â”œâ”€â”€ routes/   # å…·ä½“çš„ API ç«¯ç‚¹</span><br><span class=\"line\">â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py</span><br><span class=\"line\">â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ user.py  # ç”¨æˆ·ç›¸å…³çš„ API è·¯ç”±</span><br><span class=\"line\">â”‚   â”‚   â”‚   â”‚   â””â”€â”€ item.py  # å…¶ä»–æ¨¡å—ï¼ˆå¦‚å•†å“ï¼‰çš„ API è·¯ç”±</span><br><span class=\"line\">â”‚   â”‚   â”‚   â””â”€â”€ ...          # æ›´å¤š API è·¯ç”±</span><br><span class=\"line\">â”‚   â”œâ”€â”€ core/                # æ ¸å¿ƒé…ç½®æ¨¡å—</span><br><span class=\"line\">â”‚   â”‚   â”œâ”€â”€ __init__.py</span><br><span class=\"line\">â”‚   â”‚   â”œâ”€â”€ config.py        # é…ç½®æ–‡ä»¶ï¼ŒåŒ…å«æ•°æ®åº“è¿æ¥ã€ç¬¬ä¸‰æ–¹æœåŠ¡é…ç½®ç­‰</span><br><span class=\"line\">â”‚   â”‚   â”œâ”€â”€ security.py      # å®‰å…¨ç›¸å…³çš„è®¾ç½®ï¼Œä¾‹å¦‚ OAuth2ã€JWT</span><br><span class=\"line\">â”‚   â”œâ”€â”€ models/              # æ•°æ®åº“æ¨¡å‹</span><br><span class=\"line\">â”‚   â”‚   â”œâ”€â”€ __init__.py</span><br><span class=\"line\">â”‚   â”‚   â””â”€â”€ user.py          # ç”¨æˆ·æ¨¡å‹</span><br><span class=\"line\">â”‚   â”‚   â””â”€â”€ item.py          # å…¶ä»–æ•°æ®æ¨¡å‹</span><br><span class=\"line\">â”‚   â”œâ”€â”€ crud/                # å¢åˆ æ”¹æŸ¥æ“ä½œçš„å°è£…</span><br><span class=\"line\">â”‚   â”‚   â”œâ”€â”€ __init__.py</span><br><span class=\"line\">â”‚   â”‚   â”œâ”€â”€ user.py          # ç”¨æˆ·çš„ CRUD æ“ä½œ</span><br><span class=\"line\">â”‚   â”‚   â””â”€â”€ item.py          # å…¶ä»–æ•°æ®çš„ CRUD æ“ä½œ</span><br><span class=\"line\">â”‚   â”œâ”€â”€ db/                  # æ•°æ®åº“åˆå§‹åŒ–åŠè¿æ¥</span><br><span class=\"line\">â”‚   â”‚   â”œâ”€â”€ __init__.py</span><br><span class=\"line\">â”‚   â”‚   â”œâ”€â”€ base.py          # åŸºç¡€çš„æ•°æ®åº“æ¨¡å‹</span><br><span class=\"line\">â”‚   â”‚   â””â”€â”€ session.py       # æ•°æ®åº“ä¼šè¯ï¼ˆSQLAlchemy ä¼šè¯ï¼‰</span><br><span class=\"line\">â”‚   â”œâ”€â”€ tests/               # æµ‹è¯•ç›®å½•</span><br><span class=\"line\">â”‚   â”‚   â”œâ”€â”€ __init__.py</span><br><span class=\"line\">â”‚   â”‚   â””â”€â”€ test_user.py     # ç”¨æˆ·ç›¸å…³çš„æµ‹è¯•æ–‡ä»¶</span><br><span class=\"line\">â”‚   â”‚   â””â”€â”€ test_item.py     # å…¶ä»–æ¨¡å—çš„æµ‹è¯•æ–‡ä»¶</span><br><span class=\"line\">â”‚   â”œâ”€â”€ utils/               # å·¥å…·å‡½æ•°ç›®å½•</span><br><span class=\"line\">â”‚   â”‚   â”œâ”€â”€ __init__.py</span><br><span class=\"line\">â”‚   â”‚   â””â”€â”€ hashing.py       # ç”¨äºå¯†ç åŠ å¯†/è§£å¯†ç­‰å®ç”¨å·¥å…·</span><br><span class=\"line\">    â”œâ”€â”€ alembic/             # æ•°æ®åº“è¿ç§»å·¥å…· Alembic ç›¸å…³æ–‡ä»¶ï¼ˆå¦‚æœä½¿ç”¨ï¼‰</span><br><span class=\"line\">â”‚   â”‚   â”œâ”€â”€ versions/        # æ¯ä¸ªè¿ç§»æ–‡ä»¶éƒ½ä¿å­˜åœ¨è¿™ä¸ªç›®å½•ä¸­</span><br><span class=\"line\">â”‚   â”‚   â”œâ”€â”€ env.py           # Alembic ç¯å¢ƒé…ç½®æ–‡ä»¶</span><br><span class=\"line\">â”‚   â”‚   â”œâ”€â”€ README           # Alembic è¯´æ˜</span><br><span class=\"line\">â”‚   â”‚   â””â”€â”€ script.py.mako   # Alembic è„šæœ¬æ¨¡æ¿</span><br><span class=\"line\">â”‚   â””â”€â”€ ...</span><br><span class=\"line\">â”œâ”€â”€ .env                     # ç¯å¢ƒå˜é‡æ–‡ä»¶ï¼ˆæ•æ„Ÿä¿¡æ¯ï¼Œä¸åº”æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶ï¼‰</span><br><span class=\"line\">â”œâ”€â”€ .gitignore               # Git å¿½ç•¥æ–‡ä»¶åˆ—è¡¨</span><br><span class=\"line\">â”œâ”€â”€ requirements.txt         # ä¾èµ–åŒ…åˆ—è¡¨ï¼ˆå¦‚æœä½¿ç”¨ pipï¼‰</span><br><span class=\"line\">â”œâ”€â”€ setup.py Â  Â  Â  Â  Â  Â  Â    # å®‰è£…è„šæœ¬ï¼ˆå¦‚æœä½¿ç”¨setuptoolsï¼‰</span><br><span class=\"line\">â”œâ”€â”€ pyproject.toml           # é¡¹ç›®å…ƒæ•°æ®åŠä¾èµ–ç®¡ç†ï¼ˆå¦‚æœä½¿ç”¨ poetryï¼‰</span><br><span class=\"line\">â”œâ”€â”€ README.md                # é¡¹ç›®è¯´æ˜æ–‡ä»¶</span><br><span class=\"line\">â””â”€â”€ Dockerfile               # Docker é…ç½®æ–‡ä»¶ï¼ˆå¦‚æœä½¿ç”¨å®¹å™¨åŒ–ï¼‰</span><br></pre></td></tr></table></figure>\n\n<p>ä¸€ä¸ªä»¥ FastAPI ä¸ºåŸºç¡€ Web æ¡†æ¶çš„é¡¹ç›®çš„ç›®å½•ç»“æ„å¦‚ä¸Šæ‰€ç¤ºã€‚å…¶ä¸­ï¼Œé™¤äº†<code>api</code>ï¼Œ<code>models</code>ï¼Œ<code>crud</code>ï¼Œ<code>utils</code>è¿™ç±»è§åçŸ¥æ„çš„ç›®å½•ï¼Œè¿˜æœ‰ä¸€ä¸ªä¸å¤ªå¸¸è§çš„<code>alembic</code>è¿™ä¸ªç›®å½•ï¼Œalembic å…¶å®æ˜¯æ•°æ®åº“è¿ç§»ï¼ˆ<strong>Database Migration</strong>ï¼‰çš„å·¥å…·ã€‚è€Œæ•°æ®åº“è¿ç§»å°±æ˜¯æŒ‡åœ¨æˆ‘ä»¬çš„åº”ç”¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå½“æ¶‰åŠåˆ°éœ€è¦ä¿®æ”¹ ORM å¯¹åº”çš„æ•°æ®åº“ç»“æ„ï¼ˆä¾‹å¦‚è¡¨ã€å­—æ®µã€ç´¢å¼•ç­‰ï¼‰æ—¶ï¼Œå¼•å…¥çš„ä¸€å¥—é€æ­¥æ¼”è¿›æ•°æ®åº“çš„çŠ¶æ€ï¼Œä½¿å…¶ä¸åº”ç”¨ä»£ç ä¿æŒä¸€è‡´çš„å·¥å…·ã€‚è¿™å¥—å·¥å…·ä¸€èˆ¬æ˜¯åŠè‡ªåŠ¨æˆ–è€…å…¨è‡ªåŠ¨çš„ï¼Œå¯ä»¥å¤§å¤§é™ä½æ‰‹åŠ¨æ“ä½œæ•°æ®åº“å¸¦æ¥çš„é£é™©ã€‚</p>\n<h2 id=\"æ•°æ®-AI-å·¥ç¨‹\"><a href=\"#æ•°æ®-AI-å·¥ç¨‹\" class=\"headerlink\" title=\"æ•°æ®&#x2F;AI å·¥ç¨‹\"></a>æ•°æ®&#x2F;AI å·¥ç¨‹</h2><p>è€Œå¯¹äºæ•°æ®ç§‘å­¦ï¼Œæ¨¡å‹è®­ç»ƒï¼Œç§‘å­¦è®¡ç®—è¿™ç±»é¡¹ç›®ï¼Œåˆ™æœ‰ç€å¦ä¸€å¥—å®Œå…¨ä¸ä¸€æ ·çš„ç›®å½•é£æ ¼ï¼š</p>\n<figure class=\"highlight plaintext\"><figcaption><span>Text</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">robocanic-project/</span><br><span class=\"line\">â”œâ”€â”€ data/</span><br><span class=\"line\">â”œâ”€â”€ notebooks/</span><br><span class=\"line\">â”œâ”€â”€ scripts/</span><br><span class=\"line\">â”œâ”€â”€ requirements.txt</span><br><span class=\"line\">â””â”€â”€ README.md</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>ä»¥ä¸Šæ˜¯æ¯”è¾ƒç®€ç•¥çš„ç›®å½•ç»“æ„ï¼Œå±•å¼€æ¥çœ‹ï¼š</p>\n<figure class=\"highlight plaintext\"><figcaption><span>Text</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">robocanic-project/</span><br><span class=\"line\">â”œâ”€â”€ data/</span><br><span class=\"line\">â”‚   â”œâ”€â”€ raw/                  # åŸå§‹æ•°æ®ï¼ˆæœªå¤„ç†çš„æ•°æ®ï¼‰</span><br><span class=\"line\">â”‚   â”œâ”€â”€ processed/            # å¤„ç†åçš„æ•°æ®ï¼ˆæ¸…æ´—åçš„æ•°æ®ã€ç‰¹å¾å·¥ç¨‹åçš„æ•°æ®ï¼‰</span><br><span class=\"line\">â”‚   â””â”€â”€ external/             # å¤–éƒ¨æ•°æ®æºï¼ˆå¯èƒ½æ˜¯APIæˆ–ç¬¬ä¸‰æ–¹æä¾›çš„æ•°æ®ï¼‰</span><br><span class=\"line\">â”‚</span><br><span class=\"line\">â”œâ”€â”€ notebooks/                # Jupyter Notebooksï¼ˆæ¢ç´¢æ€§åˆ†æå’Œåˆæ­¥æ¨¡å‹ï¼‰</span><br><span class=\"line\">â”‚   â”œâ”€â”€ 01_data_exploration.ipynb  # æ•°æ®æ¢ç´¢</span><br><span class=\"line\">â”‚   â”œâ”€â”€ 02_data_cleaning.ipynb     # æ•°æ®æ¸…ç†</span><br><span class=\"line\">â”‚   â””â”€â”€ 03_model_training.ipynb    # æ¨¡å‹è®­ç»ƒ</span><br><span class=\"line\">â”‚</span><br><span class=\"line\">â”œâ”€â”€ scripts/                  # æ•°æ®å¤„ç†å’Œæ¨¡å‹è®­ç»ƒçš„Pythonè„šæœ¬</span><br><span class=\"line\">â”‚   â”œâ”€â”€ data_preprocessing.py  # æ•°æ®é¢„å¤„ç†è„šæœ¬</span><br><span class=\"line\">â”‚   â”œâ”€â”€ train_model.py         # æ¨¡å‹è®­ç»ƒè„šæœ¬</span><br><span class=\"line\">â”‚   â””â”€â”€ evaluate_model.py      # æ¨¡å‹è¯„ä¼°è„šæœ¬</span><br><span class=\"line\">â”‚</span><br><span class=\"line\">â”œâ”€â”€ models/                   # ä¿å­˜çš„æ¨¡å‹ï¼ˆè®­ç»ƒå¥½çš„æ¨¡å‹ã€æ ‡è®°åŒ–æ–‡ä»¶ç­‰ï¼‰</span><br><span class=\"line\">â”‚   â””â”€â”€ model_v1.pkl           # ä¿å­˜çš„æ¨¡å‹æ–‡ä»¶</span><br><span class=\"line\">â”‚</span><br><span class=\"line\">â”œâ”€â”€ reports/                  # é¡¹ç›®æŠ¥å‘Šä¸ç»“æœå±•ç¤º</span><br><span class=\"line\">â”‚   â”œâ”€â”€ figures/              # å›¾è¡¨å’Œå¯è§†åŒ–ç»“æœ</span><br><span class=\"line\">â”‚   â””â”€â”€ final_report.pdf      # æœ€ç»ˆæŠ¥å‘Šæˆ–ç»“æœæ€»ç»“</span><br><span class=\"line\">â”‚</span><br><span class=\"line\">â”œâ”€â”€ requirements.txt          # é¡¹ç›®æ‰€éœ€çš„ä¾èµ–åº“åˆ—è¡¨</span><br><span class=\"line\">â”œâ”€â”€ environment.yml           # Conda ç¯å¢ƒé…ç½®æ–‡ä»¶</span><br><span class=\"line\">â”œâ”€â”€ README.md                 # é¡¹ç›®è¯´æ˜æ–‡ä»¶</span><br><span class=\"line\">â””â”€â”€ .gitignore                # Gitå¿½ç•¥æ–‡ä»¶</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>å¯ä»¥çœ‹å‡ºæ•°æ®&#x2F;AI é¡¹ç›®å’Œæ™®é€šçš„åº”ç”¨è¿˜æ˜¯æœ‰å¾ˆå¤§åŒºåˆ«çš„ã€‚<strong>æ•°æ®&#x2F;AI é¡¹ç›®æ›´å¤šæ˜¯ä»æ•°æ®çš„æµå‘æ¥è¿›è¡Œç›®å½•ç»“æ„çš„åˆ’åˆ†ï¼Œä»æ•°æ®é‡‡é›† â†’ æ•°æ®å¤„ç† â†’ æ¨¡å‹è®­ç»ƒï¼ˆæ•°æ®èšåˆï¼‰â†’ æ¨¡å‹è¯„ä¼°ï¼ˆæ•°æ®è¯„ä¼°ï¼‰â†’â€¦â€¦ è€Œæ™®é€šåº”ç”¨é¡¹ç›®åˆ™æ›´å¤šæ˜¯æŒ‰åŠŸèƒ½æ¨¡å—æ¥åˆ’åˆ†ï¼Œæ¯”å¦‚ MVC çš„åˆ’åˆ†æ¨¡å¼ï¼Œä»¥ APP ä¸ºæ ¸å¿ƒçš„åˆ’åˆ†æ¨¡å‹ç­‰ã€‚</strong></p>\n<p>æ€»çš„æ¥è¯´ï¼ŒPython å·¥ç¨‹çš„ç›®å½•è¿˜æ˜¯æ¯”è¾ƒçµæ´»çš„ï¼Œæˆ‘ä»¬åœ¨æ„å»ºæˆ‘ä»¬è‡ªå·±çš„é¡¹ç›®ç›®å½•æ—¶å¯ä»¥ä¸æ‹˜æ³¥äºå›ºå®šçš„ç›®å½•ç»“æ„ï¼Œä½†ä¹Ÿè¦éµå¾ªä¸Šé¢æåˆ°çš„ä¸€äº›åŸºæœ¬è§„å¾‹ï¼Œè¿™æ ·åˆ«äººä¸Šæ‰‹æˆ‘ä»¬çš„é¡¹ç›®æ—¶èƒ½å¤Ÿå¿«é€Ÿè¯»æ‡‚æˆ‘ä»¬çš„é¡¹ç›®ç»“æ„ï¼Œè¿›è€Œè¯»æ‡‚ä»£ç ã€‚</p>\n<h1 id=\"é¡¹ç›®ç¯å¢ƒä¸ä¾èµ–ç®¡ç†\"><a href=\"#é¡¹ç›®ç¯å¢ƒä¸ä¾èµ–ç®¡ç†\" class=\"headerlink\" title=\"é¡¹ç›®ç¯å¢ƒä¸ä¾èµ–ç®¡ç†\"></a>é¡¹ç›®ç¯å¢ƒä¸ä¾èµ–ç®¡ç†</h1><p>æ¥ä¸‹æ¥è¦è°ˆåˆ°çš„éƒ¨åˆ†ä¸ªäººè®¤ä¸ºæ˜¯ python ä¸­æœ€æ··ä¹±çš„éƒ¨åˆ†â€”â€”ä¾èµ–ç®¡ç†ã€‚ä½†æ˜¯è®² Python çš„ä¾èµ–ç®¡ç†ä¸èƒ½åªè®²ä¾èµ–ç®¡ç†ï¼Œè¿˜è¦è¿å¸¦ç€**è™šæ‹Ÿç¯å¢ƒ(Virtual Environment)**ä¸€èµ·è®²ã€‚</p>\n<p>ä¸åŒäº Javaï¼ŒGo è¿™ç±»ä¾èµ–è·Ÿç€é¡¹ç›®èµ°çš„åšæ³•ï¼ŒPython é¡¹ç›®çš„ä¾èµ–æ˜¯å¯¹äºå½“å‰è™šæ‹Ÿç¯å¢ƒè€Œè¨€çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ä½ åœ¨å‘½ä»¤è¡Œä¸­æ•²ä¸‹<code>pip install fastapi</code>å»ä¸‹è½½ fastapi è¿™ä¸ªåŒ…æ—¶ï¼Œè¿™ä¸ªä¾èµ–æ˜¯å¯¹å½“å‰ç¯å¢ƒæœ‰æ•ˆçš„ï¼Œå¦‚æœé¡¹ç›® A å’Œé¡¹ç›® B éƒ½ä½¿ç”¨äº†è™šæ‹Ÿç¯å¢ƒ Eï¼Œé‚£é¡¹ç›® A å’Œé¡¹ç›® B éƒ½å¯ä»¥ä½¿ç”¨<code>fastapi</code>è¿™ä¸ªä¾èµ–ï¼Œå¦‚æœæœ‰å¤šä¸ªé¡¹ç›®éƒ½éœ€è¦ä¾èµ–<code>fastapi</code>ï¼Œé‚£æ˜¯ä¸æ˜¯æŠŠä»–ä»¬æ”¾åˆ°ä¸€ä¸ªè™šæ‹ŸåŒ–ç¯å¢ƒé‡Œå°±è¡Œï¼Ÿç­”æ¡ˆæ˜¯å¦å®šçš„ï¼Œå› ä¸ºä¸€èˆ¬æ¥è¯´ï¼Œä¸€ä¸ªé¡¹ç›®ä¸å•å•åªä¾èµ–ä¸€ä¸ª<code>fastapi</code>ï¼Œè¿˜æœ‰å…¶ä»–çš„ä¾èµ–ã€‚æ¯”å¦‚ä¸¤ä¸ªé¡¹ç›® A å’Œ B ä¾èµ–äº†ä¸€ä¸ªå…±åŒçš„åŒ…<code>pymysql</code>ï¼Œä½†æ˜¯ä¾èµ–çš„ç‰ˆæœ¬ä¸ä¸€æ ·ï¼Œè¿™æ ·å°±ä¼šå‘ç”Ÿä¾èµ–å†²çªã€‚å› æ­¤æˆ‘ä»¬åœ¨åˆ›å»º Python é¡¹ç›®æ—¶ï¼Œä¸€èˆ¬éƒ½ä¼šåˆ›å»ºä¸€ä¸ªå¯¹åº”çš„è™šæ‹Ÿç¯å¢ƒæ¥é˜²æ­¢ä¾èµ–å†²çªã€‚æ‰€ä»¥åˆ°è¿™ä½ å°±ä¼šå‘ç°è™šæ‹Ÿç¯å¢ƒå…¶å®è¿˜æ˜¯é¡¹ç›®å±‚é¢çš„ï¼Œä¸€ä¸ªé¡¹ç›®å°±å¯¹åº”ä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒï¼Œè™šæ‹Ÿç¯å¢ƒçš„è¿™ä¸ªè®¾è®¡è¯´å®è¯å¾ˆé¸¡è‚‹ï¼Œä¸ä»…ç›¸åŒç‰ˆæœ¬çš„åŒ…ä¸èƒ½å¾—åˆ°å¤ç”¨ï¼Œè¿˜å˜ç›¸åœ°æé«˜äº†ä¾èµ–ç®¡ç†çš„å¤æ‚åº¦ã€‚</p>\n<p>åæ§½å®Œä¹‹åï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ç°é˜¶æ®µç¯å¢ƒç®¡ç†ä»¥åŠä¾èµ–ç®¡ç†çš„æœ€ä½³å®è·µã€‚è¿™ä¸ªæœ€ä½³å®è·µåŒ…æ‹¬ä¸æ¨èçš„æ–¹å¼ venv&#x2F;virtualenv+pipï¼Œä»¥åŠä¸¤ç§æ¨èçš„æ–¹å¼ï¼šconda+pipï¼Œpoetryã€‚</p>\n<h2 id=\"venv-virtualenv-pipï¼ˆä¸æ¨èï¼‰\"><a href=\"#venv-virtualenv-pipï¼ˆä¸æ¨èï¼‰\" class=\"headerlink\" title=\"venv&#x2F;virtualenv+pipï¼ˆä¸æ¨èï¼‰\"></a>venv&#x2F;virtualenv+pipï¼ˆä¸æ¨èï¼‰</h2><p>venv å’Œ virtualenv éƒ½æ˜¯ç”¨æ¥åˆ›å»º python è™šæ‹Ÿç¯å¢ƒçš„å·¥å…·ï¼Œä¸åŒçš„åœ°æ–¹åœ¨äº venv æ˜¯ python3.3 åè‡ªå¸¦çš„è½»é‡çº§è™šæ‹Ÿç¯å¢ƒåˆ›å»ºå·¥å…·ï¼Œåªèƒ½ç”¨äº python3ï¼›è€Œ virtualenv åˆ™éœ€è¦å¦å¤–å®‰è£…ï¼Œå¯ä»¥ç”¨äº py2 ä»¥åŠ py3ï¼Œè¿˜æœ‰ä¸€äº› venv æ²¡æœ‰çš„åŠŸèƒ½ï¼ˆä¸ªäººè§‰å¾—å¯æœ‰å¯æ— ï¼‰ã€‚é‚£å¯¹äº python3.3 ä»¥åçš„é¡¹ç›®ï¼Œç°åœ¨éƒ½æ¨èè‡ªå¸¦çš„ venv äº†ã€‚venv ä½¿ç”¨èµ·æ¥ä¹Ÿå¾ˆç®€å•ï¼š</p>\n<ol>\n<li><p><code>python -m venv venv</code>å‘½ä»¤çš„ç¬¬ä¸€ä¸ª venvï¼Œæ˜¯è¿è¡Œ venv è¿™ä¸ªæ¨¡å—æ¥åˆ›å»ºä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒã€‚ç¬¬äºŒä¸ª venv æ˜¯æŒ‡è™šæ‹Ÿç¯å¢ƒçš„æ–‡ä»¶å¤¹çš„åå­—ï¼Œè¿™ä¸ªå¯ä»¥æ ¹æ®éœ€è¦æ¥ä¿®æ”¹ã€‚å‘½ä»¤æ‰§è¡Œåï¼Œä¼šåœ¨å½“å‰æ–‡ä»¶å¤¹ä¸­ï¼Œå»ºç«‹ä¸€ä¸ª venv ç›®å½•ã€‚ åœ¨è¿™ä¸ª venv ç›®å½•ä¸­ï¼Œä¼šé»˜è®¤æ”¾ç½® python.exeã€pip.exe ç­‰ä¸ç³»ç»Ÿç›®å½•éš”ç¦»çš„å¯æ‰§è¡Œæ–‡ä»¶å’Œä¾èµ–ã€‚ä¸€èˆ¬ venv ä¼šæ”¾ç½®åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹ã€‚</p>\n</li>\n<li><p>è¿›å…¥åˆ°<code>venv/Scipts</code>æ–‡ä»¶å¤¹ï¼Œæ‰§è¡Œ<code>activate</code>ï¼Œå¯ä»¥æ¿€æ´»å½“å‰çš„è™šæ‹Ÿç¯å¢ƒ; æ‰§è¡Œ<code>deactivate</code>ï¼Œå¯ä»¥åœç”¨å½“å‰è™šæ‹Ÿç¯å¢ƒ</p>\n</li>\n<li><p>åˆ é™¤è¿™ä¸ªè™šæ‹Ÿç¯å¢ƒåªéœ€è¦åˆ é™¤æ‰é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ venv æ–‡ä»¶å¤¹å³å¯ã€‚</p>\n</li>\n</ol>\n<p>venv æ²¡æœ‰ç®¡ç†è™šæ‹Ÿç¯å¢ƒçš„åŠŸèƒ½ï¼Œè¿™æ˜¯å› ä¸ºè™šæ‹Ÿç¯å¢ƒçš„ä¾èµ–éƒ½è·Ÿç€é¡¹ç›®èµ°äº†ï¼ˆvenv æ–‡ä»¶å¤¹åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼‰ã€‚å› æ­¤å®ƒè¶³å¤Ÿçš„è½»é‡ã€‚</p>\n<p>pip æ˜¯ä¸€ä¸ªè½»é‡çº§åŒ…ç®¡ç†å·¥å…·ï¼Œå®‰è£… python æ—¶éƒ½ä¼šè‡ªå¸¦ pipã€‚pip æœ€å¸¸ç”¨çš„å‘½ä»¤æœ‰ç”¨äºä¸‹è½½ä¾èµ–çš„<code>pip install deps</code>ã€<code>pip install -r requirements</code>å’Œç”¨äºåˆ é™¤ä¾èµ–çš„<code>pip uninstall deps</code>ã€‚å¾ˆå¤šäººåœ¨ä¸€å¼€å§‹ä½¿ç”¨ pip æ—¶è¿˜è§‰å¾—ç®€å•å¥½ç”¨ï¼Œä½†åœ¨ä½¿ç”¨å¤šäº†ä¹‹åå°±æ·±æ¶ç—›ç»ã€‚pip è®©äººæ·±æ¶ç—›ç»çš„æœ€ä¸»è¦çš„ä¸¤ä¸ªåŸå› å¦‚ä¸‹ï¼š</p>\n<ol>\n<li><p>åœ¨å‘½ä»¤è¡Œæ‰§è¡Œå®Œ<code>pip install deps</code>åä¸‹è½½çš„ä¾èµ–ä¸ä¼šåŒæ­¥åˆ° requirements.txt ä¸­ï¼ŒåŒæ ·<code>pip uninstall deps</code>åˆ é™¤çš„ä¾èµ–ä¹Ÿä¸ä¼šåˆ é™¤ requirements ä¸­å£°æ˜çš„ä¾èµ–ã€‚</p>\n</li>\n<li><p><strong><code>pip uninstall deps</code>åªä¼šåˆ é™¤<code>deps</code>è¿™ä¸ªç›´æ¥ä¾èµ–ï¼Œè€Œä¸ä¼šåˆ é™¤æœ€åˆä¸‹è½½<code>deps</code>è¿™ä¸ªåŒ…å¼•å…¥çš„é—´æ¥ä¾èµ–</strong></p>\n</li>\n</ol>\n<p>å…¶ä¸­ï¼Œç¬¬ä¸€ç‚¹è¿˜å¯ä»¥ä½¿ç”¨<code>pip freeze &gt; requirements.txt</code>æ¥å®Œæˆæ‰‹åŠ¨åŒæ­¥ï¼Œç¬¬äºŒç‚¹åˆ™æ˜¯åæ§½æœ€å¤šçš„ç‚¹ã€‚è¿™ä¸¤ç‚¹ç»å¸¸ä¼šå¼•èµ·ä¾èµ–å†²çªï¼Œç”Ÿäº§ç¯å¢ƒä¸æœ¬åœ°å¼€å‘ç¯å¢ƒä¸ä¸€è‡´çš„æƒ…å†µå‡ºç°ã€‚æ‰€ä»¥åœ¨ä½¿ç”¨ venv+pip ç»„åˆæ—¶ï¼Œå¾—éµå¾ªä¸€ä¸ªå¼€å‘èŒƒå¼ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºä»¥ä¸‹å‡ ç‚¹</p>\n<ol>\n<li><p>ç›´æ¥ä¾èµ–éœ€è¦å†™å…¥ requirements.txt ä¸­ï¼Œä½¿ç”¨<code>pip install -r requirements</code>æ¥ä¸‹è½½ä¾èµ–ï¼Œæ‘ˆå¼ƒ<code>pip install deps</code>ï¼Œä¿è¯é¡¹ç›®ä¾èµ–ç›¸å¯¹æ¸…æ™°</p>\n</li>\n<li><p>å‘ç‰ˆæ—¶å¿…é¡»æ‰§è¡Œ<code>pip freeze &gt; requirements.txt</code>æ¥ä¿è¯æœ¬åœ°ä¸äº‘ç«¯ç¯å¢ƒä¸€è‡´</p>\n</li>\n</ol>\n<h2 id=\"conda-pipï¼ˆæ¨èç”¨äºæ•°æ®-AI-é¢†åŸŸï¼‰\"><a href=\"#conda-pipï¼ˆæ¨èç”¨äºæ•°æ®-AI-é¢†åŸŸï¼‰\" class=\"headerlink\" title=\"conda+pipï¼ˆæ¨èç”¨äºæ•°æ®&#x2F;AI é¢†åŸŸï¼‰\"></a>conda+pipï¼ˆæ¨èç”¨äºæ•°æ®&#x2F;AI é¢†åŸŸï¼‰</h2><p>conda ä¸ä»…æ˜¯ä¸€ä¸ªåŒ…ç®¡ç†å·¥å…·åº“ï¼Œè¿˜æ˜¯ä¸€ä¸ªç¯å¢ƒç®¡ç†å·¥å…·ï¼Œå¹¿æ³›ç”¨äºç§‘å­¦è®¡ç®—é¢†åŸŸï¼Œconda å‘½ä»¤ä¹Ÿæ¯”è¾ƒç®€å•æ˜“ç”¨ï¼Œä½¿ç”¨ conda çš„åŸºæœ¬æ­¥éª¤å¦‚ä¸‹ï¼š</p>\n<ol>\n<li><p><code>conda create -n my-ns</code>åˆ›å»ºä¸€ä¸ªéš”ç¦»çš„è™šæ‹Ÿç¯å¢ƒ</p>\n</li>\n<li><p><code>conda activate my-ns</code>ï¼Œæ¿€æ´»è™šæ‹Ÿç¯å¢ƒ</p>\n</li>\n<li><p><code>conda install dps</code>ä¸‹è½½ä¾èµ–</p>\n</li>\n<li><p><code>conda remve deps</code> å¸è½½ä¾èµ–ï¼Œconda åœ¨å¸è½½ä¾èµ–æ—¶ä¼šæ™ºèƒ½åœ°å¤„ç†åŒ…çš„ä¾èµ–å…³ç³»ï¼Œå°†é—´æ¥ä¾èµ–ä¸­æ— ç”¨çš„åŒ…ä¹Ÿä¼šä¸€å¹¶å¸è½½</p>\n</li>\n<li><p><code>conda remove --name my-ns --all</code>åˆ é™¤è™šæ‹Ÿç¯å¢ƒ</p>\n</li>\n</ol>\n<p>å…¶ä¸­ï¼Œconda åˆ›å»ºçš„è™šæ‹Ÿç¯å¢ƒä¼šç»´æŠ¤ä¸€ä¸ªä¸ç¯å¢ƒååŒåçš„æ–‡ä»¶ç›®å½•ï¼ˆç±»ä¼¼ venvï¼‰ï¼Œä½†è¿™ä¸ªæ–‡ä»¶ç›®å½•ä¼šç»Ÿä¸€æ”¾åœ¨ä¸€ä¸ªåœ°æ–¹ï¼Œä¸ä¼šæ”¾åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼Œè¿™ä¹Ÿè®©å¤šä¸ªä½¿ç”¨ conda çš„é¡¹ç›®â€œæœ‰äº†å…±äº«è™šæ‹Ÿç¯å¢ƒçš„å¯èƒ½â€ã€‚é‚£ conda æ—¢èƒ½ç®¡ç†ç¯å¢ƒï¼Œåˆèƒ½ç®¡ç†ä¾èµ–ï¼Œæ˜¯ä¸æ˜¯å°±èƒ½æ›¿ä»£ pipï¼Ÿå¾ˆé—æ†¾è¿˜æ˜¯ä¸èƒ½ï¼Œä¸»è¦åŸå› æœ‰ä¸¤ç‚¹ï¼š</p>\n<ol>\n<li><p>conda ä¸»è¦ç”¨äºæ•°æ®ç§‘å­¦é¢†åŸŸï¼Œæ•´ä¸ªç¯å¢ƒå®‰è£…èµ·æ¥å°±æ¯”è¾ƒé‡ï¼Œç¯å¢ƒåˆå§‹æ—¶å°±è‡ªå¸¦äº†å¾ˆå¤šä¾èµ–ï¼Œå¾ˆå¤šä¾èµ–æ˜¯æ™®é€šé¡¹ç›®ä¸éœ€è¦çš„ã€‚æ­¤å¤–ï¼Œconda ä¸‹è½½ä¾èµ–çš„é€Ÿåº¦ä¹Ÿä¼šæ…¢ä¸€äº›ã€‚</p>\n</li>\n<li><p>conda çš„åŒ…ä¸ pip å®‰è£…çš„åŒ…ä¸ä¸€æ ·ï¼Œconda åŒ…æ˜¯äºŒè¿›åˆ¶æ ¼å¼çš„ï¼Œé™¤äº†æ•°æ®ç§‘å­¦é¢†åŸŸï¼Œå¾ˆå¤š python åº“éƒ½ä¼šåœ¨ PyPI ä¸Šå‘å¸ƒï¼Œä½†ä¸ä¼šåœ¨ Anaconda repository ä¸Šå‘å¸ƒ</p>\n</li>\n</ol>\n<p>æ‰€ä»¥ä»¥ä¸Šä¸¤ç‚¹å°±é™åˆ¶äº† conda çš„åº”ç”¨é¢†åŸŸï¼Œé™¤äº†æ•°æ®ç§‘å­¦é¢†åŸŸï¼Œconda å°±åªèƒ½ä½œä¸ºä¸€ä¸ªç¯å¢ƒç®¡ç†çš„å·¥å…·ã€‚é‚£å¯¹äºä½¿ç”¨ conda æ¥ç®¡ç†ç¯å¢ƒçš„æƒ…å†µï¼Œpip ä¸€èˆ¬ä¹Ÿæ˜¯ä¸å¯æˆ–ç¼ºçš„ï¼Œä½¿ç”¨æ—¶çš„æ³¨æ„ç‚¹åŒä¸Šé¢çš„<code>venv+pip</code></p>\n<h2 id=\"poetryï¼ˆæ¨èï¼‰\"><a href=\"#poetryï¼ˆæ¨èï¼‰\" class=\"headerlink\" title=\"poetryï¼ˆæ¨èï¼‰\"></a>poetryï¼ˆæ¨èï¼‰</h2><blockquote>\n<p>ä»¥ä¸‹ä»£ç åœ°å€: <a href=\"https://github.com/robocanic/poetry-fastapi-demo.git\">https://github.com/robocanic/poetry-fastapi-demo.git</a></p>\n</blockquote>\n<p>ä¸Šé¢ä¸¤ç§ç¯å¢ƒä¸ä¾èµ–ç®¡ç†çš„æ–¹å¼éƒ½æœ‰ä¸€ä¸ªæ¯”è¾ƒæ£˜æ‰‹çš„ç‚¹æ— æ³•è§£å†³ï¼Œé‚£å°±æ˜¯ pip å¸è½½ä¾èµ–æ—¶æ— æ³•åˆ é™¤å¼•å…¥çš„é—´æ¥ä¾èµ–ï¼Œè¿™å¾ˆå¯èƒ½ä¼šå¯¼è‡´<strong>ä¾èµ–è‡ƒè‚¿ï¼Œä¾èµ–å†²çª</strong>ç­‰é—®é¢˜ã€‚</p>\n<p>poetry æ˜¯ä¸€ä¸ª python ä¾èµ–ç®¡ç†ä¸ç¯å¢ƒç®¡ç†çš„å·¥å…·ï¼Œå®ƒèƒ½å¤Ÿåˆ†æå‡ºå“ªäº›æ˜¯ç›´æ¥ä¾èµ–ï¼Œå“ªäº›æ˜¯é—´æ¥ä¾èµ–ï¼Œåœ¨åˆ é™¤ä¾èµ–æ—¶èƒ½å¤Ÿåˆ æ‰æ— ç”¨çš„é—´æ¥ä¾èµ–ï¼Œä¿æŒé¡¹ç›®ä¾èµ–çš„æ¸…çˆ½ã€‚æ­¤å¤–ï¼Œpoetry è¿˜æœ‰æŒ‡å®šæ¨¡ç³Šä¾èµ–ï¼Œä¾èµ–å¿«é€Ÿå‡çº§ç­‰å®ç”¨çš„åŠŸèƒ½ï¼Œè¿™è®©å®ƒåœ¨ä¾èµ–ç®¡ç†æ–¹é¢ç›´æ¥ç”©äº† pip å¥½å‡ æ¡è¡—ã€‚è‡³äºç¯å¢ƒç®¡ç†ï¼Œpoetry åˆ™æ˜¯åœ¨ virtualenv çš„åŸºç¡€ä¸Šï¼Œå¢å¼ºäº†ä¸€äº›åŠŸèƒ½ï¼Œå¦‚è‡ªåŠ¨åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼Œé›†ä¸­&#x2F;åˆ†ç¦»çš„ç¯å¢ƒç®¡ç†ç­‰ç­‰ã€‚</p>\n<p>poetry çš„å‘½ä»¤ä¼šç›¸å¯¹å¤šä¸€äº›ï¼Œä½†å¸¸ç”¨çš„ä¹Ÿåªæœ‰å‡ ä¸ªï¼Œä¸‹é¢ä»å»ºç«‹ä¸€ä¸ªæ–°é¡¹ç›®çš„æµç¨‹æ¥ç†Ÿæ‚‰ä¸€ä¸‹å¦‚ä½•ä½¿ç”¨ poetryï¼š</p>\n<h4 id=\"åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ\"><a href=\"#åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ\" class=\"headerlink\" title=\"åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ\"></a>åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ</h4><p>åœ¨åˆ›å»ºæ–‡ä»¶å¤¹åï¼Œæ‰§è¡Œ<code>poetry init</code>ï¼Œä¼šæœ‰ä¸€ç³»åˆ—äº’åŠ¨çš„ command æ¥å¼•å¯¼ä½ åˆ›å»º<code>pyproject.toml</code>:</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Â <span class=\"string\">PS</span> <span class=\"string\">D:\\code\\python-projects\\poetry-fastapi-demo&gt;poetry</span> <span class=\"string\">init</span></span><br><span class=\"line\">Â <span class=\"string\">â€‹</span></span><br><span class=\"line\">Â <span class=\"string\">This</span> <span class=\"string\">command</span> <span class=\"string\">will</span> <span class=\"string\">guide</span> <span class=\"string\">you</span> <span class=\"string\">through</span> <span class=\"string\">creating</span> <span class=\"string\">your</span> <span class=\"string\">pyproject.toml</span> <span class=\"string\">config.</span></span><br><span class=\"line\">Â <span class=\"string\">â€‹</span></span><br><span class=\"line\">Â <span class=\"string\">Package</span> <span class=\"string\">name</span> [<span class=\"string\">poetry-fastapi-demo</span>]<span class=\"string\">:</span> Â </span><br><span class=\"line\">Â <span class=\"string\">Version</span> [<span class=\"number\">0.1</span><span class=\"number\">.0</span>]<span class=\"string\">:</span> Â </span><br><span class=\"line\">Â <span class=\"string\">Description</span> []<span class=\"string\">:</span>  <span class=\"string\">A</span> <span class=\"string\">web</span> <span class=\"string\">project</span> <span class=\"string\">template</span> <span class=\"string\">using</span> <span class=\"string\">poetry</span> <span class=\"string\">and</span> <span class=\"string\">fastapi.</span></span><br><span class=\"line\">Â <span class=\"string\">Author</span> [<span class=\"string\">robocanic</span> <span class=\"string\">&lt;robocanic@example.com&gt;</span>, <span class=\"string\">n</span> <span class=\"string\">to</span> <span class=\"string\">skip</span>]<span class=\"string\">:</span> Â </span><br><span class=\"line\">Â <span class=\"string\">License</span> []<span class=\"string\">:</span>  <span class=\"string\">Apache</span> <span class=\"number\">2.0</span></span><br><span class=\"line\">Â <span class=\"string\">Compatible</span> <span class=\"string\">Python</span> <span class=\"string\">versions</span> [<span class=\"string\">^3.11</span>]<span class=\"string\">:</span>  <span class=\"string\">~3.10</span></span><br><span class=\"line\">Â <span class=\"string\">â€‹</span></span><br><span class=\"line\">Â <span class=\"string\">Would</span> <span class=\"string\">you</span> <span class=\"string\">like</span> <span class=\"string\">to</span> <span class=\"string\">define</span> <span class=\"string\">your</span> <span class=\"string\">main</span> <span class=\"string\">dependencies</span> <span class=\"string\">interactively?</span> <span class=\"string\">(yes/no)</span> [<span class=\"literal\">yes</span>] <span class=\"literal\">no</span></span><br><span class=\"line\">Â <span class=\"string\">Would</span> <span class=\"string\">you</span> <span class=\"string\">like</span> <span class=\"string\">to</span> <span class=\"string\">define</span> <span class=\"string\">your</span> <span class=\"string\">development</span> <span class=\"string\">dependencies</span> <span class=\"string\">interactively?</span> <span class=\"string\">(yes/no)</span> [<span class=\"literal\">yes</span>] <span class=\"literal\">no</span></span><br><span class=\"line\">Â <span class=\"string\">Generated</span> <span class=\"string\">file</span></span><br><span class=\"line\">Â <span class=\"string\">â€‹</span></span><br><span class=\"line\">Â [<span class=\"string\">tool.poetry</span>]</span><br><span class=\"line\">Â <span class=\"string\">name</span> <span class=\"string\">=</span> <span class=\"string\">&quot;poetry-fastapi-demo&quot;</span></span><br><span class=\"line\">Â <span class=\"string\">version</span> <span class=\"string\">=</span> <span class=\"string\">&quot;0.1.0&quot;</span></span><br><span class=\"line\">Â <span class=\"string\">description</span> <span class=\"string\">=</span> <span class=\"string\">&quot;A web project template using poetry and fastapi.&quot;</span></span><br><span class=\"line\">Â <span class=\"string\">authors</span> <span class=\"string\">=</span> [<span class=\"string\">&quot;robocanic &lt;robocanic@example.com&gt;&quot;</span>]</span><br><span class=\"line\">Â <span class=\"string\">license</span> <span class=\"string\">=</span> <span class=\"string\">&quot;Apache 2.0&quot;</span></span><br><span class=\"line\">Â <span class=\"string\">readme</span> <span class=\"string\">=</span> <span class=\"string\">&quot;README.md&quot;</span></span><br><span class=\"line\">Â <span class=\"string\">â€‹</span></span><br><span class=\"line\">Â [<span class=\"string\">tool.poetry.dependencies</span>]</span><br><span class=\"line\">Â <span class=\"string\">python</span> <span class=\"string\">=</span> <span class=\"string\">&quot;~3.10&quot;</span></span><br><span class=\"line\">Â <span class=\"string\">â€‹</span></span><br><span class=\"line\">Â <span class=\"string\">â€‹</span></span><br><span class=\"line\">Â [<span class=\"string\">build-system</span>]</span><br><span class=\"line\">Â <span class=\"string\">requires</span> <span class=\"string\">=</span> [<span class=\"string\">&quot;poetry-core&quot;</span>]</span><br><span class=\"line\">Â <span class=\"string\">build-backend</span> <span class=\"string\">=</span> <span class=\"string\">&quot;poetry.core.masonry.api&quot;</span></span><br><span class=\"line\">Â <span class=\"string\">â€‹</span></span><br><span class=\"line\">Â <span class=\"string\">â€‹</span></span><br><span class=\"line\">Â <span class=\"string\">Do</span> <span class=\"string\">you</span> <span class=\"string\">confirm</span> <span class=\"string\">generation?</span> <span class=\"string\">(yes/no)</span> [<span class=\"literal\">yes</span>]</span><br></pre></td></tr></table></figure>\n\n<p>è¿™é‡Œä½ åœ¨å‘½ä»¤è¡Œè¾“å…¥çš„åœ¨åé¢éƒ½æ˜¯å¯ä»¥é€šè¿‡ä¿®æ”¹<code>pyproject.toml</code>æ¥åŒæ­¥çš„ï¼Œå› æ­¤ä¸€èˆ¬æˆ‘ä»¬éƒ½ä¼šå¿«é€Ÿåœ°è·³è¿‡è¿™ä¸ªé˜¶æ®µã€‚ç”Ÿæˆçš„<code>pyproject.toml</code>å¦‚ä¸‹æ‰€ç¤ºï¼š</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Â [<span class=\"string\">tool.poetry</span>] <span class=\"comment\">#é¡¹ç›®ä¿¡æ¯</span></span><br><span class=\"line\">Â <span class=\"string\">name</span> <span class=\"string\">=</span> <span class=\"string\">&quot;poetry-fastapi-demo&quot;</span></span><br><span class=\"line\">Â <span class=\"string\">version</span> <span class=\"string\">=</span> <span class=\"string\">&quot;0.1.0&quot;</span></span><br><span class=\"line\">Â <span class=\"string\">description</span> <span class=\"string\">=</span> <span class=\"string\">&quot;A web project template using poetry and fastapi.&quot;</span></span><br><span class=\"line\">Â <span class=\"string\">authors</span> <span class=\"string\">=</span> [<span class=\"string\">&quot;robocanic &lt;robocanic@example.com&gt;&quot;</span>]</span><br><span class=\"line\">Â <span class=\"string\">license</span> <span class=\"string\">=</span> <span class=\"string\">&quot;Apache 2.0&quot;</span></span><br><span class=\"line\">Â <span class=\"string\">readme</span> <span class=\"string\">=</span> <span class=\"string\">&quot;README.md&quot;</span></span><br><span class=\"line\">Â <span class=\"string\">â€‹</span></span><br><span class=\"line\">Â [<span class=\"string\">tool.poetry.dependencies</span>] Â <span class=\"comment\">#ä¸»è¦ä¾èµ–</span></span><br><span class=\"line\">Â <span class=\"string\">python</span> <span class=\"string\">=</span> <span class=\"string\">&quot;~3.10&quot;</span></span><br><span class=\"line\">Â <span class=\"string\">â€‹</span></span><br><span class=\"line\">Â <span class=\"string\">â€‹</span></span><br><span class=\"line\">Â [<span class=\"string\">build-system</span>] Â <span class=\"comment\"># æ„å»ºå·¥å…·</span></span><br><span class=\"line\">Â <span class=\"string\">requires</span> <span class=\"string\">=</span> [<span class=\"string\">&quot;poetry-core&quot;</span>]</span><br><span class=\"line\">Â <span class=\"string\">build-backend</span> <span class=\"string\">=</span> <span class=\"string\">&quot;poetry.core.masonry.api&quot;</span></span><br><span class=\"line\">Â <span class=\"string\">â€‹</span></span><br></pre></td></tr></table></figure>\n\n<p>åœ¨åˆ›å»º<code>pyproject.toml</code>åï¼Œåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ‰§è¡Œ<code>poetry env use python</code>ï¼Œä¼šåˆ›å»ºä¸€ä¸ªè¯¥é¡¹ç›®ä¸“æœ‰çš„è™šæ‹Ÿç¯å¢ƒï¼š</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Â <span class=\"string\">PS</span> <span class=\"string\">D:\\code\\python-projects\\poetry-fastapi-demo&gt;</span> <span class=\"string\">poetry</span> <span class=\"string\">config</span> <span class=\"string\">virtualenvs.in-project</span> <span class=\"literal\">true</span></span><br><span class=\"line\">Â <span class=\"string\">PS</span> <span class=\"string\">D:\\code\\python-projects\\poetry-fastapi-demo&gt;</span> <span class=\"string\">poetry</span> <span class=\"string\">env</span> <span class=\"string\">use</span> <span class=\"string\">D:\\env\\python\\python.exe</span></span><br><span class=\"line\">Â <span class=\"string\">Creating</span> <span class=\"string\">virtualenv</span> <span class=\"string\">poetry-fastapi-demo</span> <span class=\"string\">in</span> <span class=\"string\">D:\\code\\python-projects\\poetry-fastapi-demo\\.venv</span></span><br><span class=\"line\">Â <span class=\"attr\">Using virtualenv:</span> <span class=\"string\">D:\\code\\python-projects\\poetry-fastapi-demo\\.venv</span></span><br></pre></td></tr></table></figure>\n\n<p>è¿™é‡Œæˆ‘æŒ‡å®šäº† poetry è™šæ‹Ÿç¯å¢ƒçš„è·¯å¾„æ”¾ç½®åœ¨é¡¹ç›®æ ¹ç›®å½•çš„.venv ç›®å½•ä¸‹ï¼Œæˆ‘è§‰å¾—è¿™æ ·çš„é¡¹ç›®ç»„ç»‡æ–¹å¼æ›´æ¸…æ™°ã€‚<code>poetry env use python</code> è¿™ä¸ªå‘½ä»¤é»˜è®¤ä½¿ç”¨ç³»ç»Ÿç¯å¢ƒå˜é‡ä¸­çš„ pythonï¼Œå¦‚æœä½ æƒ³ä½¿ç”¨æŒ‡å®šç‰ˆæœ¬çš„ pythonï¼Œå¯ä»¥å°† python æ¢æˆ<code>path/to/your/py</code>ã€‚</p>\n<h4 id=\"æ·»åŠ ä¾èµ–\"><a href=\"#æ·»åŠ ä¾èµ–\" class=\"headerlink\" title=\"æ·»åŠ ä¾èµ–\"></a>æ·»åŠ ä¾èµ–</h4><p>æˆ‘ä»¬å¯ä»¥ç¼–è¾‘<code>pyproject.toml</code>ï¼Œæ·»åŠ æŒ‡å®šçš„ä¾èµ–ï¼Œå†å…ˆåæ‰§è¡Œ<code>poetry lock</code> å’Œ<code>poetry install</code>ï¼Œ<code>poetry lock</code>ä¼šè§£æ<code>pyproject.toml</code>ä¸­çš„ä¸»è¦ä¾èµ–ä¸å¼€å‘ä¾èµ–ä»¥åŠé—´æ¥ä¾èµ–ï¼Œé€‰æ‹©åˆé€‚çš„ä¾èµ–ç‰ˆæœ¬ï¼Œè®°å½•åˆ° poetry.lock è¿™ä¸ªæ–‡ä»¶ä¸­ã€‚poetry.lock çš„ä½œç”¨ç±»ä¼¼äº requirements.txtï¼Œå³â€œé”å®šâ€é¡¹ç›®éœ€è¦çš„ä¾èµ–ï¼ˆåŒ…æ‹¬ç›´æ¥ä¾èµ–å’Œé—´æ¥ä¾èµ–ï¼‰ç‰ˆæœ¬ã€‚ç´§æ¥ç€çš„<code>poetry install</code>å°±ä¼šæ ¹æ® poetry.lock ä¸­çš„å†…å®¹å»ä¸‹è½½ç›¸åº”ç‰ˆæœ¬çš„ä¾èµ–ã€‚</p>\n<figure class=\"highlight toml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"section\">[tool.poetry]</span> <span class=\"comment\"># é¡¹ç›®ä¿¡æ¯</span></span><br><span class=\"line\"><span class=\"attr\">name</span> = <span class=\"string\">&quot;poetry-fastapi-demo&quot;</span></span><br><span class=\"line\"><span class=\"attr\">version</span> = <span class=\"string\">&quot;0.1.0&quot;</span></span><br><span class=\"line\"><span class=\"attr\">description</span> = <span class=\"string\">&quot;A web project template using poetry and fastapi.&quot;</span></span><br><span class=\"line\"><span class=\"attr\">authors</span> = [<span class=\"string\">&quot;robocanic &lt;robocanic@example.com&gt;&quot;</span>]</span><br><span class=\"line\"><span class=\"attr\">license</span> = <span class=\"string\">&quot;Apache 2.0&quot;</span></span><br><span class=\"line\"><span class=\"attr\">readme</span> = <span class=\"string\">&quot;README.md&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"section\">[tool.poetry.dependencies]</span>  <span class=\"comment\"># ä¸»è¦ä¾èµ–</span></span><br><span class=\"line\"><span class=\"attr\">python</span> = <span class=\"string\">&quot;~3.10&quot;</span>        <span class=\"comment\"># pythonç‰ˆæœ¬&gt;=3.10 ä¸” &lt;3.20</span></span><br><span class=\"line\"><span class=\"attr\">fastapi</span> = <span class=\"string\">&quot;^0.115.0&quot;</span>    <span class=\"comment\"># fastapiç‰ˆæœ¬ &gt;=0.115.0 ä¸” &lt;0.116.0</span></span><br><span class=\"line\"><span class=\"attr\">sqlalchemy</span> = <span class=\"string\">&quot;^2.0.36&quot;</span>  <span class=\"comment\"># sqlalchemyç‰ˆæœ¬ &gt;=2.0.36 ä¸” &lt; 3.0</span></span><br><span class=\"line\"><span class=\"attr\">pyyaml</span> = <span class=\"string\">&quot;^6.0.2&quot;</span>       <span class=\"comment\"># pyyamlç‰ˆæœ¬ &gt;=6.0.2 ä¸” &lt; 7.0.0</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"section\">[tool.poetry.group.dev.dependencies]</span>  <span class=\"comment\"># å¼€å‘ä¾èµ–</span></span><br><span class=\"line\"><span class=\"attr\">pytest</span> = <span class=\"string\">&quot;^8.3.3&quot;</span>       <span class=\"comment\"># pytestç‰ˆæœ¬ &gt;=8.3.3 ä¸” &lt; 9.0.0</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"section\">[build-system]</span>  <span class=\"comment\"># æ„å»ºå·¥å…·</span></span><br><span class=\"line\"><span class=\"attr\">requires</span> = [<span class=\"string\">&quot;poetry-core&quot;</span>]</span><br><span class=\"line\"><span class=\"attr\">build-backend</span> = <span class=\"string\">&quot;poetry.core.masonry.api&quot;</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>æˆ‘ä»¬å¯ä»¥æŒ‡å®šä¸»è¦ä¾èµ–å’Œå¼€å‘ä¾èµ–ï¼Œåœ¨å‘å¸ƒéƒ¨ç½²æ—¶åªæ‰“åŒ…ä¸»è¦ä¾èµ–ï¼Œè¿™æ ·å°±å¯ä»¥å‡å°åŒ…çš„ä½“ç§¯ã€‚åŒæ—¶æˆ‘ä»¬å¯ä»¥æŒ‡å®šä¾èµ–çš„ç‰ˆæœ¬èŒƒå›´ï¼Œä¸åŒçš„ç¬¦å·æœ‰ä¸åŒçš„æŒ‡å®šèŒƒå›´ç­–ç•¥ï¼Œè¿™ä¸€å—å¯ä»¥å‚è€ƒ poetry å®˜æ–¹æ–‡æ¡£ï¼š<a href=\"https://python-poetry.org/docs/dependency-specification/\">https://python-poetry.org/docs/dependency-specification/</a></p>\n<p>æ­¤å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨å‘½ä»¤è¡Œ<code>poetry add deps</code>æ¥ä¸‹è½½åŒ…ï¼Œè¿™ä¸ªå‘½ä»¤ä¼šè‡ªåŠ¨åœ°æ›´æ–°<code>pyproject.toml</code>ä»¥åŠ<code>poetry.lock</code>æ–‡ä»¶ï¼Œä¿è¯ç¯å¢ƒä¸­çš„ä¾èµ–ä¸<code>pyproject.toml</code>ä¸­çš„çš„ä¾èµ–çš„ä¸€è‡´æ€§ã€‚</p>\n<h4 id=\"åˆ é™¤ä¾èµ–\"><a href=\"#åˆ é™¤ä¾èµ–\" class=\"headerlink\" title=\"åˆ é™¤ä¾èµ–\"></a>åˆ é™¤ä¾èµ–</h4><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ç¼–è¾‘<code>pyproject.toml</code>ï¼Œåˆ é™¤å¯¹åº”çš„ä¾èµ–å£°æ˜ï¼Œç„¶åæ‰§è¡Œ<code>poetry lock</code> å³å¯ï¼Œpoetry ä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬æŠŠä¾èµ–åˆ é™¤ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨<code>poetry remove deps</code>æ¥åˆ é™¤ä¾èµ–ã€‚</p>\n<p>poetry çš„è¿™ä¸¤ç§åˆ é™¤æ–¹å¼éƒ½ä¼šè§£æ<code>deps</code>çš„æ— ç”¨çš„é—´æ¥ä¾èµ–ï¼Œå°†å…¶ä¸€å¹¶åˆ é™¤ã€‚</p>\n<h4 id=\"åˆ é™¤è™šæ‹Ÿç¯å¢ƒ\"><a href=\"#åˆ é™¤è™šæ‹Ÿç¯å¢ƒ\" class=\"headerlink\" title=\"åˆ é™¤è™šæ‹Ÿç¯å¢ƒ\"></a>åˆ é™¤è™šæ‹Ÿç¯å¢ƒ</h4><p>æ‰§è¡Œ<code>poetry env remove poetry-demo</code>ï¼Œå³å¯åˆ é™¤è™šæ‹Ÿç¯å¢ƒã€‚</p>\n<blockquote>\n<p>å¦‚æœåœ¨ poetry çš„é…ç½®ä¸­æŒ‡å®šäº†<code>poetry config virtualenvs.in-project true</code>ï¼Œè™šæ‹Ÿç¯å¢ƒç»´æŠ¤çš„ç›®å½•å°±ä¼šæ”¾åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹ã€‚ç±»ä¼¼äº venv çš„æ–¹å¼ï¼Œå› æ­¤è¿™ç§æƒ…å†µä¸‹åˆ é™¤.venv æ–‡ä»¶å¤¹å°±ç­‰åŒäºåˆ é™¤è™šæ‹Ÿç¯å¢ƒ</p>\n</blockquote>\n<h4 id=\"æŸ¥çœ‹ä¾èµ–æ ‘\"><a href=\"#æŸ¥çœ‹ä¾èµ–æ ‘\" class=\"headerlink\" title=\"æŸ¥çœ‹ä¾èµ–æ ‘\"></a>æŸ¥çœ‹ä¾èµ–æ ‘</h4><p>poetry ä¸­å¾ˆå®ç”¨çš„ä¸€ä¸ªåŠŸèƒ½æ˜¯å®ƒå¯ä»¥ä½¿ç”¨<code>poetry show --tree</code>æ¥æŸ¥çœ‹ä¾èµ–å…³ç³»ï¼Œä»è€Œåœ¨ä¾èµ–é”™è¯¯æ—¶èƒ½å¤Ÿæ›´å¥½åœ°å®šä½å¼‚å¸¸ï¼Œæ›´å¿«é€Ÿåœ°è§£å†³é—®é¢˜ã€‚</p>\n<p><img src=\"https://image.robocanic.com/notes/image-20241104154436296.png\" alt=\"poetry-show--tree\"></p>\n<h4 id=\"å¯¼å‡ºä¾èµ–\"><a href=\"#å¯¼å‡ºä¾èµ–\" class=\"headerlink\" title=\"å¯¼å‡ºä¾èµ–\"></a>å¯¼å‡ºä¾èµ–</h4><p>ç†è®ºä¸Šæ¥è¯´ï¼Œæœ‰äº† poetry ä¸å†éœ€è¦ pip äº†ï¼Œè‡ªç„¶ä¹Ÿä¸éœ€è¦ requirements.txt äº†ï¼Œä½†æ˜¯åœ¨åé¢çš„é¡¹ç›®å‘å¸ƒç®¡ç†ä¸­æˆ‘ä»¬ä¼šæåˆ°ï¼Œå½“ä½¿ç”¨å®¹å™¨åŒ–éƒ¨ç½²æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›æˆ‘ä»¬çš„é•œåƒå°½å¯èƒ½åœ°ç²¾ç®€ï¼Œæˆ‘ä»¬çš„é¡¹ç›®éƒ¨ç½²èƒ½å°½å¯èƒ½å¿«é€Ÿã€‚ä»ç²¾ç®€é•œåƒè¿™ä¸ªè§’åº¦æ¥çœ‹ï¼Œpoetry å¯¹äºæˆ‘ä»¬çš„é¡¹ç›®è€Œè¨€åªæ˜¯å¼€å‘æ—¶ä¾èµ–ï¼Œåœ¨è¿è¡Œæ—¶æˆ‘ä»¬å¸Œæœ›åªç”¨æœ€ç®€å•çš„ä¾èµ–å°±èƒ½æŠŠé¡¹ç›®è·‘èµ·æ¥ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦å°† poetry.lock ä¸­çš„ä¾èµ–è½¬åŒ–ä¸º requirements.txtï¼Œè¿™æ ·éƒ¨ç½²æ—¶ä½¿ç”¨<code>pip install -r requirements.txt</code>ä¸‹å®Œä¾èµ–ä¹‹åç›´æ¥å°±èƒ½ run èµ·æ¥é¡¹ç›®ã€‚</p>\n<p>poetry æœ¬èº«ä¹Ÿæ”¯æŒå¯¼å‡ºç¯å¢ƒå†…çš„ä¾èµ–ï¼Œä½¿ç”¨<code>poetry export -f requirements.txt -o requirements.txt</code>å°±å¯ä»¥å°†ç¯å¢ƒä¸­çš„æ‰€æœ‰ä¾èµ–å¯¼å‡ºåˆ° requirements.txt ä¸­ã€‚</p>\n<h4 id=\"æ€»ç»“\"><a href=\"#æ€»ç»“\" class=\"headerlink\" title=\"æ€»ç»“\"></a>æ€»ç»“</h4><p>poetry ä½œä¸ºç¯å¢ƒç®¡ç†ä¸ä¾èµ–ç®¡ç†åˆäºŒä¸ºä¸€çš„é“¶å¼¹ï¼Œåœ¨ä½“éªŒä¸‹æ¥ï¼Œé™¤äº†æ•°æ®ç§‘å­¦&#x2F;AI é¢†åŸŸçš„é¡¹ç›®ï¼Œæˆ‘è®¤ä¸º poetry æ˜¯å¼€å‘å¤§å¤šæ•° python é¡¹ç›®çš„æœ€ä½³ç¯å¢ƒä¸ä¾èµ–çš„ç®¡ç†æ–¹å¼ã€‚</p>\n<h1 id=\"é¡¹ç›®æ—¥å¿—\"><a href=\"#é¡¹ç›®æ—¥å¿—\" class=\"headerlink\" title=\"é¡¹ç›®æ—¥å¿—\"></a>é¡¹ç›®æ—¥å¿—</h1><blockquote>\n<p>ä»¥ä¸‹ä»£ç åœ°å€: <a href=\"https://github.com/robocanic/poetry-fastapi-demo.git\">https://github.com/robocanic/poetry-fastapi-demo.git</a></p>\n</blockquote>\n<h2 id=\"ç›®æ ‡\"><a href=\"#ç›®æ ‡\" class=\"headerlink\" title=\"ç›®æ ‡\"></a>ç›®æ ‡</h2><p>æ—¥å¿—çš„é‡è¦æ€§ä¸è¨€è€Œå–»ï¼Œæˆ‘ä»¬è¿™é‡Œæ¢è®¨çš„â€œé¡¹ç›®æ—¥å¿—â€ï¼Œæ›´å‡†ç¡®åœ°æ¥è¯´æ˜¯æ€ä¹ˆä½¿ç”¨æ—¥å¿—èƒ½å¤Ÿå¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„æ•ˆæœã€‚é€šå¸¸ï¼Œæˆ‘ä»¬å¯¹äºæ—¥å¿—ä¼šæœ‰ä¸€äº›è¦æ±‚ï¼š</p>\n<ol>\n<li><p>æˆ‘ä»¬å¸Œæœ›æˆ‘ä»¬çš„æ—¥å¿—èƒ½å¤Ÿæ˜¾ç¤ºå‡ºæ—¥å¿—æ—¶é—´ï¼Œæ—¥å¿—ç­‰çº§(INFO, WARN, ERROR â€¦..)ï¼Œæ—¥å¿—å†…å®¹ï¼Œæ‰€åœ¨çº¿ç¨‹ï¼Œæ˜¯ç”±å“ªä¸ªç»„ä»¶&#x2F;py æ–‡ä»¶æ‰“å°çš„â€¦â€¦</p>\n</li>\n<li><p>å¯¹äºä»¥ä¸Šæ—¥å¿—ä¿¡æ¯ï¼Œä¸ç®¡æ˜¯è‡ªå·±é¡¹ç›®ä¸­çš„è¿˜æ˜¯ä¾èµ–åŒ…ä¸­çš„ï¼Œéƒ½æœ‰ä¸€ä¸ªç»Ÿä¸€çš„æ ¼å¼æ‰“å°å‡ºæ¥</p>\n</li>\n<li><p>ä¸ä»…è¦åœ¨æ§åˆ¶å°æ‰“å°ï¼Œè¿˜éœ€è¦ä¿å­˜åˆ°æ–‡ä»¶ä¸­ï¼Œä»¥ä¾¿åç»­æ’æŸ¥é”™è¯¯æ—¶èƒ½å¤Ÿè¿½æº¯ã€‚</p>\n</li>\n<li><p>æ›´è¿›ä¸€æ­¥ï¼Œæˆ‘ä»¬å¸Œæœ› ERROR çº§åˆ«çš„æ—¥å¿—èƒ½å¤Ÿå•ç‹¬æ”¾åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œæ¯å¤©çš„æ—¥å¿—æŒ‰ç…§æ—¥æœŸåšä¸€ä¸ªåˆ‡å‰²åˆ†å—â€¦â€¦</p>\n</li>\n</ol>\n<h2 id=\"åŸç†\"><a href=\"#åŸç†\" class=\"headerlink\" title=\"åŸç†\"></a>åŸç†</h2><p>åœ¨é˜æ˜æ—¥å¿—éœ€è¦è¾¾åˆ°çš„æ•ˆæœä¹‹åï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ python ä¸­çš„ logging æ¨¡å—ï¼Œè¿™ä¸ªæ¨¡å—æ˜¯ python è‡ªå¸¦çš„ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆæ¥è¯•ç”¨ä¸€ä¸‹ï¼š</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> logging</span><br><span class=\"line\">logging.info(<span class=\"string\">&quot;this is a info log&quot;</span>)</span><br><span class=\"line\">logging.warning(<span class=\"string\">&quot;this is a warning log&quot;</span>)</span><br><span class=\"line\">logging.error(<span class=\"string\">&quot;this is a error log&quot;</span>)</span><br><span class=\"line\">logging.critical(<span class=\"string\">&quot;this is a critical log&quot;</span>)</span><br><span class=\"line\"><span class=\"string\">&quot;&quot;&quot;</span></span><br><span class=\"line\"><span class=\"string\">output:</span></span><br><span class=\"line\"><span class=\"string\">WARNING:root:this is a warning log</span></span><br><span class=\"line\"><span class=\"string\">ERROR:root:this is a error log</span></span><br><span class=\"line\"><span class=\"string\">CRITICAL:root:this is a critical log</span></span><br><span class=\"line\"><span class=\"string\">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>\n\n<p>è¿è¡Œè¿™ä¸ª python æ–‡ä»¶ä¼šå‘ç°æ§åˆ¶å°å¹¶æ²¡æœ‰æ‰“å°å‡º info çº§åˆ«çš„æ—¥å¿—ï¼Œè¿™æ˜¯å› ä¸º logging æ¨¡å—æä¾›çš„æ—¥å¿—è®°å½•å‡½æ•°æ‰€ä½¿ç”¨çš„æ—¥å¿—å™¨è®¾ç½®çš„æ—¥å¿—çº§åˆ«æ˜¯<code>WARNING</code>ï¼Œå› æ­¤åªæœ‰<code>WARNING</code>çº§åˆ«çš„æ—¥å¿—è®°å½•ä»¥åŠå¤§äºå®ƒçš„<code>ERROR</code>å’Œ<code>CRITICAL</code>çº§åˆ«çš„æ—¥å¿—è®°å½•è¢«è¾“å‡ºäº†ï¼Œè€Œå°äºå®ƒçš„<code>INFO</code>çº§åˆ«çš„æ—¥å¿—è®°å½•è¢«ä¸¢å¼ƒäº†ã€‚</p>\n<p>æˆ‘ä»¬å¯ä»¥è§‚å¯Ÿæ¯æ¡æ—¥å¿—ï¼Œæ¯ä¸ªæ—¥å¿—éƒ½ç”±ä¸‰éƒ¨åˆ†æ„æˆï¼š<code>æ—¥å¿—çº§åˆ«:æ—¥å¿—å™¨åç§°:æ—¥å¿—å†…å®¹</code>ï¼Œè¿™æ˜¯å› ä¸º logging æ¨¡å—æä¾›çš„æ—¥å¿—è®°å½•å‡½æ•°æ‰€ä½¿ç”¨çš„æ—¥å¿—å™¨è®¾ç½®çš„æ—¥å¿—æ ¼å¼é»˜è®¤ä¸º<code>%(levelname)s:%(name)s:%(message)s</code>ã€‚</p>\n<p>é‚£è‡ªç„¶æˆ‘ä»¬ä¼šæƒ³åˆ°ï¼Œå¯ä¸å¯ä»¥é€šè¿‡è®¾ç½® logging çš„æ—¥å¿—çº§åˆ«ä¸æ—¥å¿—æ ¼å¼ï¼Œæ¥ç”Ÿæˆæˆ‘ä»¬æƒ³è¦çš„æ—¥å¿—æ ¼å¼ï¼Ÿè¿›ä¸€æ­¥ï¼Œæˆ‘ä»¬å¯ä¸å¯ä»¥è°ƒæ•´æ—¥å¿—è¾“å‡ºçš„ä½ç½®ï¼ŒåŒæ—¶è¾“å‡ºåœ¨æ§åˆ¶å°å’Œæ–‡ä»¶ï¼Ÿ</p>\n<p>åœ¨å›ç­”è¿™ä¸ªé—®é¢˜ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥æ¥å…ˆç®€å•çœ‹ä¸‹ logging æ¨¡å—æ¶‰åŠåˆ°çš„å››ä¸ªç»„ä»¶</p>\n<ol>\n<li><p>æ—¥å¿—å™¨ï¼ˆLoggerï¼‰ï¼Œæä¾›äº†æˆ‘ä»¬çš„ä»£ç å¯ä»¥ä½¿ç”¨çš„æ¥å£ï¼Œå³ log.infoï¼Œlog.warningï¼Œlog.error ç­‰</p>\n</li>\n<li><p>å¤„ç†å™¨ï¼ˆHandlerï¼‰ï¼Œå°† logger åˆ›å»ºçš„æ—¥å¿—è®°å½•å‘é€åˆ°åˆé€‚çš„ç›®çš„è¾“å‡º</p>\n</li>\n<li><p>è¿‡æ»¤å™¨ï¼ˆFilterï¼‰ï¼Œæä¾›äº†æ›´ç»†ç²’åº¦çš„æ§åˆ¶å·¥å…·æ¥å†³å®šè¾“å‡ºå“ªæ¡æ—¥å¿—è®°å½•ï¼Œä¸¢å¼ƒå“ªæ¡æ—¥å¿—è®°å½•</p>\n</li>\n<li><p>æ ¼å¼å™¨ï¼ˆFormatterï¼‰ï¼Œå†³å®šæ—¥å¿—è®°å½•çš„è¾“å‡ºæ ¼å¼</p>\n</li>\n</ol>\n<p>è¿™äº›ç»„ä»¶çš„å…³ç³»å¤§è‡´å¦‚ä¸‹ï¼šæ—¥å¿—å™¨ï¼ˆLoggerï¼‰éœ€è¦é€šè¿‡å¤„ç†å™¨ï¼ˆHandlerï¼‰å°†æ—¥å¿—ä¿¡æ¯è¾“å‡ºåˆ°ç›®æ ‡ä½ç½®ï¼ˆæ–‡ä»¶ï¼Œæ§åˆ¶å°ï¼Œç½‘ç»œç­‰ï¼‰ã€‚è€Œå¤„ç†å™¨ï¼ˆHandlerï¼‰å¯ä»¥è®¾ç½®è¿‡æ»¤å™¨ï¼ˆFilterï¼‰å’Œæ ¼å¼å™¨ï¼ˆFormatterï¼‰æ¥å¯¹æ—¥å¿—è¿›è¡Œè¿‡æ»¤å’Œæ ¼å¼åŒ–ï¼Œå†è¾“å‡ºåˆ°æŒ‡å®šçš„ç›®æ ‡ä½ç½®ã€‚</p>\n<p>å› æ­¤ä¸Šé¢çš„é—®é¢˜ä¹Ÿæœ‰äº†ç­”æ¡ˆï¼šé€šè¿‡è°ƒæ•´ Loggerï¼ŒHandlerï¼ŒFilterï¼ŒFormatter çš„è®¾ç½®å’Œç»„åˆå…³ç³»ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„æ—¥å¿—ã€‚</p>\n<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ 3 ç§æ–¹å¼æ¥é…ç½® loggingï¼š</p>\n<ol>\n<li><p>ä½¿ç”¨ Python ä»£ç æ˜¾å¼çš„åˆ›å»º loggerï¼Œhandleï¼Œfilterï¼Œformatter å¹¶åˆ†åˆ«è°ƒç”¨å®ƒä»¬çš„é…ç½®å‡½æ•°</p>\n</li>\n<li><p>åˆ›å»ºä¸€ä¸ªæ—¥å¿—é…ç½®æ–‡ä»¶ï¼Œç„¶åä½¿ç”¨<code>fileConfig()</code>å‡½æ•°æ¥è¯»å–è¯¥æ–‡ä»¶çš„å†…å®¹ï¼›</p>\n</li>\n<li><p>åˆ›å»ºä¸€ä¸ªåŒ…å«é…ç½®ä¿¡æ¯çš„ dictï¼Œç„¶åæŠŠå®ƒä¼ é€’ç»™<code>dictConfig()</code>å‡½æ•°ï¼›</p>\n</li>\n</ol>\n<h2 id=\"å®è·µ\"><a href=\"#å®è·µ\" class=\"headerlink\" title=\"å®è·µ\"></a>å®è·µ</h2><p>è¿™é‡Œæˆ‘ä»‹ç»ä¸€ä¸‹ç¬¬ä¸‰ç§ï¼Œå…¶ä»–ä¸¤ç§å¯ä»¥è‡ªè¡Œç ”ç©¶ã€‚ç¬¬ä¸‰ç§æˆ‘ä»¬é€šå¸¸ä¼šç”¨ä¸€ä¸ª yaml&#x2F;json æ–‡ä»¶æ¥æè¿°é…ç½®ï¼Œç„¶åä½¿ç”¨<code>yaml.load</code>è¯»å–æ—¥å¿—é…ç½®æ–‡ä»¶ï¼Œè½¬åŒ–æˆ dictï¼Œè¿›è€Œä¼ é€’ç»™<code>dictConfig()</code>ï¼Œå®Œæˆ logging çš„é…ç½®ã€‚</p>\n<p>yaml å½¢å¼çš„æ—¥å¿—é…ç½®å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">version:</span> <span class=\"number\">1</span></span><br><span class=\"line\"><span class=\"attr\">formatters:</span>  <span class=\"comment\"># å®šä¹‰æ ¼å¼å™¨</span></span><br><span class=\"line\">  <span class=\"attr\">default:</span>   <span class=\"comment\"># æ ¼å¼å™¨å</span></span><br><span class=\"line\">    <span class=\"attr\">format:</span> <span class=\"string\">&#x27;%(asctime)s - %(name)s - %(levelname)s -%(threadName)s%(thread)d - %(message)s&#x27;</span>  <span class=\"comment\"># æ—¥å¿—æ ¼å¼ï¼šæ—¶é—´ - æ—¥å¿—å™¨å - æ—¥å¿—ç­‰çº§ - çº¿ç¨‹å çº¿ç¨‹ID - æ—¥å¿—å†…å®¹</span></span><br><span class=\"line\">    <span class=\"attr\">datefmt:</span> <span class=\"string\">&#x27;%Y-%m-%d %H:%M:%S&#x27;</span>   <span class=\"comment\"># æ—¶é—´æ ¼å¼</span></span><br><span class=\"line\">    <span class=\"attr\">use_colors:</span> <span class=\"literal\">true</span>   <span class=\"comment\"># ä½¿ç”¨é¢œè‰²</span></span><br><span class=\"line\"><span class=\"attr\">handlers:</span>     <span class=\"comment\"># å®šä¹‰å¤„ç†å™¨</span></span><br><span class=\"line\">  <span class=\"attr\">console:</span>    <span class=\"comment\"># å¤„ç†å™¨å</span></span><br><span class=\"line\">    <span class=\"attr\">class:</span> <span class=\"string\">logging.StreamHandler</span>  <span class=\"comment\"># ä½¿ç”¨çš„handler</span></span><br><span class=\"line\">    <span class=\"attr\">level:</span> <span class=\"string\">INFO</span>    <span class=\"comment\"># æ—¥å¿—ç­‰çº§</span></span><br><span class=\"line\">    <span class=\"attr\">formatter:</span> <span class=\"string\">default</span>  <span class=\"comment\"># ä½¿ç”¨çš„formatteråå­—</span></span><br><span class=\"line\">    <span class=\"attr\">stream:</span> <span class=\"string\">ext://sys.stdout</span>  <span class=\"comment\"># è¾“å‡ºåˆ°æ§åˆ¶å°</span></span><br><span class=\"line\">  <span class=\"attr\">file:</span></span><br><span class=\"line\">    <span class=\"attr\">class:</span> <span class=\"string\">logging.FileHandler</span></span><br><span class=\"line\">    <span class=\"attr\">level:</span> <span class=\"string\">INFO</span></span><br><span class=\"line\">    <span class=\"attr\">formatter:</span> <span class=\"string\">default</span></span><br><span class=\"line\">    <span class=\"attr\">filename:</span> <span class=\"string\">app.log</span>   <span class=\"comment\"># è¾“å‡ºåˆ°app.log</span></span><br><span class=\"line\"><span class=\"attr\">loggers:</span>         <span class=\"comment\"># å®šä¹‰æ—¥å¿—å™¨</span></span><br><span class=\"line\">  <span class=\"attr\">poetry_fastapi_demo:</span>   <span class=\"comment\"># æ—¥å¿—å™¨åç§°</span></span><br><span class=\"line\">    <span class=\"attr\">level:</span> <span class=\"string\">INFO</span>  <span class=\"comment\"># æ—¥å¿—ç­‰çº§</span></span><br><span class=\"line\">    <span class=\"attr\">handlers:</span>    <span class=\"comment\"># ä½¿ç”¨çš„handler</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">file</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">console</span></span><br><span class=\"line\">    <span class=\"attr\">propagate:</span> <span class=\"literal\">false</span>   <span class=\"comment\"># æ˜¯å¦ä¼ æ’­åˆ°çˆ¶loggerå†å¤„ç†</span></span><br><span class=\"line\">  <span class=\"attr\">poetry_fastapi_demo.routers:</span>  <span class=\"comment\"># poetry_fastapi_demoçš„å­logger</span></span><br><span class=\"line\">    <span class=\"attr\">level:</span> <span class=\"string\">INFO</span></span><br><span class=\"line\">    <span class=\"attr\">handlers:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">console</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">file</span></span><br><span class=\"line\">    <span class=\"attr\">propagate:</span> <span class=\"literal\">false</span>   <span class=\"comment\"># æ˜¯å¦ä¼ æ’­åˆ°çˆ¶loggerå†å¤„ç†</span></span><br><span class=\"line\">  <span class=\"attr\">uvicorn:</span></span><br><span class=\"line\">    <span class=\"attr\">level:</span> <span class=\"string\">INFO</span></span><br><span class=\"line\">    <span class=\"attr\">handlers:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">console</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">file</span></span><br><span class=\"line\">    <span class=\"attr\">propagate:</span> <span class=\"literal\">false</span></span><br><span class=\"line\"><span class=\"attr\">root:</span>            <span class=\"comment\"># æ ¹æ—¥å¿—å™¨ï¼Œæ‰€æœ‰æ²¡æœ‰å½’å±çš„æ—¥å¿—éƒ½ä¼šç”±rootæ¥å¤„ç†</span></span><br><span class=\"line\">  <span class=\"attr\">level:</span> <span class=\"string\">INFO</span></span><br><span class=\"line\">  <span class=\"attr\">handlers:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">console</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">file</span></span><br></pre></td></tr></table></figure>\n\n<p>å…¶ä¸­ï¼Œlogger æ˜¯æœ‰å±‚çº§ç»“æ„çš„ï¼Œlogger çš„åç§°æ˜¯ä¸€ä¸ªä»¥â€™.â€™åˆ†å‰²çš„ç»“æ„ï¼Œæ¯ä¸ªâ€™.â€™åé¢çš„ logger éƒ½æ˜¯â€™.â€™å‰é¢çš„ logger çš„ childrenã€‚è€Œ root æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ loggerï¼Œå®ƒä¼šæ•æ‰æ²¡æœ‰è¢«å…¶ä»– logger å¤„ç†çš„æ—¥å¿—æ¶ˆæ¯ï¼Œæˆ‘ä»¬ä¾èµ–çš„ä¸‰æ–¹åŒ…æ‰“å°çš„æ—¥å¿—å¤§éƒ¨åˆ†éƒ½ä¼šç”± root logger æ•è·åˆ°è¿›è¡Œå¤„ç†ï¼Œå› æ­¤ root æ˜¯å¾ˆé‡è¦çš„å…œåº• loggerã€‚</p>\n<p>åœ¨å®Œå–„å¥½<code>log.yaml</code>åï¼Œæˆ‘ä»¬åšä¸€ä¸ªéªŒè¯ï¼Œ<code>poetry-fastapi-demo</code>é¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight plaintext\"><figcaption><span>Text</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">poetry-fastapi-demo/</span><br><span class=\"line\">Â â”‚</span><br><span class=\"line\">Â â”œâ”€â”€ poetry_fastapi_demo/ Â  Â   Â  Â </span><br><span class=\"line\">Â â”‚ Â  â”œâ”€â”€ models Â  Â  Â  Â      # æ¨¡å‹</span><br><span class=\"line\">â”‚   â”‚   â”œâ”€â”€ __init__.py</span><br><span class=\"line\">|   |   â”œâ”€â”€ user.py</span><br><span class=\"line\">|   â”œâ”€â”€ routers Â  Â  Â  Â      # è·¯ç”±</span><br><span class=\"line\">|   |   â”œâ”€â”€ __init__.py</span><br><span class=\"line\">|   |   â”œâ”€â”€ user.py</span><br><span class=\"line\">|   â”œâ”€â”€ tables              # å¢åˆ æ”¹æŸ¥</span><br><span class=\"line\">|   |   â”œâ”€â”€ __init__.py</span><br><span class=\"line\">|   |   â”œâ”€â”€ user.py</span><br><span class=\"line\">â”‚ Â  â”œâ”€â”€ __init__.py Â  Â </span><br><span class=\"line\">â”‚   â””â”€â”€ main.py Â  Â  Â  Â      # ä¸»ç¨‹åºå…¥å£</span><br></pre></td></tr></table></figure>\n\n<p><code>poetry_fastapi_demo/__init__.py</code>çš„å†…å®¹å¦‚ä¸‹ï¼Œè¿™é‡Œæˆ‘ä»¬å°† log.yaml çš„è·¯å¾„ä»¥ç¯å¢ƒå˜é‡ä¼ å…¥ï¼Œç„¶åä½¿ç”¨<code>.dictConfig</code>å®Œæˆæ—¥å¿—çš„é…ç½®</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> logging.config</span><br><span class=\"line\"><span class=\"keyword\">import</span> os</span><br><span class=\"line\"><span class=\"keyword\">import</span> yaml</span><br><span class=\"line\"></span><br><span class=\"line\">log_conf_path = os.environ.get(<span class=\"string\">&quot;LOG_CONFIG&quot;</span>)</span><br><span class=\"line\"><span class=\"keyword\">with</span> <span class=\"built_in\">open</span>(log_conf_path, <span class=\"string\">&#x27;r&#x27;</span>, encoding=<span class=\"string\">&#x27;utf-8&#x27;</span>) <span class=\"keyword\">as</span> f:</span><br><span class=\"line\">    dict_conf = yaml.safe_load(f)</span><br><span class=\"line\">logging.config.dictConfig(dict_conf)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p><code>poetry_fastapi_demo/routers/user.py</code>çš„å†…å®¹å¦‚ä¸‹</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> logging</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">from</span> fastapi <span class=\"keyword\">import</span> APIRouter</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">from</span> poetry_fastapi_demo.models <span class=\"keyword\">import</span> User</span><br><span class=\"line\"><span class=\"keyword\">from</span> poetry_fastapi_demo.tables <span class=\"keyword\">import</span> user_table</span><br><span class=\"line\"></span><br><span class=\"line\">log = logging.getLogger(__name__)</span><br><span class=\"line\">router = APIRouter()</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@router.get(<span class=\"params\"><span class=\"string\">&quot;&quot;</span></span>)</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">get_all_users</span>():</span><br><span class=\"line\">    <span class=\"keyword\">return</span> user_table.get_all_users()</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@router.get(<span class=\"params\"><span class=\"string\">&quot;/&#123;user_id&#125;&quot;</span></span>)</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">get_user</span>(<span class=\"params\">user_id: <span class=\"built_in\">int</span></span>):</span><br><span class=\"line\">    <span class=\"keyword\">return</span> user_table.get_user_by_id(user_id)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@router.post(<span class=\"params\"><span class=\"string\">&quot;&quot;</span></span>)</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">create_user</span>(<span class=\"params\">user: User</span>):</span><br><span class=\"line\">    log.info(<span class=\"string\">f&quot;Creating user: <span class=\"subst\">&#123;user&#125;</span>&quot;</span>)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> user_table.add_user(user)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@router.delete(<span class=\"params\"><span class=\"string\">&quot;/&#123;user_id&#125;&quot;</span></span>)</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">delete_user</span>(<span class=\"params\">user_id: <span class=\"built_in\">int</span></span>):</span><br><span class=\"line\">    log.warning(<span class=\"string\">f&quot;Deleting user with id: <span class=\"subst\">&#123;user_id&#125;</span>&quot;</span>)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> user_table.delete_user(user_id)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@router.put(<span class=\"params\"><span class=\"string\">&quot;&quot;</span></span>)</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">update_user</span>(<span class=\"params\">user: User</span>):</span><br><span class=\"line\">    log.warning(<span class=\"string\">f&quot;Updating user: <span class=\"subst\">&#123;user&#125;</span>&quot;</span>)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> user_table.update_user(user)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>è¿è¡Œ main.pyï¼ˆè®°å¾—è®¾ç½®ç¯å¢ƒå˜é‡ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ§åˆ¶å°ä¸­çœ‹åˆ°æ—¥å¿—è¾“å‡ºï¼ŒåŒæ—¶åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹ä¹Ÿä¼šç”Ÿæˆ app.log æ—¥å¿—æ–‡ä»¶ï¼Œè®°å½•è¿è¡Œçš„æ—¥å¿—ã€‚</p>\n<p><img src=\"https://image.robocanic.com/notes/app-log.png\" alt=\"app-log\"></p>\n<p>æˆ‘ä»¬å‘èµ·ä¸€ä¸ªæ–°å¢ user çš„è¯·æ±‚ï¼š</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl --request POST \\</span><br><span class=\"line\">  --url http://localhost:8080/api/v1/user \\</span><br><span class=\"line\">  --header &#x27;content-type: application/json&#x27; \\</span><br><span class=\"line\">  --data &#x27;&#123;</span><br><span class=\"line\">  &quot;id&quot;: 6,</span><br><span class=\"line\">  &quot;name&quot;: &quot;robb&quot;,</span><br><span class=\"line\">  &quot;email&quot;: &quot;robocanic@gmail.com&quot;,</span><br><span class=\"line\"> &quot;password&quot;: &quot;xclkjva&quot;,</span><br><span class=\"line\">  &quot;role&quot;: &quot;user&quot;</span><br><span class=\"line\">&#125;&#x27;</span><br></pre></td></tr></table></figure>\n\n<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ—¥å¿—æ˜¾ç¤ºå¦‚ä¸‹ï¼š</p>\n<p><img src=\"https://image.robocanic.com/notes/create-user-log.png\" alt=\"create-user-log\"></p>\n<p>åˆ°è¿™ï¼ŒåŸºæœ¬çš„æ—¥å¿—éœ€æ±‚å°±æ»¡è¶³äº†ï¼Œæˆ‘ä»¬æ— éœ€è°ƒæ•´ä»£ç ï¼Œä»…é€šè¿‡è°ƒæ•´é…ç½®æ–‡ä»¶å°±èƒ½é€‚æ—¶è°ƒæ•´æ—¥å¿—ã€‚é‚£å¯¹äºç›®æ ‡ä¸­çš„ç¬¬ 4 ç‚¹â€œæˆ‘ä»¬å¸Œæœ› ERROR çº§åˆ«çš„æ—¥å¿—èƒ½å¤Ÿå•ç‹¬æ”¾åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œæ¯å¤©çš„æ—¥å¿—æŒ‰ç…§æ—¥æœŸåšä¸€ä¸ªåˆ‡å‰²åˆ†å—â€ï¼Œç›¸ä¿¡ä½ å¯ä»¥ä¸¾ä¸€åä¸‰</p>\n<h1 id=\"é¡¹ç›®æµ‹è¯•\"><a href=\"#é¡¹ç›®æµ‹è¯•\" class=\"headerlink\" title=\"é¡¹ç›®æµ‹è¯•\"></a>é¡¹ç›®æµ‹è¯•</h1><blockquote>\n<p>ä»¥ä¸‹ä»£ç åœ°å€: <a href=\"https://github.com/robocanic/poetry-fastapi-demo.git\">https://github.com/robocanic/poetry-fastapi-demo.git</a></p>\n</blockquote>\n<p>ä¸€ä¸ªé¡¹ç›®å¯é çš„é¡¹ç›®ç¦»ä¸å¼€å®Œå¤‡çš„æµ‹è¯•ï¼Œæµ‹è¯•ä¸€èˆ¬åˆ†ä¸ºå•å…ƒæµ‹è¯•å’Œæ¥å£æµ‹è¯•ï¼Œå•æµ‹é’ˆå¯¹æŸä¸ªå‡½æ•°æˆ–è€…æŸä¸ªæ¨¡å—ï¼Œæµ‹è¯•è¿”å›çš„å‚æ•°æ˜¯å¦ç¬¦åˆé¢„æœŸï¼Œè€Œæ¥å£æµ‹è¯•æ˜¯é’ˆå¯¹äº HTTPï¼ˆRPCï¼‰æ¥å£ï¼Œæµ‹è¯•çš„æ˜¯æŸä¸€å—åŠŸèƒ½çš„å®Œå¤‡æ€§ã€‚</p>\n<p>è¿™é‡Œæˆ‘ä»¬è®¨è®ºçš„ä»…é™äºå•å…ƒæµ‹è¯•ã€‚åœ¨ python ä¸­ï¼Œå•å…ƒæµ‹è¯•å¯ä»¥ä½¿ç”¨ unittest æ¨¡å—å’Œ pytestï¼Œuninttest æ˜¯ python è‡ªå¸¦çš„æµ‹è¯•æ¨¡å—ï¼Œè€Œ pytest æ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹æ¨¡å—ï¼Œåœ¨å…¼å®¹ unittest çš„åŸºç¡€ä¸Šï¼Œå¢åŠ äº†é›†æˆæµ‹è¯•çš„åŠŸèƒ½ï¼Œæ–¹ä¾¿æˆ‘ä»¬è¿›è¡Œæ‰¹é‡çš„å•å…ƒæµ‹è¯•ï¼Œä¸ CI è¿›è¡Œç»“åˆã€‚å› æ­¤åæ–‡ä¸­ä½¿ç”¨ pytest æ¥è¿›è¡Œè®²è§£ã€‚</p>\n<p>pytest å¯ä»¥è‡ªåŠ¨é€’å½’æŒ‡å®šè·¯å¾„ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼Œåªè¦ç¬¦åˆ<code>test_</code>æˆ–è€…<code>_test</code>å¼€å¤´çš„ py æ–‡ä»¶éƒ½ä¼šè¢«è¯†åˆ«ä¸ºæµ‹è¯•ç”¨ä¾‹æ–‡ä»¶ã€‚éƒ½ä¼šåœ¨æµ‹è¯•è®¡åˆ’ä¸­æ‰§è¡Œã€‚</p>\n<h2 id=\"å®è·µ-1\"><a href=\"#å®è·µ-1\" class=\"headerlink\" title=\"å®è·µ\"></a>å®è·µ</h2><p>åœ¨ä½¿ç”¨ pytest ä¹‹å‰éœ€è¦ä½¿ç”¨ pip æˆ–è€… poetry ä¸‹è½½ï¼Œæˆ‘ä»¬å¯ä»¥å°† pytest ä¸‹è½½åˆ°<code>dev</code>åˆ†ç»„çš„ä¾èµ–ï¼Œä¹Ÿå°±æ˜¯å¼€å‘æ—¶ä¾èµ–ï¼ˆå¦‚<code>poetry add pytest --group dev</code>ï¼‰ï¼Œä»¥ä¾¿ç”Ÿäº§éƒ¨ç½²æ—¶ç²¾ç®€æ‰å¼€å‘æ—¶ä¾èµ–ã€‚</p>\n<p>é¡¹ç›®ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight plaintext\"><figcaption><span>Text</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">poetry-fastapi-demo/</span><br><span class=\"line\">Â â”‚</span><br><span class=\"line\">Â â”œâ”€â”€ poetry_fastapi_demo/ Â  # ç¨‹åºä¸»åŒ… Â  Â </span><br><span class=\"line\">Â â”‚ Â  â”œâ”€â”€ models/ Â  Â  Â  Â      # æ¨¡å‹</span><br><span class=\"line\">â”‚   â”‚   â”œâ”€â”€ __init__.py</span><br><span class=\"line\">|   |   â”œâ”€â”€ user.py</span><br><span class=\"line\">|   â”œâ”€â”€ routers/ Â  Â  Â  Â      # è·¯ç”±</span><br><span class=\"line\">|   |   â”œâ”€â”€ __init__.py</span><br><span class=\"line\">|   |   â”œâ”€â”€ user.py</span><br><span class=\"line\">|   â”œâ”€â”€ tables/              # å¢åˆ æ”¹æŸ¥</span><br><span class=\"line\">|   |   â”œâ”€â”€ __init__.py</span><br><span class=\"line\">|   |   â”œâ”€â”€ user.py</span><br><span class=\"line\">â”‚ Â  â”œâ”€â”€ __init__.py Â  Â </span><br><span class=\"line\">â”‚   â””â”€â”€ main.py Â  Â  Â  Â      # ä¸»ç¨‹åºå…¥å£</span><br><span class=\"line\">â”œâ”€â”€ tests/                  # æµ‹è¯•æ–‡ä»¶</span><br><span class=\"line\">|   â”œâ”€â”€ test_user_table.py Â  Â # æ¨¡å‹</span><br><span class=\"line\">......</span><br></pre></td></tr></table></figure>\n\n<p>å…¶ä¸­ï¼Œ<code>poetry_fastapi_demo/tables/user.py</code>å†…å®¹å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> typing <span class=\"keyword\">import</span> <span class=\"type\">Optional</span>, <span class=\"type\">List</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">from</span> poetry_fastapi_demo.models <span class=\"keyword\">import</span> User</span><br><span class=\"line\"></span><br><span class=\"line\">user_list = [</span><br><span class=\"line\">    User(</span><br><span class=\"line\">        <span class=\"built_in\">id</span>=<span class=\"number\">1</span>,</span><br><span class=\"line\">        name=<span class=\"string\">&quot;Chris&quot;</span>,</span><br><span class=\"line\">        email=<span class=\"string\">&quot;chris@gmail.com&quot;</span>,</span><br><span class=\"line\">        password=<span class=\"string\">&quot;pso3sd5xv&quot;</span>,</span><br><span class=\"line\">        role=<span class=\"string\">&quot;admin&quot;</span></span><br><span class=\"line\">    ),</span><br><span class=\"line\">    User(</span><br><span class=\"line\">        <span class=\"built_in\">id</span>=<span class=\"number\">2</span>,</span><br><span class=\"line\">        name=<span class=\"string\">&quot;Jon&quot;</span>,</span><br><span class=\"line\">        email=<span class=\"string\">&quot;jon@gmail.com&quot;</span>,</span><br><span class=\"line\">        password=<span class=\"string\">&quot;rthdfwe5sdf&quot;</span>,</span><br><span class=\"line\">        role=<span class=\"string\">&quot;user&quot;</span></span><br><span class=\"line\">    ),</span><br><span class=\"line\">    User(</span><br><span class=\"line\">        <span class=\"built_in\">id</span>=<span class=\"number\">3</span>,</span><br><span class=\"line\">        name=<span class=\"string\">&quot;Arya&quot;</span>,</span><br><span class=\"line\">        email=<span class=\"string\">&quot;arya@gmail.com&quot;</span>,</span><br><span class=\"line\">        password=<span class=\"string\">&quot;ndddrwe42&quot;</span>,</span><br><span class=\"line\">        role=<span class=\"string\">&quot;user&quot;</span></span><br><span class=\"line\">    )</span><br><span class=\"line\"></span><br><span class=\"line\">]</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">UserTable</span>:</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">get_all_users</span>(<span class=\"params\">self</span>) -&gt; <span class=\"type\">List</span>[User]:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> user_list</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">get_user_by_id</span>(<span class=\"params\">self, user_id: <span class=\"built_in\">int</span></span>) -&gt; <span class=\"type\">Optional</span>[User]:</span><br><span class=\"line\">        <span class=\"keyword\">for</span> user <span class=\"keyword\">in</span> user_list:</span><br><span class=\"line\">            <span class=\"keyword\">if</span> user.<span class=\"built_in\">id</span> == user_id:</span><br><span class=\"line\">                <span class=\"keyword\">return</span> user</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">None</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">update_user</span>(<span class=\"params\">self, user: User</span>) -&gt; <span class=\"built_in\">bool</span>:</span><br><span class=\"line\">        <span class=\"keyword\">for</span> u <span class=\"keyword\">in</span> user_list:</span><br><span class=\"line\">            <span class=\"keyword\">if</span> u.<span class=\"built_in\">id</span> == user.<span class=\"built_in\">id</span>:</span><br><span class=\"line\">                u.name = user.name</span><br><span class=\"line\">                u.email = user.email</span><br><span class=\"line\">                u.password = user.password</span><br><span class=\"line\">                u.role = user.role</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">True</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">False</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">delete_user</span>(<span class=\"params\">self, user_id: <span class=\"built_in\">int</span></span>) -&gt; <span class=\"built_in\">bool</span>:</span><br><span class=\"line\">        <span class=\"keyword\">for</span> i, u <span class=\"keyword\">in</span> <span class=\"built_in\">enumerate</span>(user_list):</span><br><span class=\"line\">            <span class=\"keyword\">if</span> u.<span class=\"built_in\">id</span> == user_id:</span><br><span class=\"line\">                <span class=\"keyword\">del</span> user_list[i]</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">True</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">False</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">add_user</span>(<span class=\"params\">self, user: User</span>) -&gt; <span class=\"built_in\">bool</span>:</span><br><span class=\"line\">        <span class=\"keyword\">for</span> u <span class=\"keyword\">in</span> user_list:</span><br><span class=\"line\">            <span class=\"keyword\">if</span> u.<span class=\"built_in\">id</span> == user.<span class=\"built_in\">id</span>:</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">False</span></span><br><span class=\"line\">        user_list.append(user)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">True</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">user_table = UserTable()</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>æµ‹è¯•æ¡ˆä¾‹<code>test_user_table.py</code>å†…å®¹å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> poetry_fastapi_demo.models <span class=\"keyword\">import</span> User</span><br><span class=\"line\"><span class=\"keyword\">from</span> poetry_fastapi_demo.tables <span class=\"keyword\">import</span> user_table</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">TestUserTable</span>:</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">test_get_all</span>(<span class=\"params\">self</span>):</span><br><span class=\"line\">        user_table.get_all_users()</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">test_get_by_id</span>(<span class=\"params\">self</span>):</span><br><span class=\"line\">        user = user_table.get_user_by_id(<span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">assert</span> user.name == <span class=\"string\">&quot;Chris&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">test_update_user</span>(<span class=\"params\">self</span>):</span><br><span class=\"line\">        user = user_table.get_user_by_id(<span class=\"number\">1</span>)</span><br><span class=\"line\">        user.name = <span class=\"string\">&quot;Chris2&quot;</span></span><br><span class=\"line\">        <span class=\"keyword\">assert</span> user_table.update_user(user) <span class=\"keyword\">is</span> <span class=\"literal\">True</span></span><br><span class=\"line\">        <span class=\"keyword\">assert</span> user_table.get_user_by_id(<span class=\"number\">1</span>).name == <span class=\"string\">&quot;Chris&quot;</span>   <span class=\"comment\"># æ•…æ„å†™é”™</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">test_delete_user</span>(<span class=\"params\">self</span>):</span><br><span class=\"line\">        <span class=\"keyword\">assert</span> user_table.delete_user(<span class=\"number\">1</span>) <span class=\"keyword\">is</span> <span class=\"literal\">True</span></span><br><span class=\"line\">        <span class=\"keyword\">assert</span> user_table.get_user_by_id(<span class=\"number\">1</span>) <span class=\"keyword\">is</span> <span class=\"literal\">None</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">test_add_user</span>(<span class=\"params\">self</span>):</span><br><span class=\"line\">        result = user_table.add_user(User(</span><br><span class=\"line\">            <span class=\"built_in\">id</span>=<span class=\"number\">4</span>,</span><br><span class=\"line\">            name=<span class=\"string\">&quot;robb&quot;</span>,</span><br><span class=\"line\">            email=<span class=\"string\">&quot;robb@gmail.com&quot;</span>,</span><br><span class=\"line\">            password=<span class=\"string\">&quot;loqjwnd[as;&quot;</span>,</span><br><span class=\"line\">            role=<span class=\"string\">&quot;admin&quot;</span></span><br><span class=\"line\">        ))</span><br><span class=\"line\">        <span class=\"keyword\">assert</span> result <span class=\"keyword\">is</span> <span class=\"literal\">True</span></span><br><span class=\"line\">        <span class=\"keyword\">assert</span> user_table.get_user_by_id(<span class=\"number\">4</span>).name == <span class=\"string\">&quot;robb&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>ç„¶åæˆ‘ä»¬åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ<code>pytest tests/ -v</code>ï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š</p>\n<p><img src=\"https://image.robocanic.com/notes/py-test.png\" alt=\"py-test\"></p>\n<p>pytest ä¼šé€’å½’åœ°åœ¨ tests æ–‡ä»¶å¤¹ä¸‹å¯»æ‰¾ä»¥<code>test_</code>æˆ–<code>_test</code>å¼€å¤´çš„ py æ–‡ä»¶ï¼Œåœ¨ py æ–‡ä»¶ä¸­ï¼Œä¼šå¯»æ‰¾ä»¥<code>test_</code>æˆ–<code>_test</code>å¼€å¤´çš„å‡½æ•°æˆ–è€…ç±»ï¼Œå¯¹äºæˆ‘ä»¬è¿™ä¸ªæ¡ˆä¾‹æ¥è¯´ï¼Œä¸€å…±æœ‰ 5 ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œåœ¨è¾“å‡ºä¸­æˆ‘ä»¬ä¹Ÿèƒ½è¯¦ç»†åœ°æŸ¥çœ‹åˆ°é€šè¿‡å’Œå¤±è´¥çš„å…·ä½“ç”¨ä¾‹ï¼Œé”™è¯¯çš„åŸå› ï¼Œæ‰§è¡Œçš„æ—¶é—´ç­‰ç­‰ã€‚æ­¤å¤–ï¼Œpytest è¿˜æœ‰å…¶ä»–çš„åŠŸèƒ½ï¼ˆå¯å‚è€ƒ<a href=\"https://learning-pytest.readthedocs.io/zh/latest/index.html\">https://learning-pytest.readthedocs.io/zh/latest/index.html</a>ï¼‰ï¼Œå¦‚æµ‹è¯•å‰å’Œæµ‹è¯•åçš„é¢„å¤„ç†å’Œåå¤„ç†ï¼Œä½¿ç”¨æ’ä»¶ç”Ÿæˆæµ‹è¯•æŠ¥å‘Šç­‰ï¼Œè¿™é‡Œå°±ç®—æŠ›ç –å¼•ç‰ç»™å¤§å®¶ã€‚</p>\n<h2 id=\"CI-é›†æˆ\"><a href=\"#CI-é›†æˆ\" class=\"headerlink\" title=\"CI é›†æˆ\"></a>CI é›†æˆ</h2><p>æŒ‰ç…§å¼€å‘æµç¨‹æ¥è¯´ï¼Œæˆ‘ä»¬åœ¨æœ¬åœ°å¼€å‘å¹¶å•æµ‹å®Œåï¼Œä¼šå‘å¸ƒåˆ°æµ‹è¯•ç¯å¢ƒä¸­è¿›è¡Œè¿›ä¸€æ­¥åœ°è°ƒè¯•éªŒè¯ã€‚æœ‰æ—¶å€™æˆ‘ä»¬ä¿®æ”¹å®Œä»£ç åå¿˜è®°æ‰§è¡Œå¯¹åº”çš„å•æµ‹å°±æäº¤äº†ï¼Œç„¶ååœ¨è°ƒè¯•ä¸­æ‰å‘ç°äº†é”™è¯¯ï¼Œç„¶ååˆå›ç‚‰é‡é€ ã€‚ä¸ºäº†å°½é‡å‡å°‘ä¿®æ”¹å°é”™è¯¯åå¤å‘å¸ƒçš„æ—¶é—´ï¼Œæˆ‘ä»¬å¯ä»¥å°†è‡ªåŠ¨åŒ–æµ‹è¯•é›†æˆåˆ° gitlab pipelineï¼ˆä½¿ç”¨å‚è€ƒ<a href=\"https://docs.gitlab.com/ee/ci/pipelines/\">https://docs.gitlab.com/ee/ci/pipelines/</a>ï¼‰æˆ– github actions(ä½¿ç”¨å‚è€ƒ<a href=\"https://docs.github.com/zh/actions\">https://docs.github.com/zh/actions</a>)ã€‚</p>\n<h4 id=\"github-actions\"><a href=\"#github-actions\" class=\"headerlink\" title=\"github actions\"></a>github actions</h4><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">name:</span> <span class=\"string\">Python</span> <span class=\"string\">ci</span>           <span class=\"comment\"># workflowåå­—</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">on:</span>                            <span class=\"comment\"># è§¦å‘æ¡ä»¶ï¼Œpushæˆ–mergeåˆ°devä¸­è§¦å‘</span></span><br><span class=\"line\">  <span class=\"attr\">push:</span></span><br><span class=\"line\">    <span class=\"attr\">branches:</span> [ <span class=\"string\">&quot;dev&quot;</span> ]</span><br><span class=\"line\">  <span class=\"attr\">pull_request:</span></span><br><span class=\"line\">    <span class=\"attr\">branches:</span> [ <span class=\"string\">&quot;dev&quot;</span> ]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">jobs:</span></span><br><span class=\"line\">  <span class=\"attr\">build:</span></span><br><span class=\"line\">    <span class=\"attr\">runs-on:</span> <span class=\"string\">ubuntu-latest</span>    <span class=\"comment\"># è·‘åœ¨ubuntuè™šæ‹Ÿæœºä¸Š</span></span><br><span class=\"line\">    <span class=\"attr\">strategy:</span>                 <span class=\"comment\"># æ‰§è¡Œç­–ç•¥</span></span><br><span class=\"line\">      <span class=\"attr\">fail-fast:</span> <span class=\"literal\">false</span></span><br><span class=\"line\">      <span class=\"attr\">matrix:</span></span><br><span class=\"line\">        <span class=\"attr\">python-version:</span> [<span class=\"string\">&quot;3.10&quot;</span>]</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"attr\">steps:</span>                    <span class=\"comment\"># æ‰§è¡Œæ­¥éª¤</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">uses:</span> <span class=\"string\">actions/checkout@v4</span>    <span class=\"comment\"># ä½¿ç”¨checkoutè¿™ä¸ªå·²æœ‰çš„actionæ¥åˆå§‹åŒ–gitç¯å¢ƒ</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Set</span> <span class=\"string\">up</span> <span class=\"string\">Python</span> <span class=\"string\">$&#123;&#123;</span> <span class=\"string\">matrix.python-version</span> <span class=\"string\">&#125;&#125;</span>   <span class=\"comment\"># ä½¿ç”¨setup-pythonæ¥åˆå§‹åŒ–pythonç¯å¢ƒ</span></span><br><span class=\"line\">      <span class=\"attr\">uses:</span> <span class=\"string\">actions/setup-python@v3</span></span><br><span class=\"line\">      <span class=\"attr\">with:</span></span><br><span class=\"line\">        <span class=\"attr\">python-version:</span> <span class=\"string\">$&#123;&#123;</span> <span class=\"string\">matrix.python-version</span> <span class=\"string\">&#125;&#125;</span>     <span class=\"comment\"># æŒ‡å®špythonç‰ˆæœ¬</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Set</span> <span class=\"string\">up</span> <span class=\"string\">Poetry</span>                 <span class=\"comment\"># ä½¿ç”¨setup-poetryè¿™ä¸ªå·²æœ‰çš„actionæ¥åˆå§‹åŒ–poetry</span></span><br><span class=\"line\">      <span class=\"attr\">uses:</span> <span class=\"string\">Gr1N/setup-poetry@v9</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Install</span> <span class=\"string\">dependencies</span>         <span class=\"comment\"># ä½¿ç”¨poetryä¸‹è½½ä¾èµ–ï¼Œå› ä¸ºæ˜¯åœ¨ä¸€ä¸ªå•ç‹¬çš„è™šæ‹Ÿæœº/å®¹å™¨ä¸­ï¼Œæ‰€ä»¥æ— éœ€åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ</span></span><br><span class=\"line\">      <span class=\"attr\">run:</span> <span class=\"string\">|</span></span><br><span class=\"line\"><span class=\"string\">        poetry config virtualenvs.create false</span></span><br><span class=\"line\"><span class=\"string\">        poetry lock</span></span><br><span class=\"line\"><span class=\"string\">        poetry install --all-extras</span></span><br><span class=\"line\"><span class=\"string\"></span>    <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Test</span> <span class=\"string\">with</span> <span class=\"string\">pytest</span>            <span class=\"comment\"># ä½¿ç”¨pytestæ‰§è¡Œé›†æˆæµ‹è¯•</span></span><br><span class=\"line\">      <span class=\"attr\">env:</span></span><br><span class=\"line\">        <span class=\"attr\">LOG_CONFIG:</span> <span class=\"string\">./log.yaml</span></span><br><span class=\"line\">      <span class=\"attr\">run:</span> <span class=\"string\">|</span></span><br><span class=\"line\">        <span class=\"string\">pytest</span> <span class=\"string\">tests/</span> <span class=\"string\">-v</span></span><br></pre></td></tr></table></figure>\n\n<p>æˆ‘ä»¬æŠŠä¸Šé¢è¿™ä¸ª yml å‘½åä¸º ci.ymlï¼Œå¹¶æ”¾ç½®åœ¨é¡¹ç›®æ ¹ç›®å½•.github&#x2F;workflows ç›®å½•ä¸‹ï¼Œç„¶å github ä¼šè‡ªåŠ¨æ£€æµ‹åˆ° workflow çš„å­˜åœ¨å¹¶æŒ‰ç…§ yml ä¸­å®šä¹‰çš„æ­¥éª¤ä¾æ¬¡æ‰§è¡Œã€‚ç„¶åæˆ‘ä»¬åœ¨ dev åˆ†æ”¯ push åˆ°è¿œç¨‹ï¼Œç„¶åæˆ‘ä»¬ä¼šåœ¨ actions ä¸­å‘ç°å†å²æ‰§è¡Œ&#x2F;æ­£åœ¨æ‰§è¡Œçš„ workflowã€‚</p>\n<p><img src=\"https://image.robocanic.com/notes/github-action.png\" alt=\"github-action\"></p>\n<p>æˆ‘ä»¬ç‚¹è¿›æŸä¸€ä¸ª workflow å¯ä»¥çœ‹åˆ° job çš„æ‰§è¡Œç»“æœæ˜¯æˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼š</p>\n<p><img src=\"https://image.robocanic.com/notes/github-workflow-job.png\" alt=\"github-workflow-job\"></p>\n<p>è¿›ä¸€æ­¥ï¼Œæˆ‘ä»¬è¿›å…¥ build è¿™ä¸ª jobï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°é›†æˆæµ‹è¯•çš„ä¿¡æ¯ï¼š</p>\n<p><img src=\"https://image.robocanic.com/notes/job-test.png\" alt=\"job-test\"></p>\n<p>æ­¤å¤–ï¼Œgithub actions è¿˜å¯ä»¥æ¢ç´¢æ›´å¤šçš„ç©æ³•ï¼Œæ¯”å¦‚ï¼šå½“ job å¤±è´¥äº†å‘é€é‚®ä»¶åˆ°è‡ªå·±çš„é‚®ç®±æç¤ºæµæ°´çº¿å¤±è´¥äº†ï¼Œå½“ job å¤±è´¥äº†å›æ»šåˆ°ä¸Šä¸€ä¸ª commit çš„çŠ¶æ€ç­‰ç­‰ï¼Œè¿™äº›å°±éƒ½ç•™ç»™ä½ å»æ¢ç´¢äº†</p>\n<h4 id=\"gitlab-pipeline\"><a href=\"#gitlab-pipeline\" class=\"headerlink\" title=\"gitlab pipeline\"></a>gitlab pipeline</h4><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">stages:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">automatic_test_dev</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">automatic_test_job_dev:</span>   <span class=\"comment\"># æˆ‘ä»¬åªåœ¨æµ‹è¯•ç¯å¢ƒæ‰§è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œç”Ÿäº§ç¯å¢ƒä¸ºäº†åŠ å¿«å‘å¸ƒé€Ÿåº¦ï¼Œä¸æ‰§è¡Œæµ‹è¯•</span></span><br><span class=\"line\">  <span class=\"attr\">image:</span> <span class=\"string\">sunpeek/poetry:py3.10-slim</span>    <span class=\"comment\"># ä½¿ç”¨å¸¦poetryçš„pythoné•œåƒ</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">automatic_test_dev</span></span><br><span class=\"line\">  <span class=\"attr\">only:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">dev</span>                 <span class=\"comment\"># åªæœ‰devåˆ†æ”¯å‘ç”Ÿå˜åŒ–ï¼ˆmergeæˆ–pushï¼‰æ—¶è§¦å‘</span></span><br><span class=\"line\">  <span class=\"attr\">tags:</span>                   <span class=\"comment\"># åŒ¹é…pythonæ ‡ç­¾çš„runneræ‰è¿è¡Œ</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">python</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span>                 <span class=\"comment\"># æ‰§è¡Œè„šæœ¬</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">poetry</span> <span class=\"string\">config</span> <span class=\"string\">virtualenvs.create</span> <span class=\"literal\">false</span>  <span class=\"comment\"># åœ¨å®¹å™¨ä¸­ï¼Œä¸ç”¨åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">poetry</span> <span class=\"string\">lock</span>     <span class=\"comment\"># é”å®šä¾èµ–ç‰ˆæœ¬</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">poetry</span> <span class=\"string\">install</span>  <span class=\"comment\"># ä¸‹è½½ä¾èµ–</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">pytest</span> <span class=\"string\">tests/</span>   <span class=\"comment\"># æ‰§è¡Œæµ‹è¯•</span></span><br></pre></td></tr></table></figure>\n\n<p>æˆ‘ä»¬å°†è¿™ä¸ª yml æ–‡ä»¶å‘½åä¸º.gitlab-ci.ymlï¼Œç„¶å push åˆ° dev åˆ†æ”¯ï¼Œå°±ä¼šè§¦å‘ pipelineã€‚gitlab pipeline æœ¬è´¨ä¸Šå’Œ github actions æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯å£°æ˜å¼çš„æµæ°´çº¿ï¼Œå› æ­¤è¿™é‡Œå°±ä¸å†èµ˜è¿°ï¼Œä½ å¯ä»¥æŸ¥é˜…å®˜æ–¹æ–‡æ¡£ï¼ˆ<a href=\"https://docs.gitlab.com/ee/ci/pipelines/\">https://docs.gitlab.com/ee/ci/pipelines/</a>ï¼‰æ¥ç»„åˆå‡ºä½ çš„ pipelineã€‚</p>\n<h1 id=\"é¡¹ç›®å‘å¸ƒç®¡ç†\"><a href=\"#é¡¹ç›®å‘å¸ƒç®¡ç†\" class=\"headerlink\" title=\"é¡¹ç›®å‘å¸ƒç®¡ç†\"></a>é¡¹ç›®å‘å¸ƒç®¡ç†</h1><p>å½“æˆ‘ä»¬é¡¹ç›®åœ¨æœ¬åœ°è¿è¡Œ okï¼Œæµ‹è¯•ä¹Ÿ ok åï¼Œè¯¥è€ƒè™‘å‘å¸ƒåˆ°å„ä¸ªç¯å¢ƒï¼ˆè”è°ƒï¼Œæµ‹è¯•ï¼Œç”Ÿäº§ç­‰ï¼‰ã€‚è¿™ä¸ªè¿‡ç¨‹æ ¹æ®é¡¹ç›®çš„å±æ€§åˆ†ä¸ºä¸¤ç±»ï¼Œä¸€ç±»æ˜¯äºŒæ–¹åŒ…çš„å‘å¸ƒï¼Œå¦ä¸€ç±»åˆ™æ˜¯æ­£ç»åº”ç”¨å‘å¸ƒã€‚</p>\n<p>åœ¨è°ˆè¿™ä¸¤ç±»å‘å¸ƒä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥ç¡®è®¤å‘å¸ƒè¿‡ç¨‹ä¸­æˆ‘ä»¬æƒ³è¦è¾¾åˆ°çš„ç›®æ ‡ï¼ˆè¦æ±‚ï¼‰ï¼š</p>\n<ol>\n<li><p>å¯¹äºäºŒæ–¹åŒ…å‘å¸ƒï¼Œæˆ‘ä»¬å¸Œæœ›å®ƒåœ¨æœ¬åœ°å°±èƒ½å¤Ÿå‘å¸ƒ beta ç‰ˆæœ¬ï¼Œä»¥ä¾¿äºå¿«é€ŸéªŒè¯ã€‚æ­¤å¤–ï¼Œæ­£å¼ç‰ˆæœ¬çš„å‘å¸ƒï¼Œæˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿé›†æˆåˆ° CI ä¸­ã€‚</p>\n</li>\n<li><p>å¯¹äºåº”ç”¨å‘å¸ƒï¼Œæˆ‘ä»¬å¸Œæœ›å®ƒå‘å¸ƒæ—¶è¶³å¤Ÿè¿…é€Ÿï¼Œä»¥ä¾¿åœ¨å‡ºç°é—®é¢˜æ—¶å¿«é€Ÿæ¨é€è¡¥ä¸è§£å†³é—®é¢˜ã€‚</p>\n</li>\n<li><p>æ— è®ºæ˜¯äºŒæ–¹åŒ…è¿˜æ˜¯åº”ç”¨å‘å¸ƒï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨å‘å¸ƒçš„æ—¶å€™è‡ªåŠ¨æ‰§è¡Œé›†æˆæµ‹è¯•ï¼ˆç”Ÿäº§é™¤å¤–ï¼‰ï¼Œç”Ÿæˆä¸€ä»½æµ‹è¯•æŠ¥å‘Šã€‚</p>\n</li>\n</ol>\n<h2 id=\"äºŒæ–¹åŒ…å‘å¸ƒ\"><a href=\"#äºŒæ–¹åŒ…å‘å¸ƒ\" class=\"headerlink\" title=\"äºŒæ–¹åŒ…å‘å¸ƒ\"></a>äºŒæ–¹åŒ…å‘å¸ƒ</h2><p>äºŒæ–¹åŒ…çš„å‘å¸ƒæ ¹æ®æˆ‘ä»¬ä½¿ç”¨çš„é¡¹ç›®ç¯å¢ƒå’Œä¾èµ–ç®¡ç†å·¥å…·å¯ä»¥åˆ’åˆ†ä¸ºä¸¤ç±»ï¼Œç¬¬ä¸€ç±»æ˜¯ä½¿ç”¨ conda+pip æˆ–è€… venv+pip åçš„å‘å¸ƒæµç¨‹ï¼Œå¦ä¸€ç±»æ˜¯ä½¿ç”¨ poetry åçš„å‘å¸ƒæµç¨‹ã€‚</p>\n<h3 id=\"setuptools-twine\"><a href=\"#setuptools-twine\" class=\"headerlink\" title=\"setuptools+twine\"></a>setuptools+twine</h3><p>å‘å¸ƒåˆ†ä¸ºæ‰“åŒ…å’Œæ¨é€ä¸¤ä¸ªæ­¥éª¤ï¼Œsetuptools è´Ÿè´£å°†æˆ‘ä»¬çš„ python ä»£ç æ‰“åŒ…ï¼Œè€Œ twine åˆ™è´Ÿè´£å°†æ‰“åŒ…åçš„ pkg æ¨é€åˆ° PyPI ä»“åº“ã€‚</p>\n<p>setuptools æ˜¯å¾ˆå¤šå¹´æ¥ python æ‰“åŒ…çš„é¦–é€‰å·¥å…·ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦æ‰§è¡Œ<code>pip install setuptools</code>æ¥ä¸‹è½½è¿™ä¸ªå·¥å…·ã€‚ç„¶ååœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª<code>setup.py</code>æ–‡ä»¶æ¥å†™æ‰“åŒ…æ—¶çš„é…ç½®ï¼Œä¸€ä¸ª setup.py å¦‚ä¸‹æ‰€ç¤ºï¼š</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> setuptools <span class=\"keyword\">import</span> setup, find_packages</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">with</span> <span class=\"built_in\">open</span>(<span class=\"string\">&quot;README.md&quot;</span>, <span class=\"string\">&quot;r&quot;</span>, encoding=<span class=\"string\">&quot;UTF-8&quot;</span>) <span class=\"keyword\">as</span> fh:</span><br><span class=\"line\">    long_description = fh.read()</span><br><span class=\"line\">version= os.environ.get(<span class=\"string\">&quot;GITHUB_REF_NAME&quot;</span>, <span class=\"string\">&quot;0.0.1b0&quot;</span>) <span class=\"comment\"># åŒ…çš„ç‰ˆæœ¬ï¼ŒGITHUB_REF_NAMEæ˜¯github tag nameçš„ç¯å¢ƒå˜é‡ï¼Œä»£è¡¨ä»£ç åˆ†æ”¯TAGï¼›0.0.1b0 æ˜¯0.0.1-BETA0çš„ç¼©å†™</span></span><br><span class=\"line\">setup(</span><br><span class=\"line\">    name=<span class=\"string\">&#x27;poetry_fastapi_demo&#x27;</span>,  <span class=\"comment\"># åŒ…å</span></span><br><span class=\"line\">    version=version,     <span class=\"comment\"># æ„å»ºç‰ˆæœ¬</span></span><br><span class=\"line\">    author=<span class=\"string\">&#x27;robocanic&#x27;</span>,  <span class=\"comment\"># ä½œè€…</span></span><br><span class=\"line\">    author_email=<span class=\"string\">&#x27;robocanic@gmail.com&#x27;</span>,</span><br><span class=\"line\">    description=<span class=\"string\">&#x27;A web project template using poetry and fastapi.&#x27;</span>,   <span class=\"comment\"># æè¿°</span></span><br><span class=\"line\">    long_description=long_description,  <span class=\"comment\"># é•¿çš„æè¿°</span></span><br><span class=\"line\">    long_description_content_type=<span class=\"string\">&quot;text/markdown&quot;</span>,</span><br><span class=\"line\">    url=<span class=\"string\">&#x27;https://github.com/robocanic/poetry-fastapi-demo&#x27;</span>,</span><br><span class=\"line\">    packages=find_packages(),  <span class=\"comment\"># æ‰“åŒ…æ‰€æœ‰åŒ…ç›®å½•</span></span><br><span class=\"line\">    classifiers=[</span><br><span class=\"line\">        <span class=\"string\">&quot;Development Status :: 2 - Beta&quot;</span>    <span class=\"comment\"># å¼€å‘é˜¶æ®µ</span></span><br><span class=\"line\">        <span class=\"string\">&quot;Programming Language :: Python :: 3.10&quot;</span>,   <span class=\"comment\"># ä½¿ç”¨çš„è¯­è¨€</span></span><br><span class=\"line\">        <span class=\"string\">&quot;Operating System:: OS Independent&quot;</span>,   <span class=\"comment\"># ä¸é™å®šOS</span></span><br><span class=\"line\">    ],</span><br><span class=\"line\">    install_requires=[     <span class=\"comment\"># è¯¥é¡¹ç›®çš„ä¾èµ–ï¼Œåˆ«äººä¸‹è½½æˆ‘ä»¬çš„åŒ…æ—¶ä¼šè‡ªåŠ¨ä¸‹è½½è¿™äº›ä¾èµ–</span></span><br><span class=\"line\">        <span class=\"string\">&quot;fastapi==0.115.0&quot;</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;sqlalchemy==2.0.36&quot;</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;pyyaml==6.0.2&quot;</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;uvicorn=0.32.0&quot;</span></span><br><span class=\"line\">    ],</span><br><span class=\"line\">    python_requires=<span class=\"string\">&#x27;&gt;=3.10&#x27;</span>    <span class=\"comment\"># pythonè¦æ±‚</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p><code>setup.py</code>ä½¿ç”¨ä»£ç çš„æ–¹å¼å£°æ˜äº†æˆ‘ä»¬æ‰“åŒ…çš„é…ç½®ï¼ŒåŒ…æ‹¬æ„å»ºç‰ˆæœ¬ï¼Œç›´æ¥ä¾èµ–ï¼Œpython ç‰ˆæœ¬è¦æ±‚ç­‰ç­‰ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬åªéœ€è¦æ‰§è¡Œ<code>python setup.py sdist</code>å°±èƒ½å°†é¡¹ç›®æ‰“åŒ…æˆ.tar.gz æ–‡ä»¶ï¼Œå½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥æŒ‡å®šæ‰“åŒ…æ ¼å¼ä¸º<code>bdist_wheel</code>ï¼Œæ‰“åŒ…æˆ.wheel æ–‡ä»¶ã€‚æ‰“åŒ…åçš„æ–‡ä»¶é»˜è®¤æ”¾åœ¨ dist ç›®å½•ä¸‹ã€‚</p>\n<p>æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦ä½¿ç”¨ twine ä¸Šä¼ åˆ° PyPI ä»“åº“ï¼Œtwine ä¹Ÿæ˜¯ä¸€ä¸ª python åŒ…ï¼Œåœ¨ä½¿ç”¨ä¹‹å‰éœ€è¦é€šè¿‡<code>pip install twine</code>ä¸‹è½½ã€‚ç„¶åæ‰§è¡Œ<code>twine upload dist/*</code>å°±ä¸Šä¼ åˆ°äº†ä»“åº“ã€‚</p>\n<blockquote>\n<p>å¦‚æœè¦ä¸Šä¼ åˆ°ç§æœ‰çš„ PyPI ä»“åº“ï¼Œåˆ™éœ€è¦é…ç½®ä¸Šä¼ çš„ç”¨æˆ·åå’Œå¯†ç ï¼ŒåŒæ—¶åœ¨ä¸Šä¼ æ—¶éœ€è¦æŒ‡å®šç§æœ‰ä»“åº“ã€‚æœ€ä¾¿æ·çš„æ–¹æ³•æ˜¯åœ¨ root ç›®å½•ä¸‹æ–°å¢ä¸€ä¸ª.pypirc æ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹ä¸ºï¼š</p>\n</blockquote>\n<pre><code>[distutils]\n\n\nindex-servers = private-pypi\n\n[nexus]\n</code></pre>\n<p>repository&#x3D;<a href=\"https://private-pypi.com/simple/\">https://private-pypi.com/simple/</a><br>username&#x3D;foo<br>password&#x3D;bar<br>ç„¶åä½¿ç”¨<code>twine upload -r private-pypi dist/*</code> æ¥ä¸Šä¼ åˆ°æŒ‡å®šçš„ç§æœ‰ä»“åº“</p>\n<h3 id=\"poetry\"><a href=\"#poetry\" class=\"headerlink\" title=\"poetry\"></a>poetry</h3><p>å¦‚æœä½ ä½¿ç”¨äº† poetryï¼Œé‚£ poetry å°±è‡ªå¸¦äº†æ‰“åŒ…å’Œä¸Šä¼ çš„åŠŸèƒ½ã€‚poetry æ‰“åŒ…éå¸¸ç®€å•ï¼Œåªéœ€è¦æ‰§è¡Œ<code>poetry build</code>ï¼Œå®ƒå°±ä¼šå‚ç…§<code>pyproject.toml</code>ä¸­çš„é…ç½®è¿›è¡Œæ‰“åŒ…ã€‚æ‰“åŒ…ç”Ÿæˆçš„æ–‡ä»¶é»˜è®¤ä¹Ÿä¼šæ”¾åœ¨ dist ç›®å½•ä¸‹ã€‚</p>\n<p>ç„¶åæˆ‘ä»¬æ‰§è¡Œ<code>poetry publish</code>å°±å¯ä»¥å‘å¸ƒåˆ° PyPI ä»“åº“</p>\n<blockquote>\n<p>åŒæ ·ï¼Œè‹¥è¦ä½¿ç”¨ poetry ä¸Šä¼ åˆ°ç§æœ‰çš„ PyPI ä»“åº“ã€‚ä¹Ÿéœ€è¦é¢å¤–çš„é…ç½®ï¼š<br><code>poetry config repositories.foo-pub [https://pypi.example.org/legacy/](https://pypi.example.org/legacy/)</code> &gt; <code>poetry config http-basic.foo-pub &lt;username&gt; &lt;password&gt;</code> &gt; <code>poetry publish --repository foo-pub</code></p>\n</blockquote>\n<h3 id=\"CI-é›†æˆ-1\"><a href=\"#CI-é›†æˆ-1\" class=\"headerlink\" title=\"CI é›†æˆ\"></a>CI é›†æˆ</h3><p>å¾ˆå¤šæ—¶å€™æˆ‘ä»¬å‘ç°äº†ç‰¹å®šç‰ˆæœ¬åŒ…çš„ä¸€äº›é—®é¢˜ï¼Œæˆ‘ä»¬æƒ³è¦è¿™ä¸ªç‰¹å®šç‰ˆæœ¬çš„åŒ…å¯¹åº”çš„æºä»£ç ï¼Œå¹¶åœ¨æ­¤åŸºç¡€ä¸ŠåŠ ä¸€ä¸ªè¡¥ä¸ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦å°†æˆ‘ä»¬åŒ…çš„ç‰ˆæœ¬å’Œæˆ‘ä»¬ä»£ç çš„ç‰¹å®šåˆ†æ”¯ä¸€ä¸€å¯¹åº”ã€‚é€šè¿‡äººå·¥å®Œæˆè¿™ä¸ªè¿‡ç¨‹æ˜¯å¯è¡Œçš„ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨æ¯æ¬¡æ‰“åŒ…å‰&#x2F;å åŠ ä¸€ä¸ª commitï¼Œæ¨åˆ°è¿œç¨‹ä»“åº“ï¼Œæ‰“ä¸€ä¸ª tag å°±èƒ½å¯¹åº”èµ·æ¥ã€‚ä½†æ˜¯è¿™ä»¶é‡å¤çš„å·¥ä½œæˆ‘ä»¬æ—¶å¸¸ä¼šå¿˜è®°ï¼Œè¿™ä¸ªé‡å¤çš„å·¥ä½œå¯ä»¥äº¤ç»™ä¸€ä¸ªå•ç‹¬çš„ç¨‹åºæ¥åšå—ï¼Ÿç­”æ¡ˆå½“ç„¶æ˜¯è‚¯å®šçš„ï¼Œæ¯•ç«Ÿç¨‹åºå‘˜æœ€ä¹ æƒ¯çš„äº‹å°±æ˜¯å°†é‡å¤çš„å·¥ä½œç¨‹åºåŒ–ï¼Œå¤æ‚çš„å·¥ä½œæµç¨‹åŒ–ã€‚gitlab pipeline&#x2F;github actions èƒ½å¤Ÿé€šè¿‡æˆ‘ä»¬å£°æ˜çš„ yml æ–‡ä»¶æ¥å®Œæˆè¿™ä¸ªè¿‡ç¨‹ã€‚</p>\n<h4 id=\"gitlab-pipeline-1\"><a href=\"#gitlab-pipeline-1\" class=\"headerlink\" title=\"gitlab pipeline\"></a>gitlab pipeline</h4><p>ä¸€ä¸ªä½¿ç”¨ poetry çš„äºŒæ–¹åŒ…å‘å¸ƒçš„ gitlab pipeline æ–‡ä»¶å¯ä»¥å¦‚ä¸‹ï¼ˆé›†æˆäº†å•æµ‹ï¼‰ï¼š</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">image:</span> <span class=\"string\">sunpeek/poetry:py3.10-slim</span>   <span class=\"comment\"># éœ€è¦å¸¦æœ‰poetryçš„pythoné•œåƒ</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">stages:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">automatic_test</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">package_build_push</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">automatic_test_job:</span>   <span class=\"comment\">#</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">automatic_test</span></span><br><span class=\"line\">  <span class=\"attr\">only:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">dev</span></span><br><span class=\"line\">  <span class=\"attr\">tags:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">golang</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">poetry</span> <span class=\"string\">config</span> <span class=\"string\">virtualenvs.create</span> <span class=\"literal\">false</span>  <span class=\"comment\"># åœ¨å®¹å™¨ä¸­ï¼Œä¸ç”¨åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">poetry</span> <span class=\"string\">lock</span>     <span class=\"comment\"># é”å®šä¾èµ–ç‰ˆæœ¬</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">poetry</span> <span class=\"string\">install</span>  <span class=\"comment\"># ä¸‹è½½ä¾èµ–</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">pytest</span> <span class=\"string\">tests/</span>   <span class=\"comment\"># æ‰§è¡Œæµ‹è¯•</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">package_build_push_job:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">package_build_push</span></span><br><span class=\"line\">  <span class=\"attr\">only:</span>    <span class=\"comment\"># è§¦å‘æ¡ä»¶ï¼šåªæœ‰æ‰“tagä¹‹åæ‰ä¼šè§¦å‘è¯¥job</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">tags</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">poetry</span> <span class=\"string\">config</span> <span class=\"string\">repositories.foo-pub</span> <span class=\"string\">https://pypi.example.org/legacy/</span>   <span class=\"comment\"># æ·»åŠ å‘å¸ƒä»“åº“</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">poetry</span> <span class=\"string\">config</span> <span class=\"string\">http-basic.foo-pub</span> <span class=\"string\">$FOO_USERNAME</span> <span class=\"string\">$FOO_PASSWORD</span>          <span class=\"comment\"># æ·»åŠ å‘å¸ƒä»“åº“çš„ç”¨æˆ·åå¯†ç ï¼Œé€šè¿‡æµæ°´çº¿ç¯å¢ƒå˜é‡å¯ä»¥è®¾ç½®</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">sed</span> <span class=\"string\">-i</span> <span class=\"string\">&quot;s/^version = \\&quot;.*\\&quot;/version = \\&quot;$CI_COMMIT_TAG\\&quot;/&quot;</span> <span class=\"string\">pyproject.toml</span>  <span class=\"comment\"># ä¿®æ”¹æ„å»ºç‰ˆæœ¬ï¼Œä¸TAGä¸€è‡´</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">poetry</span> <span class=\"string\">publish</span> <span class=\"string\">--build</span>  <span class=\"string\">--repository</span> <span class=\"string\">foo-pub</span>   <span class=\"comment\"># æ‰“åŒ…å¹¶æ¨é€</span></span><br></pre></td></tr></table></figure>\n\n<p>ç®€å•æ¥è¯´ï¼Œgitlab åœ¨æˆ‘ä»¬æ‰“ä¸Šä¸€ä¸ª tag ä¹‹åï¼Œä¼šèµ·ä¸€ä¸ª runner æ‰§è¡Œè¿™ä¸ª yml æ–‡ä»¶çš„ scriptï¼ˆå…·ä½“è¿‡ç¨‹å¯è‡ªè¡Œäº†è§£ï¼‰ã€‚å› æ­¤å½“æˆ‘ä»¬æƒ³è¦å‘å¸ƒä¸€ä¸ªç‰ˆæœ¬æ—¶ï¼Œæ¨åˆ°é•œåƒä»“åº“åï¼Œæ‰“ä¸€ä¸ª tagï¼Œgitlab pipeline å°±ä¼šè¿›è¡Œæ‰“åŒ…ï¼Œæ¨é€ï¼Œå¹¶ä¸”æ¨é€åˆ°ä»“åº“çš„åŒ…çš„ç‰ˆæœ¬å’Œæˆ‘ä»¬çš„ TAG æ˜¯ä¸¥æ ¼å¯¹åº”çš„ã€‚</p>\n<h4 id=\"github-actions-1\"><a href=\"#github-actions-1\" class=\"headerlink\" title=\"github actions\"></a>github actions</h4><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">name:</span> <span class=\"string\">Release</span> <span class=\"string\">package</span>           <span class=\"comment\"># workflowåå­—</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">on:</span>                            <span class=\"comment\"># è§¦å‘æ¡ä»¶ï¼Œæ–°å»ºtagæ—¶è§¦å‘</span></span><br><span class=\"line\">  <span class=\"attr\">push:</span></span><br><span class=\"line\">    <span class=\"attr\">tags:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">&#x27;*&#x27;</span>                  <span class=\"comment\"># ä»»æ„æ ‡ç­¾éƒ½ä¼šè§¦å‘å·¥ä½œæµ</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">jobs:</span></span><br><span class=\"line\">  <span class=\"attr\">pkg:</span></span><br><span class=\"line\">    <span class=\"attr\">runs-on:</span> <span class=\"string\">ubuntu-latest</span></span><br><span class=\"line\">    <span class=\"attr\">steps:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"attr\">uses:</span> <span class=\"string\">actions/checkout@v4</span>    <span class=\"comment\"># ä½¿ç”¨checkoutè¿™ä¸ªå·²æœ‰çš„actionæ¥åˆå§‹åŒ–gitç¯å¢ƒ</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Set</span> <span class=\"string\">up</span> <span class=\"string\">Python</span> <span class=\"string\">$&#123;&#123;</span> <span class=\"string\">matrix.python-version</span> <span class=\"string\">&#125;&#125;</span>   <span class=\"comment\"># ä½¿ç”¨setup-pythonæ¥åˆå§‹åŒ–pythonç¯å¢ƒ</span></span><br><span class=\"line\">        <span class=\"attr\">uses:</span> <span class=\"string\">actions/setup-python@v3</span></span><br><span class=\"line\">        <span class=\"attr\">with:</span></span><br><span class=\"line\">          <span class=\"attr\">python-version:</span> <span class=\"string\">$&#123;&#123;</span> <span class=\"string\">matrix.python-version</span> <span class=\"string\">&#125;&#125;</span>     <span class=\"comment\"># æŒ‡å®špythonç‰ˆæœ¬</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Set</span> <span class=\"string\">up</span> <span class=\"string\">Poetry</span>                 <span class=\"comment\"># ä½¿ç”¨setup-poetryè¿™ä¸ªå·²æœ‰çš„actionæ¥åˆå§‹åŒ–poetry</span></span><br><span class=\"line\">        <span class=\"attr\">uses:</span> <span class=\"string\">Gr1N/setup-poetry@v9</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Extract</span> <span class=\"string\">version</span></span><br><span class=\"line\">        <span class=\"attr\">id:</span> <span class=\"string\">extract_version</span></span><br><span class=\"line\">        <span class=\"attr\">run:</span> <span class=\"string\">|</span></span><br><span class=\"line\"><span class=\"string\">          VERSION=&quot;$&#123;GITHUB_REF#refs/tags/&#125;&quot;</span></span><br><span class=\"line\"><span class=\"string\">          echo &quot;VERSION=$&#123;VERSION&#125;&quot; &gt;&gt; $GITHUB_ENV</span></span><br><span class=\"line\"><span class=\"string\"></span>      <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Replace</span> <span class=\"string\">version</span></span><br><span class=\"line\">        <span class=\"attr\">run:</span> <span class=\"string\">|</span></span><br><span class=\"line\"><span class=\"string\">          sed -i &quot;s/^version = \\&quot;.*\\&quot;/version = \\&quot;$&#123;&#123; env.VERSION &#125;&#125;\\&quot;/&quot; pyproject.toml</span></span><br><span class=\"line\"><span class=\"string\"></span>      <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Build</span> <span class=\"string\">Package</span>        <span class=\"comment\"># æ‰“åŒ…</span></span><br><span class=\"line\">        <span class=\"attr\">run:</span> <span class=\"string\">|</span></span><br><span class=\"line\"><span class=\"string\">          poetry config virtualenvs.create false</span></span><br><span class=\"line\"><span class=\"string\">          poetry build</span></span><br><span class=\"line\"><span class=\"string\"></span>      <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Publish</span> <span class=\"string\">Package</span>    <span class=\"comment\"># å‘å¸ƒ</span></span><br><span class=\"line\">        <span class=\"attr\">env:</span></span><br><span class=\"line\">          <span class=\"attr\">PYPI_API_TOKEN:</span> <span class=\"string\">$&#123;&#123;</span> <span class=\"string\">secrets.PYPI_API_TOKEN</span> <span class=\"string\">&#125;&#125;</span>    <span class=\"comment\"># æå‰å®šä¹‰pypiçš„ api token</span></span><br><span class=\"line\">        <span class=\"attr\">run:</span> <span class=\"string\">|</span></span><br><span class=\"line\"><span class=\"string\">          poetry config pypi-token.pypi $PYPI_API_TOKEN</span></span><br><span class=\"line\"><span class=\"string\">          poetry publish</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"æ€»ç»“-1\"><a href=\"#æ€»ç»“-1\" class=\"headerlink\" title=\"æ€»ç»“\"></a>æ€»ç»“</h4><p>poetry ä½œä¸ºé›†ç¯å¢ƒç®¡ç†ï¼Œä¾èµ–ç®¡ç†ï¼Œæ‰“åŒ…å‘å¸ƒä¸€ä½“çš„å·¥å…·ï¼Œè™½ç„¶æœ‰ä¸Šæ‰‹éš¾åº¦ï¼Œä½†ä»é•¿æœŸæ¥çœ‹æ˜¯å€¼å¾—ä½¿ç”¨çš„ï¼Œå¼ºçƒˆæ¨èã€‚gitlab pipeline&#x2F;github actions çš„ä½¿ç”¨å€’æ˜¯å¯ä»¥çœ‹è‡ªèº«éœ€æ±‚ï¼Œå¦‚æœé¡¹ç›®æ¯”è¾ƒå°ï¼Œå‘å¸ƒæ¬¡æ•°å°‘ï¼Œä¸è¦æ±‚ä»£ç åˆ†æ”¯ä¸åŒ…çš„ç‰ˆæœ¬ä¸¥æ ¼å¯¹åº”ï¼Œæ˜¯å¯ä»¥ä¸ç”¨çš„ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨ gitlab pipeline æ—¶ä¹Ÿå¯ä»¥é€‚å½“æ²¡é‚£ä¹ˆâ€œä¸¥æ ¼â€ï¼Œæ¯”å¦‚ï¼Œä¸ºäº†å›¾æ–¹ä¾¿æˆ‘ä»¬å¯ä»¥åœ¨æœ¬åœ°å‘å¸ƒéæ­£å¼ç‰ˆæœ¬ï¼Œè€Œæ­£å¼ç‰ˆæœ¬åˆ™èµ° pipelineï¼Œä¿è¯æ­£å¼ç‰ˆæœ¬çš„ç¨³å®šã€‚</p>\n<h2 id=\"åº”ç”¨å‘å¸ƒ\"><a href=\"#åº”ç”¨å‘å¸ƒ\" class=\"headerlink\" title=\"åº”ç”¨å‘å¸ƒ\"></a>åº”ç”¨å‘å¸ƒ</h2><p>åº”ç”¨å‘å¸ƒå³è®©æˆ‘ä»¬çš„åº”ç”¨è¿è¡Œåœ¨æœºå™¨ä¸Šï¼Œå¯¹å¤–æä¾›æœåŠ¡ã€‚åº”ç”¨çš„è¿è¡Œå½¢æ€å¯ä»¥åŸºæœ¬åˆ†ä¸ºå®¹å™¨&#x2F;è™šæ‹Ÿæœºï¼Œåæ–‡ä¸­éƒ½åŸºäºä½¿ç”¨æ›´å¹¿æ³›çš„å®¹å™¨æ¥è¿›è¡Œè¯´æ˜ã€‚</p>\n<p>åº”ç”¨å‘å¸ƒå¤§ä½“ä¸Šåˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼Œä¸€ä¸ªæ˜¯é•œåƒçš„æ‰“åŒ…ä¸æ¨é€ï¼Œå¦ä¸€ä¸ªæ˜¯é•œåƒæ‹‰å–å’Œå¯åŠ¨å®¹å™¨ã€‚å…¶ä¸­ï¼Œé•œåƒæ¨é€ï¼Œé•œåƒæ‹‰å–å’Œå¯åŠ¨å®¹å™¨å¯¹äºæ¯ä¸€ç§åº”ç”¨ç¨‹åºéƒ½æ˜¯å¤§å·®ä¸å·®çš„ï¼Œè€Œé•œåƒæ‰“åŒ…åˆ™æ˜¯å·®å¼‚æ¯”è¾ƒå¤§çš„ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘å°±é•œåƒæ‰“åŒ…å±•å¼€æ¥è®²ã€‚</p>\n<h3 id=\"é•œåƒæ‰“åŒ…\"><a href=\"#é•œåƒæ‰“åŒ…\" class=\"headerlink\" title=\"é•œåƒæ‰“åŒ…\"></a>é•œåƒæ‰“åŒ…</h3><p>é•œåƒçš„å¤§å°å…³ä¹åˆ°æ¨é€å’Œæ‹‰å–çš„æ•ˆç‡ï¼Œå› æ­¤æˆ‘ä»¬è¦å°½å¯èƒ½åœ°å‡å°é•œåƒå¤§å°ã€‚python çš„åŸºç¡€é•œåƒä¸­ï¼Œ<code>slim</code>ç‰ˆæœ¬çš„åŸºç¡€é•œåƒç§»é™¤äº†ä¸å¿…è¦çš„ç³»ç»Ÿä¸ªå·¥å…·å’Œåº“ï¼Œå› æ­¤åŸºç¡€é•œåƒæˆ‘ä»¬é€‰æ‹©<code>slim</code>ç‰ˆæœ¬ï¼ˆ127MB å·¦å³ï¼‰ã€‚</p>\n<p>æ­¤å¤–ï¼Œæˆ‘ä»¬å¦‚æœä½¿ç”¨äº† poetry æ¥ä½œä¸ºä¾èµ–ç®¡ç†çš„å·¥å…·ï¼Œé‚£åœ¨æ‰“åŒ…æ—¶å°±æœ‰ä¸¤ç§é€‰æ‹©ï¼šç¬¬ä¸€ç§æ˜¯ç›´æ¥å°† poetry æ‰“åˆ°åŸºç¡€é•œåƒä¸­ï¼Œç¬¬äºŒç§æ˜¯ä½¿ç”¨ multi-stage buildï¼Œå³åœ¨ç¬¬ä¸€ä¸ªé˜¶æ®µå…ˆä¸‹è½½ poetryï¼Œå¯¼å‡ºä¾èµ–åˆ° requirements.txtï¼Œç„¶ååœ¨ç¬¬äºŒä¸ªé˜¶æ®µä½¿ç”¨ pip install æ¥ä¸‹è½½ä¾èµ–ã€‚multi-stage build è™½ç„¶æœ€ç»ˆçš„é•œåƒé‡Œä¸åŒ…å« poetryï¼Œä½†æ˜¯ç¬¬ä¸€ä¸ªé˜¶æ®µä¸‹è½½ poetry å’Œå¯¼å‡ºä¾èµ–éƒ½éœ€è¦æ—¶é—´ï¼Œè€Œç¬¬ä¸€ç§æ–¹æ³•ä¸­ç›´æ¥å°† poetry æ‰“åˆ°åŸºç¡€é•œåƒä¸­ï¼Œé•œåƒå¤§å°ä¹Ÿåªå¢åŠ äº†ä¸åˆ° 100MBï¼Œåœ¨å¯ä»¥æ¥å—çš„èŒƒå›´å†…ï¼Œå› æ­¤æˆ‘æ›´æ¨èç¬¬ä¸€ç§ã€‚</p>\n<p>ç¡®å®šå¥½é•œåƒç­–ç•¥åï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ Dockerfile é•¿å•¥æ ·ï¼ˆåŸºç¡€é•œåƒçš„æ‰“åŒ…å°±æ˜¯åœ¨ python åŸºç¡€é•œåƒçš„ä¸Šé¢ä½¿ç”¨ pip ä¸‹è½½ poetry å³å¯ï¼Œä¸å†èµ˜è¿°ï¼‰ï¼š</p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># åŒ…å«poetryçš„pythonåŸºç¡€é•œåƒ</span></span><br><span class=\"line\"><span class=\"keyword\">FROM</span> sunpeek/poetry:py3.<span class=\"number\">10</span>-slim</span><br><span class=\"line\"><span class=\"keyword\">LABEL</span><span class=\"language-bash\"> maintainer=<span class=\"string\">&quot;robocanic@gmail.com&quot;</span></span></span><br><span class=\"line\"><span class=\"comment\"># Keeps Python from generating .pyc files in the container</span></span><br><span class=\"line\"><span class=\"keyword\">ENV</span> PYTHONDONTWRITEBYTECODE=<span class=\"number\">1</span></span><br><span class=\"line\"><span class=\"comment\"># Turns off buffering for easier container logging</span></span><br><span class=\"line\"><span class=\"keyword\">ENV</span> PYTHONUNBUFFERED=<span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># mv source code to a specific directory</span></span><br><span class=\"line\"><span class=\"keyword\">WORKDIR</span><span class=\"language-bash\"> /appruntime</span></span><br><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"language-bash\"> . /appruntime</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># no need to create virtual env</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"language-bash\"> poetry config virtualenvs.create <span class=\"literal\">false</span></span></span><br><span class=\"line\"><span class=\"comment\"># analyze deps</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"language-bash\"> poetry lock</span></span><br><span class=\"line\"><span class=\"comment\"># Install deps</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"language-bash\"> poetry install</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Creates a non-root user with an explicit UID and adds permission to access the /appruntime folder</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"language-bash\"> adduser -u 5678 --disabled-password --gecos <span class=\"string\">&quot;&quot;</span> appuser &amp;&amp; <span class=\"built_in\">chown</span> -R appuser /appruntime</span></span><br><span class=\"line\"><span class=\"keyword\">USER</span> appuser</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">CMD</span><span class=\"language-bash\"> [<span class=\"string\">&quot;uvicorn&quot;</span>, <span class=\"string\">&quot;poetry_fastapi_demo.main:app&quot;</span>, <span class=\"string\">&quot;--host=0.0.0.0&quot;</span>, <span class=\"string\">&quot;--port=8080&quot;</span>, <span class=\"string\">&quot;--log-config=/appruntime/log.yaml&quot;</span>]</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"CI-é›†æˆ-2\"><a href=\"#CI-é›†æˆ-2\" class=\"headerlink\" title=\"CI é›†æˆ\"></a>CI é›†æˆ</h3><p>å¦‚æœä½¿ç”¨äº† gitlab pipeline&#x2F;github actionsï¼Œé‚£æˆ‘ä»¬å¯ä»¥å°†é•œåƒæ‰“åŒ…ï¼Œé•œåƒæ¨é€éƒ½ç»“åˆåˆ° CI ä¸­</p>\n<h4 id=\"gitlab-pipeline-2\"><a href=\"#gitlab-pipeline-2\" class=\"headerlink\" title=\"gitlab pipeline\"></a>gitlab pipeline</h4><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">variables:</span>    <span class=\"comment\"># å˜é‡</span></span><br><span class=\"line\">  <span class=\"attr\">IMAGE_NAME:</span> <span class=\"string\">$CI_PROJECT_PATH</span></span><br><span class=\"line\">  <span class=\"attr\">PROJECT_NAME:</span> <span class=\"string\">$CI_PROJECT_NAME</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">stages:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">automatic_test_dev</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">package_build_push_dev</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">deploy_dev</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">automatic_test_job_dev:</span>   <span class=\"comment\"># æˆ‘ä»¬åªåœ¨è”è°ƒ/æµ‹è¯•æ—¶æ‰§è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œç”Ÿäº§ç¯å¢ƒä¸ºäº†åŠ å¿«å‘å¸ƒé€Ÿåº¦ï¼Œä¸æ‰§è¡Œæµ‹è¯•</span></span><br><span class=\"line\">  <span class=\"attr\">image:</span> <span class=\"string\">sunpeek/poetry:py3.10-slim</span>    <span class=\"comment\"># ä½¿ç”¨å¸¦poetryçš„pythoné•œåƒ</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">automatic_test_dev</span></span><br><span class=\"line\">  <span class=\"attr\">only:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">dev</span></span><br><span class=\"line\">  <span class=\"attr\">tags:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">python</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">poetry</span> <span class=\"string\">config</span> <span class=\"string\">virtualenvs.create</span> <span class=\"literal\">false</span>  <span class=\"comment\"># åœ¨å®¹å™¨ä¸­ï¼Œä¸ç”¨åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">poetry</span> <span class=\"string\">lock</span>     <span class=\"comment\"># é”å®šä¾èµ–ç‰ˆæœ¬</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">poetry</span> <span class=\"string\">install</span>  <span class=\"comment\"># ä¸‹è½½ä¾èµ–</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">pytest</span> <span class=\"string\">tests/</span>   <span class=\"comment\"># æ‰§è¡Œæµ‹è¯•</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">package_build_push_job_dev:</span></span><br><span class=\"line\">  <span class=\"attr\">image:</span> <span class=\"string\">docker:27.3</span>  <span class=\"comment\"># ä½¿ç”¨dockeré•œåƒ</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">package_build_push_dev</span></span><br><span class=\"line\">  <span class=\"attr\">only:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">dev</span></span><br><span class=\"line\">  <span class=\"attr\">tags:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">python</span></span><br><span class=\"line\">  <span class=\"attr\">artifacts:</span></span><br><span class=\"line\">    <span class=\"attr\">paths:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">BUILDTIME</span>   <span class=\"comment\"># ç¼“å­˜æ„å»ºæ—¶é—´æ–‡ä»¶ä¾›ä¸‹ä¸€ä¸ªjobä½¿ç”¨</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">date</span> <span class=\"string\">+&#x27;%Y%m%d%H%M&#x27;</span> <span class=\"string\">&gt;</span> <span class=\"string\">BUILDTIME</span>  <span class=\"comment\"># å°†æ„å»ºæ—¶é—´å†™åˆ°æ–‡ä»¶</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">export</span> <span class=\"string\">IMAGE_TAG=dev-$(cat</span> <span class=\"string\">BUILDTIME)-$CI_COMMIT_SHORT_SHA</span> <span class=\"comment\"># é•œåƒtag  dev-[å¹´æœˆæ—¥æ—¶åˆ†]-[commit idå‰å…«ä½]</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">export</span> <span class=\"string\">IMAGE_NAME=$(echo</span> <span class=\"string\">$IMAGE_NAME</span> <span class=\"string\">|</span> <span class=\"string\">tr</span> <span class=\"string\">&#x27;A-Z&#x27;</span> <span class=\"string\">&#x27;a-z&#x27;</span><span class=\"string\">)</span>  <span class=\"comment\"># æŠŠgitlabçš„ç›®å½•å’Œé¡¹ç›®åå°å†™ä½œä¸ºé•œåƒå</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker</span> <span class=\"string\">login</span> <span class=\"string\">-u</span> <span class=\"string\">$REGISTRY_USERNAME</span> <span class=\"string\">-p</span> <span class=\"string\">$REGISTRY_PASSWORD</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker</span> <span class=\"string\">build</span>  <span class=\"string\">-t</span> <span class=\"string\">$IMAGE_NAME:$IMAGE_TAG</span> <span class=\"string\">.</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker</span> <span class=\"string\">push</span> <span class=\"string\">$IMAGE_NAME:$IMAGE_TAG</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"github-actions-2\"><a href=\"#github-actions-2\" class=\"headerlink\" title=\"github actions\"></a>github actions</h4><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">name:</span> <span class=\"string\">Release</span> <span class=\"string\">deploy</span>           <span class=\"comment\"># workflowåå­—</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">on:</span>                            <span class=\"comment\"># è§¦å‘æ¡ä»¶ï¼Œæ–°å»ºtagæ—¶è§¦å‘</span></span><br><span class=\"line\">  <span class=\"attr\">push:</span></span><br><span class=\"line\">    <span class=\"attr\">tags:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">&#x27;*&#x27;</span>                   <span class=\"comment\"># ä»»æ„æ ‡ç­¾éƒ½ä¼šè§¦å‘å·¥ä½œæµ</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">jobs:</span></span><br><span class=\"line\">  <span class=\"attr\">pkg:</span></span><br><span class=\"line\">    <span class=\"attr\">runs-on:</span> <span class=\"string\">ubuntu-latest</span></span><br><span class=\"line\">    <span class=\"attr\">steps:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Set</span> <span class=\"string\">up</span> <span class=\"string\">QEMU</span>       <span class=\"comment\"># åˆå§‹åŒ–qemu</span></span><br><span class=\"line\">        <span class=\"attr\">uses:</span> <span class=\"string\">docker/setup-qemu-action@v3</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Set</span> <span class=\"string\">up</span> <span class=\"string\">Docker</span> <span class=\"string\">Buildx</span>   <span class=\"comment\"># åˆå§‹åŒ–buildx</span></span><br><span class=\"line\">        <span class=\"attr\">uses:</span> <span class=\"string\">docker/setup-buildx-action@v3</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Login</span> <span class=\"string\">to</span> <span class=\"string\">Docker</span> <span class=\"string\">Hub</span>   <span class=\"comment\"># ç™»å½•dockerhub</span></span><br><span class=\"line\">        <span class=\"attr\">uses:</span> <span class=\"string\">docker/login-action@v3</span></span><br><span class=\"line\">        <span class=\"attr\">with:</span></span><br><span class=\"line\">          <span class=\"attr\">username:</span> <span class=\"string\">$&#123;&#123;</span> <span class=\"string\">secrets.DOCKERHUB_USERNAME</span> <span class=\"string\">&#125;&#125;</span></span><br><span class=\"line\">          <span class=\"attr\">password:</span> <span class=\"string\">$&#123;&#123;</span> <span class=\"string\">secrets.DOCKERHUB_PASSWORD</span> <span class=\"string\">&#125;&#125;</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Extract</span> <span class=\"string\">version</span>   <span class=\"comment\"># æå–tag</span></span><br><span class=\"line\">        <span class=\"attr\">id:</span> <span class=\"string\">extract_version</span></span><br><span class=\"line\">        <span class=\"attr\">run:</span> <span class=\"string\">|</span></span><br><span class=\"line\"><span class=\"string\">          VERSION=&quot;$&#123;GITHUB_REF#refs/tags/&#125;&quot;</span></span><br><span class=\"line\"><span class=\"string\">          echo &quot;VERSION=$&#123;VERSION&#125;&quot; &gt;&gt; $GITHUB_ENV</span></span><br><span class=\"line\"><span class=\"string\"></span>      <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Build</span> <span class=\"string\">and</span> <span class=\"string\">push</span>   <span class=\"comment\"># æ„å»ºé•œåƒå¹¶æ¨é€</span></span><br><span class=\"line\">        <span class=\"attr\">uses:</span> <span class=\"string\">docker/build-push-action@v6</span></span><br><span class=\"line\">        <span class=\"attr\">with:</span></span><br><span class=\"line\">          <span class=\"attr\">push:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">          <span class=\"attr\">tags:</span> <span class=\"string\">$&#123;&#123;</span> <span class=\"string\">github.repository</span> <span class=\"string\">&#125;&#125;:$&#123;&#123;</span> <span class=\"string\">env.VERSION</span> <span class=\"string\">&#125;&#125;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"æ€»ç»“-2\"><a href=\"#æ€»ç»“-2\" class=\"headerlink\" title=\"æ€»ç»“\"></a>æ€»ç»“</h3><p>å¦‚æœä½ ä½¿ç”¨ docker compose&#x2F;docker swarm&#x2F;k8s ç­‰åŸºç¡€è®¾æ–½ï¼Œä½ è¿˜å¯ä»¥ç»“åˆ docker&#x2F;kubectl æˆ–è€… docker api&#x2F;k8s api æ¥è¿›è¡Œ CDï¼Œä»è€Œå®ç°åº”ç”¨ä»å‘å¸ƒåˆ°éƒ¨ç½²å®Œå…¨æµæ°´çº¿åŒ–ã€‚</p>\n<p>åº”ç”¨çš„å‘å¸ƒåœ¨ä¸åŒçš„å›¢é˜Ÿï¼Œä¸åŒçš„å…¬å¸æ˜¯æœ‰ç€ä¸åŒçš„æµç¨‹å’Œåå¥½çš„ï¼Œä»¥ä¸Šåªæ˜¯æˆ‘æä¾›çš„ä¸€ç§å®ç°å‚è€ƒï¼Œä½†æ˜¯æ— è®ºæ˜¯ä»€ä¹ˆå‘å¸ƒæµç¨‹ï¼Œè€ƒè™‘çš„é‡ç‚¹å…¶å®æ˜¯å¤§å·®ä¸å·®çš„ï¼š</p>\n<ol>\n<li><p>é•œåƒå¤§å°è¦å°½å¯èƒ½å‹ç¼©</p>\n</li>\n<li><p>å‘å¸ƒè¦åšåˆ°å¯å›æ»šï¼Œå¯ç°åº¦</p>\n</li>\n<li><p>å‘å¸ƒæµç¨‹ä¸­çš„ä¿¡æ¯è¦å¯è¿½æº¯</p>\n</li>\n<li><p>å‘å¸ƒä¸­ç”¨åˆ°çš„ç»„ä»¶å¤ç”¨åº¦è¦é«˜</p>\n</li>\n<li><p>â€¦â€¦</p>\n</li>\n</ol>\n<p>æŒ‰ç…§è¿™äº›ä¸ªæ€è·¯å»ç¼–æ’å‘å¸ƒæµæ°´çº¿ï¼Œç›¸ä¿¡ä½ èƒ½å¾—åˆ°ä¸€ä¸ªç†æƒ³ä¸­çš„æµæ°´çº¿ã€‚</p>\n"}],"PostAsset":[],"PostCategory":[{"post_id":"cm50ntui200033gwbfmg56z1g","category_id":"cm50ntui700043gwb7ob77f2d","_id":"cm50ntuia00073gwbbcmq3b3x"},{"post_id":"cm521ppgw00000kwbdm7l44jx","category_id":"cm521pph100010kwbf4ln3vnm","_id":"cm521pph400040kwb2tn6eqob"}],"PostTag":[{"post_id":"cm50ntui200033gwbfmg56z1g","tag_id":"cm50ntui800053gwb1v5zbfir","_id":"cm50ntuia00063gwbhwne6ukh"},{"post_id":"cm521ppgw00000kwbdm7l44jx","tag_id":"cm55fa7l60000pcwb5ugv0x8s","_id":"cm55fa7l80001pcwbg9dbdcae"}],"Tag":[{"name":"äº‘åŸç”Ÿ","_id":"cm50ntui800053gwb1v5zbfir"},{"name":"Python","_id":"cm521pph300020kwbf1ru7lx7"},{"name":"Python, æ—¥å¸¸å¼€å‘","_id":"cm55fa7l60000pcwb5ugv0x8s"}]}}